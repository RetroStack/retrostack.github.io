(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},58234,e=>{"use strict";var t=e.i(43476),r=e.i(22016),a=e.i(28540),s=e.i(85149);function n(){let e=new Date().getFullYear();return(0,t.jsx)("footer",{className:"bg-retro-navy border-t border-retro-grid safe-bottom safe-x",children:(0,t.jsx)(a.Container,{children:(0,t.jsxs)("div",{className:"py-8 sm:py-12",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8 mb-8 sm:mb-12",children:[(0,t.jsxs)("div",{className:"sm:col-span-2 lg:col-span-1",children:[(0,t.jsx)(r.default,{href:"/",className:"inline-block touch-target",children:(0,t.jsx)("span",{className:"font-display text-base sm:text-lg text-retro-pink",children:s.SITE_CONFIG.name})}),(0,t.jsx)("p",{className:"mt-3 sm:mt-4 text-sm text-gray-400 max-w-xs",children:s.SITE_CONFIG.description})]}),s.NAV_ITEMS.filter(e=>e.children).map(e=>(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-ui text-xs sm:text-sm uppercase tracking-wider text-retro-cyan mb-3 sm:mb-4",children:e.label}),(0,t.jsx)("ul",{className:"space-y-1 sm:space-y-2",children:e.children?.map(e=>(0,t.jsx)("li",{children:(0,t.jsx)(r.default,{href:e.href,className:"inline-flex items-center min-h-[36px] sm:min-h-[32px] text-sm text-gray-400 hover:text-retro-pink transition-colors duration-200",children:e.label})},e.href))})]},e.label))]}),(0,t.jsxs)("div",{className:"pt-6 sm:pt-8 border-t border-retro-grid/50 flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 text-center sm:text-left",children:["Â© ",e," ",s.SITE_CONFIG.name,". All rights reserved."]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("a",{href:s.SOCIAL_LINKS.github,target:"_blank",rel:"noopener noreferrer",className:"touch-target flex items-center justify-center text-gray-400 hover:text-retro-cyan transition-colors duration-200 rounded-md hover:bg-retro-purple/30","aria-label":"GitHub",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"})})}),(0,t.jsx)("a",{href:s.SOCIAL_LINKS.patreon,target:"_blank",rel:"noopener noreferrer",className:"touch-target flex items-center justify-center text-gray-400 hover:text-retro-pink transition-colors duration-200 rounded-md hover:bg-retro-purple/30","aria-label":"Patreon",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M15.386.524c-4.764 0-8.64 3.876-8.64 8.64 0 4.75 3.876 8.613 8.64 8.613 4.75 0 8.614-3.864 8.614-8.613C24 4.4 20.136.524 15.386.524M.003 23.537h4.22V.524H.003"})})})]})]})]})})})}e.s(["Footer",()=>n])},72547,79724,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(22016);function s(e,t=!0){let a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!t)return;let r=t=>{a.current&&!a.current.contains(t.target)&&e()},s=t=>{"Escape"===t.key&&e()};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),document.addEventListener("keydown",s),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r),document.removeEventListener("keydown",s)}},[e,t]),a}function n({items:e,trigger:n,align:l="right",className:i="",label:o="More options"}){let[c,d]=(0,r.useState)(!1),u=s((0,r.useCallback)(()=>{d(!1)},[]),c),h=e=>{e.disabled||(e.onClick?.(),d(!1))};return 0===e.length?null:(0,t.jsxs)("div",{ref:u,className:`relative ${i}`,children:[(0,t.jsx)("button",{onClick:()=>{d(!c)},className:"touch-target flex items-center justify-center p-2 text-gray-400 hover:text-retro-cyan transition-colors rounded-md hover:bg-retro-purple/30","aria-label":o,"aria-expanded":c,"aria-haspopup":"menu",children:n||(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})}),c&&(0,t.jsx)("div",{className:`absolute top-full mt-2 z-50 min-w-[180px] bg-retro-navy/95 backdrop-blur-md border border-retro-grid/50 rounded-lg py-1 shadow-xl shadow-black/50 ${"right"===l?"right-0":"left-0"}`,role:"menu","aria-orientation":"vertical",children:e.map(e=>{let r=`
              w-full flex items-center gap-3 px-4 py-3 text-sm text-left
              transition-colors touch-target
              ${e.disabled?"text-gray-500 cursor-not-allowed":"danger"===e.variant?"text-red-400 hover:bg-red-500/20 hover:text-red-300":"text-gray-200 hover:bg-retro-purple/40 hover:text-retro-cyan"}
            `;return e.href&&!e.disabled?(0,t.jsxs)(a.default,{href:e.href,className:r,role:"menuitem",onClick:()=>d(!1),children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id):(0,t.jsxs)("button",{className:r,role:"menuitem",disabled:e.disabled,onClick:()=>h(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),h(e))},children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id)})})]})}e.s(["useOutsideClick",()=>s],79724),e.s(["OverflowMenu",()=>n],72547)},16015,(e,t,r)=>{},98547,(e,t,r)=>{var a=e.i(47167);e.r(16015);var s=e.r(71645),n=s&&"object"==typeof s&&"default"in s?s:{default:s},l=void 0!==a.default&&a.default.env&&!0,i=function(e){return"[object String]"===Object.prototype.toString.call(e)},o=function(){function e(e){var t=void 0===e?{}:e,r=t.name,a=void 0===r?"stylesheet":r,s=t.optimizeForSpeed,n=void 0===s?l:s;c(i(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",c("boolean"==typeof n,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=n,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var o="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=o?o.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(l||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(c(i(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return l||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var r="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(a){l||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];c(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},r.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&c(i(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return r?s.insertBefore(a,r):s.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},u={};function h(e,t){if(!t)return"jsx-"+e;var r=String(t),a=e+r;return u[a]||(u[a]="jsx-"+d(e+"-"+r)),u[a]}function X(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return u[r]||(u[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[r]}var m=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,a=void 0===r?null:r,s=t.optimizeForSpeed,n=void 0!==s&&s;this._sheet=a||new o({name:"styled-jsx",optimizeForSpeed:n}),this._sheet.inject(),a&&"boolean"==typeof n&&(this._sheet.setOptimizeForSpeed(n),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),a=r.styleId,s=r.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var n=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=n,this._instancesCounts[a]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var a=this._fromServer&&this._fromServer[r];a?(a.parentNode.removeChild(a),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],a=e[1];return n.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,a=e.id;if(r){var s=h(a,r);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return X(s,e)}):[X(s,t)]}}return{styleId:h(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),x=s.createContext(null);function p(){return new m}function f(){return s.useContext(x)}x.displayName="StyleSheetContext";var g=n.default.useInsertionEffect||n.default.useLayoutEffect,y="undefined"!=typeof window?p():void 0;function b(e){var t=y||f();return t&&("undefined"==typeof window?t.add(e):g(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}b.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,a=s.useContext(x),l=s.useState(function(){return a||t||p()})[0];return n.default.createElement(x.Provider,{value:l},r)},r.createStyleRegistry=p,r.style=b,r.useStyleRegistry=f},37902,(e,t,r)=>{t.exports=e.r(98547).style},89043,49738,32267,29493,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function a({pixels:e,scale:a=1,showGrid:s=!1,gridColor:n="#333333",gridThickness:l=1,foregroundColor:i="#ffffff",backgroundColor:o="#000000",onPixelClick:c,onPixelDrag:d,onDragEnd:u,className:h="",interactive:X=!0,mixedPixels:m,mixedColor:x="#666666"}){let p=(0,r.useRef)(null),[f,g]=(0,r.useState)(!1),y=(0,r.useRef)(null),b=e.length,v=e[0]?.length||0,k=s?l:0,j=v*a+(s?(v+1)*l:0),w=b*a+(s?(b+1)*l:0);(0,r.useEffect)(()=>{let t=p.current;if(!t)return;let r=t.getContext("2d");if(r){r.fillStyle=s?n:o,r.fillRect(0,0,j,w);for(let t=0;t<b;t++)for(let n=0;n<v;n++){let c=s?n*(a+l)+l:n*a,d=s?t*(a+l)+l:t*a,u=`${t},${n}`,h=m?.has(u),X=e[t]?.[n]||!1;if(h){let e=Math.floor(a/2);r.fillStyle=i,r.fillRect(c,d,e,e),r.fillRect(c+e,d+e,a-e,a-e),r.fillStyle=o,r.fillRect(c+e,d,a-e,e),r.fillRect(c,d+e,e,a-e)}else r.fillStyle=X?i:o,r.fillRect(c,d,a,a)}}},[e,a,s,n,l,i,o,j,w,v,b,m,x]);let C=(0,r.useCallback)(e=>{let t,r,n=p.current;if(!n)return null;let i=n.getBoundingClientRect();if("touches"in e){if(0===e.touches.length)return null;t=e.touches[0].clientX,r=e.touches[0].clientY}else t=e.clientX,r=e.clientY;let o=t-i.left,c=r-i.top,d=n.width/i.width,u=n.height/i.height,h=a+(s?l:0),X=Math.floor((o*d-k)/h),m=Math.floor((c*u-k)/h);return m>=0&&m<b&&X>=0&&X<v?{row:m,col:X}:null},[a,s,l,k,b,v]),N=(0,r.useCallback)(e=>{if(!X)return;let t=C(e);t&&c&&(c(t.row,t.col),y.current=t,g(!0))},[X,C,c]),S=(0,r.useCallback)(e=>{if(!X||!f||!d)return;let t=C(e);t&&(!y.current||y.current.row!==t.row||y.current.col!==t.col)&&(d(t.row,t.col),y.current=t)},[X,f,C,d]),A=(0,r.useCallback)(()=>{f&&(g(!1),y.current=null,u?.())},[f,u]),M=(0,r.useCallback)(()=>{f&&(g(!1),y.current=null,u?.())},[f,u]),L=(0,r.useCallback)(e=>{if(!X)return;e.preventDefault();let t=C(e);t&&c&&(c(t.row,t.col),y.current=t,g(!0))},[X,C,c]),_=(0,r.useCallback)(e=>{if(!X||!f||!d)return;e.preventDefault();let t=C(e);t&&(!y.current||y.current.row!==t.row||y.current.col!==t.col)&&(d(t.row,t.col),y.current=t)},[X,f,C,d]),R=(0,r.useCallback)(()=>{f&&(g(!1),y.current=null,u?.())},[f,u]);return(0,t.jsx)("canvas",{ref:p,width:j,height:w,className:`${X?"cursor-crosshair":""} ${h}`,style:{imageRendering:"pixelated",touchAction:"none"},onMouseDown:N,onMouseMove:S,onMouseUp:A,onMouseLeave:M,onTouchStart:L,onTouchMove:_,onTouchEnd:R})}function s({character:e,mode:s="small",scale:n=20,smallScale:l=2,selected:i=!1,batchSelected:o=!1,onClick:c,onPixelClick:d,onPixelDrag:u,onDragEnd:h,foregroundColor:X="#ffffff",backgroundColor:m="#000000",gridColor:x="#333333",gridThickness:p=1,interactive:f=!0,className:g="",mixedPixels:y,index:b,showIndex:v=!1}){let k="large"===s,j=k?n:l,w=["relative inline-block",!k&&f?"cursor-pointer":"",!k&&f?"hover:opacity-80 transition-opacity":"",(0,r.useMemo)(()=>i?"ring-2 ring-retro-cyan ring-offset-2 ring-offset-retro-dark":o?"ring-2 ring-retro-pink/50 ring-offset-1 ring-offset-retro-dark":"",[i,o]),g].filter(Boolean).join(" ");return(0,t.jsxs)("div",{className:w,onClick:e=>{c&&!k&&(e.stopPropagation(),c())},onKeyDown:e=>{c&&!k&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),c())},role:!k&&f?"button":void 0,tabIndex:!k&&f?0:void 0,"aria-pressed":i||o,"aria-label":void 0!==b?`Character ${b}`:"Character",children:[(0,t.jsx)(a,{pixels:e.pixels,scale:j,showGrid:k,gridColor:x,gridThickness:k?p:0,foregroundColor:X,backgroundColor:m,onPixelClick:k?d:void 0,onPixelDrag:k?u:void 0,onDragEnd:k?h:void 0,interactive:k&&f,mixedPixels:y}),v&&void 0!==b&&(0,t.jsx)("div",{className:"absolute -top-1 -right-1 bg-retro-navy/90 text-[8px] text-gray-400 px-1 rounded font-mono",children:b})]})}function n({width:e,height:r,mode:a="small",scale:s=20,smallScale:n=2,onClick:l,className:i=""}){let o="large"===a,c=o?s:n;return(0,t.jsx)("div",{className:`relative inline-flex items-center justify-center bg-retro-navy/50 border border-dashed border-retro-grid/50 cursor-pointer hover:border-retro-cyan/50 transition-colors ${i}`,style:{width:e*c+(o?(e+1)*1:0),height:r*c+(o?(r+1)*1:0)},onClick:l,role:"button",tabIndex:0,onKeyDown:e=>{l&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),l())},"aria-label":"Add new character",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}function l({characters:e,config:a,selectedIndex:l,batchSelection:i,onSelect:o,showAddButton:c=!1,onAdd:d,foregroundColor:u="#ffffff",backgroundColor:h="#000000",showIndices:X=!1,minColumns:m=8,maxColumns:x=32,gap:p=4,className:f="",smallScale:g=2}){let y=(0,r.useRef)(null),{size:b}=function(e){let t=(0,r.useRef)(null),[a,s]=(0,r.useState)({width:0,height:0}),n=(0,r.useCallback)(e=>{for(let t of e){let{width:e,height:r}=t.contentRect;s({width:e,height:r})}},[void 0]);return(0,r.useEffect)(()=>{let e=t.current;if(!e)return;let r=new ResizeObserver(n);r.observe(e);let a=e.getBoundingClientRect();return s({width:a.width,height:a.height}),()=>{r.disconnect()}},[n]),{ref:t,size:a}}(),v=a.width*g,k=(0,r.useMemo)(()=>{if(!b.width)return m;let e=v+p+8;return Math.max(m,Math.min(x,Math.floor((b.width-p)/e)))},[b.width,v,p,m,x]);return(0,t.jsx)("div",{ref:y,className:`overflow-auto p-2 ${f}`,role:"listbox","aria-label":"Character selection grid",children:(0,t.jsxs)("div",{className:"grid",style:{gridTemplateColumns:`repeat(${k}, auto)`,gap:`${p}px`},children:[e.map((e,r)=>(0,t.jsx)("div",{onClick:e=>o?.(r,e.shiftKey),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),o?.(r,e.shiftKey))},role:"option","aria-selected":l===r||i?.has(r),tabIndex:0,className:"focus:outline-none focus-visible:ring-1 focus-visible:ring-retro-cyan rounded",children:(0,t.jsx)(s,{character:e,mode:"small",smallScale:g,selected:l===r,batchSelected:i?.has(r)&&l!==r,foregroundColor:u,backgroundColor:h,interactive:!1,index:r,showIndex:X})},r)),c&&(0,t.jsx)(n,{width:a.width,height:a.height,mode:"small",smallScale:g,onClick:d})]})})}function i({characters:e,config:s,maxCharacters:n=32,maxWidth:l=128,maxHeight:i=64,foregroundColor:o="#ffffff",backgroundColor:c="#000000",className:d=""}){let{displayChars:u,columns:h,rows:X}=(0,r.useMemo)(()=>{let t=s.width,r=s.height,a=Math.floor(l/t),o=Math.floor(i/r),c=Math.min(n,a*o,e.length),d=a,u=Math.ceil(c/d);for(;u>o&&d>1;)u=Math.ceil(c/--d);let h=Math.min(d*u,c);return{displayChars:e.slice(0,h),columns:d,rows:u}},[e,s,n,l,i]),m=(0,r.useMemo)(()=>{let{width:e,height:t}=s,r=h*e,a=Array.from({length:X*t},()=>Array(r).fill(!1));return u.forEach((r,s)=>{let n=s%h*e,l=Math.floor(s/h)*t;for(let s=0;s<t;s++)for(let t=0;t<e;t++)r.pixels[s]?.[t]&&(a[l+s][n+t]=!0)}),a},[u,s,h,X]),x=e.length-u.length;return(0,t.jsxs)("div",{className:`relative inline-block ${d}`,children:[(0,t.jsx)(a,{pixels:m,scale:1,showGrid:!1,foregroundColor:o,backgroundColor:c,interactive:!1}),x>0&&(0,t.jsxs)("div",{className:"absolute bottom-0 right-0 bg-retro-dark/90 text-[9px] text-gray-400 px-1 rounded-tl font-mono",children:["+",x]})]})}e.s(["PixelGrid",()=>a],89043),e.s(["CharacterDisplay",()=>s,"EmptyCharacterDisplay",()=>n],49738),e.i(37902),e.s(["InteractiveCharacterGrid",()=>l],32267),e.s(["CharacterPreview",()=>i],29493)},3813,33712,38152,82906,92921,44824,79086,4941,93949,25544,60441,42187,87355,45835,3573,43237,99401,15558,16244,63427,66811,83621,54750,7259,e=>{"use strict";e.i(89043);var t=e.i(49738),r=e.i(32267),a=e.i(29493),s=e.i(43476),n=e.i(71645),l=e.i(72547);function i(e){return Math.ceil(e/8)}function o(e){return i(e.width)*e.height}function c(e,t){let r=[];for(let a=0;a<t;a++)r.push(Array(e).fill(!1));return{pixels:r}}function d(e){return{pixels:e.pixels.map(e=>[...e])}}function u(){return{width:8,height:8,padding:"right",bitDirection:"ltr"}}function h(){return crypto.randomUUID()}function X(e,t){let{width:r,height:a,padding:s,bitDirection:n}=t,l=i(r),o=new Uint8Array(a*l);for(let t=0;t<a;t++){let a=8*l,i=a-r,c=Array(a).fill(!1);if("left"===s)for(let a=0;a<r;a++)c[i+a]=e.pixels[t]?.[a]||!1;else for(let a=0;a<r;a++)c[a]=e.pixels[t]?.[a]||!1;for(let e=0;e<l;e++){let r=0;for(let t=0;t<8;t++)c[8*e+t]&&(r|=1<<("ltr"===n?7-t:t));o[t*l+e]=r}}return o}function m(e,t){let r=e instanceof Uint8Array?e:new Uint8Array(e),a=o(t),s=Math.floor(r.length/a),n=[];for(let e=0;e<s;e++){let s=r.slice(e*a,(e+1)*a);n.push(function(e,t){let{width:r,height:a,padding:s,bitDirection:n}=t,l=i(r),o=[];for(let t=0;t<a;t++){let a=[],i=t*l,c=[];for(let t=0;t<l;t++){let r=e[i+t]||0;for(let e=0;e<8;e++){let t=(r&1<<("ltr"===n?7-e:e))!=0;c.push(t)}}let d=8*l,u=d-r;if("left"===s)for(let e=u;e<d;e++)a.push(c[e]);else for(let e=0;e<r;e++)a.push(c[e]);o.push(a)}return{pixels:o}}(s,t))}return n}function x(e,t){let r=o(t),a=new Uint8Array(e.length*r);for(let s=0;s<e.length;s++){let n=X(e[s],t);a.set(n,s*r)}return a}function p(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function f(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function g(e){let t=x(e.characters,e.config);return{metadata:e.metadata,config:e.config,binaryData:p(t)}}function y(e){let t=m(f(e.binaryData),e.config);return{metadata:e.metadata,config:e.config,characters:t}}function b(e,t,r){return new Blob([x(e,{...t,...r}).buffer],{type:"application/octet-stream"})}function v(e,t){let r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}e.s(["bytesPerCharacter",()=>o,"bytesPerLine",()=>i,"cloneCharacter",()=>d,"createDefaultConfig",()=>u,"createEmptyCharacter",()=>c,"generateId",()=>h],33712),e.s(["base64ToBinary",()=>f,"binaryToBase64",()=>p,"characterToBytes",()=>X,"createDownloadBlob",()=>b,"deserializeCharacterSet",()=>y,"downloadBlob",()=>v,"parseCharacterRom",()=>m,"serializeCharacterRom",()=>x,"serializeCharacterSet",()=>g],38152);let k="character-sets",j="retrostack-character-sets",w=new class{db=null;initialized=!1;initPromise=null;async initialize(){if(!this.initialized){if(this.initPromise)return this.initPromise;this.initPromise=this._initialize(),await this.initPromise,this.initialized=!0}}async _initialize(){return!function(){try{return!!window.indexedDB}catch{return!1}}()?void console.log("IndexedDB not available, using localStorage fallback"):new Promise((e,t)=>{let r=indexedDB.open("retrostack-character-editor",2);r.onerror=()=>{console.error("Failed to open IndexedDB, using localStorage fallback"),e()},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=e=>{let t=e.target.result,r=e.target.transaction,a=e.oldVersion;if(t.objectStoreNames.contains(k)){if(a<2){let e=r.objectStore(k);e.indexNames.contains("by-maker")||e.createIndex("by-maker","metadata.maker",{unique:!1}),e.indexNames.contains("by-system")||e.createIndex("by-system","metadata.system",{unique:!1}),e.openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.maker&&(e.metadata.maker=""),e.metadata&&void 0===e.metadata.system&&(e.metadata.system=""),t.update(e),t.continue()}}}}else{let e=t.createObjectStore(k,{keyPath:"metadata.id"});e.createIndex("by-name","metadata.name",{unique:!1}),e.createIndex("by-updated","metadata.updatedAt",{unique:!1}),e.createIndex("by-size","sizeKey",{unique:!1}),e.createIndex("by-maker","metadata.maker",{unique:!1}),e.createIndex("by-system","metadata.system",{unique:!1})}}})}useFallback(){return null===this.db}fallbackGetAll(){try{let e=localStorage.getItem(j);if(!e)return[];return JSON.parse(e).map(e=>({...e,metadata:{...e.metadata,maker:e.metadata.maker??"",system:e.metadata.system??""}}))}catch{return[]}}fallbackSaveAll(e){try{localStorage.setItem(j,JSON.stringify(e))}catch(e){throw console.error("Failed to save to localStorage:",e),Error("Storage quota exceeded")}}async getAll(){return(await this.initialize(),this.useFallback())?this.fallbackGetAll():new Promise((e,t)=>{let r=this.db.transaction([k],"readonly").objectStore(k).getAll();r.onsuccess=()=>{let t=r.result;t.sort((e,t)=>t.metadata.updatedAt-e.metadata.updatedAt),e(t)},r.onerror=()=>{t(Error("Failed to get character sets"))}})}async getById(e){return(await this.initialize(),this.useFallback())?this.fallbackGetAll().find(t=>t.metadata.id===e)||null:new Promise((t,r)=>{let a=this.db.transaction([k],"readonly").objectStore(k).get(e);a.onsuccess=()=>{t(a.result||null)},a.onerror=()=>{r(Error("Failed to get character set"))}})}async save(e){await this.initialize();let t={...e,sizeKey:`${e.config.width}x${e.config.height}`};if(this.useFallback()){let t=this.fallbackGetAll(),r=t.findIndex(t=>t.metadata.id===e.metadata.id);return r>=0?t[r]=e:t.push(e),this.fallbackSaveAll(t),e.metadata.id}return new Promise((r,a)=>{let s=this.db.transaction([k],"readwrite").objectStore(k).put(t);s.onsuccess=()=>{r(e.metadata.id)},s.onerror=()=>{a(Error("Failed to save character set"))}})}async saveAs(e,t){let r=h(),a=Date.now(),s={...e,metadata:{...e.metadata,id:r,name:t,createdAt:a,updatedAt:a,isBuiltIn:!1,source:"yourself"}};return await this.save(s),r}async delete(e){if(await this.initialize(),this.useFallback()){let t=this.fallbackGetAll().filter(t=>t.metadata.id!==e);this.fallbackSaveAll(t);return}return new Promise((t,r)=>{let a=this.db.transaction([k],"readwrite").objectStore(k).delete(e);a.onsuccess=()=>{t()},a.onerror=()=>{r(Error("Failed to delete character set"))}})}async search(e){let t=await this.getAll(),r=e.toLowerCase();return t.filter(e=>e.metadata.name.toLowerCase().includes(r)||e.metadata.description.toLowerCase().includes(r)||e.metadata.source.toLowerCase().includes(r)||e.metadata.maker.toLowerCase().includes(r)||e.metadata.system.toLowerCase().includes(r))}async filterBySize(e,t){return(await this.getAll()).filter(r=>(null===e||r.config.width===e)&&(null===t||r.config.height===t))}async filterByMakers(e){if(0===e.length)return this.getAll();let t=await this.getAll(),r=e.map(e=>e.toLowerCase());return t.filter(e=>r.includes(e.metadata.maker.toLowerCase()))}async filterBySystems(e){if(0===e.length)return this.getAll();let t=await this.getAll(),r=e.map(e=>e.toLowerCase());return t.filter(e=>r.includes(e.metadata.system.toLowerCase()))}async getAvailableMakers(){let e=await this.getAll(),t=new Set;for(let r of e)r.metadata.maker&&t.add(r.metadata.maker);return Array.from(t).sort()}async getAvailableSystems(){let e=await this.getAll(),t=new Set;for(let r of e)r.metadata.system&&t.add(r.metadata.system);return Array.from(t).sort()}async getAvailableSizes(){let e=await this.getAll(),t=new Map;for(let r of e){let e=`${r.config.width}x${r.config.height}`;t.has(e)||t.set(e,{width:r.config.width,height:r.config.height})}return Array.from(t.values()).sort((e,t)=>e.width!==t.width?e.width-t.width:e.height-t.height)}async nameExists(e,t){return(await this.getAll()).some(r=>r.metadata.name.toLowerCase()===e.toLowerCase()&&r.metadata.id!==t)}async count(){return(await this.getAll()).length}async isEmpty(){return 0===(await this.getAll()).length}async clear(){return(await this.initialize(),this.useFallback())?void localStorage.removeItem(j):new Promise((e,t)=>{let r=this.db.transaction([k],"readwrite").objectStore(k).clear();r.onsuccess=()=>{e()},r.onerror=()=>{t(Error("Failed to clear storage"))}})}};function C(e){return{pixels:e.pixels.map(e=>e.map(e=>!e))}}function N(e){return{pixels:e.pixels.map(e=>[...e].reverse())}}function S(e){return{pixels:[...e.pixels].reverse().map(e=>[...e])}}function A(e,t,r,a){return{pixels:e.pixels.map((e,s)=>s===t?e.map((e,t)=>t===r?a:e):[...e])}}function M(e,t,r){return e.map((e,a)=>t.has(a)?r(e):e)}function L(e,t,r,a){let s=Array.from(t).map(t=>e[t]);if(0===s.length)return"same-off";let n=s[0]?.pixels[r]?.[a]||!1;for(let e=1;e<s.length;e++)if((s[e]?.pixels[r]?.[a]||!1)!==n)return"mixed";return n?"same-on":"same-off"}let _=[{id:"classic",name:"Classic (White/Black)",foreground:"#ffffff",background:"#000000",gridColor:"#333333"},{id:"green",name:"Green Phosphor",foreground:"#33ff33",background:"#001100",gridColor:"#004400"},{id:"amber",name:"Amber Phosphor",foreground:"#ffb000",background:"#1a0a00",gridColor:"#4d2e00"},{id:"c64-blue",name:"C64 Blue",foreground:"#6c5eb5",background:"#40318d",gridColor:"#2e2266"},{id:"c64-cyan",name:"C64 Light Blue",foreground:"#70a4b2",background:"#352879",gridColor:"#493f99"},{id:"apple-green",name:"Apple II Green",foreground:"#14f53c",background:"#000000",gridColor:"#0a4d15"},{id:"zx-spectrum",name:"ZX Spectrum",foreground:"#ffffff",background:"#0000d7",gridColor:"#0000aa"},{id:"ibm-cga",name:"IBM CGA Cyan",foreground:"#55ffff",background:"#000000",gridColor:"#005555"},{id:"vt100",name:"VT100",foreground:"#00ff00",background:"#000000",gridColor:"#003300"},{id:"custom",name:"Custom...",foreground:"",background:"",gridColor:""}],R="character-editor-color-preset",E="character-editor-custom-colors";function I(e){return _.find(t=>t.id===e)}function B(e){try{localStorage.setItem(R,e)}catch{}}function D(){try{return localStorage.getItem(R)||"classic"}catch{return"classic"}}function $(e){try{localStorage.setItem(E,JSON.stringify(e))}catch{}}function z(){try{let e=localStorage.getItem(E);if(e)return JSON.parse(e)}catch{}return{foreground:"#ffffff",background:"#000000",gridColor:"#333333"}}function F(){let e=D();if("custom"===e)return z();let t=I(e);return t?{foreground:t.foreground,background:t.background,gridColor:t.gridColor}:{foreground:"#ffffff",background:"#000000",gridColor:"#333333"}}function P(){let e=[];e.push(["........","........","........","........","........","........","........","........"]),e.push(["...XX...","...XX...","...XX...","...XX...","...XX...","........","...XX...","........"]),e.push([".XX..XX.",".XX..XX.",".XX..XX.","........","........","........","........","........"]),e.push([".XX..XX.","XXXXXXXX",".XX..XX.",".XX..XX.","XXXXXXXX",".XX..XX.","........","........"]),e.push(["...XX...",".XXXXXX.","XX......",".XXXXX..","....XX..","XXXXXX..","...XX...","........"]),e.push(["XX....XX","XX...XX.","....XX..","...XX...","..XX....",".XX...XX","XX....XX","........"]),e.push(["..XXX...",".XX.XX..","..XXX...",".XXX.XX.","XX..XX..","XX..XX..",".XXX.XX.","........"]),e.push(["...XX...","...XX...","..XX....","........","........","........","........","........"]),e.push(["....XX..","...XX...","..XX....","..XX....","..XX....","...XX...","....XX..","........"]),e.push(["..XX....","...XX...","....XX..","....XX..","....XX..","...XX...","..XX....","........"]),e.push(["........","..X..X..","...XX...",".XXXXXX.","...XX...","..X..X..","........","........"]),e.push(["........","...XX...","...XX...",".XXXXXX.","...XX...","...XX...","........","........"]),e.push(["........","........","........","........","........","...XX...","...XX...","..XX...."]),e.push(["........","........","........",".XXXXXX.","........","........","........","........"]),e.push(["........","........","........","........","........","...XX...","...XX...","........"]),e.push(["......XX",".....XX.","....XX..","...XX...","..XX....",".XX.....","XX......","........"]),e.push([".XXXXX..","XX...XX.","XX..XXX.","XX.X.XX.","XXX..XX.","XX...XX.",".XXXXX..","........"]),e.push(["...XX...","..XXX...","...XX...","...XX...","...XX...","...XX...",".XXXXXX.","........"]),e.push([".XXXXX..","XX...XX.",".....XX.","...XXX..","..XX....",".XX.....","XXXXXXX.","........"]),e.push([".XXXXX..","XX...XX.",".....XX.","..XXXX..",".....XX.","XX...XX.",".XXXXX..","........"]),e.push(["....XXX.","...XXXX.","..XX.XX.",".XX..XX.","XXXXXXX.",".....XX.",".....XX.","........"]),e.push(["XXXXXXX.","XX......","XXXXXX..",".....XX.",".....XX.","XX...XX.",".XXXXX..","........"]),e.push(["..XXXX..",".XX.....","XX......","XXXXXX..","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XXXXXXX.",".....XX.","....XX..","...XX...","..XX....","..XX....","..XX....","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.",".XXXXX..","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.",".XXXXXX.",".....XX.","....XX..",".XXXX...","........"]),e.push(["........","...XX...","...XX...","........","...XX...","...XX...","........","........"]),e.push(["........","...XX...","...XX...","........","...XX...","...XX...","..XX....","........"]),e.push([".....XX.","....XX..","...XX...","..XX....","...XX...","....XX..",".....XX.","........"]),e.push(["........","........",".XXXXXX.","........",".XXXXXX.","........","........","........"]),e.push([".XX.....","..XX....","...XX...","....XX..","...XX...","..XX....",".XX.....","........"]),e.push([".XXXXX..","XX...XX.",".....XX.","...XXX..","...XX...","........","...XX...","........"]),e.push([".XXXXX..","XX...XX.","XX.XXXX.","XX.XXXX.","XX.XXX..","XX......",".XXXXX..","........"]),e.push(["..XXX...",".XX.XX..","XX...XX.","XXXXXXX.","XX...XX.","XX...XX.","XX...XX.","........"]),e.push(["XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","........"]),e.push([".XXXXX..","XX...XX.","XX......","XX......","XX......","XX...XX.",".XXXXX..","........"]),e.push(["XXXXX...","XX..XX..","XX...XX.","XX...XX.","XX...XX.","XX..XX..","XXXXX...","........"]),e.push(["XXXXXXX.","XX......","XX......","XXXXX...","XX......","XX......","XXXXXXX.","........"]),e.push(["XXXXXXX.","XX......","XX......","XXXXX...","XX......","XX......","XX......","........"]),e.push([".XXXXX..","XX...XX.","XX......","XX..XXX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XXXXXXX.","XX...XX.","XX...XX.","XX...XX.","........"]),e.push([".XXXXXX.","...XX...","...XX...","...XX...","...XX...","...XX...",".XXXXXX.","........"]),e.push(["...XXXX.",".....XX.",".....XX.",".....XX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XX...XX.","XX..XX..","XX.XX...","XXXX....","XX.XX...","XX..XX..","XX...XX.","........"]),e.push(["XX......","XX......","XX......","XX......","XX......","XX......","XXXXXXX.","........"]),e.push(["XX...XX.","XXX.XXX.","XXXXXXX.","XX.X.XX.","XX...XX.","XX...XX.","XX...XX.","........"]),e.push(["XX...XX.","XXX..XX.","XXXX.XX.","XX.XXXX.","XX..XXX.","XX...XX.","XX...XX.","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.","XX...XX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","XX......","XX......","XX......","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.","XX...XX.","XX.X.XX.","XX..XX..",".XXX.XX.","........"]),e.push(["XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","XX.XX...","XX..XX..","XX...XX.","........"]),e.push([".XXXXX..","XX...XX.","XX......",".XXXXX..",".....XX.","XX...XX.",".XXXXX..","........"]),e.push(["XXXXXXX.","...XX...","...XX...","...XX...","...XX...","...XX...","...XX...","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XX...XX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XX...XX.",".XX.XX..","..XXX...","...X....","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XX.X.XX.","XXXXXXX.","XXX.XXX.","XX...XX.","........"]),e.push(["XX...XX.",".XX.XX..","..XXX...","...X....","..XXX...",".XX.XX..","XX...XX.","........"]),e.push(["XX...XX.",".XX.XX..","..XXX...","...XX...","...XX...","...XX...","...XX...","........"]),e.push(["XXXXXXX.",".....XX.","....XX..","...XX...","..XX....",".XX.....","XXXXXXX.","........"]),e.push(["..XXXX..","..XX....","..XX....","..XX....","..XX....","..XX....","..XXXX..","........"]),e.push(["XX......",".XX.....","..XX....","...XX...","....XX..",".....XX.","......XX","........"]),e.push(["..XXXX..","....XX..","....XX..","....XX..","....XX..","....XX..","..XXXX..","........"]),e.push(["...X....","..XXX...",".XX.XX..","XX...XX.","........","........","........","........"]),e.push(["........","........","........","........","........","........","XXXXXXXX","........"]);let t=new Uint8Array(8*e.length);for(let r=0;r<e.length;r++){let a=function(e){let t=new Uint8Array(8);for(let r=0;r<8&&r<e.length;r++){let a=0;for(let t=0;t<8;t++){let s=e[r]?.[t]||".";("X"===s||"#"===s||"*"===s)&&(a|=1<<7-t)}t[r]=a}return t}(e[r]);t.set(a,8*r)}return t}e.s(["COLOR_PRESETS",0,_,"getActiveColors",()=>F,"getCustomColors",()=>z,"getPresetById",()=>I,"getSavedPresetId",()=>D,"saveCustomColors",()=>$,"saveSelectedPreset",()=>B],82906);let O=[{maker:"Commodore",systems:["C64","VIC-20","C128","PET","Plus/4","C16","Amiga"]},{maker:"Apple",systems:["Apple II","Apple IIe","Apple IIc","Apple IIgs","Apple III"]},{maker:"Sinclair",systems:["ZX Spectrum","ZX81","ZX80","QL"]},{maker:"Atari",systems:["Atari 400/800","Atari ST","Atari 2600","Atari 7800","Atari Lynx"]},{maker:"IBM",systems:["PC CGA","PC EGA","PC VGA","PC MDA","PC Hercules"]},{maker:"Nintendo",systems:["NES/Famicom","SNES","Game Boy","Game Boy Color","Game Boy Advance"]},{maker:"Sega",systems:["Master System","Genesis/Mega Drive","Game Gear","Saturn"]},{maker:"Amstrad",systems:["CPC 464","CPC 6128","CPC 664","PCW"]},{maker:"Texas Instruments",systems:["TI-99/4A"]},{maker:"Tandy",systems:["TRS-80 Model I","TRS-80 Model III","TRS-80 Color Computer","TRS-80 Model 4"]},{maker:"MSX",systems:["MSX","MSX2","MSX2+","MSX turbo R"]},{maker:"Acorn",systems:["BBC Micro","Electron","Archimedes"]},{maker:"Coleco",systems:["ColecoVision","Adam"]},{maker:"Mattel",systems:["Intellivision"]},{maker:"NEC",systems:["PC Engine/TurboGrafx-16","PC-8801","PC-9801"]},{maker:"Sharp",systems:["MZ-80","X1","X68000"]}];function T(e){let t=O.find(t=>t.maker.toLowerCase()===e.toLowerCase());return t?.systems||[]}function G(e){return e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`}function W(e){return`${e.width}x${e.height}`}function H(e){let t=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");return`${t||"charset"}.bin`}function K(e){let t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return[".bin",".rom",".chr",".fnt",".dat"].includes(t)||!t||t===e.name.toLowerCase()}function U(e,t){return Math.floor(e/(Math.ceil(t.width/8)*t.height))}function V(e){let t=new Date(e),r=Math.floor((new Date().getTime()-e)/864e5);return 0===r?"Today":1===r?"Yesterday":r<7?`${r} days ago`:t.toLocaleDateString()}function Z(e){return{arrayName:e.replace(/[^a-zA-Z0-9_]/g,"_").replace(/^[0-9]/,"_$&").toUpperCase()||"CHARSET",includeGuards:!0,includeComments:!0,bytesPerLine:8}}function q(e){return{labelName:e.replace(/[^a-zA-Z0-9_]/g,"_").replace(/^[0-9]/,"_$&").toLowerCase()||"charset",directive:".byte",useHex:!0,includeComments:!0,bytesPerLine:8}}function J(){return{columns:16,scale:4,showGrid:!0,gridColor:"#333333",foregroundColor:"#ffffff",backgroundColor:"#000000",transparent:!1}}function Y(e,t,r){let a=[],s=`${r.arrayName}_H`,n=o(t);r.includeComments&&(a.push("/**"),a.push(` * ${r.arrayName} - Character ROM Data`),a.push(" * Generated by RetroStack Character ROM Editor"),a.push(" * "),a.push(` * Character dimensions: ${t.width}x${t.height}`),a.push(` * Total characters: ${e.length}`),a.push(` * Bytes per character: ${n}`),a.push(" */"),a.push("")),r.includeGuards&&(a.push(`#ifndef ${s}`),a.push(`#define ${s}`),a.push(""));let l=e.length*n;a.push(`const unsigned char ${r.arrayName}[${l}] = {`);for(let s=0;s<e.length;s++){let n=X(e[s],t),l=[];for(let e=0;e<n.length;e++)l.push(`0x${n[e].toString(16).padStart(2,"0").toUpperCase()}`);for(let t=0;t<l.length;t+=r.bytesPerLine){let n=l.slice(t,t+r.bytesPerLine),i=s===e.length-1&&t+r.bytesPerLine>=l.length,o=`  ${n.join(", ")}${i?"":","}`;r.includeComments&&0===t?a.push(`${o}  /* Char ${s} */`):a.push(o)}}return a.push("};"),a.push(""),r.includeGuards&&(a.push(`#endif /* ${s} */`),a.push("")),a.join("\n")}function Q(e,t,r){let a=[],s=o(t);r.includeComments&&(a.push("; "+"=".repeat(60)),a.push(`; ${r.labelName} - Character ROM Data`),a.push("; Generated by RetroStack Character ROM Editor"),a.push("; "),a.push(`; Character dimensions: ${t.width}x${t.height}`),a.push(`; Total characters: ${e.length}`),a.push(`; Bytes per character: ${s}`),a.push("; "+"=".repeat(60)),a.push("")),a.push(`${r.labelName}:`);for(let s=0;s<e.length;s++){let n=X(e[s],t),l=[];for(let e=0;e<n.length;e++)r.useHex?l.push(`$${n[e].toString(16).padStart(2,"0").toUpperCase()}`):l.push(n[e].toString());for(let e=0;e<l.length;e+=r.bytesPerLine){let t=l.slice(e,e+r.bytesPerLine),n=`    ${r.directive} ${t.join(", ")}`;r.includeComments&&0===e?a.push(`${n}  ; Char ${s}`):a.push(n)}}return a.push(""),a.join("\n")}async function ee(e,t,r){let{columns:a,scale:s,showGrid:n,gridColor:l,foregroundColor:i,backgroundColor:o,transparent:c}=r,d=Math.ceil(e.length/a),u=t.width,h=t.height,X=+!!n,m=a*u*s+(n?(a+1)*X:0),x=d*h*s+(n?(d+1)*X:0),p=document.createElement("canvas");p.width=m,p.height=x;let f=p.getContext("2d");if(!f)throw Error("Could not create canvas context");if(c?f.clearRect(0,0,m,x):(f.fillStyle=o,f.fillRect(0,0,m,x)),n){f.fillStyle=l;for(let e=0;e<=a;e++){let t=e*(u*s+X);f.fillRect(t,0,X,x)}for(let e=0;e<=d;e++){let t=e*(h*s+X);f.fillRect(0,t,m,X)}}for(let t=0;t<e.length;t++){let r=e[t],l=t%a,d=Math.floor(t/a),m=n?l*(u*s+X)+X:l*u*s,x=n?d*(h*s+X)+X:d*h*s;for(let e=0;e<h;e++)for(let t=0;t<u;t++)r.pixels[e]?.[t]?(f.fillStyle=i,f.fillRect(m+t*s,x+e*s,s,s)):c||(f.fillStyle=o,f.fillRect(m+t*s,x+e*s,s,s))}return new Promise((e,t)=>{p.toBlob(r=>{r?e(r):t(Error("Failed to create PNG blob"))},"image/png")})}function et(e,t,r=16){if(0===e.length)return"";let a=[],s=0;for(;a.length<r&&s<e.length;){let n=X(e[s],t);for(let e=0;e<n.length&&a.length<r;e++)a.push(n[e]);s++}return a.map(e=>e.toString(16).padStart(2,"0").toUpperCase()).join(" ")}function er(e,t,r=0){let a=X(e,t),s=i(t.width),n=a.slice(r*s,(r+1)*s),l="";for(let e of n)l+=e.toString(2).padStart(8,"0");let o=8*s-t.width,c="";return c="left"===t.padding?"P".repeat(o)+"D".repeat(t.width):"D".repeat(t.width)+"P".repeat(o),{bits:l,hex:Array.from(n).map(e=>e.toString(16).padStart(2,"0").toUpperCase()).join(" "),padding:c}}function ea({characterSet:e,onEdit:t,onExport:r,onDelete:i,onDuplicate:o,onRename:c}){let{metadata:d,config:u}=e,h=(0,n.useMemo)(()=>{try{return y(e).characters}catch{return[]}},[e]),X=h.length,m=(0,n.useMemo)(()=>{let e=[];return t&&e.push({id:"edit",label:"Edit",onClick:t}),c&&!d.isBuiltIn&&e.push({id:"rename",label:"Rename",onClick:c}),r&&e.push({id:"export",label:"Export",onClick:r}),o&&e.push({id:"duplicate",label:"Duplicate",onClick:o}),i&&!d.isBuiltIn&&e.push({id:"delete",label:"Delete",onClick:i,variant:"danger"}),e},[t,c,r,o,i,d.isBuiltIn]);return(0,s.jsxs)("div",{className:"card-retro p-4 flex flex-col gap-3 hover-glow-cyan transition-all",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-retro-cyan truncate",children:d.name}),(d.maker||d.system)&&(0,s.jsxs)("p",{className:"text-[10px] text-gray-500 mt-0.5",children:[d.maker,d.maker&&d.system?" ":"",d.system]}),d.description&&(0,s.jsx)("p",{className:"text-xs text-gray-400 line-clamp-2 mt-0.5",children:d.description})]}),m.length>0&&(0,s.jsx)(l.OverflowMenu,{items:m,align:"right",label:"Character set actions"})]}),(0,s.jsx)("div",{className:"flex justify-center py-2 bg-black/30 rounded",children:(0,s.jsx)(a.CharacterPreview,{characters:h,config:u,maxCharacters:128,maxWidth:256,maxHeight:128})}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-retro-grid/30 text-[10px]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-pink rounded",children:W(u)}),(0,s.jsxs)("span",{className:"text-gray-500",children:[X," char",1!==X?"s":""]}),d.isBuiltIn&&(0,s.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-navy text-gray-400 rounded",children:"Built-in"}),(0,s.jsx)("span",{className:"text-gray-500",children:V(d.updatedAt)})]}),(0,s.jsxs)("div",{className:"flex gap-1",children:[t&&(0,s.jsx)("button",{onClick:t,className:"px-2 py-1 text-xs bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Edit"}),r&&(0,s.jsx)("button",{onClick:r,className:"px-2 py-1 text-xs bg-retro-pink/20 text-retro-pink rounded hover:bg-retro-pink/30 transition-colors",children:"Export"})]})]})]})}function es({onImport:e,onCreate:t}){return(0,s.jsxs)("div",{className:"card-retro p-6 flex flex-col items-center justify-center gap-4 border-dashed",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-retro-purple/20 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-retro-pink",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-300",children:"Add a character set"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Import a ROM file or create from scratch"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[e&&(0,s.jsx)("button",{onClick:e,className:"px-3 py-1.5 text-xs bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Import"}),t&&(0,s.jsx)("button",{onClick:t,className:"px-3 py-1.5 text-xs bg-retro-pink/20 text-retro-pink rounded hover:bg-retro-pink/30 transition-colors",children:"Create New"})]})]})}function en({characterSets:e,loading:t=!1,onEdit:r,onExport:a,onDelete:n,onDuplicate:l,onRename:i,onImport:o,onCreate:c,className:d=""}){return t?(0,s.jsx)("div",{className:`grid-fluid gap-4 ${d}`,children:Array.from({length:4}).map((e,t)=>(0,s.jsx)(el,{},t))}):0===e.length?(0,s.jsx)("div",{className:`flex flex-col items-center justify-center py-12 ${d}`,children:(0,s.jsx)(es,{onImport:o,onCreate:c})}):(0,s.jsxs)("div",{className:`grid-fluid gap-4 ${d}`,children:[e.map(e=>(0,s.jsx)(ea,{characterSet:e,onEdit:r?()=>r(e.metadata.id):void 0,onExport:a?()=>a(e.metadata.id):void 0,onDelete:n?()=>n(e.metadata.id):void 0,onDuplicate:l?()=>l(e.metadata.id):void 0,onRename:i?()=>i(e.metadata.id):void 0},e.metadata.id)),(o||c)&&(0,s.jsx)(es,{onImport:o,onCreate:c})]})}function el(){return(0,s.jsxs)("div",{className:"card-retro p-4 animate-pulse",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"h-4 bg-retro-grid/30 rounded w-3/4"}),(0,s.jsx)("div",{className:"h-3 bg-retro-grid/20 rounded w-full mt-2"})]}),(0,s.jsx)("div",{className:"w-6 h-6 bg-retro-grid/20 rounded"})]}),(0,s.jsx)("div",{className:"h-16 bg-black/30 rounded mb-3"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,s.jsx)("div",{className:"h-4 w-12 bg-retro-grid/20 rounded"}),(0,s.jsx)("div",{className:"h-4 w-16 bg-retro-grid/20 rounded"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-retro-grid/30",children:[(0,s.jsx)("div",{className:"h-3 w-20 bg-retro-grid/20 rounded"}),(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)("div",{className:"h-6 w-12 bg-retro-grid/20 rounded"}),(0,s.jsx)("div",{className:"h-6 w-14 bg-retro-grid/20 rounded"})]})]})]})}function ei({onClearFilters:e}){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-retro-navy/50 flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:"No results found"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your search or filters"}),e&&(0,s.jsx)("button",{onClick:e,className:"px-4 py-2 text-sm bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Clear all filters"})]})}function eo({error:e,onRetry:t}){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Failed to load library"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:e}),t&&(0,s.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Try again"})]})}e.s(["calculateCharacterCount",()=>U,"formatFileSize",()=>G,"formatSize",()=>W,"formatTimestamp",()=>V,"getSuggestedFilename",()=>H,"isValidBinaryFile",()=>K],92921),e.s(["EXPORT_FORMATS",0,[{id:"binary",name:"Binary ROM",description:"Raw binary data for direct ROM programming",extension:".bin",mimeType:"application/octet-stream"},{id:"c-header",name:"C/C++ Header",description:"Byte array for embedded development",extension:".h",mimeType:"text/x-c"},{id:"assembly",name:"Assembly Include",description:"Data bytes for 6502/Z80 assembly",extension:".asm",mimeType:"text/plain"},{id:"png",name:"PNG Image",description:"Character sheet image",extension:".png",mimeType:"image/png"}],"exportToAssembly",()=>Q,"exportToCHeader",()=>Y,"exportToPng",()=>ee,"getBitLayoutVisualization",()=>er,"getDefaultAssemblyOptions",()=>q,"getDefaultCHeaderOptions",()=>Z,"getDefaultPngOptions",()=>J,"getHexPreview",()=>et],44824),e.s([],79086),e.s(["LibraryGrid",()=>en,"LibraryGridEmptyResults",()=>ei,"LibraryGridError",()=>eo],4941);var ec=e.i(79724);function ed({label:e,options:t,selected:r,onChange:a,placeholder:l="All",className:i="",showAllOption:o=!0,allOptionLabel:c="All"}){let[d,u]=(0,n.useState)(!1),h=(0,ec.useOutsideClick)(()=>u(!1),d),X=(0,n.useCallback)(e=>{r.includes(e)?a(r.filter(t=>t!==e)):a([...r,e])},[r,a]),m=(0,n.useCallback)(()=>{a([])},[a]),x=(0,n.useCallback)((e,t)=>{t.stopPropagation(),a(r.filter(t=>t!==e))},[r,a]),p=e=>{let r=t.find(t=>t.value===e);return r?.label??String(e)},f=r.length>0;return(0,s.jsxs)("div",{className:`relative ${i}`,ref:h,children:[(0,s.jsxs)("button",{type:"button",onClick:()=>u(!d),className:`
          flex items-center justify-between gap-2 w-full px-3 py-1.5
          bg-retro-dark border rounded text-sm text-left
          transition-colors
          ${d?"border-retro-cyan":"border-retro-grid/50 hover:border-retro-grid"}
          ${f?"text-white":"text-gray-400"}
        `,"aria-expanded":d,"aria-haspopup":"listbox",children:[(0,s.jsx)("span",{className:"truncate",children:f?`${e} (${r.length})`:l}),(0,s.jsx)("svg",{className:`w-4 h-4 flex-shrink-0 transition-transform ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:r.map(e=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-retro-cyan/20 text-retro-cyan rounded text-xs",children:[p(e),(0,s.jsx)("button",{type:"button",onClick:t=>x(e,t),className:"hover:text-white transition-colors","aria-label":`Remove ${p(e)}`,children:(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},String(e)))}),d&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:(0,s.jsxs)("div",{className:"max-h-60 overflow-y-auto py-1",children:[o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{type:"button",onClick:m,className:`
                    w-full flex items-center gap-2 px-3 py-2 text-sm text-left
                    transition-colors
                    ${!f?"bg-retro-cyan/10 text-retro-cyan":"text-gray-300 hover:bg-retro-purple/20"}
                  `,children:[(0,s.jsx)("span",{className:"w-4 h-4 flex items-center justify-center",children:!f&&(0,s.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})}),c]}),(0,s.jsx)("div",{className:"h-px bg-retro-grid/30 mx-2 my-1"})]}),t.map(e=>{let t=r.includes(e.value);return(0,s.jsxs)("button",{type:"button",onClick:()=>X(e.value),className:`
                    w-full flex items-center gap-2 px-3 py-2 text-sm text-left
                    transition-colors
                    ${t?"bg-retro-cyan/10 text-retro-cyan":"text-gray-300 hover:bg-retro-purple/20"}
                  `,role:"option","aria-selected":t,children:[(0,s.jsx)("span",{className:`
                      w-4 h-4 flex items-center justify-center rounded border
                      ${t?"bg-retro-cyan border-retro-cyan":"border-gray-500"}
                    `,children:t&&(0,s.jsx)("svg",{className:"w-3 h-3 text-retro-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.label]},String(e.value))}),0===t.length&&(0,s.jsx)("div",{className:"px-3 py-2 text-sm text-gray-500 text-center",children:"No options available"})]})})]})}function eu({searchQuery:e,onSearchChange:t,availableSizes:r,widthFilters:a,heightFilters:l,onSizeFilterChange:i,availableMakers:o=[],availableSystems:c=[],makerFilters:d=[],systemFilters:u=[],onMakerFilterChange:h,onSystemFilterChange:X,totalCount:m,filteredCount:x}){let[p,f]=(0,n.useState)(e),g=(0,n.useMemo)(()=>Array.from(new Set([...O.map(e=>e.maker),...o])).sort(),[o]),y=(0,n.useMemo)(()=>{if(0===d.length)return c.sort();let e=new Set;return d.forEach(t=>{T(t).forEach(t=>e.add(t))}),c.forEach(t=>e.add(t)),Array.from(e).sort()},[d,c]),b=(0,n.useMemo)(()=>Array.from(new Set(r.map(e=>e.width))).sort((e,t)=>e-t),[r]),v=(0,n.useMemo)(()=>Array.from(new Set(r.map(e=>e.height))).sort((e,t)=>e-t),[r]),k=(0,n.useCallback)(e=>{e.preventDefault(),t(p)},[p,t]),j=(0,n.useCallback)(e=>{"Enter"===e.key&&t(p)},[p,t]),w=(0,n.useCallback)(()=>{f(""),t(""),i([],[]),h?.([]),X?.([])},[t,i,h,X]),C=e.length>0||a.length>0||l.length>0||d.length>0||u.length>0;return(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsx)("form",{onSubmit:k,children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),onKeyDown:j,onBlur:()=>t(p),placeholder:"Search character sets...",className:"w-full px-4 py-2 pl-10 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50 transition-colors","aria-label":"Search character sets"}),(0,s.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),p&&(0,s.jsx)("button",{type:"button",onClick:()=>{f(""),t("")},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300","aria-label":"Clear search",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,s.jsx)(ed,{label:"Width",options:b.map(e=>({value:e,label:`${e}px`})),selected:a,onChange:e=>i(e,l),placeholder:"Width",allOptionLabel:"Any width"}),(0,s.jsx)(ed,{label:"Height",options:v.map(e=>({value:e,label:`${e}px`})),selected:l,onChange:e=>i(a,e),placeholder:"Height",allOptionLabel:"Any height"}),h&&(0,s.jsx)(ed,{label:"Maker",options:g.map(e=>({value:e,label:e})),selected:d,onChange:h,placeholder:"Maker",allOptionLabel:"Any maker"}),X&&(0,s.jsx)(ed,{label:"System",options:y.map(e=>({value:e,label:e})),selected:u,onChange:X,placeholder:"System",allOptionLabel:"Any system"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,s.jsx)("span",{children:C?`Showing ${x} of ${m} character sets`:`${m} character set${1!==m?"s":""}`}),C&&(0,s.jsx)("button",{onClick:w,className:"text-retro-cyan hover:text-retro-pink transition-colors",children:"Clear filters"})]})]})}function eh({onFileSelect:e,selectedFile:t,loading:r=!1,error:a=null,className:l=""}){let[i,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null),u=(0,n.useRef)(null),h=a||c,X=(0,n.useCallback)(async t=>{if(d(null),!K(t))return void d("Invalid file type. Please select a binary ROM file (.bin, .rom, .chr, .fnt, .dat)");if(t.size>1048576)return void d("File too large. Maximum size is 1MB.");try{let r=await t.arrayBuffer();e(t,r)}catch(e){d("Failed to read file. Please try again.")}},[e]),m=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o(!1);let t=e.dataTransfer.files;t.length>0&&X(t[0])},[X]),x=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o(!0)},[]),p=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o(!1)},[]),f=(0,n.useCallback)(()=>{u.current?.click()},[]),g=(0,n.useCallback)(e=>{let t=e.target.files;t&&t.length>0&&X(t[0])},[X]),y=(0,n.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),f())},[f]);return(0,s.jsxs)("div",{className:l,children:[(0,s.jsx)("input",{ref:u,type:"file",accept:".bin,.rom,.chr,.fnt,.dat",onChange:g,className:"hidden","aria-hidden":"true"}),(0,s.jsx)("div",{onClick:f,onDrop:m,onDragOver:x,onDragLeave:p,onKeyDown:y,role:"button",tabIndex:0,"aria-label":"Drop a ROM file or click to browse",className:`
          relative flex flex-col items-center justify-center
          p-8 sm:p-12
          border-2 border-dashed rounded-lg
          cursor-pointer
          transition-all
          ${i?"border-retro-cyan bg-retro-cyan/10":t?"border-retro-pink/50 bg-retro-pink/5":"border-retro-grid/50 hover:border-retro-cyan/50 bg-retro-navy/30"}
          ${h?"border-red-500/50 bg-red-500/5":""}
          ${r?"pointer-events-none opacity-50":""}
        `,children:r?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:"Reading file..."})]}):t?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-lg bg-retro-pink/20 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-retro-pink",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-200 truncate max-w-[200px]",children:t.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:G(t.size)})]}),(0,s.jsx)("button",{type:"button",className:"text-xs text-retro-cyan hover:text-retro-pink transition-colors",children:"Choose a different file"})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-retro-purple/20 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-retro-pink",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-300",children:"Drag and drop a ROM file here"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"or click to browse"})]}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Accepts: .bin, .rom, .chr, .fnt, .dat"})]})}),h&&(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-sm text-red-400",children:[(0,s.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,s.jsx)("span",{children:h})]})]})}function eX({character:e,config:r,onPixelToggle:a,onPixelSet:l,onDragEnd:i,getPixelState:o,batchMode:c=!1,foregroundColor:d="#ffffff",backgroundColor:u="#000000",gridColor:h="#333333",gridThickness:X=1,zoom:m=20,className:x=""}){let p=(0,n.useRef)(null),[f,g]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),v=(0,n.useMemo)(()=>{if(!c||!o||!e)return;let t=new Set;for(let e=0;e<r.height;e++)for(let a=0;a<r.width;a++)"mixed"===o(e,a)&&t.add(`${e},${a}`);return t.size>0?t:void 0},[c,o,e,r.height,r.width]),k=(0,n.useCallback)((t,r)=>{f||(a?.(t,r),b(!e?.pixels[t]?.[r]),g(!0))},[f,a,e]),j=(0,n.useCallback)((e,t)=>{f&&null!==y&&l&&l(e,t,y)},[f,y,l]),w=(0,n.useCallback)(()=>{f&&(g(!1),b(null),i?.())},[f,i]);return e?(0,s.jsx)("div",{ref:p,className:`flex items-center justify-center h-full overflow-hidden bg-black/20 ${x}`,tabIndex:0,children:(0,s.jsx)("div",{className:"inline-block",onMouseLeave:w,onMouseUp:w,children:(0,s.jsx)(t.CharacterDisplay,{character:e,mode:"large",scale:m,foregroundColor:d,backgroundColor:u,gridColor:h,gridThickness:X,onPixelClick:k,onPixelDrag:j,onDragEnd:w,interactive:!0,mixedPixels:v})})}):(0,s.jsx)("div",{className:`flex items-center justify-center h-full ${x}`,children:(0,s.jsxs)("div",{className:"text-center text-gray-500",children:[(0,s.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6z"})}),(0,s.jsx)("p",{children:"No character selected"})]})})}function em({characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:l,foregroundColor:i="#ffffff",backgroundColor:o="#000000",selectionColor:c="#00ffff",batchSelectionColor:d="#ff69b4",maxWidth:u=200,pixelScale:h=1,gap:X=1,collapsible:m=!0,defaultCollapsed:x=!1,className:p=""}){let f=(0,n.useRef)(null),g=(0,n.useRef)(null),[y,b]=(0,n.useState)(x),[v,k]=(0,n.useState)(null),j=t.width*h,w=t.height*h,C=j+X,N=w+X,S=Math.max(1,Math.floor(u/C)),A=Math.ceil(e.length/S),M=S*C-X,L=A*N-X;(0,n.useEffect)(()=>{let t=f.current;if(!t||y)return;let s=t.getContext("2d");s&&(t.width=M,t.height=L,s.fillStyle=o,s.fillRect(0,0,M,L),e.forEach((e,t)=>{let n=t%S*C,l=Math.floor(t/S)*N;s.fillStyle=o,s.fillRect(n,l,j,w),s.fillStyle=i,e.pixels.forEach((e,t)=>{e.forEach((e,r)=>{e&&s.fillRect(n+r*h,l+t*h,h,h)})}),a?.has(t)&&t!==r&&(s.strokeStyle=d,s.lineWidth=1,s.globalAlpha=.7,s.strokeRect(n+.5,l+.5,j-1,w-1),s.globalAlpha=1),t===r?(s.strokeStyle=c,s.lineWidth=2,s.strokeRect(n+1,l+1,j-2,w-2)):t!==v||a?.has(t)||(s.strokeStyle=c,s.lineWidth=1,s.globalAlpha=.5,s.strokeRect(n+.5,l+.5,j-1,w-1),s.globalAlpha=1)}))},[e,t,r,a,v,i,o,c,d,h,X,S,M,L,j,w,C,N,y]);let _=(0,n.useCallback)(t=>{if(!l)return;let r=f.current;if(!r)return;let a=r.getBoundingClientRect(),s=t.clientX-a.left,n=t.clientY-a.top,i=r.width/a.width,o=Math.floor(n*(r.height/a.height)/N)*S+Math.floor(s*i/C);o>=0&&o<e.length&&l(o)},[l,C,N,S,e.length]),R=(0,n.useCallback)(t=>{let r=f.current;if(!r)return;let a=r.getBoundingClientRect(),s=t.clientX-a.left,n=t.clientY-a.top,l=r.width/a.width,i=Math.floor(n*(r.height/a.height)/N)*S+Math.floor(s*l/C);i>=0&&i<e.length?k(i):k(null)},[C,N,S,e.length]),E=(0,n.useCallback)(()=>{k(null)},[]),I=(0,n.useCallback)(()=>{b(e=>!e)},[]);return(0,s.jsxs)("div",{className:`${p}`,ref:g,children:[m&&(0,s.jsxs)("button",{onClick:I,className:"w-full flex items-center justify-between p-2 text-sm text-gray-300 hover:text-retro-cyan transition-colors",children:[(0,s.jsx)("span",{className:"font-medium",children:"Overview"}),(0,s.jsx)("svg",{className:`w-4 h-4 transition-transform ${y?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!y&&(0,s.jsx)("div",{className:"p-2 bg-black/30 rounded overflow-auto",style:{maxHeight:"150px"},children:(0,s.jsx)("canvas",{ref:f,onClick:_,onMouseMove:R,onMouseLeave:E,className:"cursor-pointer",style:{width:M,height:L,imageRendering:"pixelated"}})})]})}function ex({characters:e,config:t,selectedIndex:a,batchSelection:l,onSelect:i,onAddCharacter:o,onDeleteSelected:c,onSelectAll:d,onSelectNone:u,showAddButton:h=!0,foregroundColor:X="#ffffff",backgroundColor:m="#000000",className:x=""}){let p=l.size+1,f=p>1,[g,y]=(0,n.useState)(!1),b=a>=32&&a<=126,v=(0,n.useCallback)(t=>{let r=e.length;if(0!==r)switch(t.key){case"ArrowUp":case"ArrowLeft":t.preventDefault(),i(a>0?a-1:r-1,t.shiftKey);break;case"ArrowDown":case"ArrowRight":t.preventDefault(),i(a<r-1?a+1:0,t.shiftKey);break;case"Delete":case"Backspace":t.preventDefault(),c?.();break;case"a":case"A":(t.ctrlKey||t.metaKey)&&t.preventDefault()}},[e.length,a,i,c]);return(0,s.jsxs)("div",{className:`flex flex-col h-full overflow-hidden ${x}`,onKeyDown:v,children:[(0,s.jsxs)("div",{className:"flex-shrink-0 p-3 border-b border-retro-grid/30",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Characters"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.length,")"]}),b&&(0,s.jsxs)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-cyan rounded text-xs font-mono",children:["'",String.fromCharCode(a),"'"]})]})}),f&&(0,s.jsxs)("div",{className:"mt-1 text-xs text-retro-pink",children:[p," characters selected"]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:[(0,s.jsx)("div",{className:"border-b border-retro-grid/30",children:(0,s.jsx)(em,{characters:e,config:t,selectedIndex:a,batchSelection:l,onSelect:e=>i(e,!1),foregroundColor:X,backgroundColor:m,maxWidth:200,pixelScale:1,collapsible:!0,defaultCollapsed:!1})}),(0,s.jsxs)("div",{className:"border-b border-retro-grid/30",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,s.jsxs)("button",{onClick:()=>y(!g),className:"flex items-center gap-1 text-sm text-gray-300 hover:text-retro-cyan transition-colors",children:[(0,s.jsx)("span",{className:"font-medium",children:"Characters"}),(0,s.jsx)("svg",{className:`w-4 h-4 transition-transform ${g?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[d&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),d()},className:"text-[10px] text-gray-500 hover:text-retro-cyan transition-colors",children:"All"}),u&&f&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),u()},className:"text-[10px] text-gray-500 hover:text-retro-pink transition-colors",children:"None"})]})]}),!g&&(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)(r.InteractiveCharacterGrid,{characters:e,config:t,selectedIndex:a,batchSelection:l,onSelect:i,showAddButton:h&&!!o,onAdd:o,foregroundColor:X,backgroundColor:m,showIndices:!1,smallScale:2,minColumns:8,maxColumns:10,gap:4,className:"max-h-[400px] overflow-y-auto"})})]})]})]})}function ep({colors:e,onColorsChange:t,className:r=""}){let[a,l]=(0,n.useState)(!1),[i,o]=(0,n.useState)(()=>D()),[c,d]=(0,n.useState)(()=>z()),[u,h]=(0,n.useState)(!1),X=(0,ec.useOutsideClick)(()=>{l(!1),h(!1)},a),m=(0,n.useCallback)(e=>{"custom"===e.id?h(!0):(o(e.id),B(e.id),t({foreground:e.foreground,background:e.background,gridColor:e.gridColor}),l(!1))},[t]),x=(0,n.useCallback)((e,r)=>{let a={...c,[e]:r};d(a),$(a),o("custom"),B("custom"),t(a)},[c,t]),p=I(i),f=p?.name||"Custom";return(0,s.jsxs)("div",{className:`relative ${r}`,ref:X,children:[(0,s.jsxs)("button",{onClick:()=>l(!a),className:"flex items-center gap-2 px-3 py-1.5 bg-retro-navy/50 border border-retro-grid/50 rounded text-sm text-gray-300 hover:border-retro-grid transition-colors","aria-expanded":a,"aria-haspopup":"listbox",children:[(0,s.jsxs)("div",{className:"flex gap-0.5",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-sm border border-white/20",style:{backgroundColor:e.foreground}}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-sm border border-white/20",style:{backgroundColor:e.background}})]}),(0,s.jsx)("span",{className:"hidden sm:inline",children:f}),(0,s.jsx)("svg",{className:`w-3 h-3 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&(0,s.jsx)("div",{className:"absolute right-0 mt-1 w-64 bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl z-50 overflow-hidden",children:u?(0,s.jsxs)("div",{className:"p-3 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-300",children:"Custom Colors"}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"text-xs text-gray-500 hover:text-gray-300",children:"Back"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Foreground"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"color",value:c.foreground,onChange:e=>x("foreground",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,s.jsx)("input",{type:"text",value:c.foreground,onChange:e=>x("foreground",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Background"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"color",value:c.background,onChange:e=>x("background",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,s.jsx)("input",{type:"text",value:c.background,onChange:e=>x("background",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Grid Lines"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"color",value:c.gridColor,onChange:e=>x("gridColor",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,s.jsx)("input",{type:"text",value:c.gridColor,onChange:e=>x("gridColor",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]})]}):(0,s.jsx)("div",{className:"py-1 max-h-80 overflow-y-auto",children:_.map(e=>(0,s.jsxs)("button",{onClick:()=>m(e),className:`
                    w-full flex items-center gap-3 px-3 py-2 text-left text-sm
                    transition-colors
                    ${i===e.id?"bg-retro-cyan/10 text-retro-cyan":"text-gray-300 hover:bg-retro-purple/20"}
                  `,role:"option","aria-selected":i===e.id,children:["custom"!==e.id?(0,s.jsxs)("div",{className:"flex gap-0.5 flex-shrink-0",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border border-white/20",style:{backgroundColor:e.foreground}}),(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border border-white/20",style:{backgroundColor:e.background}})]}):(0,s.jsx)("div",{className:"w-[34px] h-4 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),(0,s.jsx)("span",{className:"flex-1",children:e.name}),i===e.id&&(0,s.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})]},e.id))})})]})}function ef({characterSetName:e,isDirty:t,characterIndex:r,totalCharacters:a,batchMode:n=!1,zoom:l,minZoom:i=8,maxZoom:o=40,zoomStep:c=4,onZoomChange:d,colors:u,onColorsChange:h,onBack:X,className:m=""}){return(0,s.jsxs)("div",{className:`flex items-center gap-4 px-4 py-2 bg-retro-navy/50 border-b border-retro-grid/50 ${m}`,children:[(0,s.jsxs)("button",{onClick:X,className:"flex items-center gap-1 text-xs text-gray-400 hover:text-retro-cyan transition-colors whitespace-nowrap",children:[(0,s.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Back"})]}),(0,s.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-sm text-gray-300 min-w-0",children:[(0,s.jsx)("span",{className:"truncate max-w-[150px] sm:max-w-[200px]",title:e,children:e}),t&&(0,s.jsx)("span",{className:"text-retro-pink flex-shrink-0",children:"*"})]}),(0,s.jsx)("div",{className:"w-px h-4 bg-retro-grid/50 hidden sm:block"}),(0,s.jsxs)("div",{className:"hidden sm:flex items-center gap-2 text-sm text-gray-400",children:[(0,s.jsxs)("span",{className:"whitespace-nowrap",children:["Char ",(0,s.jsx)("span",{className:"text-retro-cyan",children:r}),(0,s.jsxs)("span",{className:"text-gray-500",children:["/",a]})]}),r>=32&&r<=126&&(0,s.jsxs)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-cyan rounded text-xs font-mono",children:["'",String.fromCharCode(r),"'"]}),n&&(0,s.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",children:"Batch"})]}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>{l>i&&d(Math.max(l-c,i))},disabled:l<=i,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Zoom out (-)",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 w-10 text-center",children:[l,"x"]}),(0,s.jsx)("button",{onClick:()=>{l<o&&d(Math.min(l+c,o))},disabled:l>=o,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Zoom in (+)",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),(0,s.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,s.jsx)(ep,{colors:u,onColorsChange:h})]})}function eg({className:e=""}){return(0,s.jsx)("div",{className:`flex items-center justify-center gap-4 px-4 py-1.5 bg-retro-navy/50 border-t border-retro-grid/50 ${e}`,children:(0,s.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-x-4 gap-y-1 text-[10px] text-gray-500",children:[{keys:"Arrow keys",action:"Navigate"},{keys:"Click",action:"Select"},{keys:"Shift+Click",action:"Multi-select"},{keys:"Del",action:"Delete"},{keys:"Ctrl+S",action:"Save"},{keys:"Ctrl+Z/Y",action:"Undo/Redo"},{keys:"?",action:"Help"}].map(({keys:e,action:t},r)=>(0,s.jsxs)("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[(0,s.jsx)("span",{className:"text-gray-400",children:e}),(0,s.jsxs)("span",{className:"hidden sm:inline",children:[": ",t]})]},r))})})}function ey(e,t={}){let{enabled:r=!0,target:a=null}=t,s=(0,n.useRef)(e);s.current=e;let l=(0,n.useCallback)(e=>{let t=e.target?.tagName?.toLowerCase();if("input"!==t&&"textarea"!==t&&"select"!==t||e.ctrlKey||e.metaKey)for(let t of s.current){let r=e.key.toLowerCase()===t.key.toLowerCase(),a=!!t.ctrl===(e.ctrlKey||e.metaKey),s=!!t.shift===e.shiftKey,n=!!t.alt===e.altKey;if(r&&a&&s&&n){e.preventDefault(),t.action();return}}},[]);(0,n.useEffect)(()=>{if(!r)return;let e=a||window;return e.addEventListener("keydown",l),()=>{e.removeEventListener("keydown",l)}},[r,a,l])}function eb(e){let t=[],r="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);e.ctrl&&t.push(r?"â":"Ctrl"),e.alt&&t.push(r?"â¥":"Alt"),e.shift&&t.push(r?"â§":"Shift");let a=e.key;return t.push(a=" "===a?"Space":"ArrowUp"===a?"â":"ArrowDown"===a?"â":"ArrowLeft"===a?"â":"ArrowRight"===a?"â":"Escape"===a?"Esc":"Delete"===a?"Del":"Backspace"===a?"â«":a.toUpperCase()),t.join(r?"":"+")}function ev(e){return[{key:"z",ctrl:!0,action:e.undo,description:"Undo",context:"Editor"},{key:"z",ctrl:!0,shift:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"y",ctrl:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"s",ctrl:!0,action:e.save,description:"Save",context:"Editor"},{key:"r",action:e.rotateRight,description:"Rotate right",context:"Editor"},{key:"r",shift:!0,action:e.rotateLeft,description:"Rotate left",context:"Editor"},{key:"w",action:e.shiftUp,description:"Shift up",context:"Editor"},{key:"s",action:e.shiftDown,description:"Shift down",context:"Editor"},{key:"a",action:e.shiftLeft,description:"Shift left",context:"Editor"},{key:"d",action:e.shiftRight,description:"Shift right",context:"Editor"},{key:"i",action:e.invert,description:"Invert colors",context:"Editor"},{key:"h",action:e.flipHorizontal,description:"Flip horizontal",context:"Editor"},{key:"v",action:e.flipVertical,description:"Flip vertical",context:"Editor"},{key:"a",ctrl:!0,action:e.selectAll,description:"Select all",context:"Sidebar"},{key:"Delete",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"Backspace",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"n",ctrl:!0,action:e.addCharacter,description:"Add new character",context:"Editor"},{key:"?",action:e.showHelp,description:"Show keyboard shortcuts",context:"Global"}]}function ek({isOpen:e,onClose:t,shortcuts:r}){if((0,n.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&(e.preventDefault(),t())};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e,t]),(0,n.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;let a=r.reduce((e,t)=>{let r=t.context||"General";return e[r]||(e[r]=[]),e[r].push(t),e},{}),l=["Editor","Sidebar","Global"],i=Object.keys(a).sort((e,t)=>{let r=l.indexOf(e),a=l.indexOf(t);return -1===r&&-1===a?e.localeCompare(t):-1===r?1:-1===a?-1:r-a});return(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,s.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-retro-grid/30",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-white",children:"Keyboard Shortcuts"}),(0,s.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsx)("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-6",children:i.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-retro-cyan mb-2",children:e}),(0,s.jsx)("div",{className:"space-y-1",children:a[e].map((t,r)=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-retro-purple/10",children:[(0,s.jsx)("span",{className:"text-sm text-gray-300",children:t.description}),(0,s.jsx)("kbd",{className:"px-2 py-0.5 text-xs font-mono bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:eb(t)})]},`${e}-${r}`))})]},e))}),(0,s.jsx)("div",{className:"px-4 py-3 border-t border-retro-grid/30 text-center",children:(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Press ",(0,s.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"Esc"})," or ",(0,s.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"?"})," to close"]})})]})]})}function ej({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}function ew({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}function eC({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}function eN({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function eS({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function eA({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{transform:"scaleX(-1)"},children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function eM({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h8M8 12h8m-8 5h8M4 3v18m16-18v18"})})}function eL({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8v8M12 8v8m5-8v8M3 4h18M3 20h18"})})}function e_({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}function eR({className:e="w-4 h-4"}){return(0,s.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}function eE({className:e="w-4 h-4"}){return(0,s.jsxs)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v14a1 1 0 01-1 1H5a1 1 0 01-1-1V5z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5h16v14H4z",fill:"currentColor",fillOpacity:.3})]})}function eI({onClick:e,disabled:t,title:r,children:a,className:n=""}){return(0,s.jsx)("button",{onClick:e,disabled:t,title:r,className:`
        p-2 rounded transition-colors
        ${t?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-retro-cyan hover:bg-retro-purple/30"}
        ${n}
      `,children:a})}function eB(){return(0,s.jsx)("div",{className:"w-full h-px bg-retro-grid/30 my-2"})}function eD({children:e}){return(0,s.jsx)("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider text-center mb-1",children:e})}function e$({onShift:e,onRotate:t,onFlipHorizontal:r,onFlipVertical:a,onInvert:l,onClear:i,onFill:o,disabled:c=!1,className:d=""}){let u=(0,n.useCallback)(()=>e("up"),[e]),h=(0,n.useCallback)(()=>e("down"),[e]),X=(0,n.useCallback)(()=>e("left"),[e]),m=(0,n.useCallback)(()=>e("right"),[e]),x=(0,n.useCallback)(()=>t("left"),[t]),p=(0,n.useCallback)(()=>t("right"),[t]);return(0,s.jsxs)("div",{className:`
        flex flex-col items-center p-2 bg-retro-navy/50 border-l border-retro-grid/30
        ${d}
      `,children:[(0,s.jsx)(eD,{children:"Shift"}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,s.jsx)(eI,{onClick:u,disabled:c,title:"Shift Up (W)",children:(0,s.jsx)(ej,{})}),(0,s.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,s.jsx)(eI,{onClick:X,disabled:c,title:"Shift Left (A)",children:(0,s.jsx)(eC,{})}),(0,s.jsx)("div",{className:"w-8 h-8"}),(0,s.jsx)(eI,{onClick:m,disabled:c,title:"Shift Right (D)",children:(0,s.jsx)(eN,{})})]}),(0,s.jsx)(eI,{onClick:h,disabled:c,title:"Shift Down (S)",children:(0,s.jsx)(ew,{})})]}),(0,s.jsx)(eB,{}),(0,s.jsx)(eD,{children:"Rotate"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(eI,{onClick:x,disabled:c,title:"Rotate Left (Shift+R)",children:(0,s.jsx)(eS,{})}),(0,s.jsx)(eI,{onClick:p,disabled:c,title:"Rotate Right (R)",children:(0,s.jsx)(eA,{})})]}),(0,s.jsx)(eB,{}),(0,s.jsx)(eD,{children:"Flip"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(eI,{onClick:r,disabled:c,title:"Flip Horizontal (H)",children:(0,s.jsx)(eM,{})}),(0,s.jsx)(eI,{onClick:a,disabled:c,title:"Flip Vertical (V)",children:(0,s.jsx)(eL,{})})]}),(0,s.jsx)(eB,{}),(0,s.jsx)(eD,{children:"Effects"}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,s.jsx)(eI,{onClick:l,disabled:c,title:"Invert Colors (I)",children:(0,s.jsx)(e_,{})}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(eI,{onClick:i,disabled:c,title:"Clear (Delete)",children:(0,s.jsx)(eR,{})}),(0,s.jsx)(eI,{onClick:o,disabled:c,title:"Fill",children:(0,s.jsx)(eE,{})})]})]})]})}function ez({maker:e,system:t,onMakerChange:r,onSystemChange:a,disabled:l=!1,className:i=""}){let[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[h,X]=(0,n.useState)(""),[m,x]=(0,n.useState)(""),p=(0,n.useMemo)(()=>O.map(e=>e.maker),[]),f=(0,n.useMemo)(()=>e?T(e):[],[e]),g=e&&!p.includes(e),y=t&&!f.includes(t),b=(0,n.useCallback)(e=>{let t=e.target.value;"__custom__"===t?(c(!0),X("")):(r(t),a(""),c(!1))},[r,a]),v=(0,n.useCallback)(()=>{h.trim()&&(r(h.trim()),a(""),c(!1),X(""))},[h,r,a]),k=(0,n.useCallback)(()=>{c(!1),X("")},[]),j=(0,n.useCallback)(e=>{let t=e.target.value;"__custom__"===t?(u(!0),x("")):(a(t),u(!1))},[a]),w=(0,n.useCallback)(()=>{m.trim()&&(a(m.trim()),u(!1),x(""))},[m,a]),C=(0,n.useCallback)(()=>{u(!1),x("")},[]),N=(0,n.useCallback)((e,t)=>{"Enter"===e.key?(e.preventDefault(),t()):"Escape"===e.key&&(e.preventDefault(),o&&k(),d&&C())},[o,d,k,C]),S=`
    w-full px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg
    text-sm text-gray-200 focus:outline-none focus:border-retro-cyan/50
    transition-colors disabled:opacity-50 disabled:cursor-not-allowed
  `,A=`
    flex-1 px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg
    text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50
    transition-colors
  `,M=`
    px-3 py-2 text-sm rounded-lg transition-colors
  `;return(0,s.jsxs)("div",{className:`space-y-4 ${i}`,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Maker"}),o?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:h,onChange:e=>X(e.target.value),onKeyDown:e=>N(e,v),placeholder:"Enter maker name...",className:A,autoFocus:!0,disabled:l}),(0,s.jsx)("button",{onClick:v,disabled:l||!h.trim(),className:`${M} bg-retro-cyan/20 text-retro-cyan hover:bg-retro-cyan/30 disabled:opacity-50`,children:"Add"}),(0,s.jsx)("button",{onClick:k,disabled:l,className:`${M} bg-retro-grid/20 text-gray-400 hover:bg-retro-grid/30`,children:"Cancel"})]}):(0,s.jsxs)("select",{value:g?"":e,onChange:b,disabled:l,className:S,children:[(0,s.jsx)("option",{value:"",children:"Select maker..."}),p.map(e=>(0,s.jsx)("option",{value:e,children:e},e)),(0,s.jsx)("option",{value:"__custom__",children:"Other (custom)..."}),g&&(0,s.jsxs)("option",{value:e,disabled:!0,children:[e," (custom)"]})]}),g&&!o&&(0,s.jsxs)("div",{className:"mt-1.5 flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Custom: ",(0,s.jsx)("span",{className:"text-retro-cyan",children:e})]}),(0,s.jsx)("button",{onClick:()=>{r(""),a("")},className:"text-xs text-gray-500 hover:text-retro-pink",disabled:l,children:"Clear"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"System"}),d?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),onKeyDown:e=>N(e,w),placeholder:"Enter system name...",className:A,autoFocus:!0,disabled:l}),(0,s.jsx)("button",{onClick:w,disabled:l||!m.trim(),className:`${M} bg-retro-cyan/20 text-retro-cyan hover:bg-retro-cyan/30 disabled:opacity-50`,children:"Add"}),(0,s.jsx)("button",{onClick:C,disabled:l,className:`${M} bg-retro-grid/20 text-gray-400 hover:bg-retro-grid/30`,children:"Cancel"})]}):(0,s.jsxs)("select",{value:y?"":t,onChange:j,disabled:l||!e,className:S,children:[(0,s.jsx)("option",{value:"",children:e?"Select system...":"Select a maker first..."}),f.map(e=>(0,s.jsx)("option",{value:e,children:e},e)),e&&(0,s.jsx)("option",{value:"__custom__",children:"Other (custom)..."}),y&&(0,s.jsxs)("option",{value:t,disabled:!0,children:[t," (custom)"]})]}),y&&!d&&(0,s.jsxs)("div",{className:"mt-1.5 flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Custom: ",(0,s.jsx)("span",{className:"text-retro-cyan",children:t})]}),(0,s.jsx)("button",{onClick:()=>a(""),className:"text-xs text-gray-500 hover:text-retro-pink",disabled:l,children:"Clear"})]})]})]})}function eF({isOpen:e,onClose:t,metadata:r,onSave:a}){let[l,i]=(0,n.useState)(r.name),[o,c]=(0,n.useState)(r.description),[d,u]=(0,n.useState)(r.source),[h,X]=(0,n.useState)(r.maker),[m,x]=(0,n.useState)(r.system),[p,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{e&&(i(r.name),c(r.description),u(r.source),X(r.maker),x(r.system))},[e,r]);let g=async()=>{if(l.trim()){f(!0);try{await a({name:l.trim(),description:o.trim(),source:d.trim()||"yourself",maker:h,system:m}),t()}finally{f(!1)}}};return e?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,s.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-white",children:"Edit Metadata"}),(0,s.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm text-gray-300 mb-1",children:["Name ",(0,s.jsx)("span",{className:"text-retro-pink",children:"*"})]}),(0,s.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),placeholder:"Character set name",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",autoFocus:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Description"}),(0,s.jsx)("textarea",{value:o,onChange:e=>c(e.target.value),placeholder:"Optional description",rows:2,className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan resize-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Maker & System"}),(0,s.jsx)(ez,{maker:h,system:m,onMakerChange:X,onSystemChange:x})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Source / Attribution"}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"yourself",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 p-4 border-t border-retro-grid/30",children:[(0,s.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:g,disabled:!l.trim()||p,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Saving...":"Save"})]})]})]}):null}function eP({currentStep:e,totalSteps:t,labels:r}){return(0,s.jsx)("div",{className:"flex items-center justify-center gap-2 mb-8",children:Array.from({length:t},(a,n)=>{let l=n+1,i=l===e,o=l<e;return(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:`
                flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium
                transition-colors
                ${i?"bg-retro-cyan text-retro-dark":o?"bg-retro-cyan/30 text-retro-cyan":"bg-retro-grid/30 text-gray-500"}
              `,children:o?(0,s.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}):l}),(0,s.jsx)("span",{className:`
                ml-2 text-sm hidden sm:inline
                ${i?"text-retro-cyan":o?"text-gray-400":"text-gray-500"}
              `,children:r[n]}),l<t&&(0,s.jsx)("div",{className:`
                  w-8 sm:w-12 h-0.5 mx-2 sm:mx-4
                  ${o?"bg-retro-cyan/50":"bg-retro-grid/30"}
                `})]},l)})})}function eO(){let[e,t]=(0,n.useState)([]),[r,a]=(0,n.useState)(!0),[s,l]=(0,n.useState)(null),[i,o]=(0,n.useState)([]),c=(0,n.useCallback)(async()=>{try{if(a(!0),l(null),await w.initialize(),await w.isEmpty()){let e,t,r,a;for(let s of[(e=Date.now(),{metadata:{id:"c64-uppercase",name:"C64 Uppercase",description:"Commodore 64 uppercase character set (representative sample)",source:"RetroStack",maker:"Commodore",system:"C64",createdAt:e,updatedAt:e,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:p(P())}),(t=Date.now(),{metadata:{id:"apple2-charset",name:"Apple II",description:"Apple II character set (representative sample)",source:"RetroStack",maker:"Apple",system:"Apple II",createdAt:t,updatedAt:t,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:p(P())}),(r=Date.now(),{metadata:{id:"zx-spectrum-charset",name:"ZX Spectrum",description:"ZX Spectrum character set (representative sample)",source:"RetroStack",maker:"Sinclair",system:"ZX Spectrum",createdAt:r,updatedAt:r,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:p(P())}),(a=Date.now(),{metadata:{id:"ibm-cga-charset",name:"IBM PC CGA",description:"IBM PC CGA 8x8 character set (representative sample)",source:"RetroStack",maker:"IBM",system:"PC CGA",createdAt:a,updatedAt:a,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:p(P())})])await w.save(s)}let e=await w.getAll();t(e);let r=await w.getAvailableSizes();o(r)}catch(e){l(e instanceof Error?e.message:"Failed to load library")}finally{a(!1)}},[]);(0,n.useEffect)(()=>{c()},[c]);let d=(0,n.useCallback)(async()=>{await c()},[c]),u=(0,n.useCallback)(async e=>{try{let t=await w.getById(e);if(!t)return null;return y(t)}catch(e){return console.error("Failed to get character set:",e),null}},[]),X=(0,n.useCallback)(async e=>{try{let t=g(e),r=await w.save(t);return await d(),r}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[d]),m=(0,n.useCallback)(async(e,t)=>{try{let r={...e,metadata:{...e.metadata,id:h(),name:t,createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1,source:"yourself"}},a=g(r),s=await w.save(a);return await d(),s}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[d]),x=(0,n.useCallback)(async(e,t)=>{try{let r=await w.getById(e);if(!r)throw Error("Character set not found");let a={...r,metadata:{...r.metadata,name:t,updatedAt:Date.now()}};await w.save(a),await d()}catch(e){throw Error(e instanceof Error?e.message:"Failed to rename character set")}},[d]),f=(0,n.useCallback)(async e=>{try{await w.delete(e),await d()}catch(e){throw Error(e instanceof Error?e.message:"Failed to delete character set")}},[d]),b=(0,n.useCallback)(async t=>t.trim()?w.search(t):e,[e]),v=(0,n.useCallback)(async(t,r)=>null===t&&null===r?e:w.filterBySize(t,r),[e]);return{characterSets:e,loading:r,error:s,refresh:d,getById:u,save:X,saveAs:m,rename:x,deleteSet:f,search:b,filterBySize:v,availableSizes:i,nameExists:(0,n.useCallback)(async(e,t)=>w.nameExists(e,t),[])}}function eT(e){return JSON.parse(JSON.stringify(e))}function eG(e){let{state:t,setState:r,resetState:a,undo:s,redo:l,canUndo:i,canRedo:o}=function(e,t=1/0){let r=(0,n.useRef)([]),a=(0,n.useRef)([]),[s,l]=(0,n.useState)(e),[,i]=(0,n.useState)({}),o=(0,n.useCallback)(e=>{r.current=[...r.current,s],r.current.length>t&&(r.current=r.current.slice(-t)),a.current=[],l(e),i({})},[s,t]),c=(0,n.useCallback)(e=>{r.current=[],a.current=[],l(e),i({})},[]),d=(0,n.useCallback)(()=>{if(0===r.current.length)return;a.current=[s,...a.current];let e=r.current[r.current.length-1];r.current=r.current.slice(0,-1),l(e),i({})},[s]),u=(0,n.useCallback)(()=>{if(0===a.current.length)return;r.current=[...r.current,s];let e=a.current[0];a.current=a.current.slice(1),l(e),i({})},[s]),h=(0,n.useCallback)(()=>{r.current=[],a.current=[],i({})},[]);return{state:s,setState:o,resetState:c,undo:d,redo:u,canUndo:r.current.length>0,canRedo:a.current.length>0,historyLength:r.current.length+a.current.length,clearHistory:h}}(e?{characters:e.characters.map(d),config:{...e.config}}:{characters:[],config:{width:8,height:8,padding:"right",bitDirection:"ltr"}}),[u,h]=(0,n.useState)(0),[X,m]=(0,n.useState)(new Set),[x,p]=(0,n.useState)(!1),[f,g]=(0,n.useState)(null),y=(0,n.useMemo)(()=>{let e=new Set(X);return e.add(u),e},[u,X]),b=(0,n.useCallback)(e=>{r(e(eT(t))),p(!0)},[t,r]),[v,k]=(0,n.useState)(null),j=(0,n.useCallback)((e,t)=>{if(t){let t=v??u,r=Math.min(t,e),a=Math.max(t,e),s=new Set;for(let e=r;e<=a;e++)s.add(e);h(e),s.delete(e),m(s)}else h(e),k(e),m(new Set)},[u,v]),w=(0,n.useCallback)(()=>{m(new Set)},[]),_=(0,n.useCallback)(()=>{m(new Set(Array.from({length:t.characters.length},(e,t)=>t)))},[t.characters.length]),R=(0,n.useCallback)((e,t)=>{b(r=>{var a;if(y.size>1){let s;s="same-on"!==L(a=r.characters,y,e,t),r.characters=a.map((r,a)=>y.has(a)?A(r,e,t,s):r)}else{let a=r.characters[u];a&&(r.characters[u]={pixels:a.pixels.map((r,a)=>a===e?r.map((e,r)=>r===t?!e:e):[...r])})}return r})},[b,u,y]),E=(0,n.useCallback)((e,t,r)=>{b(a=>{for(let s of y){let n=a.characters[s];n&&(a.characters[s]=A(n,e,t,r))}return a})},[b,y]),I=(0,n.useCallback)((e,r)=>L(t.characters,y,e,r),[t.characters,y]),B=(0,n.useCallback)(e=>{b(t=>(t.characters=M(t.characters,y,t=>(function(e,t){let r=e.pixels.length,a=e.pixels[0]?.length||0,s=[];for(let n=0;n<r;n++){let l=[];for(let s=0;s<a;s++){let i,o;"right"===t?(i=a-1-s,o=n):(i=s,o=r-1-n),i>=0&&i<r&&o>=0&&o<a?l.push(e.pixels[i]?.[o]||!1):l.push(!1)}s.push(l)}return{pixels:s}})(t,e)),t))},[b,y]),D=(0,n.useCallback)((e,t=!0)=>{b(r=>(r.characters=M(r.characters,y,r=>(function(e,t,r=!0){let a=e.pixels.length,s=e.pixels[0]?.length||0,n=[];for(let l=0;l<a;l++){let i=[];for(let n=0;n<s;n++){let o=l,c=n;switch(t){case"up":if((o=l+1)>=a&&(o=r?0:a-1,!r)){i.push(!1);continue}break;case"down":if((o=l-1)<0&&(o=r?a-1:0,!r)){i.push(!1);continue}break;case"left":if((c=n+1)>=s&&(c=r?0:s-1,!r)){i.push(!1);continue}break;case"right":if((c=n-1)<0&&(c=r?s-1:0,!r)){i.push(!1);continue}}i.push(e.pixels[o]?.[c]||!1)}n.push(i)}return{pixels:n}})(r,e,t)),r))},[b,y]),$=(0,n.useCallback)(()=>{b(e=>(e.characters=M(e.characters,y,C),e))},[b,y]),z=(0,n.useCallback)(()=>{b(e=>(e.characters=M(e.characters,y,N),e))},[b,y]),F=(0,n.useCallback)(()=>{b(e=>(e.characters=M(e.characters,y,S),e))},[b,y]),P=(0,n.useCallback)(()=>{b(e=>{let{width:t,height:r}=e.config;return e.characters=M(e.characters,y,()=>c(t,r)),e})},[b,y]),O=(0,n.useCallback)(()=>{b(e=>{let{width:t,height:r}=e.config;return e.characters=M(e.characters,y,()=>({pixels:Array.from({length:r},()=>Array(t).fill(!0))})),e})},[b,y]),T=(0,n.useCallback)(()=>{b(e=>{let{width:t,height:r}=e.config;return e.characters=[...e.characters,c(t,r)],e}),h(t.characters.length),m(new Set)},[b,t.characters.length]),G=(0,n.useCallback)(()=>{t.characters.length<=1||(b(e=>(e.characters=e.characters.filter((e,t)=>!y.has(t)),e)),h(Math.min(u,t.characters.length-y.size-1)),m(new Set))},[b,y,t.characters.length,u]),W=(0,n.useCallback)((e,t)=>{b(r=>{let a=r.characters[e];return a&&t>=0&&t<r.characters.length&&(r.characters[t]=d(a)),r})},[b]),H=(0,n.useCallback)((e,t,r)=>{b(a=>(a.characters=a.characters.map(a=>(function(e,t,r,a){let s=e.pixels.length,n=e.pixels[0]?.length||0,l=0,i=0;switch(a){case"tl":l=0,i=0;break;case"tr":l=t-n,i=0;break;case"bl":l=0,i=r-s;break;case"br":l=t-n,i=r-s}let o=[];for(let a=0;a<r;a++){let r=[];for(let o=0;o<t;o++){let t=a-i,c=o-l;t>=0&&t<s&&c>=0&&c<n?r.push(e.pixels[t][c]):r.push(!1)}o.push(r)}return{pixels:o}})(a,e,t,r)),a.config={...a.config,width:e,height:t},a))},[b]),K=(0,n.useCallback)((e,t)=>{b(r=>(e>=0&&e<r.characters.length&&(r.characters[e]=d(t)),r))},[b]),U=(0,n.useCallback)(e=>{b(t=>(t.characters=e.map(d),t))},[b]),V=(0,n.useCallback)(()=>{p(!1),g(eT(t))},[t]),Z=(0,n.useCallback)(e=>{a({characters:e.characters.map(d),config:{...e.config}}),h(0),k(null),m(new Set),p(!1),g(null)},[a]);return{characters:t.characters,config:t.config,selectedIndex:u,setSelectedIndex:h,batchSelection:X,toggleBatchSelection:j,clearBatchSelection:w,selectAll:_,toggleSelectedPixel:R,setSelectedPixel:E,getSelectedPixelState:I,rotateSelected:B,shiftSelected:D,invertSelected:$,flipSelectedHorizontal:z,flipSelectedVertical:F,clearSelected:P,fillSelected:O,addCharacter:T,deleteSelected:G,copyCharacter:W,resizeCharacters:H,updateCharacter:K,setCharacters:U,undo:s,redo:l,canUndo:i,canRedo:o,isDirty:x,markSaved:V,reset:Z}}e.s(["LibraryFilters",()=>eu],93949),e.s(["ImportDropZone",()=>eh],25544),e.s(["EditorCanvas",()=>eX],60441),e.s(["EditorSidebar",()=>ex],42187),e.s(["EditorHeader",()=>ef],87355),e.s(["EditorFooter",()=>eg],45835),e.s(["createEditorShortcuts",()=>ev,"formatShortcut",()=>eb,"useKeyboardShortcuts",()=>ey],3573),e.s(["KeyboardShortcutsHelp",()=>ek],43237),e.s(["TransformToolbar",()=>e$],99401),e.s(["MakerSystemSelect",()=>ez],15558),e.s(["MetadataEditModal",()=>eF],16244),u(),e.s(["ImportStepIndicator",()=>eP],63427),e.s([],3813),e.s(["useCharacterLibrary",()=>eO],66811),e.s(["useCharacterEditor",()=>eG],83621);let eW="character-editor-autosave";function eH(e){let{characterSetId:t,characters:r,config:a,selectedIndex:s,isDirty:l,enabled:i=!0}=e,[o,c]=(0,n.useState)(null),d=(0,n.useRef)(0),u=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(t)try{let e=localStorage.getItem(eW);if(e){let r=JSON.parse(e);r.characterSetId===t&&r.isDirty&&c(r)}}catch{}},[t]);let h=(0,n.useCallback)(()=>{if(t&&i&&0!==r.length)try{let e=p(x(r,a)),n={characterSetId:t,binaryData:e,config:a,selectedIndex:s,timestamp:Date.now(),isDirty:l};localStorage.setItem(eW,JSON.stringify(n)),d.current=Date.now()}catch(e){console.error("Auto-save failed:",e)}},[t,r,a,s,l,i]);(0,n.useEffect)(()=>{if(i&&l&&t)return u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{h()},Math.max(0,3e4-(Date.now()-d.current))),()=>{u.current&&clearTimeout(u.current)}},[i,l,t,h]),(0,n.useEffect)(()=>{if(!i||!l)return;let e=e=>{h(),e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[i,l,h]);let X=(0,n.useCallback)(()=>(c(null),o),[o]);return{hasRecoveryData:null!==o,recoveryData:o,recover:X,discard:(0,n.useCallback)(()=>{c(null);try{localStorage.removeItem(eW)}catch{}},[]),clearAutoSave:(0,n.useCallback)(()=>{try{localStorage.removeItem(eW)}catch{}},[]),saveNow:h}}e.s(["useAutoSave",()=>eH],54750),e.s([],7259)}]);