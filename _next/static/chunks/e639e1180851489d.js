(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},20446,e=>{"use strict";var t=e.i(43476),a=e.i(71645);function r({pixels:e,scale:r=1,showGrid:n=!1,gridColor:i="#333333",gridThickness:l=1,foregroundColor:o="#ffffff",backgroundColor:c="#000000",onPixelClick:s,onPixelDrag:u,onDragEnd:h,onPixelHover:d,onPixelLeave:f,className:m="",interactive:g=!0,mixedPixels:p,mixedColor:y="#666666"}){let w=(0,a.useRef)(null),[C,E]=(0,a.useState)(!1),b=(0,a.useRef)(null),S=e.length,A=e[0]?.length||0,R=n?l:0,x=A*r+(n?(A+1)*l:0),T=S*r+(n?(S+1)*l:0);(0,a.useEffect)(()=>{let t=w.current;if(!t)return;let a=t.getContext("2d");if(a){a.fillStyle=n?i:c,a.fillRect(0,0,x,T);for(let t=0;t<S;t++)for(let i=0;i<A;i++){let s=n?i*(r+l)+l:i*r,u=n?t*(r+l)+l:t*r,h=`${t},${i}`,d=p?.has(h),f=e[t]?.[i]||!1;if(d){let e=Math.floor(r/2);a.fillStyle=o,a.fillRect(s,u,e,e),a.fillRect(s+e,u+e,r-e,r-e),a.fillStyle=c,a.fillRect(s+e,u,r-e,e),a.fillRect(s,u+e,e,r-e)}else a.fillStyle=f?o:c,a.fillRect(s,u,r,r)}}},[e,r,n,i,l,o,c,x,T,A,S,p,y]);let k=(0,a.useCallback)(e=>{let t,a,i=w.current;if(!i)return null;let o=i.getBoundingClientRect();if("touches"in e){if(0===e.touches.length)return null;t=e.touches[0].clientX,a=e.touches[0].clientY}else t=e.clientX,a=e.clientY;let c=t-o.left,s=a-o.top,u=i.width/o.width,h=i.height/o.height,d=r+(n?l:0),f=Math.floor((c*u-R)/d),m=Math.floor((s*h-R)/d);return m>=0&&m<S&&f>=0&&f<A?{row:m,col:f}:null},[r,n,l,R,S,A]),_=(0,a.useCallback)(e=>{if(!g)return;2===e.button&&e.preventDefault();let t=k(e);t&&s&&(s(t.row,t.col,2===e.button),b.current=t,E(!0))},[g,k,s]),v=(0,a.useCallback)(e=>{g&&e.preventDefault()},[g]),O=(0,a.useCallback)(e=>{if(!g)return;let t=k(e);t&&d&&d(t.row,t.col),C&&u&&t&&(!b.current||b.current.row!==t.row||b.current.col!==t.col)&&(u(t.row,t.col),b.current=t)},[g,C,k,u,d]),D=(0,a.useCallback)(()=>{C&&(E(!1),b.current=null,h?.())},[C,h]),I=(0,a.useCallback)(()=>{C&&(E(!1),b.current=null,h?.()),f?.()},[C,h,f]),M=(0,a.useCallback)(e=>{if(!g)return;e.preventDefault();let t=k(e);t&&s&&(s(t.row,t.col),b.current=t,E(!0))},[g,k,s]),P=(0,a.useCallback)(e=>{if(!g||!C||!u)return;e.preventDefault();let t=k(e);t&&(!b.current||b.current.row!==t.row||b.current.col!==t.col)&&(u(t.row,t.col),b.current=t)},[g,C,k,u]),N=(0,a.useCallback)(()=>{C&&(E(!1),b.current=null,h?.())},[C,h]);return(0,t.jsx)("canvas",{ref:w,width:x,height:T,className:`${g?"cursor-crosshair":""} ${m}`,style:{imageRendering:"pixelated",touchAction:"none"},onMouseDown:_,onMouseMove:O,onMouseUp:D,onMouseLeave:I,onContextMenu:v,onTouchStart:M,onTouchMove:P,onTouchEnd:N})}e.s(["PixelGrid",()=>r])},60951,e=>{"use strict";e.s(["CHARACTER_EDITOR_SNAPSHOTS_STORE",0,"character-editor-snapshots","CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE",0,"retrostack-character-editor-autosave","CHARACTER_EDITOR_STORAGE_KEY_COLOR_PRESET",0,"retrostack-character-editor-color-preset","CHARACTER_EDITOR_STORAGE_KEY_CUSTOM_COLORS",0,"retrostack-character-editor-custom-colors","CHARACTER_EDITOR_STORAGE_KEY_FALLBACK",0,"retrostack-character-editor-sets","CHARACTER_EDITOR_STORAGE_KEY_ONBOARDING",0,"retrostack-character-editor-onboarding","CHARACTER_EDITOR_STORAGE_KEY_SORT_DIRECTION",0,"retrostack-character-editor-sort-direction","CHARACTER_EDITOR_STORAGE_KEY_SORT_FIELD",0,"retrostack-character-editor-sort-field","CHARACTER_EDITOR_STORE_NAME",0,"character-editor-sets","DB_NAME",0,"retrostack-web","DB_VERSION",0,5])},33712,e=>{"use strict";function t(e){return Math.ceil(e/8)}function a(e){return t(e.width)*e.height}function r(e){let t=e.binaryData,r=0;t.endsWith("==")?r=2:t.endsWith("=")&&(r=1);let n=3*t.length/4-r,i=a(e.config);return i>0?Math.floor(n/i):0}function n(e,t){let a=[];for(let r=0;r<t;r++)a.push(Array(e).fill(!1));return{pixels:a}}function i(e){return{pixels:e.pixels.map(e=>[...e])}}function l(){return{width:8,height:8,padding:"right",bitDirection:"ltr"}}function o(){return crypto.randomUUID()}e.s(["bytesPerCharacter",()=>a,"bytesPerLine",()=>t,"cloneCharacter",()=>i,"createDefaultConfig",()=>l,"createEmptyCharacter",()=>n,"generateId",()=>o,"getCharacterCount",()=>r])},20371,e=>{"use strict";var t=e.i(33712);function a(e,t){let a=e.pixels.length,r=e.pixels[0]?.length||0,n=[];for(let i=0;i<a;i++){let l=[];for(let n=0;n<r;n++){let o,c;"right"===t?(o=r-1-n,c=i):(o=n,c=a-1-i),o>=0&&o<a&&c>=0&&c<r?l.push(e.pixels[o]?.[c]||!1):l.push(!1)}n.push(l)}return{pixels:n}}function r(e,t,a=!0){let n=e.pixels.length,i=e.pixels[0]?.length||0,l=[];for(let r=0;r<n;r++){let o=[];for(let l=0;l<i;l++){let c=r,s=l;switch(t){case"up":if((c=r+1)>=n&&(c=a?0:n-1,!a)){o.push(!1);continue}break;case"down":if((c=r-1)<0&&(c=a?n-1:0,!a)){o.push(!1);continue}break;case"left":if((s=l+1)>=i&&(s=a?0:i-1,!a)){o.push(!1);continue}break;case"right":if((s=l-1)<0&&(s=a?i-1:0,!a)){o.push(!1);continue}}o.push(e.pixels[c]?.[s]||!1)}l.push(o)}return{pixels:l}}function n(e,t,a,r){let n=e.pixels.length,i=e.pixels[0]?.length||0,l=0,o=0;r.endsWith("l")?l=0:r.endsWith("c")?l=Math.floor((t-i)/2):r.endsWith("r")&&(l=t-i),r.startsWith("t")?o=0:r.startsWith("m")?o=Math.floor((a-n)/2):r.startsWith("b")&&(o=a-n);let c=[];for(let r=0;r<a;r++){let a=[];for(let c=0;c<t;c++){let t=r-o,s=c-l;t>=0&&t<n&&s>=0&&s<i?a.push(e.pixels[t][s]):a.push(!1)}c.push(a)}return{pixels:c}}function i(e){return{pixels:e.pixels.map(e=>e.map(e=>!e))}}function l(e){return{pixels:e.pixels.map(e=>[...e].reverse())}}function o(e){return{pixels:[...e.pixels].reverse().map(e=>[...e])}}function c(e,a){return(0,t.createEmptyCharacter)(e,a)}function s(e,t){let a=[];for(let r=0;r<t;r++)a.push(Array(e).fill(!0));return{pixels:a}}function u(e,t,a){return{pixels:e.pixels.map((e,r)=>r===t?e.map((e,t)=>t===a?!e:e):[...e])}}function h(e,t,a,r){return{pixels:e.pixels.map((e,n)=>n===t?e.map((e,t)=>t===a?r:e):[...e])}}function d(e,t,a){return e.map((e,r)=>t.has(r)?a(e):e)}function f(e,t,a,r){let n=Array.from(t).map(t=>e[t]);if(0===n.length)return"same-off";let i=n[0]?.pixels[a]?.[r]||!1;for(let e=1;e<n.length;e++)if((n[e]?.pixels[a]?.[r]||!1)!==i)return"mixed";return i?"same-on":"same-off"}function m(e,t,a,r){let n="same-on"!==f(e,t,a,r);return e.map((e,i)=>t.has(i)?h(e,a,r,n):e)}function g(e){let t=e.pixels.length,a=e.pixels[0]?.length||0,r=function(e){let t=e.pixels.length,a=e.pixels[0]?.length||0,r=t,n=-1,i=a,l=-1;for(let o=0;o<t;o++)for(let t=0;t<a;t++)e.pixels[o][t]&&(r=Math.min(r,o),n=Math.max(n,o),i=Math.min(i,t),l=Math.max(l,t));return -1===n?null:{minRow:r,maxRow:n,minCol:i,maxCol:l}}(e);if(!r)return e;let n=r.maxCol-r.minCol+1,i=Math.floor((t-(r.maxRow-r.minRow+1))/2),l=Math.floor((a-n)/2)-r.minCol,o=i-r.minRow;if(0===l&&0===o)return e;let c=[];for(let r=0;r<t;r++){let n=[];for(let i=0;i<a;i++){let c=r-o,s=i-l;c>=0&&c<t&&s>=0&&s<a?n.push(e.pixels[c][s]):n.push(!1)}c.push(n)}return{pixels:c}}function p(e,t,a,r){return 1===t?e:"nearest"===r?function(e,t,a){let r=e.pixels.length,n=e.pixels[0]?.length||0,i=Math.round(n*t),l=Math.round(r*t),o=[];for(let a=0;a<l;a++){let l=[];for(let o=0;o<i;o++){let i=Math.min(Math.floor(a/t),r-1),c=Math.min(Math.floor(o/t),n-1);l.push(e.pixels[i]?.[c]||!1)}o.push(l)}let c=n-i,s=r-l,u=0,h=0;a.endsWith("l")?u=0:a.endsWith("c")?u=Math.floor(c/2):a.endsWith("r")&&(u=c),a.startsWith("t")?h=0:a.startsWith("m")?h=Math.floor(s/2):a.startsWith("b")&&(h=s);let d=[];for(let e=0;e<r;e++){let t=[];for(let a=0;a<n;a++){let r=e-h,n=a-u;r>=0&&r<l&&n>=0&&n<i?t.push(o[r][n]):t.push(!1)}d.push(t)}return{pixels:d}}(e,t,a):function(e,t,a,r=.5){let n=e.pixels.length,i=e.pixels[0]?.length||0,l=Math.round(i*t),o=Math.round(n*t),c=[];for(let a=0;a<o;a++){let n=[];for(let i=0;i<l;i++){let l=a/t,o=(a+1)/t,c=i/t,s=(i+1)/t,u=function(e,t,a,r,n){let i=e.length,l=e[0]?.length||0,o=0,c=0,s=Math.max(0,Math.floor(t)),u=Math.min(i-1,Math.floor(a)),h=Math.max(0,Math.floor(r)),d=Math.min(l-1,Math.floor(n));for(let i=s;i<=u;i++)for(let l=h;l<=d;l++){let s=Math.max(i,t),u=Math.max(l,r),h=(Math.min(i+1,a)-s)*(Math.min(l+1,n)-u);o+=h,e[i][l]&&(c+=h)}return 0===o?0:c/o}(e.pixels,l,o,c,s);n.push(u>=r)}c.push(n)}let s=i-l,u=n-o,h=0,d=0;a.endsWith("l")?h=0:a.endsWith("c")?h=Math.floor(s/2):a.endsWith("r")&&(h=s),a.startsWith("t")?d=0:a.startsWith("m")?d=Math.floor(u/2):a.startsWith("b")&&(d=u);let f=[];for(let e=0;e<n;e++){let t=[];for(let a=0;a<i;a++){let r=e-d,n=a-h;r>=0&&r<o&&n>=0&&n<l?t.push(c[r][n]):t.push(!1)}f.push(t)}return{pixels:f}}(e,t,a)}e.s(["batchTogglePixel",()=>m,"batchTransform",()=>d,"centerCharacter",()=>g,"clearCharacter",()=>c,"fillCharacter",()=>s,"flipHorizontal",()=>l,"flipVertical",()=>o,"getPixelState",()=>f,"invertCharacter",()=>i,"resizeCharacter",()=>n,"rotateCharacter",()=>a,"scaleCharacter",()=>p,"setPixel",()=>h,"shiftCharacter",()=>r,"togglePixel",()=>u])},3573,e=>{"use strict";var t=e.i(71645);function a(e,r={}){let{enabled:n=!0,target:i=null}=r,l=(0,t.useRef)(e);(0,t.useEffect)(()=>{l.current=e},[e]);let o=(0,t.useCallback)(e=>{let t=e.target?.tagName?.toLowerCase();if("input"!==t&&"textarea"!==t&&"select"!==t||e.ctrlKey||e.metaKey)for(let t of l.current){let a=e.key.toLowerCase()===t.key.toLowerCase(),r=!!t.ctrl===(e.ctrlKey||e.metaKey),n=!!t.shift===e.shiftKey,i=!!t.alt===e.altKey;if(a&&r&&n&&i){e.preventDefault(),t.action();return}}},[]);(0,t.useEffect)(()=>{if(!n)return;let e=i||window;return e.addEventListener("keydown",o),()=>{e.removeEventListener("keydown",o)}},[n,i,o])}function r(e){let t=[],a="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);e.ctrl&&t.push(a?"⌘":"Ctrl"),e.alt&&t.push(a?"⌥":"Alt"),e.shift&&t.push(a?"⇧":"Shift");let r=e.key;return t.push(r=" "===r?"Space":"ArrowUp"===r?"↑":"ArrowDown"===r?"↓":"ArrowLeft"===r?"←":"ArrowRight"===r?"→":"Escape"===r?"Esc":"Delete"===r?"Del":"Backspace"===r?"⌫":r.toUpperCase()),t.join(a?"":"+")}function n(e){return[{key:"z",ctrl:!0,action:e.undo,description:"Undo",context:"Editor"},{key:"z",ctrl:!0,shift:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"y",ctrl:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"s",ctrl:!0,action:e.save,description:"Save",context:"Editor"},{key:"r",action:e.rotateRight,description:"Rotate right",context:"Editor"},{key:"r",shift:!0,action:e.rotateLeft,description:"Rotate left",context:"Editor"},{key:"w",action:e.shiftUp,description:"Shift up",context:"Editor"},{key:"s",action:e.shiftDown,description:"Shift down",context:"Editor"},{key:"a",action:e.shiftLeft,description:"Shift left",context:"Editor"},{key:"d",action:e.shiftRight,description:"Shift right",context:"Editor"},{key:"i",action:e.invert,description:"Invert colors",context:"Editor"},{key:"h",action:e.flipHorizontal,description:"Flip horizontal",context:"Editor"},{key:"v",action:e.flipVertical,description:"Flip vertical",context:"Editor"},{key:"a",ctrl:!0,action:e.selectAll,description:"Select all",context:"Sidebar"},{key:"Delete",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"Backspace",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"n",ctrl:!0,action:e.addCharacter,description:"Add new character",context:"Editor"},{key:"?",action:e.showHelp,description:"Show keyboard shortcuts",context:"Global"},...e.navigatePrev?[{key:"ArrowUp",action:e.navigatePrev,description:"Previous character",context:"Navigation"}]:[],...e.navigateNext?[{key:"ArrowDown",action:e.navigateNext,description:"Next character",context:"Navigation"}]:[],...e.navigatePageUp?[{key:"PageUp",action:e.navigatePageUp,description:"Jump 16 characters up",context:"Navigation"}]:[],...e.navigatePageDown?[{key:"PageDown",action:e.navigatePageDown,description:"Jump 16 characters down",context:"Navigation"}]:[],...e.navigateFirst?[{key:"Home",action:e.navigateFirst,description:"First character",context:"Navigation"}]:[],...e.navigateLast?[{key:"End",action:e.navigateLast,description:"Last character",context:"Navigation"}]:[],...e.goToCharacter?[{key:"g",action:e.goToCharacter,description:"Go to character",context:"Navigation"}]:[],...e.showAsciiMap?[{key:"m",action:e.showAsciiMap,description:"Show ASCII map",context:"Navigation"}]:[],...e.showTextPreview?[{key:"t",action:e.showTextPreview,description:"Text preview",context:"View"}]:[],...e.showSnapshots?[{key:"s",ctrl:!0,shift:!0,action:e.showSnapshots,description:"Snapshots",context:"Editor"}]:[],...e.exportSet?[{key:"e",action:e.exportSet,description:"Export character set",context:"File"}]:[],...e.importSet?[{key:"i",ctrl:!0,action:e.importSet,description:"Import characters",context:"File"}]:[],...e.shareSet?[{key:"e",ctrl:!0,shift:!0,action:e.shareSet,description:"Share character set",context:"File"}]:[],...e.saveAs?[{key:"s",ctrl:!0,alt:!0,action:e.saveAs,description:"Save as new",context:"File"}]:[],...e.editMetadata?[{key:"F2",action:e.editMetadata,description:"Edit info",context:"File"}]:[],...e.resetChanges?[{key:"r",ctrl:!0,shift:!0,action:e.resetChanges,description:"Reset changes",context:"Editor"}]:[],...e.reorderCharacters?[{key:"o",action:e.reorderCharacters,description:"Reorder characters",context:"Editor"}]:[]]}e.s(["createEditorShortcuts",()=>n,"formatShortcut",()=>r,"useKeyboardShortcuts",()=>a])},94136,e=>{"use strict";var t=e.i(33712);function a(e,a){let{width:r,height:n,padding:i,bitDirection:l}=a,o=(0,t.bytesPerLine)(r),c=new Uint8Array(n*o);for(let t=0;t<n;t++){let a=8*o,n=a-r,s=Array(a).fill(!1);if("left"===i)for(let a=0;a<r;a++)s[n+a]=e.pixels[t]?.[a]||!1;else for(let a=0;a<r;a++)s[a]=e.pixels[t]?.[a]||!1;for(let e=0;e<o;e++){let a=0;for(let t=0;t<8;t++)s[8*e+t]&&(a|=1<<("ltr"===l?7-t:t));c[t*o+e]=a}}return c}function r(e,a){let r=e instanceof Uint8Array?e:new Uint8Array(e),n=(0,t.bytesPerCharacter)(a),i=Math.floor(r.length/n),l=[];for(let e=0;e<i;e++){let i=r.slice(e*n,(e+1)*n);l.push(function(e,a){let{width:r,height:n,padding:i,bitDirection:l}=a,o=(0,t.bytesPerLine)(r),c=[];for(let t=0;t<n;t++){let a=[],n=t*o,s=[];for(let t=0;t<o;t++){let a=e[n+t]||0;for(let e=0;e<8;e++){let t=(a&1<<("ltr"===l?7-e:e))!=0;s.push(t)}}let u=8*o,h=u-r;if("left"===i)for(let e=h;e<u;e++)a.push(s[e]);else for(let e=0;e<r;e++)a.push(s[e]);c.push(a)}return{pixels:c}}(i,a))}return l}function n(e,r){let n=(0,t.bytesPerCharacter)(r),i=new Uint8Array(e.length*n);for(let t=0;t<e.length;t++){let l=a(e[t],r);i.set(l,t*n)}return i}function i(e){let t="";for(let a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return btoa(t)}function l(e){let t=atob(e),a=new Uint8Array(t.length);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e);return a}function o(e){let t=n(e.characters,e.config);return{metadata:e.metadata,config:e.config,binaryData:i(t)}}function c(e){let t=r(l(e.binaryData),e.config);return{metadata:e.metadata,config:e.config,characters:t}}function s(e,t,a){return new Blob([n(e,{...t,...a}).buffer],{type:"application/octet-stream"})}function u(e,t){let a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}e.s(["base64ToBinary",()=>l,"binaryToBase64",()=>i,"characterToBytes",()=>a,"createDownloadBlob",()=>s,"deserializeCharacterSet",()=>c,"downloadBlob",()=>u,"parseCharacterRom",()=>r,"serializeCharacterRom",()=>n,"serializeCharacterSet",()=>o])},72670,e=>{"use strict";var t=e.i(33712),a=e.i(60951);let r=new class{db=null;initialized=!1;initPromise=null;async initialize(){if(!this.initialized){if(this.initPromise)return this.initPromise;this.initPromise=this._initialize(),await this.initPromise,this.initialized=!0}}async _initialize(){return!function(){try{return!!window.indexedDB}catch{return!1}}()?void console.log("IndexedDB not available, using localStorage fallback"):new Promise(e=>{let t=indexedDB.open(a.DB_NAME,a.DB_VERSION);t.onerror=()=>{console.error("Failed to open IndexedDB, using localStorage fallback"),e()},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=e=>{let t=e.target.result,r=e.target.transaction,n=e.oldVersion;if(t.objectStoreNames.contains(a.CHARACTER_EDITOR_STORE_NAME)){if(n<2){let e=r.objectStore(a.CHARACTER_EDITOR_STORE_NAME);e.indexNames.contains("by-manufacturer")||e.createIndex("by-manufacturer","metadata.manufacturer",{unique:!1}),e.indexNames.contains("by-system")||e.createIndex("by-system","metadata.system",{unique:!1}),e.openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.manufacturer&&(e.metadata.manufacturer=""),e.metadata&&void 0===e.metadata.system&&(e.metadata.system=""),t.update(e),t.continue()}}}if(n<3&&(r.objectStore(a.CHARACTER_EDITOR_STORE_NAME).openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.isPinned&&(e.metadata.isPinned=!1),t.update(e),t.continue()}}),n<4){let e=r.objectStore(a.CHARACTER_EDITOR_STORE_NAME);e.indexNames.contains("by-locale")||e.createIndex("by-locale","metadata.locale",{unique:!1}),e.openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value;e.metadata&&void 0===e.metadata.locale&&(e.metadata.locale=""),t.update(e),t.continue()}}}}else{let e=t.createObjectStore(a.CHARACTER_EDITOR_STORE_NAME,{keyPath:"metadata.id"});e.createIndex("by-name","metadata.name",{unique:!1}),e.createIndex("by-updated","metadata.updatedAt",{unique:!1}),e.createIndex("by-size","sizeKey",{unique:!1}),e.createIndex("by-manufacturer","metadata.manufacturer",{unique:!1}),e.createIndex("by-system","metadata.system",{unique:!1}),e.createIndex("by-locale","metadata.locale",{unique:!1})}if(!t.objectStoreNames.contains(a.CHARACTER_EDITOR_SNAPSHOTS_STORE)){let e=t.createObjectStore(a.CHARACTER_EDITOR_SNAPSHOTS_STORE,{keyPath:"id"});e.createIndex("by-character-set","characterSetId",{unique:!1}),e.createIndex("by-created","createdAt",{unique:!1})}}})}useFallback(){return null===this.db}fallbackGetAll(){try{let e=localStorage.getItem(a.CHARACTER_EDITOR_STORAGE_KEY_FALLBACK);if(!e)return[];return JSON.parse(e).map(e=>({...e,metadata:{...e.metadata,manufacturer:e.metadata.manufacturer??"",system:e.metadata.system??"",locale:e.metadata.locale??"",isPinned:e.metadata.isPinned??!1}}))}catch{return[]}}fallbackSaveAll(e){try{localStorage.setItem(a.CHARACTER_EDITOR_STORAGE_KEY_FALLBACK,JSON.stringify(e))}catch(e){throw console.error("Failed to save to localStorage:",e),Error("Storage quota exceeded")}}async getAll(){return(await this.initialize(),this.useFallback())?this.fallbackGetAll():new Promise((e,t)=>{let r=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readonly").objectStore(a.CHARACTER_EDITOR_STORE_NAME).getAll();r.onsuccess=()=>{let t=r.result;t.sort((e,t)=>{let a=+!!e.metadata.isPinned,r=+!!t.metadata.isPinned;return a!==r?r-a:t.metadata.updatedAt-e.metadata.updatedAt}),e(t)},r.onerror=()=>{t(Error("Failed to get character sets"))}})}async getById(e){return(await this.initialize(),this.useFallback())?this.fallbackGetAll().find(t=>t.metadata.id===e)||null:new Promise((t,r)=>{let n=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readonly").objectStore(a.CHARACTER_EDITOR_STORE_NAME).get(e);n.onsuccess=()=>{t(n.result||null)},n.onerror=()=>{r(Error("Failed to get character set"))}})}async save(e){await this.initialize();let t={...e,sizeKey:`${e.config.width}x${e.config.height}`};if(this.useFallback()){let t=this.fallbackGetAll(),a=t.findIndex(t=>t.metadata.id===e.metadata.id);return a>=0?t[a]=e:t.push(e),this.fallbackSaveAll(t),e.metadata.id}return new Promise((r,n)=>{let i=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readwrite").objectStore(a.CHARACTER_EDITOR_STORE_NAME).put(t);i.onsuccess=()=>{r(e.metadata.id)},i.onerror=()=>{n(Error("Failed to save character set"))}})}async saveAs(e,a){let r=(0,t.generateId)(),n=Date.now(),i={...e,metadata:{...e.metadata,id:r,name:a,createdAt:n,updatedAt:n,isBuiltIn:!1,source:"yourself"}};return await this.save(i),r}async togglePinned(e){await this.initialize();let t=await this.getById(e);if(!t)throw Error("Character set not found");let a=!t.metadata.isPinned,r={...t,metadata:{...t.metadata,isPinned:a}};return await this.save(r),a}async delete(e){if(await this.initialize(),this.useFallback()){let t=this.fallbackGetAll().filter(t=>t.metadata.id!==e);this.fallbackSaveAll(t);return}return new Promise((t,r)=>{let n=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readwrite").objectStore(a.CHARACTER_EDITOR_STORE_NAME).delete(e);n.onsuccess=()=>{t()},n.onerror=()=>{r(Error("Failed to delete character set"))}})}async search(e){let t=await this.getAll(),a=e.toLowerCase();return t.filter(e=>e.metadata.name.toLowerCase().includes(a)||e.metadata.description.toLowerCase().includes(a)||e.metadata.source.toLowerCase().includes(a)||e.metadata.manufacturer.toLowerCase().includes(a)||e.metadata.system.toLowerCase().includes(a)||e.metadata.locale.toLowerCase().includes(a))}async filterBySize(e,t){return(await this.getAll()).filter(a=>(null===e||a.config.width===e)&&(null===t||a.config.height===t))}async filterByManufacturers(e){if(0===e.length)return this.getAll();let t=await this.getAll(),a=e.map(e=>e.toLowerCase());return t.filter(e=>a.includes(e.metadata.manufacturer.toLowerCase()))}async filterBySystems(e){if(0===e.length)return this.getAll();let t=await this.getAll(),a=e.map(e=>e.toLowerCase());return t.filter(e=>a.includes(e.metadata.system.toLowerCase()))}async getAvailableManufacturers(){let e=await this.getAll(),t=new Set;for(let a of e)a.metadata.manufacturer&&t.add(a.metadata.manufacturer);return Array.from(t).sort()}async getAvailableSystems(){let e=await this.getAll(),t=new Set;for(let a of e)a.metadata.system&&t.add(a.metadata.system);return Array.from(t).sort()}async getAvailableSizes(){let e=await this.getAll(),t=new Map;for(let a of e){let e=`${a.config.width}x${a.config.height}`;t.has(e)||t.set(e,{width:a.config.width,height:a.config.height})}return Array.from(t.values()).sort((e,t)=>e.width!==t.width?e.width-t.width:e.height-t.height)}async nameExists(e,t){return(await this.getAll()).some(a=>a.metadata.name.toLowerCase()===e.toLowerCase()&&a.metadata.id!==t)}async count(){return(await this.getAll()).length}async isEmpty(){return 0===(await this.getAll()).length}async clear(){return(await this.initialize(),this.useFallback())?void localStorage.removeItem(a.CHARACTER_EDITOR_STORAGE_KEY_FALLBACK):new Promise((e,t)=>{let r=this.db.transaction([a.CHARACTER_EDITOR_STORE_NAME],"readwrite").objectStore(a.CHARACTER_EDITOR_STORE_NAME).clear();r.onsuccess=()=>{e()},r.onerror=()=>{t(Error("Failed to clear storage"))}})}};async function n(){return await r.initialize(),r.db}e.s(["characterStorage",0,r,"getSharedDatabase",()=>n])},66811,e=>{"use strict";var t=e.i(71645),a=e.i(33712),r=e.i(72670),n=e.i(94136),i=e.i(28167);let l=[];function o(){return l.filter(e=>e.enabled)}let c=i.default;function s(e){let t=Date.now();return{metadata:{id:e.id,name:e.name,description:e.description||`${e.system} character set`,source:e.source||"RetroStack",manufacturer:e.manufacturer,system:e.system,chip:e.chip,locale:e.locale,createdAt:t,updatedAt:t,isBuiltIn:!0},config:{width:e.width,height:e.height,padding:e.bitPadding??"right",bitDirection:e.bitDirection},binaryData:(0,n.binaryToBase64)(function(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),a=0;for(let r of e)for(let e of r)t[a++]=e;return t}(e.data))}}let u=new Map;async function h(e){if(u.has(e.url))return u.get(e.url)??null;try{let t=await fetch(e.url);if(!t.ok)return console.warn(`Failed to fetch external charsets from ${e.name}: ${t.status}`),u.set(e.url,null),null;let a=await t.json();if(!Array.isArray(a))return console.warn(`Invalid format from ${e.name}: expected array of character sets`),u.set(e.url,null),null;let r=a.filter(e=>"object"==typeof e&&null!==e&&"string"==typeof e.id&&"string"==typeof e.name&&"number"==typeof e.width&&"number"==typeof e.height&&Array.isArray(e.data));return u.set(e.url,r),r}catch(t){return console.warn(`Error fetching external charsets from ${e.name}:`,t),u.set(e.url,null),null}}async function d(){let e=o();if(0===e.length)return[];let t=await Promise.all(e.map(h)),a=[];for(let e of t)if(e)for(let t of e)a.push(t.id);return a}async function f(e){let t=o();if(0===t.length)return null;for(let a of(await Promise.all(t.map(h))))if(a){let t=a.find(t=>t.id===e);if(t)return s(t)}return null}function m(){let[e,i]=(0,t.useState)([]),[l,o]=(0,t.useState)(!0),[u,h]=(0,t.useState)(null),[m,g]=(0,t.useState)([]),p=(0,t.useCallback)(async()=>{try{o(!0),h(null),await r.characterStorage.initialize();let e=await r.characterStorage.getAll(),t=new Set(e.map(e=>e.metadata.id)),a=c.map(e=>e.id).filter(e=>!t.has(e));if(a.length>0)for(let e of a){let t=function(e){let t=c.find(t=>t.id===e);return t?s(t):null}(e);t&&await r.characterStorage.save(t)}let n=(await d()).filter(e=>!t.has(e));if(n.length>0)for(let e of n){let t=await f(e);t&&await r.characterStorage.save(t)}let l=a.length>0||n.length>0?await r.characterStorage.getAll():e;i(l);let u=await r.characterStorage.getAvailableSizes();g(u)}catch(e){h(e instanceof Error?e.message:"Failed to load library")}finally{o(!1)}},[]);(0,t.useEffect)(()=>{p()},[p]);let y=(0,t.useCallback)(async()=>{await p()},[p]),w=(0,t.useCallback)(async e=>{try{let t=await r.characterStorage.getById(e);if(!t)return null;return(0,n.deserializeCharacterSet)(t)}catch(e){return console.error("Failed to get character set:",e),null}},[]),C=(0,t.useCallback)(async e=>{try{let t=(0,n.serializeCharacterSet)(e),a=await r.characterStorage.save(t);return await y(),a}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[y]),E=(0,t.useCallback)(async(e,t)=>{try{let i={...e,metadata:{...e.metadata,id:(0,a.generateId)(),name:t,createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1,source:"yourself"}},l=(0,n.serializeCharacterSet)(i),o=await r.characterStorage.save(l);return await y(),o}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[y]),b=(0,t.useCallback)(async(e,t)=>{try{let a=await r.characterStorage.getById(e);if(!a)throw Error("Character set not found");let n={...a,metadata:{...a.metadata,name:t,updatedAt:Date.now()}};await r.characterStorage.save(n),await y()}catch(e){throw Error(e instanceof Error?e.message:"Failed to rename character set")}},[y]),S=(0,t.useCallback)(async(e,t)=>{try{let a=await r.characterStorage.getById(e);if(!a)throw Error("Character set not found");let n={...a,metadata:{...a.metadata,...t,updatedAt:Date.now()}};await r.characterStorage.save(n),await y()}catch(e){throw Error(e instanceof Error?e.message:"Failed to update metadata")}},[y]),A=(0,t.useCallback)(async e=>{try{await r.characterStorage.delete(e),await y()}catch(e){throw Error(e instanceof Error?e.message:"Failed to delete character set")}},[y]),R=(0,t.useCallback)(async e=>{try{await r.characterStorage.togglePinned(e),await y()}catch(e){throw Error(e instanceof Error?e.message:"Failed to toggle pinned state")}},[y]),x=(0,t.useCallback)(async t=>t.trim()?r.characterStorage.search(t):e,[e]),T=(0,t.useCallback)(async(t,a)=>null===t&&null===a?e:r.characterStorage.filterBySize(t,a),[e]);return{characterSets:e,loading:l,error:u,refresh:y,getById:w,save:C,saveAs:E,rename:b,updateMetadata:S,deleteSet:A,togglePinned:R,search:x,filterBySize:T,availableSizes:m,nameExists:(0,t.useCallback)(async(e,t)=>r.characterStorage.nameExists(e,t),[])}}e.s(["useCharacterLibrary",()=>m],66811)},83621,16227,e=>{"use strict";var t=e.i(71645),a=e.i(33712),r=e.i(20371);function n(e,a=1/0){let[r,i]=(0,t.useState)([]),[l,o]=(0,t.useState)([]),[c,s]=(0,t.useState)({state:e,label:"Initial state",timestamp:Date.now()}),u=(0,t.useRef)(!1),h=(0,t.useRef)(null),d=(0,t.useCallback)((e,t)=>{u.current||(i(e=>{let t=[...e,c];return t.length>a&&(t=t.slice(-a)),t}),o([])),s({state:e,label:t,timestamp:Date.now()})},[c,a]),f=(0,t.useCallback)(()=>{u.current||(h.current=c,u.current=!0)},[c]),m=(0,t.useCallback)(e=>{u.current&&h.current&&(JSON.stringify(h.current.state)!==JSON.stringify(c.state)&&(i(e=>{let t=[...e,h.current];return t.length>a&&(t=t.slice(-a)),t}),o([]),s(t=>({...t,label:e||t.label}))),h.current=null,u.current=!1)},[c,a]),g=(0,t.useCallback)(e=>{i([]),o([]),s({state:e,label:"Initial state",timestamp:Date.now()})},[]),p=(0,t.useCallback)(()=>{i(e=>{if(0===e.length)return e;let t=e[e.length-1],a=e.slice(0,-1);return o(e=>[c,...e]),s(t),a})},[c]),y=(0,t.useCallback)(()=>{o(e=>{if(0===e.length)return e;let t=e[0],a=e.slice(1);return i(e=>[...e,c]),s(t),a})},[c]),w=(0,t.useCallback)(()=>{i([]),o([])},[]),C=(0,t.useMemo)(()=>[...r,c,...l],[r,c,l]),E=r.length+1+l.length,b=r.length,S=(0,t.useCallback)(e=>{let t=Math.max(0,Math.min(e,r.length+1+l.length-1));if(t===r.length)return;let a=[...r,c,...l],n=a[t],u=a.slice(0,t),h=a.slice(t+1);i(u),s(n),o(h)},[r,c,l]);return{state:c.state,setState:d,resetState:g,undo:p,redo:y,canUndo:r.length>0,canRedo:l.length>0,historyLength:r.length+l.length,clearHistory:w,history:C,historyIndex:b,jumpToHistory:S,totalHistoryEntries:E,startBatch:f,endBatch:m,isBatching:u.current}}function i(e){return JSON.parse(JSON.stringify(e))}function l(e){let{state:l,setState:o,resetState:c,undo:s,redo:u,canUndo:h,canRedo:d,history:f,historyIndex:m,jumpToHistory:g,totalHistoryEntries:p,startBatch:y,endBatch:w}=n(e?{characters:e.characters.map(a.cloneCharacter),config:{...e.config}}:{characters:[],config:{width:8,height:8,padding:"right",bitDirection:"ltr"}}),[C,E]=(0,t.useState)(0),[b,S]=(0,t.useState)(new Set),[A,R]=(0,t.useState)(!1),[,x]=(0,t.useState)(null),T=(0,t.useMemo)(()=>{let e=new Set(b);return e.add(C),e},[C,b]),k=(0,t.useCallback)((e,t)=>{o(e(i(l)),t),R(!0)},[l,o]),[_,v]=(0,t.useState)(null),O=(0,t.useCallback)((e,t,a=!1)=>{if(a)S(t=>{let a=new Set(t);if(e===C){if(a.size>0){let[e]=a;a.delete(e),a.add(C),E(e)}}else a.has(e)?a.delete(e):a.add(e);return a});else if(t){let t=_??C,a=Math.min(t,e),r=Math.max(t,e),n=new Set;for(let e=a;e<=r;e++)n.add(e);E(e),n.delete(e),S(n)}else E(e),v(e),S(new Set)},[C,_]),D=(0,t.useCallback)(()=>{S(new Set)},[]),I=(0,t.useCallback)(()=>{S(new Set(Array.from({length:l.characters.length},(e,t)=>t)))},[l.characters.length]),M=(0,t.useCallback)((e,t)=>{k(a=>{if(T.size>1)a.characters=(0,r.batchTogglePixel)(a.characters,T,e,t);else{let n=a.characters[C];n&&(a.characters[C]=(0,r.togglePixel)(n,e,t))}return a})},[k,C,T]),P=(0,t.useCallback)((e,t,a)=>{k(n=>{for(let i of T){let l=n.characters[i];l&&(n.characters[i]=(0,r.setPixel)(l,e,t,a))}return n})},[k,T]),N=(0,t.useCallback)((e,t)=>(0,r.getPixelState)(l.characters,T,e,t),[l.characters,T]),F=(0,t.useCallback)(e=>{k(t=>(t.characters=(0,r.batchTransform)(t.characters,T,t=>(0,r.rotateCharacter)(t,e)),t))},[k,T]),L=(0,t.useCallback)((e,t=!0)=>{k(a=>(a.characters=(0,r.batchTransform)(a.characters,T,a=>(0,r.shiftCharacter)(a,e,t)),a))},[k,T]),B=(0,t.useCallback)(()=>{k(e=>(e.characters=(0,r.batchTransform)(e.characters,T,r.invertCharacter),e))},[k,T]),H=(0,t.useCallback)(()=>{k(e=>(e.characters=(0,r.batchTransform)(e.characters,T,r.flipHorizontal),e))},[k,T]),z=(0,t.useCallback)(()=>{k(e=>(e.characters=(0,r.batchTransform)(e.characters,T,r.flipVertical),e))},[k,T]),U=(0,t.useCallback)(()=>{k(e=>{let{width:t,height:n}=e.config;return e.characters=(0,r.batchTransform)(e.characters,T,()=>(0,a.createEmptyCharacter)(t,n)),e})},[k,T]),K=(0,t.useCallback)(()=>{k(e=>{let{width:t,height:a}=e.config;return e.characters=(0,r.batchTransform)(e.characters,T,()=>({pixels:Array.from({length:a},()=>Array(t).fill(!0))})),e})},[k,T]),j=(0,t.useCallback)(()=>{k(e=>(e.characters=(0,r.batchTransform)(e.characters,T,r.centerCharacter),e))},[k,T]),G=(0,t.useCallback)((e,t,a)=>{k(n=>(n.characters=(0,r.batchTransform)(n.characters,T,n=>(0,r.scaleCharacter)(n,e,t,a)),n))},[k,T]),W=(0,t.useCallback)(()=>{k(e=>{let{width:t,height:r}=e.config;return e.characters=[...e.characters,(0,a.createEmptyCharacter)(t,r)],e}),E(l.characters.length),S(new Set)},[k,l.characters.length]),Y=(0,t.useCallback)(e=>{0!==e.length&&(k(t=>(t.characters=[...t.characters,...e.map(e=>(0,a.cloneCharacter)(e))],t)),E(l.characters.length),S(new Set))},[k,l.characters.length]),$=(0,t.useCallback)(()=>{l.characters.length<=1||(k(e=>(e.characters=e.characters.filter((e,t)=>!T.has(t)),e)),E(Math.min(C,l.characters.length-T.size-1)),S(new Set))},[k,T,l.characters.length,C]),V=(0,t.useCallback)((e,t)=>{k(r=>{let n=r.characters[e];return n&&t>=0&&t<r.characters.length&&(r.characters[t]=(0,a.cloneCharacter)(n)),r})},[k]),q=(0,t.useCallback)((e,t,a)=>{k(n=>(n.characters=n.characters.map(n=>(0,r.resizeCharacter)(n,e,t,a)),n.config={...n.config,width:e,height:t},n))},[k]),J=(0,t.useCallback)((e,t)=>{k(r=>(e>=0&&e<r.characters.length&&(r.characters[e]=(0,a.cloneCharacter)(t)),r))},[k]),X=(0,t.useCallback)(e=>{k(t=>(t.characters=e.map(a.cloneCharacter),t))},[k]),Q=(0,t.useCallback)(()=>{R(!1),x(i(l))},[l]),Z=(0,t.useCallback)(e=>{c({characters:e.characters.map(a.cloneCharacter),config:{...e.config}}),E(0),v(null),S(new Set),R(!1),x(null)},[c]);return{characters:l.characters,config:l.config,selectedIndex:C,setSelectedIndex:E,batchSelection:b,toggleBatchSelection:O,clearBatchSelection:D,selectAll:I,toggleSelectedPixel:M,setSelectedPixel:P,getSelectedPixelState:N,rotateSelected:F,shiftSelected:L,invertSelected:B,flipSelectedHorizontal:H,flipSelectedVertical:z,clearSelected:U,fillSelected:K,centerSelected:j,scaleSelected:G,selectedIndices:T,addCharacter:W,addCharacters:Y,deleteSelected:$,copyCharacter:V,resizeCharacters:q,updateCharacter:J,setCharacters:X,undo:s,redo:u,canUndo:h,canRedo:d,isDirty:A,markSaved:Q,reset:Z,history:f,historyIndex:m,jumpToHistory:g,totalHistoryEntries:p,startBatch:y,endBatch:w}}e.s(["deepClone",()=>i,"useUndoRedo",()=>n],16227),e.s(["useCharacterEditor",()=>l],83621)},7259,54750,69771,e=>{"use strict";e.i(66811),e.i(83621),e.i(16227),e.i(3573);var t=e.i(71645),a=e.i(94136),r=e.i(60951);function n(e){let{characterSetId:n,characters:i,config:l,selectedIndex:o,isDirty:c,enabled:s=!0}=e,[u,h]=(0,t.useState)(null),d=(0,t.useRef)(0),f=(0,t.useRef)(null);(0,t.useEffect)(()=>{if(n)try{let e=localStorage.getItem(r.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE);if(e){let t=JSON.parse(e);t.characterSetId===n&&t.isDirty&&h(t)}}catch{}},[n]);let m=(0,t.useCallback)(()=>{if(n&&s&&0!==i.length)try{let e=(0,a.binaryToBase64)((0,a.serializeCharacterRom)(i,l)),t={characterSetId:n,binaryData:e,config:l,selectedIndex:o,timestamp:Date.now(),isDirty:c};localStorage.setItem(r.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE,JSON.stringify(t)),d.current=Date.now()}catch(e){console.error("Auto-save failed:",e)}},[n,i,l,o,c,s]);(0,t.useEffect)(()=>{if(s&&c&&n)return f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{m()},Math.max(0,3e4-(Date.now()-d.current))),()=>{f.current&&clearTimeout(f.current)}},[s,c,n,m]),(0,t.useEffect)(()=>{if(!s||!c)return;let e=e=>{m(),e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[s,c,m]);let g=(0,t.useCallback)(()=>(h(null),u),[u]);return{hasRecoveryData:null!==u,recoveryData:u,recover:g,discard:(0,t.useCallback)(()=>{h(null);try{localStorage.removeItem(r.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE)}catch{}},[]),clearAutoSave:(0,t.useCallback)(()=>{try{localStorage.removeItem(r.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE)}catch{}},[]),saveNow:m}}e.s(["useAutoSave",()=>n],54750);var i=e.i(33712),l=e.i(72670);let o="snapshots";async function c(){let e=await (0,l.getSharedDatabase)();if(!e)throw Error("Database not available - storage may be disabled in your browser");return e}async function s(e){let t=await c();if((await u(e.characterSetId)).length>=10)throw Error("Maximum of 10 snapshots per character set. Delete an existing snapshot first.");return new Promise((a,r)=>{let n=t.transaction([o],"readwrite").objectStore(o).put(e);n.onsuccess=()=>a(),n.onerror=()=>r(Error("Failed to save snapshot"))})}async function u(e){let t=await c();return new Promise((a,r)=>{let n=t.transaction([o],"readonly").objectStore(o).index("by-character-set").getAll(e);n.onsuccess=()=>{let e=n.result;e.sort((e,t)=>t.createdAt-e.createdAt),a(e)},n.onerror=()=>{r(Error("Failed to get snapshots"))}})}async function h(e){let t=await c();return new Promise((a,r)=>{let n=t.transaction([o],"readonly").objectStore(o).get(e);n.onsuccess=()=>{a(n.result||null)},n.onerror=()=>{r(Error("Failed to get snapshot"))}})}async function d(e){let t=await c();return new Promise((a,r)=>{let n=t.transaction([o],"readwrite").objectStore(o).delete(e);n.onsuccess=()=>a(),n.onerror=()=>r(Error("Failed to delete snapshot"))})}async function f(e,t){let a=await c(),r=await h(e);if(!r)throw Error("Snapshot not found");let n={...r,name:t};return new Promise((e,t)=>{let r=a.transaction([o],"readwrite").objectStore(o).put(n);r.onsuccess=()=>e(),r.onerror=()=>t(Error("Failed to rename snapshot"))})}function m(e){let{characterSetId:r,enabled:n=!0}=e,[l,o]=(0,t.useState)([]),[c,h]=(0,t.useState)(!1),[m,g]=(0,t.useState)(null),p=(0,t.useCallback)(async()=>{if(!r||!n)return void o([]);h(!0),g(null);try{let e=await u(r);o(e)}catch(e){console.error("Failed to load snapshots:",e),g(e instanceof Error?e.message:"Failed to load snapshots"),o([])}finally{h(!1)}},[r,n]);(0,t.useEffect)(()=>{p()},[p]);let y=(0,t.useCallback)(async(e,t,n)=>{if(!r)return g("No character set ID"),!1;try{let l,o=(l=(0,a.binaryToBase64)((0,a.serializeCharacterRom)(t,n)),{id:(0,i.generateId)(),characterSetId:r,name:e,createdAt:Date.now(),binaryData:l,config:n,characterCount:t.length});return await s(o),await p(),!0}catch(e){return console.error("Failed to save snapshot:",e),g(e instanceof Error?e.message:"Failed to save snapshot"),!1}},[r,p]),w=(0,t.useCallback)(async e=>{try{let t,r=l.find(t=>t.id===e);if(!r)return g("Snapshot not found"),null;return t=(0,a.base64ToBinary)(r.binaryData),(0,a.parseCharacterRom)(t,r.config)}catch(e){return console.error("Failed to restore snapshot:",e),g(e instanceof Error?e.message:"Failed to restore snapshot"),null}},[l]);return{snapshots:l,loading:c,error:m,saveNewSnapshot:y,restore:w,remove:(0,t.useCallback)(async e=>{try{return await d(e),await p(),!0}catch(e){return console.error("Failed to delete snapshot:",e),g(e instanceof Error?e.message:"Failed to delete snapshot"),!1}},[p]),rename:(0,t.useCallback)(async(e,t)=>{try{return await f(e,t),await p(),!0}catch(e){return console.error("Failed to rename snapshot:",e),g(e instanceof Error?e.message:"Failed to rename snapshot"),!1}},[p]),refresh:p,isAtCapacity:l.length>=10,maxSnapshots:10}}e.s(["useSnapshots",()=>m],69771),e.s([],7259)},59544,e=>{"use strict";var t=e.i(43476),a=e.i(71645);let r={pink:"btn-neon btn-neon-pink",cyan:"btn-neon btn-neon-cyan",violet:"btn-neon btn-neon-violet",ghost:"bg-transparent text-retro-cyan hover:text-retro-pink transition-colors"},n={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},i=(0,a.forwardRef)(({className:e="",variant:a="pink",size:i="md",children:l,href:o,...c},s)=>{let u=`inline-flex items-center justify-center font-ui font-semibold uppercase tracking-wider rounded transition-all duration-300 ${r[a]} ${n[i]} ${e}`;return o?(0,t.jsx)("a",{href:o,className:u,children:l}):(0,t.jsx)("button",{ref:s,className:u,...c,children:l})});i.displayName="Button",e.s(["Button",0,i])}]);