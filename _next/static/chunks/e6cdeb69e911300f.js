(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53454,e=>{"use strict";let t,r,a;var n,s,l,o,i,c,d,h,u,x,m,f,p,g,b,v,y,w,j,C,k,N,S,M,E=e.i(43476),L=e.i(71645),R=e.i(18566),D=e.i(22016),A=e.i(3374),I=e.i(58234),T=e.i(72547),z=e.i(21745);function P(e){return"type"in e&&"separator"===e.type}function B({actions:e,minVisibleItems:t=2,className:r="",sticky:a=!1}){let n=(0,L.useRef)(null),[s,l]=(0,L.useState)(new Set),o=(0,L.useCallback)(()=>{if(!n.current)return;let r=n.current.offsetWidth-32-48,a=e.filter(e=>!P(e)).map(e=>({item:e,priority:e.priority??1})),s=[...a].sort((e,t)=>e.priority-t.priority),o=0;for(let t of e)o+=P(t)?16:48;let i=new Set,c=o,d=a.length;for(let{item:e}of s){if(c<=r||d<=t)break;i.add(e.id),c-=48,d--}l(i)},[e,t]);(0,L.useEffect)(()=>{o();let e=new ResizeObserver(()=>{o()});return n.current&&e.observe(n.current),()=>e.disconnect()},[o]);let i=[],c=[];for(let t of e)if(P(t)){let r=e.slice(e.indexOf(t)+1).some(e=>!P(e)&&!s.has(e.id)),a=e.slice(0,e.indexOf(t)).some(e=>!P(e)&&!s.has(e.id));r&&a&&i.push(t)}else s.has(t.id)?c.push(t):i.push(t);let d=c.map(e=>({id:e.id,label:e.label,icon:e.icon,onClick:e.onClick,disabled:e.disabled}));return(0,E.jsxs)("div",{ref:n,className:`
        flex items-center justify-between
        bg-retro-navy/80 backdrop-blur-sm
        border-b border-retro-grid/50
        px-2 sm:px-4
        ${a?"sticky top-[var(--header-height)] z-40":""}
        ${r}
      `,style:{minHeight:"var(--toolbar-height)"},children:[(0,E.jsx)("div",{className:"flex items-center gap-1 sm:gap-2 flex-nowrap overflow-hidden",children:i.map(e=>P(e)?(0,E.jsx)("div",{className:"h-6 w-px bg-retro-grid/50 mx-1","aria-hidden":"true"},e.id):(0,E.jsx)(z.Tooltip,{content:e.tooltip||e.label,shortcut:e.shortcut,position:"bottom",children:(0,E.jsx)("button",{onClick:e.onClick,disabled:e.disabled,"aria-label":e.label,className:`
                  touch-target flex items-center justify-center p-2 rounded-md
                  text-sm font-ui transition-colors flex-shrink-0
                  ${e.disabled?"text-gray-600 cursor-not-allowed":e.active?"amber"===e.activeVariant?"text-retro-amber bg-retro-amber/20":"text-retro-cyan bg-retro-purple/40":"text-gray-300 hover:text-retro-cyan hover:bg-retro-purple/30"}
                `,children:(0,E.jsx)("span",{className:"w-6 h-6 flex-shrink-0 [&>svg]:w-full [&>svg]:h-full",children:e.icon})})},e.id))}),d.length>0&&(0,E.jsx)(T.OverflowMenu,{items:d,align:"right",label:"More actions"})]})}var O=e.i(74080);let F=()=>()=>{},H=()=>!0,$=()=>!1;function W({isOpen:e,onClose:t,children:r,title:a,initialSnap:n="expanded",collapsedHeight:s="30vh",expandedHeight:l="60vh",allowFullHeight:o=!0,className:i=""}){let[c,d]=(0,L.useState)(n),[h,u]=(0,L.useState)(!1),[x,m]=(0,L.useState)(0),f=(0,L.useRef)(null),p=(0,L.useRef)(0),g=(0,L.useRef)(0),b=(0,L.useSyncExternalStore)(F,H,$),v=(0,L.useCallback)(e=>{switch(e){case"collapsed":return s;case"expanded":default:return l;case"full":return"calc(100vh - 60px)"}},[s,l]),y=(0,L.useCallback)(e=>{u(!0),p.current=e,f.current&&(g.current=f.current.getBoundingClientRect().height)},[]),w=(0,L.useCallback)(e=>{h&&m(p.current-e)},[h]),j=(0,L.useCallback)(()=>{h&&(u(!1),x<-50?"collapsed"===c||"expanded"===c?t():d("expanded"):x>50&&("collapsed"===c?d("expanded"):"expanded"===c&&o&&d("full")),m(0))},[h,x,c,o,t]),C=(0,L.useCallback)(e=>{e.preventDefault(),y(e.clientY)},[y]),k=(0,L.useCallback)(e=>{y(e.touches[0].clientY)},[y]),N=(0,L.useCallback)(e=>{w(e.touches[0].clientY)},[w]);if((0,L.useEffect)(()=>{if(!h)return;let e=e=>{w(e.clientY)},t=()=>{j()};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}},[h,w,j]),(0,L.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),(0,L.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e,t]),!b)return null;let S=(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:`
          fixed inset-0 bg-black/50 z-40
          transition-opacity duration-300
          ${e?"opacity-100":"opacity-0 pointer-events-none"}
        `,onClick:t,"aria-hidden":"true"}),(0,E.jsxs)("div",{ref:f,className:`
          fixed bottom-0 left-0 right-0 z-50
          bg-retro-navy border-t border-retro-grid/50
          rounded-t-2xl shadow-2xl
          transition-transform duration-300 ease-out
          ${e?"translate-y-0":"translate-y-full"}
          ${h?"transition-none":""}
          ${i}
        `,style:{height:v(c),transform:h?`translateY(${e?-x:0}px)`:e?"translateY(0)":"translateY(100%)"},role:"dialog","aria-modal":"true","aria-label":a||"Bottom sheet",children:[(0,E.jsx)("div",{className:"flex justify-center py-3 cursor-grab active:cursor-grabbing touch-none",onMouseDown:C,onTouchStart:k,onTouchMove:N,onTouchEnd:j,children:(0,E.jsx)("div",{className:"w-10 h-1 bg-gray-500 rounded-full"})}),a&&(0,E.jsx)("div",{className:"px-4 pb-2 border-b border-retro-grid/30",children:(0,E.jsx)("h2",{className:"text-sm font-medium text-gray-300",children:a})}),(0,E.jsx)("div",{className:"flex-1 overflow-y-auto px-4 pb-safe",children:r})]})]});return(0,O.createPortal)(S,document.body)}function U({title:e,children:t,toolbar:r,showFooter:a=!1,fullHeight:n=!0,className:s=""}){return(0,E.jsxs)("div",{className:`flex flex-col safe-top ${n?"viewport-locked":"min-h-screen"}`,children:[(0,E.jsx)(A.Header,{}),r&&r.length>0&&(0,E.jsx)(B,{actions:r,sticky:!0,className:"mt-[var(--header-height)]"}),(0,E.jsxs)("main",{className:`
          flex-1 bg-retro-dark
          ${!r?"mt-[var(--header-height)]":""}
          ${n?"tool-canvas overflow-hidden":""}
          ${s}
        `,children:[(0,E.jsx)("h1",{className:"sr-only",children:e}),t]}),a&&(0,E.jsx)(I.Footer,{})]})}function V({children:e,sidebar:t,sidebarPosition:r="left",sidebarWidth:a="280px",leftSidebar:n,leftSidebarWidth:s="220px",leftSidebarTitle:l="Panel",rightSidebar:o,rightSidebarWidth:i="80px",rightSidebarTitle:c="Tools",leftSidebarCollapsible:d=!0,rightSidebarCollapsible:h=!0,useBottomSheets:u=!0,className:x=""}){let m=function(e){let[t,r]=(0,L.useState)(()=>window.matchMedia(e).matches);return(0,L.useEffect)(()=>{let a=window.matchMedia(e);a.matches!==t&&r(a.matches);let n=e=>{r(e.matches)};return a.addEventListener("change",n),()=>{a.removeEventListener("change",n)}},[e,t]),t}("(max-width: 639px)"),[f,p]=(0,L.useState)(null),g=n??("left"===r?t:void 0),b=o??("right"===r?t:void 0),v=n?s:a,y=o?i:a,w=(0,L.useCallback)(()=>p("left"),[]),j=(0,L.useCallback)(()=>p("right"),[]),C=(0,L.useCallback)(()=>p(null),[]);return g||b?m&&u&&(d||h)?(0,E.jsxs)("div",{className:"h-full flex flex-col relative",children:[(0,E.jsx)("div",{className:`
            flex-1 overflow-auto
            flex items-center justify-center
            pb-14
            ${x}
          `,children:e}),(0,E.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-30 bg-retro-navy border-t border-retro-grid/50 safe-bottom",children:(0,E.jsxs)("div",{className:"flex justify-around py-2 px-4",children:[g&&d&&(0,E.jsxs)("button",{onClick:w,className:`
                  flex flex-col items-center gap-1 px-4 py-2 rounded-lg
                  transition-colors min-w-[80px]
                  ${"left"===f?"bg-retro-cyan/20 text-retro-cyan":"text-gray-400 hover:text-gray-200"}
                `,"aria-label":`Open ${l}`,children:[(0,E.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h7"})}),(0,E.jsx)("span",{className:"text-xs",children:l})]}),b&&h&&(0,E.jsxs)("button",{onClick:j,className:`
                  flex flex-col items-center gap-1 px-4 py-2 rounded-lg
                  transition-colors min-w-[80px]
                  ${"right"===f?"bg-retro-pink/20 text-retro-pink":"text-gray-400 hover:text-gray-200"}
                `,"aria-label":`Open ${c}`,children:[(0,E.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),(0,E.jsx)("span",{className:"text-xs",children:c})]})]})}),g&&d&&(0,E.jsx)(W,{isOpen:"left"===f,onClose:C,title:l,expandedHeight:"70vh",collapsedHeight:"40vh",children:g}),b&&h&&(0,E.jsx)(W,{isOpen:"right"===f,onClose:C,title:c,expandedHeight:"60vh",collapsedHeight:"35vh",children:b})]}):(0,E.jsxs)("div",{className:"h-full flex flex-col lg:flex-row",children:[g&&(0,E.jsx)("aside",{className:`
            w-full lg:w-auto lg:flex-shrink-0
            ${d?"border-b lg:border-b-0":""}
            lg:border-r border-retro-grid/50
            bg-retro-navy/50
            overflow-y-auto
            ${d?"max-h-[30vh] lg:max-h-none":""}
          `,style:{"--sidebar-width":v},children:(0,E.jsx)("div",{className:"lg:w-[var(--sidebar-width)] h-full",children:g})}),(0,E.jsx)("div",{className:`
          flex-1 overflow-auto
          flex items-center justify-center
          ${x}
        `,children:e}),b&&(0,E.jsx)("aside",{className:`
            w-full lg:w-auto lg:flex-shrink-0
            ${h?"border-t lg:border-t-0":""}
            lg:border-l border-retro-grid/50
            bg-retro-navy/50
            overflow-y-auto
            ${h?"max-h-[30vh] lg:max-h-none":""}
          `,style:{"--sidebar-width":y},children:(0,E.jsx)("div",{className:"lg:w-[var(--sidebar-width)] h-full",children:b})})]}):(0,E.jsx)("div",{className:`h-full overflow-auto ${x}`,children:e})}var _=e.i(88419);function K({character:e,config:t,onPixelToggle:r,onPixelSet:a,onDragStart:n,onDragEnd:s,getPixelState:l,batchMode:o=!1,foregroundColor:i="#ffffff",backgroundColor:c="#000000",gridColor:d="#4a4a4a",gridThickness:h=1,zoom:u=20,minZoom:x=8,maxZoom:m=40,onZoomChange:f,onPixelHover:p,onPixelLeave:g,className:b="",overlayCharacter:v,overlayConfig:y,overlayMode:w="pixel",keyboardCursorEnabled:j=!0}){let C,k,N=(0,L.useRef)(null),S=(0,L.useRef)(null),M=(0,L.useRef)(null),[R,D]=(0,L.useState)(!1),[A,I]=(0,L.useState)(null),T=(0,L.useRef)(null),[z,P]=(0,L.useState)(null),[B,O]=(0,L.useState)(!1),F=(0,L.useMemo)(()=>{if(!o||!l||!e)return;let r=new Set;for(let e=0;e<t.height;e++)for(let a=0;a<t.width;a++)"mixed"===l(e,a)&&r.add(`${e},${a}`);return r.size>0?r:void 0},[o,l,e,t.height,t.width]);(0,L.useEffect)(()=>{let e=S.current;if(!e||!y)return;let r=e.getContext("2d");if(!r)return;let a=t.width,n=t.height,s=y.width,l=y.height,o=u+h,i=a*o+h,c=n*o+h;if(e.width=i,e.height=c,r.clearRect(0,0,i,c),v)if(r.fillStyle="rgba(255, 0, 128, 0.5)","stretch"===w){let e=a*o/s,t=n*o/l;for(let a=0;a<l;a++)for(let n=0;n<s;n++)if(v.pixels[a]?.[n]){let s=h+n*e,l=h+a*t;r.fillRect(s,l,e,t)}}else{let e=Math.min(l,n),t=Math.min(s,a);for(let a=0;a<e;a++)for(let e=0;e<t;e++)if(v.pixels[a]?.[e]){let t=e*o+h,n=a*o+h;r.fillRect(t,n,u,u)}}},[v,y,w,t.width,t.height,u,h]);let H=(0,L.useCallback)((t,s,l)=>{R||(n?.(),l?(a?.(t,s,!1),I(!1)):(r?.(t,s),I(!e?.pixels[t]?.[s])),D(!0))},[R,r,a,n,e]),$=(0,L.useCallback)((e,t)=>{R&&null!==A&&a&&a(e,t,A)},[R,A,a]),W=(0,L.useCallback)(()=>{R&&(D(!1),I(null),s?.())},[R,s]),U=(0,L.useCallback)(e=>{if((e.ctrlKey||e.metaKey)&&(e.preventDefault(),f)){let t=Math.min(m,Math.max(x,u+(e.deltaY>0?-4:4)));t!==u&&f(t)}},[u,x,m,f]),V=(0,L.useCallback)(e=>{if(e.length<2)return null;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},[]),K=(0,L.useCallback)(e=>{2===e.touches.length&&(e.preventDefault(),T.current=V(e.touches))},[V]),Y=(0,L.useCallback)(e=>{if(2===e.touches.length&&null!==T.current&&f){e.preventDefault();let t=V(e.touches);if(null!==t){let e=Math.min(m,Math.max(x,u+(t-T.current)/20));Math.abs(e-u)>=1&&(f(Math.round(e)),T.current=t)}}},[V,u,x,m,f]),G=(0,L.useCallback)(()=>{T.current=null},[]),X=(0,L.useCallback)(a=>{if(!j||!e)return;let n=[" ","Enter"];if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End"].includes(a.key)||n.includes(a.key)){if(a.preventDefault(),!B){O(!0),P({row:0,col:0});return}let e=z?.row??0,s=z?.col??0;if(n.includes(a.key))r?.(e,s);else{let r=e,n=s;switch(a.key){case"ArrowUp":r=Math.max(0,e-1);break;case"ArrowDown":r=Math.min(t.height-1,e+1);break;case"ArrowLeft":n=Math.max(0,s-1);break;case"ArrowRight":n=Math.min(t.width-1,s+1);break;case"Home":r=0,n=0;break;case"End":r=t.height-1,n=t.width-1}P({row:r,col:n}),p?.(r,n)}}},[j,e,B,z,t.height,t.width,r,p]),Q=(0,L.useCallback)(()=>{j&&e&&(O(!0),z||P({row:0,col:0}))},[j,e,z]),J=(0,L.useCallback)(()=>{O(!1)},[]);if((0,L.useEffect)(()=>{let e=M.current;if(!e||!B||!z)return;let r=e.getContext("2d");if(!r)return;let a=u+h,n=t.width*a+h,s=t.height*a+h;e.width=n,e.height=s,r.clearRect(0,0,n,s);let l=z.col*a+h,o=z.row*a+h;r.strokeStyle="#00f5ff",r.lineWidth=2,r.setLineDash([4,2]),r.strokeRect(l-1,o-1,u+2,u+2),r.fillStyle="#00f5ff",r.fillRect(l-1,o-1,4,2),r.fillRect(l-1,o-1,2,4),r.fillRect(l+u-4+1,o-1,4,2),r.fillRect(l+u-1,o-1,2,4),r.fillRect(l-1,o+u-1,4,2),r.fillRect(l-1,o+u-4+1,2,4),r.fillRect(l+u-4+1,o+u-1,4,2),r.fillRect(l+u-1,o+u-4+1,2,4)},[B,z,u,h,t.width,t.height]),(0,L.useEffect)(()=>{let e=N.current;if(!e)return;let t=e=>{2===e.touches.length&&e.preventDefault()};return e.addEventListener("touchmove",t,{passive:!1}),()=>{e.removeEventListener("touchmove",t)}},[]),!e)return(0,E.jsx)("div",{className:`flex items-center justify-center h-full ${b}`,children:(0,E.jsxs)("div",{className:"text-center text-gray-500",children:[(0,E.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6z"})}),(0,E.jsx)("p",{children:"No character selected"})]})});let q=u+h,Z=t.width*q+h,ee=t.height*q+h,et=z&&B?`Pixel at row ${z.row+1}, column ${z.col+1}, ${e?.pixels[z.row]?.[z.col]?"on":"off"}`:"Pixel editor canvas";return(0,E.jsx)("div",{ref:N,className:`flex items-center justify-center w-full h-full overflow-hidden ${b} ${B?"ring-2 ring-retro-cyan/50 rounded":""}`,tabIndex:0,role:"application","aria-label":et,"aria-roledescription":"Pixel editor",onWheel:U,onKeyDown:X,onFocus:Q,onBlur:J,onTouchStart:K,onTouchMove:Y,onTouchEnd:G,children:(0,E.jsx)("div",{className:"inline-block",onMouseLeave:W,onMouseUp:W,children:(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsx)(_.CharacterDisplay,{character:e,mode:"large",scale:u,foregroundColor:i,backgroundColor:c,gridColor:d,gridThickness:h,onPixelClick:H,onPixelDrag:$,onDragEnd:W,onPixelHover:p,onPixelLeave:g,interactive:!0,mixedPixels:F}),B&&z&&(0,E.jsx)("canvas",{ref:M,className:"absolute top-0 left-0 pointer-events-none",style:{imageRendering:"pixelated",zIndex:15,width:Z,height:ee},"aria-hidden":"true"}),y&&"side-by-side"!==w&&(C=t.width*q+h,k=t.height*q+h,(0,E.jsx)("canvas",{ref:S,className:"absolute top-0 left-0 pointer-events-none",style:{imageRendering:"pixelated",zIndex:10,width:C,height:k}}))]})})})}e.i(85984);var Y=e.i(96174);function G({characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:n,foregroundColor:s="#ffffff",backgroundColor:l="#000000",selectionColor:o="#00ffff",batchSelectionColor:i="#ff69b4",maxWidth:c=200,pixelScale:d=1,gap:h=1,collapsible:u=!0,defaultCollapsed:x=!1,className:m="",isSelectionMode:f=!1,onLongPress:p,onToggleSelection:g}){let b=(0,L.useRef)(null),v=(0,L.useRef)(null),[y,w]=(0,L.useState)(x),[j,C]=(0,L.useState)(null),k=(0,L.useRef)(null),N=(0,L.useRef)(null),S=(0,L.useRef)(!1),M=(0,L.useRef)({isActive:!1,hasMoved:!1,touchedIndices:new Set}),R=t.width*d,D=t.height*d,A=R+h,I=D+h,T=Math.max(1,Math.floor(c/A)),z=Math.ceil(e.length/T),P=T*A-h,B=z*I-h;(0,L.useEffect)(()=>{let t=b.current;if(!t||y)return;let n=t.getContext("2d");n&&(t.width=P,t.height=B,n.fillStyle=l,n.fillRect(0,0,P,B),e.forEach((e,t)=>{let c=t%T*A,h=Math.floor(t/T)*I;n.fillStyle=l,n.fillRect(c,h,R,D),n.fillStyle=s,e.pixels.forEach((e,t)=>{e.forEach((e,r)=>{e&&n.fillRect(c+r*d,h+t*d,d,d)})}),a?.has(t)&&t!==r&&(n.strokeStyle=i,n.lineWidth=1,n.globalAlpha=.7,n.strokeRect(c+.5,h+.5,R-1,D-1),n.globalAlpha=1),t===r?(n.strokeStyle=o,n.lineWidth=2,n.strokeRect(c+1,h+1,R-2,D-2)):t!==j||a?.has(t)||(n.strokeStyle=o,n.lineWidth=1,n.globalAlpha=.5,n.strokeRect(c+.5,h+.5,R-1,D-1),n.globalAlpha=1);let u=t===r||a?.has(t);if(f&&u){let e=Math.max(3,Math.min(6,R/3)),t=c+R-e;n.fillStyle=o,n.beginPath(),n.moveTo(t+e,h),n.lineTo(t+e,h+e),n.lineTo(t,h+e),n.closePath(),n.fill(),n.strokeStyle=l,n.lineWidth=1,n.beginPath();let r=t+.65*e,a=h+.55*e;n.moveTo(r-.25*e,a),n.lineTo(r,a+.2*e),n.lineTo(r+.25*e,a-.2*e),n.stroke()}}))},[e,t,r,a,j,s,l,o,i,d,h,T,P,B,R,D,A,I,y,f]);let O=(0,L.useCallback)(t=>{if(!n)return;let r=b.current;if(!r)return;let a=r.getBoundingClientRect(),s=t.clientX-a.left,l=t.clientY-a.top,o=r.width/a.width,i=Math.floor(l*(r.height/a.height)/I)*T+Math.floor(s*o/A);i>=0&&i<e.length&&n(i)},[n,A,I,T,e.length]),F=(0,L.useCallback)(t=>{let r=b.current;if(!r)return;let a=r.getBoundingClientRect(),n=t.clientX-a.left,s=t.clientY-a.top,l=r.width/a.width,o=Math.floor(s*(r.height/a.height)/I)*T+Math.floor(n*l/A);o>=0&&o<e.length?C(o):C(null)},[A,I,T,e.length]),H=(0,L.useCallback)(()=>{C(null)},[]),$=(0,L.useCallback)((t,r)=>{let a=b.current;if(!a)return null;let n=a.getBoundingClientRect(),s=t-n.left,l=r-n.top,o=a.width/n.width,i=Math.floor(l*(a.height/n.height)/I)*T+Math.floor(s*o/A);return i>=0&&i<e.length?i:null},[A,I,T,e.length]),W=(0,L.useCallback)(()=>{N.current&&(clearTimeout(N.current),N.current=null)},[]),U=(0,L.useCallback)(e=>{if(1!==e.touches.length){W(),M.current={isActive:!1,hasMoved:!1,touchedIndices:new Set};return}let t=e.touches[0],r=$(t.clientX,t.clientY);null!==r&&(S.current=!1,k.current={x:t.clientX,y:t.clientY,time:Date.now(),index:r},M.current={isActive:f,hasMoved:!1,touchedIndices:new Set([r])},p&&(W(),N.current=setTimeout(()=>{S.current=!0,p(r)},500)))},[$,p,W,f]),V=(0,L.useCallback)(e=>{if(1!==e.touches.length||!k.current){W(),M.current={isActive:!1,hasMoved:!1,touchedIndices:new Set};return}let t=e.touches[0],r=Math.abs(t.clientX-k.current.x),a=Math.abs(t.clientY-k.current.y);(r>10||a>10)&&W();let n=M.current;if(n.isActive&&g){if(!n.hasMoved&&(r>=5||a>=5)){n.hasMoved=!0;let e=k.current.index;void 0!==e&&g(e)}if(n.hasMoved){let e=$(t.clientX,t.clientY);null===e||n.touchedIndices.has(e)||(n.touchedIndices.add(e),g(e))}}},[W,$,g]),_=(0,L.useCallback)(e=>{W();let t=M.current.hasMoved;if(M.current={isActive:!1,hasMoved:!1,touchedIndices:new Set},!k.current)return;let r=k.current;(k.current=null,S.current||t)?e.preventDefault():f&&g?(e.preventDefault(),g(r.index)):n&&n(r.index)},[f,g,n,W]),K=(0,L.useCallback)(e=>{S.current&&e.preventDefault()},[]),Y=(0,L.useCallback)(()=>{w(e=>!e)},[]);return(0,E.jsxs)("div",{className:`${m}`,ref:v,children:[u&&(0,E.jsxs)("button",{onClick:Y,className:"w-full flex items-center justify-between p-2 text-sm text-gray-300 hover:text-retro-cyan transition-colors",children:[(0,E.jsx)("span",{className:"font-medium",children:"Overview"}),(0,E.jsx)("svg",{className:`w-4 h-4 transition-transform ${y?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!y&&(0,E.jsx)("div",{className:`p-2 bg-black/30 rounded ${f?"ring-1 ring-retro-cyan/30":""}`,children:(0,E.jsx)("canvas",{ref:b,onClick:O,onMouseMove:F,onMouseLeave:H,onTouchStart:U,onTouchMove:V,onTouchEnd:_,onContextMenu:K,className:"cursor-pointer",style:{width:P,height:B,imageRendering:"pixelated",touchAction:"manipulation"}})})]})}function X({isVisible:e,selectionCount:t,totalItems:r,onSelectAll:a,onClearSelection:n,onExitMode:s,actions:l=[],fixed:o=!1,className:i=""}){return e?(0,E.jsxs)("div",{className:`
        ${o?"sticky":"absolute"} bottom-0 left-0 right-0
        bg-retro-navy/95 backdrop-blur-sm
        border-t border-retro-cyan/50
        px-3 py-2
        flex items-center justify-between gap-2
        animate-slide-up
        safe-bottom
        z-10
        ${i}
      `,role:"toolbar","aria-label":"Selection actions",children:[(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,E.jsx)("span",{className:"inline-flex items-center justify-center min-w-[1.5rem] h-6 px-1.5 rounded-full bg-retro-cyan/20 text-retro-cyan text-sm font-medium",children:t}),(0,E.jsx)("span",{className:"text-xs text-gray-400",children:"selected"})]}),(0,E.jsxs)("div",{className:"flex items-center gap-1 border-l border-retro-grid/30 pl-3",children:[(0,E.jsx)("button",{onClick:a,disabled:t>=r,className:"px-2 py-1 text-xs text-gray-400 hover:text-retro-cyan disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"All"}),(0,E.jsx)("button",{onClick:n,disabled:t<=1,className:"px-2 py-1 text-xs text-gray-400 hover:text-retro-pink disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"None"})]})]}),(0,E.jsx)("div",{className:"flex items-center gap-2",children:l.map(e=>(0,E.jsxs)("button",{onClick:e.onClick,disabled:e.disabled,className:`
              flex items-center gap-1.5 px-2.5 py-1.5 rounded text-xs font-medium
              transition-colors
              disabled:opacity-50 disabled:cursor-not-allowed
              ${"danger"===e.variant?"text-retro-pink hover:bg-retro-pink/20":"text-gray-300 hover:bg-retro-grid/30"}
            `,title:e.label,children:[e.icon&&(0,E.jsx)("span",{className:"w-4 h-4",children:e.icon}),(0,E.jsx)("span",{className:"hidden sm:inline",children:e.label})]},e.id))})]}):null}function Q({characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:n,onAddCharacter:s,onDeleteSelected:l,onSelectAll:o,onSelectNone:i,onContextMenu:c,showAddButton:d=!0,foregroundColor:h="#ffffff",backgroundColor:u="#000000",className:x=""}){let m=a.size+1,[f,p]=(0,L.useState)(!1),g=function({itemCount:e,selectedIndex:t,batchSelection:r,onSelect:a,onSelectionModeChange:n}){let[s,l]=(0,L.useState)(!1),o=r.size+1,i=(0,L.useMemo)(()=>{let e=new Set(r);return e.add(t),e},[t,r]),c=(0,L.useCallback)(e=>{l(!0),n?.(!0),void 0===e||e===t||r.has(e)||a(e,!1,!0)},[t,r,a,n]),d=(0,L.useCallback)(()=>{l(!1),n?.(!1),a(t,!1,!1)},[t,a,n]),h=(0,L.useCallback)(()=>{s?d():c()},[s,c,d]),u=(0,L.useCallback)(e=>{a(e,!1,!0)},[a]),x=(0,L.useCallback)(()=>{for(let n=0;n<e;n++)n===t||r.has(n)||a(n,!1,!0)},[e,t,r,a]),m=(0,L.useCallback)(()=>{a(t,!1,!1)},[t,a]),f=(0,L.useCallback)((e,t,r)=>{s?u(e):a(e,t,r)},[s,u,a]),p=(0,L.useCallback)(e=>{s||c(e)},[s,c]);return{isSelectionMode:s,enterSelectionMode:c,exitSelectionMode:d,toggleSelectionMode:h,toggleItem:u,selectAll:x,clearSelection:m,handleItemInteraction:f,handleLongPress:p,selectionCount:o,hasMultipleSelected:o>1,selectedIndices:i}}({itemCount:e.length,selectedIndex:r,batchSelection:a,onSelect:n}),b=(0,L.useCallback)(t=>{let a=e.length;if(0!==a)switch(t.key){case"ArrowUp":case"ArrowLeft":t.preventDefault(),n(r>0?r-1:a-1,t.shiftKey,t.metaKey||t.ctrlKey);break;case"ArrowDown":case"ArrowRight":t.preventDefault(),n(r<a-1?r+1:0,t.shiftKey,t.metaKey||t.ctrlKey);break;case"Delete":case"Backspace":t.preventDefault(),l?.();break;case"a":case"A":(t.ctrlKey||t.metaKey)&&t.preventDefault()}},[e.length,r,n,l]);return(0,E.jsxs)("div",{className:`flex flex-col relative ${x}`,onKeyDown:b,children:[(0,E.jsxs)("div",{className:"p-3 border-b border-retro-grid/30",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Characters"}),(0,E.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.length,")"]})]}),(0,E.jsxs)("button",{onClick:g.toggleSelectionMode,className:`flex items-center gap-1 px-2 py-1 rounded text-xs transition-colors ${g.isSelectionMode?"bg-retro-cyan/20 text-retro-cyan":"text-gray-400 hover:text-retro-cyan hover:bg-retro-cyan/10"}`,title:g.isSelectionMode?"Exit selection mode":"Enter selection mode",children:[g.isSelectionMode?(0,E.jsx)("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,E.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,E.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,E.jsx)("span",{className:"hidden sm:inline",children:"Select"})]})]}),m>1&&!g.isSelectionMode&&(0,E.jsxs)("div",{className:"mt-1 text-xs text-retro-pink",children:[m," characters selected"]})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"border-b border-retro-grid/30",children:(0,E.jsx)(G,{characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:e=>g.handleItemInteraction(e,!1,!1),foregroundColor:h,backgroundColor:u,maxWidth:200,pixelScale:1,collapsible:!0,defaultCollapsed:!1,isSelectionMode:g.isSelectionMode,onLongPress:g.handleLongPress,onToggleSelection:g.toggleItem})}),(0,E.jsxs)("div",{className:"border-b border-retro-grid/30",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,E.jsx)("span",{className:"font-medium text-sm text-gray-300",children:"Characters"}),(0,E.jsx)("button",{onClick:()=>p(!f),className:"p-1 text-gray-400 hover:text-retro-cyan transition-colors","aria-label":f?"Expand characters":"Collapse characters",children:(0,E.jsx)("svg",{className:`w-4 h-4 transition-transform ${f?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!f&&(0,E.jsx)("div",{className:"p-2 pb-14",children:(0,E.jsx)(Y.InteractiveCharacterGrid,{characters:e,config:t,selectedIndex:r,batchSelection:a,onSelect:g.handleItemInteraction,showAddButton:d&&!!s&&!g.isSelectionMode,onAdd:s,foregroundColor:h,backgroundColor:u,showIndices:!1,smallScale:2,minColumns:8,maxColumns:10,gap:4,onContextMenu:g.isSelectionMode?void 0:c,isSelectionMode:g.isSelectionMode,onLongPress:g.handleLongPress})})]})]}),(0,E.jsx)(X,{isVisible:g.isSelectionMode,selectionCount:g.selectionCount,totalItems:e.length,onSelectAll:g.selectAll,onClearSelection:g.clearSelection,onExitMode:g.exitSelectionMode,fixed:!0})]})}var J=e.i(58240);let q={0:{abbr:"NUL",name:"Null"},1:{abbr:"SOH",name:"Start of Heading"},2:{abbr:"STX",name:"Start of Text"},3:{abbr:"ETX",name:"End of Text"},4:{abbr:"EOT",name:"End of Transmission"},5:{abbr:"ENQ",name:"Enquiry"},6:{abbr:"ACK",name:"Acknowledgement"},7:{abbr:"BEL",name:"Bell"},8:{abbr:"BS",name:"Backspace"},9:{abbr:"HT",name:"Horizontal Tab"},10:{abbr:"LF",name:"Line Feed"},11:{abbr:"VT",name:"Vertical Tab"},12:{abbr:"FF",name:"Form Feed"},13:{abbr:"CR",name:"Carriage Return"},14:{abbr:"SO",name:"Shift Out"},15:{abbr:"SI",name:"Shift In"},16:{abbr:"DLE",name:"Data Link Escape"},17:{abbr:"DC1",name:"Device Control 1 (XON)"},18:{abbr:"DC2",name:"Device Control 2"},19:{abbr:"DC3",name:"Device Control 3 (XOFF)"},20:{abbr:"DC4",name:"Device Control 4"},21:{abbr:"NAK",name:"Negative Acknowledgement"},22:{abbr:"SYN",name:"Synchronous Idle"},23:{abbr:"ETB",name:"End of Transmission Block"},24:{abbr:"CAN",name:"Cancel"},25:{abbr:"EM",name:"End of Medium"},26:{abbr:"SUB",name:"Substitute"},27:{abbr:"ESC",name:"Escape"},28:{abbr:"FS",name:"File Separator"},29:{abbr:"GS",name:"Group Separator"},30:{abbr:"RS",name:"Record Separator"},31:{abbr:"US",name:"Unit Separator"},127:{abbr:"DEL",name:"Delete"}};function Z(e){return q[e]||null}function ee(e){return e>=32&&e<=126}function et({characterSetName:e,isBuiltIn:t=!1,isDirty:r,characterIndex:a,totalCharacters:n,batchMode:s=!1,zoom:l,minZoom:o=8,maxZoom:i=40,zoomStep:c=4,onZoomChange:d,onZoomToFit:h,colors:u,onColorsChange:x,onBack:m,className:f=""}){let p=ee(a),g=Z(a);return(0,E.jsxs)("div",{className:`flex items-center gap-4 px-4 py-2 bg-retro-navy/50 border-b border-retro-grid/50 ${f}`,children:[(0,E.jsxs)("button",{onClick:m,className:"flex items-center gap-1 text-xs text-gray-400 hover:text-retro-cyan transition-colors whitespace-nowrap",children:[(0,E.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,E.jsx)("span",{className:"hidden sm:inline",children:"Back"})]}),(0,E.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,E.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-300 min-w-0",children:[(0,E.jsx)("span",{className:"truncate max-w-[150px] sm:max-w-[200px]",title:e,children:e}),t&&(0,E.jsx)("span",{className:"flex-shrink-0 text-xs px-2 py-0.5 rounded bg-retro-amber/20 text-retro-amber border border-retro-amber/30",title:"Built-in character sets are read-only. Use 'Save As' to create an editable copy.",children:"Read-only"}),r&&(0,E.jsxs)("span",{className:"flex items-center gap-1.5 flex-shrink-0",title:"Unsaved changes",children:[(0,E.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,E.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-retro-pink opacity-75"}),(0,E.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-retro-pink"})]}),(0,E.jsx)("span",{className:"hidden sm:inline text-xs text-retro-pink font-medium",children:"Unsaved"})]})]}),(0,E.jsx)("div",{className:"w-px h-4 bg-retro-grid/50 hidden sm:block"}),(0,E.jsxs)("div",{className:"hidden sm:flex items-center gap-2 text-sm text-gray-400",children:[(0,E.jsxs)("span",{className:"whitespace-nowrap",children:["Char ",(0,E.jsx)("span",{className:"text-retro-cyan",children:a}),(0,E.jsxs)("span",{className:"text-gray-500",children:["/",n]})]}),p&&(0,E.jsxs)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-cyan rounded text-xs font-mono",title:"Printable ASCII Character",children:["'",String.fromCharCode(a),"'"]}),g&&(0,E.jsxs)("span",{className:"px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",children:[g.abbr," (",g.name,")"]}),s&&(0,E.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",children:"Batch"})]}),(0,E.jsx)("div",{className:"flex-1"}),(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)(z.Tooltip,{content:"Zoom out",shortcut:"-",children:(0,E.jsx)("button",{onClick:()=>{l>o&&d(Math.max(l-c,o))},disabled:l<=o,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",children:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})}),(0,E.jsxs)("span",{className:"text-xs text-gray-500 w-10 text-center",children:[l,"x"]}),(0,E.jsx)(z.Tooltip,{content:"Zoom in",shortcut:"+",children:(0,E.jsx)("button",{onClick:()=>{l<i&&d(Math.min(l+c,i))},disabled:l>=i,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",children:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}),(0,E.jsx)(z.Tooltip,{content:"Zoom to fit",shortcut:"0",children:(0,E.jsx)("button",{onClick:h,className:"p-1 text-gray-400 hover:text-white ml-1",children:(0,E.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4h4"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 4h4v4"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v4h4"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 16v4h-4"}),(0,E.jsx)("rect",{x:"8",y:"8",width:"8",height:"8",strokeWidth:2,rx:"1"})]})})})]}),(0,E.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,E.jsx)(J.ColorPresetSelector,{colors:u,onColorsChange:x})]})}function er({hoverCoords:e,className:t=""}){return(0,E.jsxs)("div",{className:`flex-shrink-0 flex items-center px-4 py-1.5 bg-retro-navy/50 border-t border-retro-grid/50 ${t}`,children:[(0,E.jsx)("div",{className:"w-24 flex-shrink-0"}),(0,E.jsx)("div",{className:"flex-1 flex justify-center",children:(0,E.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-x-4 gap-y-1 text-[10px] text-gray-500",children:[{keys:"Arrow keys",action:"Navigate"},{keys:"Click",action:"Select"},{keys:"Shift+Click",action:"Multi-select"},{keys:"Del",action:"Delete"},{keys:"Ctrl+S",action:"Save"},{keys:"Ctrl+Z/Y",action:"Undo/Redo"},{keys:"?",action:"Help"}].map(({keys:e,action:t},r)=>(0,E.jsxs)("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[(0,E.jsx)("span",{className:"text-gray-400",children:e}),(0,E.jsxs)("span",{className:"hidden sm:inline",children:[": ",t]})]},r))})}),(0,E.jsx)("div",{className:"w-24 flex-shrink-0 flex justify-end",children:e&&(0,E.jsxs)("div",{className:"hidden sm:flex items-center gap-1 text-[10px] text-gray-500 font-mono",children:[(0,E.jsx)("span",{className:"text-gray-400",children:"Pixel:"}),(0,E.jsxs)("span",{className:"text-retro-cyan",children:["(",e.x,", ",e.y,")"]})]})})]})}var ea=e.i(20371);let en={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};function es(e,t){return t||(e?en[e]:"w-5 h-5")}function el({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}function eo({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}function ei({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}function ec({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function ed({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function eh({className:e,size:t,style:r,...a}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{transform:"scaleX(-1)",...r},...a,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function eu({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h8M8 12h8m-8 5h8M4 3v18m16-18v18"})})}function ex({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8v8M12 8v8m5-8v8M3 4h18M3 20h18"})})}function em({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4l4 4m0-4H4v4m16-4l-4 4m4 0V4h-4m-12 16l4-4m-4 0v4h4m12 0l-4-4m4 0v4h-4"})})}function ef({className:e,size:t,...r}){return(0,E.jsxs)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:[(0,E.jsx)("circle",{cx:"12",cy:"12",r:"3",strokeWidth:2}),(0,E.jsx)("path",{strokeLinecap:"round",strokeWidth:2,d:"M12 2v4m0 12v4M2 12h4m12 0h4"})]})}function ep({className:e,size:t,...r}){return(0,E.jsxs)("svg",{className:es(t,e),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",...r,children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 17l3.5-10h3L17 17M8.5 13h7"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 4v4m-2-2h4"})]})}function eg({className:e,size:t,...r}){return(0,E.jsxs)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2"}),(0,E.jsx)("rect",{x:"10",y:"10",width:"10",height:"10",rx:"1",strokeWidth:2}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M20 4v3m-1.5-1.5h3"})]})}function eb({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}function ev({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"1",strokeWidth:2})})}function ey({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),viewBox:"0 0 24 24",...r,children:(0,E.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"1",fill:"currentColor"})})}function ew({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}function ej({className:e,size:t,...r}){return(0,E.jsx)("svg",{className:es(t,e),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",...r,children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}function eC({pixels:e,label:t,foregroundColor:r="#ffffff",backgroundColor:a="#000000"}){let n=e.length,s=e[0]?.length||0;return(0,E.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,E.jsx)("span",{className:"text-[9px] text-gray-400 uppercase",children:t}),(0,E.jsx)("div",{className:"border border-gray-600",style:{width:3*s,height:3*n,display:"grid",gridTemplateColumns:`repeat(${s}, 3px)`,gridTemplateRows:`repeat(${n}, 3px)`},children:e.flat().map((e,t)=>(0,E.jsx)("div",{style:{backgroundColor:e?r:a,width:3,height:3}},t))})]})}function ek({before:e,after:t,label:r,shortcut:a}){return(0,E.jsxs)("div",{className:"flex flex-col gap-1.5 p-1",children:[(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)("span",{className:"text-xs font-medium",children:r}),a&&(0,E.jsx)("span",{className:"text-gray-400 font-mono text-[10px] bg-gray-700/50 px-1.5 py-0.5 rounded",children:a})]}),(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)(eC,{pixels:e,label:"Before"}),(0,E.jsx)("span",{className:"text-gray-500",children:"â†’"}),(0,E.jsx)(eC,{pixels:t,label:"After"})]})]})}function eN({onClick:e,disabled:t,tooltip:r,shortcut:a,previewContent:n,children:s,className:l=""}){return(0,E.jsx)(z.Tooltip,{content:n||r,shortcut:n?void 0:a,position:"left",children:(0,E.jsx)("button",{onClick:e,disabled:t,className:`
          p-2.5 rounded transition-colors touch-target
          ${t?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-retro-cyan hover:bg-retro-purple/30"}
          ${l}
        `,children:s})})}function eS(){return(0,E.jsx)("div",{className:"w-full h-px bg-retro-grid/30 my-1"})}function eM({id:e,label:t,isExpanded:r,onToggle:a,children:n}){return(0,E.jsxs)("div",{className:"w-full",children:[(0,E.jsxs)("button",{onClick:()=>a(e),className:"w-full flex items-center justify-between px-1 py-0.5 text-[10px] font-medium text-gray-500 hover:text-gray-300 transition-colors","aria-expanded":r,"aria-controls":`toolbar-section-${e}`,children:[(0,E.jsx)("span",{children:t}),(0,E.jsx)("svg",{className:`w-3 h-3 transition-transform duration-200 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,E.jsx)("div",{id:`toolbar-section-${e}`,className:`overflow-hidden transition-all duration-200 ease-in-out ${r?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:(0,E.jsx)("div",{className:"py-1",children:n})})]})}function eE({character:e,characterWidth:t=8,characterHeight:r=8,onShift:a,onRotate:n,onFlipHorizontal:s,onFlipVertical:l,onInvert:o,onClear:i,onFill:c,onCenter:d,onScale:h,onDelete:u,onCopy:x,onAdd:m,onDuplicate:f,onImport:p,disabled:g=!1,className:b=""}){let[v,y]=(0,L.useState)(new Set(["shift","rotate","flip"])),w=(0,L.useCallback)(e=>{y(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),j=(0,L.useCallback)(()=>a("up"),[a]),C=(0,L.useCallback)(()=>a("down"),[a]),k=(0,L.useCallback)(()=>a("left"),[a]),N=(0,L.useCallback)(()=>a("right"),[a]),S=(0,L.useCallback)(()=>n("left"),[n]),M=(0,L.useCallback)(()=>n("right"),[n]),R=(0,L.useMemo)(()=>{if(!e)return null;let a=e.pixels;return{shiftUp:(0,E.jsx)(ek,{before:a,after:(0,ea.shiftCharacter)(e,"up").pixels,label:"Shift Up",shortcut:"W"}),shiftDown:(0,E.jsx)(ek,{before:a,after:(0,ea.shiftCharacter)(e,"down").pixels,label:"Shift Down",shortcut:"S"}),shiftLeft:(0,E.jsx)(ek,{before:a,after:(0,ea.shiftCharacter)(e,"left").pixels,label:"Shift Left",shortcut:"A"}),shiftRight:(0,E.jsx)(ek,{before:a,after:(0,ea.shiftCharacter)(e,"right").pixels,label:"Shift Right",shortcut:"D"}),rotateLeft:(0,E.jsx)(ek,{before:a,after:(0,ea.rotateCharacter)(e,"left").pixels,label:"Rotate Left",shortcut:"Shift+R"}),rotateRight:(0,E.jsx)(ek,{before:a,after:(0,ea.rotateCharacter)(e,"right").pixels,label:"Rotate Right",shortcut:"R"}),flipHorizontal:(0,E.jsx)(ek,{before:a,after:(0,ea.flipHorizontal)(e).pixels,label:"Flip Horizontal",shortcut:"H"}),flipVertical:(0,E.jsx)(ek,{before:a,after:(0,ea.flipVertical)(e).pixels,label:"Flip Vertical",shortcut:"V"}),invert:(0,E.jsx)(ek,{before:a,after:(0,ea.invertCharacter)(e).pixels,label:"Invert Colors",shortcut:"I"}),center:(0,E.jsx)(ek,{before:a,after:(0,ea.centerCharacter)(e).pixels,label:"Center Content"}),clear:(0,E.jsx)(ek,{before:a,after:(0,ea.clearCharacter)(t,r).pixels,label:"Clear"}),fill:(0,E.jsx)(ek,{before:a,after:(0,ea.fillCharacter)(t,r).pixels,label:"Fill"})}},[e,t,r]);return(0,E.jsxs)("div",{className:`
        flex flex-col items-center py-1 px-2 bg-retro-navy/50 border-l border-retro-grid/30 overflow-y-auto
        ${b}
      `,role:"toolbar","aria-label":"Character transform tools",children:[(0,E.jsx)(eM,{id:"shift",label:"Shift",isExpanded:v.has("shift"),onToggle:w,children:(0,E.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,E.jsx)(eN,{onClick:j,disabled:g,tooltip:"Shift Up",shortcut:"W",previewContent:R?.shiftUp,children:(0,E.jsx)(el,{})}),(0,E.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,E.jsx)(eN,{onClick:k,disabled:g,tooltip:"Shift Left",shortcut:"A",previewContent:R?.shiftLeft,children:(0,E.jsx)(ei,{})}),(0,E.jsx)(eN,{onClick:()=>d?.(),disabled:g||!d,tooltip:"Center Content",previewContent:R?.center,children:(0,E.jsx)(ef,{})}),(0,E.jsx)(eN,{onClick:N,disabled:g,tooltip:"Shift Right",shortcut:"D",previewContent:R?.shiftRight,children:(0,E.jsx)(ec,{})})]}),(0,E.jsx)(eN,{onClick:C,disabled:g,tooltip:"Shift Down",shortcut:"S",previewContent:R?.shiftDown,children:(0,E.jsx)(eo,{})})]})}),(0,E.jsx)(eS,{}),(0,E.jsx)(eM,{id:"rotate",label:"Rotate",isExpanded:v.has("rotate"),onToggle:w,children:(0,E.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,E.jsx)(eN,{onClick:S,disabled:g,tooltip:"Rotate Left",shortcut:"Shift+R",previewContent:R?.rotateLeft,children:(0,E.jsx)(ed,{})}),(0,E.jsx)(eN,{onClick:M,disabled:g,tooltip:"Rotate Right",shortcut:"R",previewContent:R?.rotateRight,children:(0,E.jsx)(eh,{})})]})}),(0,E.jsx)(eS,{}),(0,E.jsx)(eM,{id:"flip",label:"Flip",isExpanded:v.has("flip"),onToggle:w,children:(0,E.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,E.jsx)(eN,{onClick:s,disabled:g,tooltip:"Flip Horizontal",shortcut:"H",previewContent:R?.flipHorizontal,children:(0,E.jsx)(eu,{})}),(0,E.jsx)(eN,{onClick:l,disabled:g,tooltip:"Flip Vertical",shortcut:"V",previewContent:R?.flipVertical,children:(0,E.jsx)(ex,{})})]})}),(0,E.jsx)(eS,{}),(0,E.jsx)(eM,{id:"modify",label:"Modify",isExpanded:v.has("modify"),onToggle:w,children:(0,E.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,E.jsx)("div",{className:"flex items-center gap-1",children:(0,E.jsx)(eN,{onClick:o,disabled:g,tooltip:"Invert Colors",shortcut:"I",previewContent:R?.invert,children:(0,E.jsx)(ew,{})})}),(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)(eN,{onClick:i,disabled:g,tooltip:"Clear",previewContent:R?.clear,children:(0,E.jsx)(ev,{})}),(0,E.jsx)(eN,{onClick:c,disabled:g,tooltip:"Fill",previewContent:R?.fill,children:(0,E.jsx)(ey,{})})]}),(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)(eN,{onClick:h,disabled:g,tooltip:"Scale Character",children:(0,E.jsx)(em,{})}),(0,E.jsx)(eN,{onClick:x,disabled:g,tooltip:"Copy from character set",shortcut:"C",children:(0,E.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,E.jsx)("rect",{x:"3",y:"3",width:"4",height:"4",strokeWidth:1.5}),(0,E.jsx)("rect",{x:"8",y:"3",width:"4",height:"4",strokeWidth:1.5}),(0,E.jsx)("rect",{x:"3",y:"8",width:"4",height:"4",strokeWidth:1.5}),(0,E.jsx)("rect",{x:"8",y:"8",width:"4",height:"4",strokeWidth:1.5}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10h6m0 0l-3-3m3 3l-3 3"}),(0,E.jsx)("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1",strokeWidth:2})]})})]})]})}),(0,E.jsx)(eS,{}),(0,E.jsx)(eM,{id:"char",label:"Char",isExpanded:v.has("char"),onToggle:w,children:(0,E.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)(eN,{onClick:m,disabled:g,tooltip:"Add new character",shortcut:"Ctrl+N",children:(0,E.jsx)(ep,{})}),(0,E.jsx)(eN,{onClick:f,disabled:g,tooltip:"Duplicate selected characters",shortcut:"Ctrl+D",children:(0,E.jsx)(eg,{})})]}),(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)(eN,{onClick:p,disabled:g,tooltip:"Import characters from another set",shortcut:"Ctrl+I",children:(0,E.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 20l2.5-7h3L16 20M9.25 16h5.5"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v8m0 0l-3-3m3 3l3-3"})]})}),(0,E.jsx)(eN,{onClick:u,disabled:g,tooltip:"Delete character",shortcut:"Del",className:"hover:text-red-400",children:(0,E.jsx)(eb,{})})]})]})})]})}function eL({history:e,currentIndex:t,onJump:r,canRedo:a=!1,totalEntries:n,onClear:s}){let l=(0,L.useRef)(null),o=(0,L.useRef)(!1),[i,c]=(0,L.useState)(!1),[d,h]=(0,L.useState)(null),[u,x]=(0,L.useState)(0),m=n??e.length,f=m-1,p=(0,L.useCallback)(e=>0===f?50:e/f*100,[f]),g=(0,L.useCallback)(e=>{if(!l.current||0===f)return 0;let t=l.current.getBoundingClientRect(),r=Math.round((e-t.left)/t.width*f);return Math.max(0,Math.min(f,r))},[f]),b=(0,L.useRef)(r),v=(0,L.useRef)(g);(0,L.useEffect)(()=>{b.current=r,v.current=g},[r,g]),(0,L.useEffect)(()=>{let e=e=>{if(!o.current)return;let t=v.current(e.clientX);b.current(t)},t=()=>{o.current&&(o.current=!1,c(!1))};return window.addEventListener("pointermove",e),window.addEventListener("pointerup",t),window.addEventListener("pointercancel",t),()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",t),window.removeEventListener("pointercancel",t)}},[]);let y=(0,L.useCallback)(e=>{e.preventDefault(),o.current=!0,c(!0),r(g(e.clientX))},[g,r]),w=(0,L.useCallback)(e=>{if(!o.current&&(h(g(e.clientX)),l.current)){let t=l.current.getBoundingClientRect();x(e.clientX-t.left)}},[g]),j=(0,L.useCallback)(()=>{h(null)},[]),C=(0,L.useCallback)(t=>t<0||t>=e.length?null:e[t]?.label||`State ${t}`,[e]),k=(0,L.useCallback)(e=>{"ArrowLeft"===e.key&&t>0?(e.preventDefault(),r(t-1)):"ArrowRight"===e.key&&t<f?(e.preventDefault(),r(t+1)):"Home"===e.key?(e.preventDefault(),r(0)):"End"===e.key&&(e.preventDefault(),r(f))},[t,f,r]);if(e.length<=1&&!a)return(0,E.jsx)("div",{className:"h-10 flex-shrink-0 bg-retro-navy/50 border-t border-retro-grid/30 flex items-center justify-center",children:(0,E.jsx)("span",{className:"text-[10px] text-gray-500",children:"No history yet"})});let N=p(t),S=null!==d?C(d):null,M=C(t);return(0,E.jsxs)("div",{className:"h-10 flex-shrink-0 bg-retro-navy/50 border-t border-retro-grid/30 flex items-center px-4 gap-3",children:[(0,E.jsxs)("div",{className:"text-[10px] text-gray-400 w-12 flex-shrink-0 font-mono",children:[t+1,"/",m]}),(0,E.jsxs)("div",{ref:l,className:"flex-1 h-6 relative cursor-pointer select-none",style:{touchAction:"none"},onPointerDown:y,onPointerMove:w,onPointerLeave:j,onKeyDown:k,tabIndex:0,role:"slider","aria-valuemin":0,"aria-valuemax":f,"aria-valuenow":t,"aria-label":"History timeline",children:[(0,E.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 right-0 h-1 bg-retro-grid/30 rounded-full"}),(0,E.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 h-1 bg-retro-cyan/50 rounded-full transition-[width] duration-75",style:{width:`${N}%`}}),e.map((e,r)=>{let a=p(r),n=r===t,s=r<t,l=r>t;return(0,E.jsx)("div",{className:`absolute top-1/2 -translate-y-1/2 w-1 h-3 rounded-full transition-all duration-75 ${n?"bg-retro-cyan":s?"bg-retro-cyan/40":l?"bg-retro-pink/40":"bg-retro-grid/40"}`,style:{left:`${a}%`,transform:"translateX(-50%) translateY(-50%)"}},r)}),(0,E.jsx)("div",{className:`absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 transition-all duration-75 ${i?"bg-retro-cyan border-white scale-110":"bg-retro-navy border-retro-cyan hover:bg-retro-cyan/20"}`,style:{left:`${N}%`,transform:"translateX(-50%) translateY(-50%)"}}),S&&!i&&(0,E.jsx)("div",{className:"absolute bottom-full mb-2 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-[10px] text-white whitespace-nowrap pointer-events-none z-10",style:{left:u,transform:"translateX(-50%)"},children:S})]}),(0,E.jsx)("div",{className:"text-[10px] text-gray-400 w-32 flex-shrink-0 truncate text-right",title:M||void 0,children:M||"â€”"}),s&&e.length>1&&(0,E.jsx)("button",{type:"button",onClick:s,className:"flex-shrink-0 p-1 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded transition-colors",title:"Clear history","aria-label":"Clear history",children:(0,E.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,E.jsx)("path",{d:"M3 6h18"}),(0,E.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,E.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),(0,E.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,E.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})]})}function eR({x:e,y:t,items:r,onClose:a}){let n=(0,L.useRef)(null);(0,L.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a()},t=e=>{n.current&&!n.current.contains(e.target)&&a()};return document.addEventListener("keydown",e),document.addEventListener("mousedown",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",t)}},[a]),(0,L.useEffect)(()=>{if(!n.current)return;let e=n.current.getBoundingClientRect(),t=window.innerWidth,r=window.innerHeight;e.right>t-8&&(n.current.style.left=`${t-e.width-8}px`),e.bottom>r-8&&(n.current.style.top=`${r-e.height-8}px`)},[e,t]);let s=(0,L.useCallback)(e=>{e.disabled||(e.onClick(),a())},[a]);return(0,E.jsx)("div",{ref:n,className:"fixed z-[100] min-w-[160px] py-1 bg-retro-navy/95 backdrop-blur-sm border border-retro-grid/50 rounded-lg shadow-xl",style:{left:e,top:t},children:r.map((e,t)=>e.divider?(0,E.jsx)("div",{className:"h-px bg-retro-grid/30 my-1"},t):(0,E.jsxs)("button",{onClick:()=>s(e),disabled:e.disabled,className:`
              w-full px-3 py-1.5 text-left text-sm flex items-center justify-between gap-4
              transition-colors
              ${e.disabled?"text-gray-600 cursor-not-allowed":e.danger?"text-red-400 hover:bg-red-500/20":"text-gray-200 hover:bg-retro-cyan/20 hover:text-retro-cyan"}
            `,children:[(0,E.jsx)("span",{children:e.label}),e.shortcut&&(0,E.jsx)("span",{className:"text-[10px] text-gray-500 font-mono",children:e.shortcut})]},t))})}function eD({isOpen:e,onClose:t,shortcuts:r}){if((0,L.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&(e.preventDefault(),t())};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e,t]),(0,L.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;let a=r.reduce((e,t)=>{let r=t.context||"General";return e[r]||(e[r]=[]),e[r].push(t),e},{}),n=["Editor","Sidebar","Global"],s=Object.keys(a).sort((e,t)=>{let r=n.indexOf(e),a=n.indexOf(t);return -1===r&&-1===a?e.localeCompare(t):-1===r?1:-1===a?-1:r-a});return(0,E.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,E.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,E.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-retro-grid/30",children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Keyboard Shortcuts"}),(0,E.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,E.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,E.jsx)("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-6",children:s.map(e=>(0,E.jsxs)("div",{children:[(0,E.jsx)("h3",{className:"text-sm font-medium text-retro-cyan mb-2",children:e}),(0,E.jsx)("div",{className:"space-y-1",children:a[e].map((t,r)=>{let a,n,s;return(0,E.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-retro-purple/10",children:[(0,E.jsx)("span",{className:"text-sm text-gray-300",children:t.description}),(0,E.jsx)("kbd",{className:"px-2 py-0.5 text-xs font-mono bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:(a=[],n="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),t.ctrl&&a.push(n?"âŒ˜":"Ctrl"),t.alt&&a.push(n?"âŒ¥":"Alt"),t.shift&&a.push(n?"â‡§":"Shift"),a.push(s=" "===(s=t.key)?"Space":"ArrowUp"===s?"â†‘":"ArrowDown"===s?"â†“":"ArrowLeft"===s?"â†":"ArrowRight"===s?"â†’":"Escape"===s?"Esc":"Delete"===s?"Del":"Backspace"===s?"âŒ«":s.toUpperCase()),a.join(n?"":"+"))})]},`${e}-${r}`)})})]},e))}),(0,E.jsx)("div",{className:"px-4 py-3 border-t border-retro-grid/30 text-center",children:(0,E.jsxs)("span",{className:"text-xs text-gray-500",children:["Press ",(0,E.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"Esc"})," or ",(0,E.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"?"})," to close"]})})]})]})}var eA=e.i(32098),eI=e.i(38749);let eT=[{id:"drawing",title:"Drawing Tools",icon:"pencil",description:"Master the pixel editing canvas",defaultExpanded:!0,tips:[{id:"click-toggle",title:"Click to Toggle Pixels",description:"Click any pixel on the canvas to toggle it between foreground and background colors. This is the most basic drawing operation - simple clicks let you place individual pixels with precision."},{id:"drag-paint",title:"Drag to Paint",description:"Hold the mouse button and drag across the canvas to paint multiple pixels in a single stroke. Great for drawing lines, curves, and filling in larger areas quickly. The paint operation continues as long as you hold the button."},{id:"right-click-erase",title:"Right-Click to Erase",description:"Right-click and drag to erase pixels (set them to background color) without switching tools. This two-button approach lets you quickly alternate between drawing and erasing without any mode changes."},{id:"zoom-controls",title:"Zoom for Precision",description:"Use the zoom slider in the header or scroll your mouse wheel over the canvas to zoom in and out. Higher zoom levels are great for detailed pixel work, while zoomed out gives you a better view of the overall character shape."},{id:"grid-visibility",title:"Adaptive Grid",description:"The pixel grid automatically adjusts its visibility based on your zoom level. At lower zoom levels, the grid fades to give you a cleaner view of the character. Zoom in to see individual pixel boundaries clearly."},{id:"color-presets",title:"Color Presets",description:"Choose from various color presets in the header to change the foreground and background colors. Different color schemes can help you visualize how your characters will look on different systems - from classic green phosphor to amber CRT to modern high-contrast displays."}]},{id:"navigation",title:"Character Navigation",icon:"navigation",description:"Navigate through your character set efficiently",tips:[{id:"arrow-keys",title:"Arrow Key Navigation",description:"Use the Left and Right arrow keys to move between characters in your set. Navigation wraps around - pressing Right on the last character takes you to the first, and Left on the first takes you to the last.",shortcut:"Left/Right"},{id:"page-navigation",title:"Page Navigation",description:"Press Page Up or Page Down to jump 16 characters at a time. This is perfect for quickly navigating through large character sets, especially when looking for specific character ranges like uppercase letters, lowercase, or symbols.",shortcut:"PageUp/PageDown"},{id:"home-end",title:"Jump to Start or End",description:"Press Home to instantly jump to the first character (index 0), or End to jump to the last character in your set. Useful when you need to quickly get to the beginning or end of your character set.",shortcut:"Home/End"},{id:"go-to-dialog",title:"Go To Character",description:"Press G to open the Go To dialog where you can enter a specific character index (0-255) or hexadecimal value (00-FF) to jump directly to that character. You can also enter an ASCII character to find its position.",shortcut:"G"},{id:"ascii-map",title:"ASCII Map View",description:"Press M to open the ASCII Map - a complete grid showing all characters with their decimal and hex codes. Click any character in the map to select it for editing. Great for finding specific characters or getting an overview of your entire set.",shortcut:"M"},{id:"sidebar-click",title:"Sidebar Character Grid",description:"The sidebar shows a scrollable grid of all characters in your set. Click any character thumbnail to immediately select and edit it. The current character is highlighted, and the sidebar scrolls to keep your selection visible."}]},{id:"transform",title:"Transform Tools",icon:"transform",description:"Rotate, flip, shift, and modify characters",tips:[{id:"rotate",title:"Rotate Characters",description:"Press [ (left bracket) to rotate the character 90 degrees counter-clockwise, or ] (right bracket) to rotate clockwise. Multiple rotations let you orient characters in any direction. Works on selected characters in batch mode too.",shortcut:"[ / ]"},{id:"flip",title:"Flip Operations",description:"Press H to flip horizontally (mirror left-to-right) or V to flip vertically (mirror top-to-bottom). Flipping is perfect for creating mirrored versions of characters or fixing orientation issues.",shortcut:"H / V"},{id:"shift-pixels",title:"Shift Pixels",description:"Use Shift + Arrow keys to move all pixels in the character one position in that direction. Pixels that move off one edge wrap around to the opposite edge. Great for repositioning characters within their grid.",shortcut:"Shift+Arrows"},{id:"invert",title:"Invert Colors",description:"Press I to invert all pixels in the character - foreground becomes background and vice versa. This creates an inverse video effect, useful for highlighted or selected-state characters.",shortcut:"I"},{id:"clear-fill",title:"Clear and Fill",description:"The transform toolbar on the right side has Clear (empties all pixels) and Fill (sets all pixels) buttons. Clear is useful for starting fresh, while Fill creates a solid block character."},{id:"center",title:"Center Character",description:"The Center button automatically repositions your character to be centered within the grid. Useful after importing or when pixels have drifted to one side. Found in the transform toolbar."},{id:"scale",title:"Scale Characters",description:"Scale your character up or down using different algorithms. Nearest neighbor preserves hard pixel edges (best for pixel art), while bilinear smoothing creates anti-aliased results. Access via the toolbar."}]},{id:"selection",title:"Batch Selection",icon:"layers",description:"Select and modify multiple characters at once",tips:[{id:"ctrl-select",title:"Multi-Select with Ctrl",description:"Hold Ctrl (or Cmd on Mac) and click characters in the sidebar to add them to your selection. Each click toggles that character's selection state. Build up a selection of non-contiguous characters for batch operations.",shortcut:"Ctrl+Click"},{id:"shift-range",title:"Range Select with Shift",description:"Click a character, then Shift+click another to select all characters between them (inclusive). This is the fastest way to select a contiguous range like all uppercase letters or all digits.",shortcut:"Shift+Click"},{id:"select-all",title:"Select All Characters",description:"Press Ctrl+A (or Cmd+A on Mac) to select every character in your set. Useful when you want to apply a transform to the entire character set at once.",shortcut:"Ctrl+A"},{id:"batch-transforms",title:"Batch Transforms",description:"When multiple characters are selected, all transform operations (rotate, flip, invert, shift, etc.) apply to every selected character simultaneously. This lets you maintain consistency across related characters."},{id:"long-press",title:"Long-Press Selection (Touch)",description:"On touch devices, long-press (hold for about 500ms) on any character to enter selection mode. Once in selection mode, tap characters to toggle their selection. A floating action bar appears with batch operations."},{id:"selection-bar",title:"Selection Mode Bar",description:"When multiple characters are selected, a floating bar appears showing the selection count and quick action buttons. Use it to apply transforms, copy, delete, or clear your selection. Press Escape to exit selection mode."},{id:"drag-select",title:"Drag to Select",description:"In selection mode, drag across the character grid to select multiple characters in one motion. This rubber-band selection works like selecting files in a file manager - fast and intuitive."}]},{id:"shortcuts",title:"Keyboard Shortcuts",icon:"keyboard",description:"Speed up your workflow with keyboard shortcuts",tips:[{id:"help-dialog",title:"View All Shortcuts",description:"Press ? (question mark) at any time to open the complete keyboard shortcuts reference. This modal shows all available shortcuts organized by context - editor, sidebar, and global shortcuts.",shortcut:"?"},{id:"undo-redo",title:"Undo and Redo",description:"Press Ctrl+Z to undo your last action, or Ctrl+Y (or Ctrl+Shift+Z) to redo. The editor maintains a full history of your changes with descriptions, so you can step back through your entire editing session.",shortcut:"Ctrl+Z / Ctrl+Y"},{id:"save-shortcuts",title:"Save Shortcuts",description:"Press Ctrl+S to save your current character set. Use Ctrl+Alt+S to open the Save As dialog for creating a copy with a new name. Your work is also auto-saved periodically.",shortcut:"Ctrl+S"},{id:"quick-actions",title:"Single-Key Actions",description:"Many common actions have single-key shortcuts: I (invert), N (notes), T (text preview), E (export), G (go to), M (ASCII map). These work when focus is on the editor canvas."},{id:"escape-key",title:"Escape to Cancel",description:"Press Escape to close any open modal, exit selection mode, or cancel the current operation. It's the universal 'cancel' action throughout the editor.",shortcut:"Escape"}]},{id:"overlay",title:"Overlays & Comparison",icon:"overlay",description:"Compare and trace from other character sets",tips:[{id:"overlay-feature",title:"Character Set Overlay",description:"Load another character set as a transparent overlay on your canvas for tracing or comparison. Click the Overlay button in the toolbar to select a reference set. The overlay appears semi-transparent so you can see both your work and the reference."},{id:"overlay-modes",title:"Three Overlay Modes",description:"Choose between overlay modes: '1:1 Pixels' shows the reference at exact pixel scale (best for same-size sets), 'Stretch' scales the reference to fit your canvas, and 'Side by Side' shows both characters next to each other for direct comparison."},{id:"similar-sets",title:"Find Similar Sets",description:"Click the 'Similar' button in the toolbar to find character sets with similar dimensions to your current set. This helps you find compatible sets for overlay comparison or to use as references."},{id:"toggle-overlay",title:"Quick Toggle",description:"Once an overlay is configured, click the Overlay button again to quickly toggle it on and off. The overlay settings are preserved, so you can easily switch between reference view and clean editing."}]},{id:"saving",title:"Saving & History",icon:"save",description:"Save your work and navigate history",tips:[{id:"autosave",title:"Auto-Save Recovery",description:"The editor automatically saves your work in progress. If your browser closes unexpectedly or you navigate away, you'll be prompted to recover your unsaved changes when you return. Your work is never lost."},{id:"snapshots",title:"Named Snapshots",description:"Save named snapshots of your character set at any point. Unlike undo history, snapshots persist across sessions and can be given descriptive names. Restore a full snapshot or selectively restore just specific characters."},{id:"history-timeline",title:"Visual History",description:"The undo/redo system tracks all your changes with timestamps and descriptions. Each action is recorded so you can step back through your entire editing session and see exactly what changed at each step."},{id:"builtin-readonly",title:"Built-In Sets are Read-Only",description:"Built-in character sets (like C64, Apple II, etc.) are read-only to preserve the originals. To modify them, use 'Save As' to create your own editable copy. Your copy will appear in your library alongside the built-ins."},{id:"notes",title:"Character Set Notes",description:"Press N to add notes and annotations to any character set. Notes are saved with your set and can include information about the design, intended use, or any other details you want to remember.",shortcut:"N"}]},{id:"export",title:"Import & Export",icon:"export",description:"Import from and export to various formats",tips:[{id:"export-formats",title:"Multiple Export Formats",description:"Export your character set as: binary ROM files (ready to burn), C header files, assembly source, PNG images of individual characters or the full set, and printable PDF reference sheets. Each format is optimized for its use case.",shortcut:"E"},{id:"import-sources",title:"Import From Many Sources",description:"Import characters from: ROM binary files, PNG grid images (auto-detects character boundaries), font files (TTF, OTF, WOFF), or paste C/assembly code directly. The import wizard guides you through each format."},{id:"share-links",title:"Shareable Links",description:"Generate a shareable URL that encodes your entire character set. Recipients can open the link to view and import your characters directly - no file downloads needed. Great for sharing on forums or social media."},{id:"text-preview",title:"Text Preview",description:"Press T to open the text preview panel where you can type sample text and see how it renders with your character set. Includes CRT effects simulation to see how your characters look on vintage displays.",shortcut:"T"},{id:"color-export",title:"Color Options in Export",description:"When exporting to PNG or PDF, you can choose custom foreground and background colors. The exported files will use your chosen color scheme, letting you create reference materials that match your target system's display."},{id:"qr-sharing",title:"QR Code Sharing",description:"Generate a QR code for your shareable link. This is perfect for sharing your character set at meetups, in printed materials, or anywhere you want quick mobile access. Scan the code to instantly load the character set."}]}];var ez=e.i(57688);function eP({tip:e}){return(0,E.jsxs)("div",{className:"py-3 px-2 rounded hover:bg-retro-purple/10 transition-colors",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,E.jsx)("h4",{className:"text-sm font-medium text-white",children:e.title}),e.shortcut&&(0,E.jsx)("kbd",{className:"px-2 py-0.5 text-xs font-mono bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:e.shortcut})]}),(0,E.jsx)("p",{className:"text-sm text-gray-400 mt-1 leading-relaxed",children:e.description}),e.image&&(0,E.jsx)("div",{className:"mt-3",children:(0,E.jsx)(ez.default,{src:e.image,alt:e.imageAlt||e.title,width:400,height:200,className:"rounded border border-retro-grid/30 max-w-full h-auto"})})]})}function eB({icon:e,className:t=""}){let r=`w-5 h-5 ${t}`;switch(e){case"pencil":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})});case"navigation":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})});case"transform":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})});case"layers":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})});case"keyboard":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})});case"overlay":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})});case"save":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})});case"export":return(0,E.jsx)("svg",{className:r,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})});default:return null}}function eO({isExpanded:e}){return(0,E.jsx)("svg",{className:`w-4 h-4 transition-transform duration-200 ${e?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}function eF({category:e,isExpanded:t,onToggle:r}){return(0,E.jsxs)("div",{className:"border border-retro-grid/30 rounded-lg overflow-hidden",children:[(0,E.jsxs)("button",{onClick:r,className:"w-full flex items-center gap-3 p-3 text-left hover:bg-retro-purple/10 transition-colors",children:[(0,E.jsx)("div",{className:"flex-shrink-0 text-retro-cyan",children:(0,E.jsx)(eB,{icon:e.icon})}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("h3",{className:"text-sm font-medium text-white",children:e.title}),(0,E.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.tips.length," tips)"]})]}),(0,E.jsx)("p",{className:"text-xs text-gray-400 mt-0.5 truncate",children:e.description})]}),(0,E.jsx)("div",{className:"flex-shrink-0 text-gray-400",children:(0,E.jsx)(eO,{isExpanded:t})})]}),(0,E.jsx)("div",{className:`overflow-hidden transition-all duration-200 ease-in-out ${t?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:(0,E.jsx)("div",{className:"border-t border-retro-grid/30 px-3 py-2 bg-retro-dark/30",children:e.tips.map(e=>(0,E.jsx)(eP,{tip:e},e.id))})})]})}function eH({isOpen:e,onClose:t,autoShowEnabled:r,onAutoShowChange:a,expandedCategories:n,onToggleCategory:s,onFirstClose:l}){let o=()=>{l?.(),t()};return(0,L.useEffect)(()=>{e&&0===n.length&&eT.length>0&&s((eT.find(e=>e.defaultExpanded)||eT[0]).id)},[e,n.length,s]),(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:o,size:"2xl",maxHeight:"80vh",ariaLabel:"Tips and Tricks",children:[(0,E.jsx)(eA.ModalHeader,{onClose:o,showCloseButton:!0,children:(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)("div",{className:"text-retro-amber",children:(0,E.jsx)(ej,{className:"w-6 h-6"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Tips & Tricks"}),(0,E.jsx)("p",{className:"text-xs text-gray-400",children:"Get the most out of the Character ROM Editor"})]})]})}),(0,E.jsxs)(eA.ModalContent,{scrollable:!0,className:"p-4",children:[(0,E.jsx)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded-lg border border-retro-grid/30",children:(0,E.jsx)("p",{className:"text-sm text-gray-300 leading-relaxed",children:"Welcome to the Character ROM Editor! This guide covers all the features and shortcuts to help you create and edit character sets efficiently. Click on any category below to expand it and see detailed tips."})}),(0,E.jsx)("div",{className:"space-y-3",children:eT.map(e=>{let t;return(0,E.jsx)(eF,{category:e,isExpanded:(t=e.id,n.includes(t)),onToggle:()=>s(e.id)},e.id)})})]}),(0,E.jsxs)(eA.ModalFooter,{className:"flex items-center justify-between",children:[(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)(eI.ToggleSwitch,{id:"tips-auto-show",checked:r,onChange:a}),(0,E.jsx)("label",{htmlFor:"tips-auto-show",className:"text-sm text-gray-400 cursor-pointer",children:"Show on startup"})]}),(0,E.jsx)("button",{onClick:o,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Close"})]})]})}eP.displayName="TipItem",eF.displayName="TipsCategory",eH.displayName="TipsOverlay";var e$=e.i(37559),eW=e.i(47509);let eU=(0,eW.getAnchorPositions)();function eV({value:e,onChange:t,label:r="Anchor Position",description:a}){return(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:r}),a&&(0,E.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:a}),(0,E.jsx)("div",{className:"grid grid-cols-3 gap-1 w-32 mx-auto",children:eU.map(r=>{let a=e===r;return(0,E.jsx)("button",{type:"button",onClick:()=>t(r),className:`
                w-10 h-10 rounded border-2 transition-all
                flex items-center justify-center
                ${a?"border-retro-amber bg-retro-amber/20":"border-retro-grid/50 bg-retro-dark hover:border-retro-grid"}
              `,title:(0,eW.getAnchorPositionLabel)(r),children:(0,E.jsx)("div",{className:`
                  w-3 h-3 rounded-sm transition-colors
                  ${a?"bg-retro-amber":"bg-gray-600"}
                `})},r)})})]})}function e_({isOpen:e,onClose:t,currentWidth:r,currentHeight:a,onResize:n}){let[s,l]=(0,L.useState)(r),[o,i]=(0,L.useState)(a),[c,d]=(0,L.useState)("tl"),h=(0,L.useCallback)(()=>{s>0&&o>0&&(n(s,o,c),t())},[s,o,c,n,t]),u=s!==r||o!==a;return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,onConfirm:h,confirmOnEnter:!0,size:"sm",children:[(0,E.jsxs)(eA.ModalContent,{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Resize Characters"}),(0,E.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Width"}),(0,E.jsx)("input",{type:"number",min:1,max:32,value:s,onChange:e=>l(Math.max(1,Math.min(32,parseInt(e.target.value)||1))),className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan",autoFocus:!0})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Height"}),(0,E.jsx)("input",{type:"number",min:1,max:32,value:o,onChange:e=>i(Math.max(1,Math.min(32,parseInt(e.target.value)||1))),className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan"})]})]}),(0,E.jsx)("div",{className:"mb-6",children:(0,E.jsx)(eV,{value:c,onChange:d,description:"Select where to anchor existing content when resizing"})}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mb-4 text-center h-4",children:u?s>r||o>a?"New pixels will be added with background color":s<r||o<a?"Some pixels will be cropped":"No changes":"No changes"})]}),(0,E.jsx)(eA.ModalActions,{onCancel:t,onConfirm:h,confirmDisabled:!u||s<1||o<1})]})}var eK=e.i(76849),eY=e.i(66811),eG=e.i(94136),eX=e.i(92921),eQ=e.i(81553),eJ=e.i(40674);let eq=["tl","tc","tr","ml","mc","mr","bl","bc","br"];function eZ({character:e,index:t,isSelected:r,isSelectionMode:a,onClick:n,onLongPress:s}){let l=(0,L.useCallback)(e=>{n(t,e.shiftKey,e.ctrlKey||e.metaKey)},[t,n]),o=(0,L.useCallback)(()=>{s(t)},[t,s]),i=(0,eQ.useLongPress)({onLongPress:o});return(0,E.jsxs)("button",{onClick:l,onMouseDown:i.onMouseDown,onMouseUp:i.onMouseUp,onMouseLeave:i.onMouseLeave,onTouchStart:i.onTouchStart,onTouchEnd:i.onTouchEnd,onTouchMove:i.onTouchMove,onContextMenu:i.onContextMenu,"data-grid-index":t,className:`
        p-1 rounded border-2 transition-all relative touch-manipulation
        ${r?"border-retro-cyan bg-retro-cyan/20":"border-transparent hover:border-retro-grid/50"}
      `,style:{touchAction:"manipulation"},title:`Character ${t}`,children:[(0,E.jsx)(_.CharacterDisplay,{character:e,mode:"small",smallScale:3}),a&&r&&(0,E.jsx)("div",{className:"absolute top-0 right-0 w-3 h-3 bg-retro-cyan rounded-bl flex items-center justify-center",children:(0,E.jsx)("svg",{className:"w-2 h-2 text-retro-dark",fill:"currentColor",viewBox:"0 0 20 20",children:(0,E.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}function e0({isOpen:e,onClose:t,currentConfig:r,onImport:a}){let{characterSets:n,loading:s}=(0,eY.useCharacterLibrary)(),[l,o]=(0,L.useState)("select-set"),[i,c]=(0,L.useState)(null),[d,h]=(0,L.useState)(""),[u,x]=(0,L.useState)(new Set),[m,f]=(0,L.useState)(null),[p,g]=(0,L.useState)("tl"),[b,v]=(0,L.useState)(!1),y=(0,L.useRef)(null);(0,L.useEffect)(()=>{e||(o("select-set"),c(null),h(""),x(new Set),f(null),g("tl"),v(!1))},[e]);let w=(0,L.useMemo)(()=>i&&n.find(e=>e.metadata.id===i)||null,[n,i]),j=(0,L.useMemo)(()=>{if(!w)return[];try{return(0,eG.deserializeCharacterSet)(w).characters}catch{return[]}},[w]),C=(0,L.useMemo)(()=>!!w&&(r.width!==w.config.width||r.height!==w.config.height),[w,r]),k=(0,L.useMemo)(()=>{if(!d.trim())return n;let e=d.toLowerCase();return n.filter(t=>t.metadata.name.toLowerCase().includes(e)||t.metadata.description.toLowerCase().includes(e))},[n,d]),N=(0,L.useCallback)((e,t)=>{let r=document.elementFromPoint(e,t);if(!r)return null;let a=r;for(;a&&a!==document.body;){let e=a.getAttribute("data-grid-index");if(null!==e){let t=parseInt(e,10);return t>=0&&t<j.length?t:null}a=a.parentElement}return null},[j.length]),S=(0,L.useCallback)(e=>{x(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),M=(0,eJ.useDragSelect)({enabled:b,onItemTouched:S,getIndexFromPoint:N}),R=(0,L.useCallback)(e=>{c(e.metadata.id)},[]),D=(0,L.useCallback)((e,t,r)=>{b?x(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r}):(x(a=>{let n=new Set(a);if(t&&null!==m){let t=Math.min(m,e),r=Math.max(m,e);for(let e=t;e<=r;e++)n.add(e)}else r?n.has(e)?n.delete(e):n.add(e):(n.clear(),n.add(e));return n}),f(e))},[m,b]),A=(0,L.useCallback)(e=>{v(!0),x(t=>{let r=new Set(t);return r.add(e),r})},[]),I=(0,L.useCallback)(()=>{x(new Set(j.map((e,t)=>t)))},[j]),T=(0,L.useCallback)(()=>{x(new Set)},[]),z=(0,L.useCallback)(()=>{v(!1)},[]),P=(0,L.useCallback)(()=>{"resize"===l?o("select-chars"):"select-chars"===l&&(o("select-set"),x(new Set))},[l]),B=(0,L.useCallback)(()=>{"select-set"===l&&i?o("select-chars"):"select-chars"===l&&u.size>0&&(C?o("resize"):(a(Array.from(u).sort((e,t)=>e-t).map(e=>j[e])),t()))},[l,i,u,C,j,a,t]),O=(0,L.useCallback)(()=>{let e=Array.from(u).sort((e,t)=>e-t).map(e=>j[e]);C&&(e=e.map(e=>(0,ea.resizeCharacter)(e,r.width,r.height,p))),a(e),t()},[u,j,C,r,p,a,t]);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,size:"2xl",maxHeight:"80vh",children:[(0,E.jsxs)(eA.ModalHeader,{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Import Characters"}),(0,E.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["select-set"===l&&"Select a character set to import from","select-chars"===l&&`Select characters to import (${u.size} selected)`,"resize"===l&&"Configure resize settings"]})]}),(0,E.jsxs)(eA.ModalContent,{className:"p-4 flex flex-col min-h-0 overflow-hidden",children:["select-set"===l&&(0,E.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 gap-4",children:[(0,E.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,E.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),placeholder:"Search...",className:"w-full px-3 py-2 pl-9 bg-retro-dark border border-retro-grid/50 rounded text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50",autoFocus:!0}),(0,E.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,E.jsx)("div",{className:"space-y-2 flex-1 overflow-y-auto min-h-0",children:s?(0,E.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):0===k.length?(0,E.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No character sets found"}):k.map(e=>(0,E.jsx)(eK.LibraryCardCompact,{characterSet:e,selected:i===e.metadata.id,onClick:()=>R(e)},e.metadata.id))}),w&&(0,E.jsxs)("div",{className:"flex-shrink-0 text-xs text-gray-500 text-center pt-2 border-t border-retro-grid/30",children:["Source: ",(0,eX.formatSize)(w.config)," (",j.length," chars)",C&&(0,E.jsxs)("span",{className:"text-yellow-500 ml-2",children:["(will be resized to ",(0,eX.formatSize)(r),")"]})]})]}),"select-chars"===l&&w&&(0,E.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 gap-4 relative",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between flex-shrink-0",children:[(0,E.jsx)("div",{className:"text-xs text-gray-500",children:b?"Tap to toggle selection":"Click to select, Shift+click for range, Ctrl+click to toggle"}),(0,E.jsx)("div",{className:"flex items-center gap-2",children:(0,E.jsxs)("button",{onClick:()=>v(!b),className:`flex items-center gap-1 px-2 py-1 rounded text-xs transition-colors ${b?"bg-retro-cyan/20 text-retro-cyan":"text-gray-400 hover:text-retro-cyan hover:bg-retro-cyan/10"}`,title:b?"Exit selection mode":"Enter selection mode",children:[b?(0,E.jsx)("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,E.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,E.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,E.jsx)("span",{children:"Select"})]})})]}),(0,E.jsx)("div",{className:`bg-black/30 rounded-lg p-3 flex-1 overflow-y-auto min-h-0 ${b?"pb-16 ring-1 ring-retro-cyan/30":""}`,children:(0,E.jsx)("div",{ref:y,className:"grid gap-1 select-none",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${Math.max(3*w.config.width,24)+8}px, 1fr))`},onTouchStartCapture:M.onTouchStart,onTouchMoveCapture:M.onTouchMove,onTouchEndCapture:M.onTouchEnd,onMouseDownCapture:M.onMouseDown,onMouseMoveCapture:M.onMouseMove,onMouseUpCapture:M.onMouseUp,onClickCapture:M.onClickCapture,children:j.map((e,t)=>(0,E.jsx)(eZ,{character:e,index:t,isSelected:u.has(t),isSelectionMode:b,onClick:D,onLongPress:A},t))})}),(0,E.jsx)(X,{isVisible:b,selectionCount:u.size,totalItems:j.length,onSelectAll:I,onClearSelection:T,onExitMode:z})]}),"resize"===l&&w&&(0,E.jsxs)("div",{className:"space-y-6",children:[(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"Source dimensions differ from target"}),(0,E.jsxs)("p",{className:"text-xs text-gray-500",children:[(0,eX.formatSize)(w.config)," â†’ ",(0,eX.formatSize)(r)]})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2 text-center",children:"Anchor Position"}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mb-3 text-center",children:"Select where to anchor content when resizing"}),(0,E.jsx)("div",{className:"grid grid-cols-3 gap-1 w-32 mx-auto",children:eq.map(e=>{let t=p===e;return(0,E.jsx)("button",{type:"button",onClick:()=>g(e),className:`
                          w-10 h-10 rounded border-2 transition-all
                          flex items-center justify-center
                          ${t?"border-retro-cyan bg-retro-cyan/20":"border-retro-grid/50 bg-retro-dark hover:border-retro-grid"}
                        `,title:{tl:"Top Left",tc:"Top Center",tr:"Top Right",ml:"Middle Left",mc:"Middle Center",mr:"Middle Right",bl:"Bottom Left",bc:"Bottom Center",br:"Bottom Right"}[e],children:(0,E.jsx)("div",{className:`
                            w-3 h-3 rounded-sm transition-colors
                            ${t?"bg-retro-cyan":"bg-gray-600"}
                          `})},e)})})]}),(0,E.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:[u.size," character",1!==u.size?"s":""," will be imported and resized"]})]})]}),(0,E.jsxs)(eA.ModalFooter,{className:"flex justify-between",children:["select-set"===l?(0,E.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}):(0,E.jsx)("button",{onClick:P,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Back"}),"resize"===l?(0,E.jsxs)("button",{onClick:O,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors",children:["Import (",u.size,")"]}):(0,E.jsx)("button",{onClick:B,disabled:"select-set"===l&&!i||"select-chars"===l&&0===u.size,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"select-chars"!==l||C?"Next":`Import (${u.size})`})]})]})}function e1({isOpen:e,onClose:t,characters:r,currentIndex:a,onCopy:n}){let[s,l]=(0,L.useState)(null);(0,L.useEffect)(()=>{e||l(null)},[e]);let o=(0,L.useCallback)(e=>{l(e)},[]),i=(0,L.useCallback)(()=>{null!==s&&(n(s),t())},[s,n,t]);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,onConfirm:i,confirmOnEnter:!0,size:"lg",maxHeight:"70vh",children:[(0,E.jsxs)(eA.ModalHeader,{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Copy Character"}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Select a character to copy. It will replace the currently selected character(s)."})]}),(0,E.jsxs)(eA.ModalContent,{scrollable:!0,children:[(0,E.jsx)("div",{className:"bg-black/30 rounded-lg p-3",children:(0,E.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(40px, 1fr))"},children:r.map((e,t)=>{let r=s===t,n=t===a;return(0,E.jsxs)("button",{onClick:()=>o(t),disabled:n,className:`
                    p-1.5 rounded border-2 transition-all relative
                    ${r?"border-retro-cyan bg-retro-cyan/20":n?"border-retro-pink/30 bg-retro-pink/10 opacity-50 cursor-not-allowed":"border-transparent hover:border-retro-grid/50"}
                  `,title:n?"Current selection":`Character ${t}`,children:[(0,E.jsx)(_.CharacterDisplay,{character:e,mode:"small",smallScale:3}),n&&(0,E.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,E.jsx)("span",{className:"text-[8px] text-retro-pink bg-retro-dark/80 px-1 rounded",children:"current"})})]},t)})})}),null!==s&&(0,E.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-3",children:["Character ",s," selected"]})]}),(0,E.jsxs)(eA.ModalFooter,{className:"flex justify-between",children:[(0,E.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,E.jsx)("button",{onClick:i,disabled:null===s,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Copy"})]})]})}let e2="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function e4(e){let t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function e3(e){return"nodeType"in e}function e5(e){var t,r;return e?e4(e)?e:e3(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function e8(e){let{Document:t}=e5(e);return e instanceof t}function e6(e){return!e4(e)&&e instanceof e5(e).HTMLElement}function e7(e){return e instanceof e5(e).SVGElement}function e9(e){return e?e4(e)?e.document:e3(e)?e8(e)?e:e6(e)||e7(e)?e.ownerDocument:document:document:document}let te=e2?L.useLayoutEffect:L.useEffect;function tt(e){let t=(0,L.useRef)(e);return te(()=>{t.current=e}),(0,L.useCallback)(function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return null==t.current?void 0:t.current(...r)},[])}function tr(e,t){void 0===t&&(t=[e]);let r=(0,L.useRef)(e);return te(()=>{r.current!==e&&(r.current=e)},t),r}function ta(e,t){let r=(0,L.useRef)();return(0,L.useMemo)(()=>{let t=e(r.current);return r.current=t,t},[...t])}function tn(e){let t=tt(e),r=(0,L.useRef)(null),a=(0,L.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,a]}function ts(e){let t=(0,L.useRef)();return(0,L.useEffect)(()=>{t.current=e},[e]),t.current}let tl={};function to(e,t){return(0,L.useMemo)(()=>{if(t)return t;let r=null==tl[e]?0:tl[e]+1;return tl[e]=r,e+"-"+r},[e,t])}function ti(e){return function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];return a.reduce((t,r)=>{for(let[a,n]of Object.entries(r)){let r=t[a];null!=r&&(t[a]=r+e*n)}return t},{...t})}}let tc=ti(1),td=ti(-1);function th(e){if(!e)return!1;let{KeyboardEvent:t}=e5(e.target);return t&&e instanceof t}function tu(e){if(function(e){if(!e)return!1;let{TouchEvent:t}=e5(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return"clientX"in e&&"clientY"in e?{x:e.clientX,y:e.clientY}:null}let tx=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[tx.Translate.toString(e),tx.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:a}=e;return t+" "+r+"ms "+a}}}),tm="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",tf={display:"none"};function tp(e){let{id:t,value:r}=e;return L.default.createElement("div",{id:t,style:tf},r)}function tg(e){let{id:t,announcement:r,ariaLiveType:a="assertive"}=e;return L.default.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":a,"aria-atomic":!0},r)}let tb=(0,L.createContext)(null),tv={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},ty={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function tw(e){var t;let r,{announcements:a=ty,container:n,hiddenTextDescribedById:s,screenReaderInstructions:l=tv}=e,{announce:o,announcement:i}=function(){let[e,t]=(0,L.useState)("");return{announce:(0,L.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),c=to("DndLiveRegion"),[d,h]=(0,L.useState)(!1);if((0,L.useEffect)(()=>{h(!0)},[]),t=(0,L.useMemo)(()=>({onDragStart(e){let{active:t}=e;o(a.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;a.onDragMove&&o(a.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;o(a.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;o(a.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;o(a.onDragCancel({active:t,over:r}))}}),[o,a]),r=(0,L.useContext)(tb),(0,L.useEffect)(()=>{if(!r)throw Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r]),!d)return null;let u=L.default.createElement(L.default.Fragment,null,L.default.createElement(tp,{id:s,value:l.draggable}),L.default.createElement(tg,{id:c,announcement:i}));return n?(0,O.createPortal)(u,n):u}function tj(){}function tC(e,t){return(0,L.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}(n=g||(g={})).DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable";let tk=Object.freeze({x:0,y:0});function tN(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function tS(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return r-a}function tM(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return a-r}function tE(e){let{left:t,top:r,height:a,width:n}=e;return[{x:t,y:r},{x:t+n,y:r},{x:t,y:r+a},{x:t+n,y:r+a}]}function tL(e,t){if(!e||0===e.length)return null;let[r]=e;return t?r[t]:r}function tR(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}let tD=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=tR(t,t.left,t.top),s=[];for(let e of a){let{id:t}=e,a=r.get(t);if(a){let r=tN(tR(a),n);s.push({id:t,data:{droppableContainer:e,value:r}})}}return s.sort(tS)},tA=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=[];for(let e of a){let{id:a}=e,s=r.get(a);if(s){let r=function(e,t){let r=Math.max(t.top,e.top),a=Math.max(t.left,e.left),n=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height);if(a<n&&r<s){let l=t.width*t.height,o=e.width*e.height,i=(n-a)*(s-r);return Number((i/(l+o-i)).toFixed(4))}return 0}(s,t);r>0&&n.push({id:a,data:{droppableContainer:e,value:r}})}}return n.sort(tM)};function tI(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:tk}let tT=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.reduce((e,t)=>({...e,top:e.top+ +t.y,bottom:e.bottom+ +t.y,left:e.left+ +t.x,right:e.right+ +t.x}),{...e})};function tz(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}let tP={ignoreTransform:!1};function tB(e,t){void 0===t&&(t=tP);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:t,transformOrigin:a}=e5(e).getComputedStyle(e);t&&(r=function(e,t,r){let a=tz(t);if(!a)return e;let{scaleX:n,scaleY:s,x:l,y:o}=a,i=e.left-l-(1-n)*parseFloat(r),c=e.top-o-(1-s)*parseFloat(r.slice(r.indexOf(" ")+1)),d=n?e.width/n:e.width,h=s?e.height/s:e.height;return{width:d,height:h,top:c,right:i+d,bottom:c+h,left:i}}(r,t,a))}let{top:a,left:n,width:s,height:l,bottom:o,right:i}=r;return{top:a,left:n,width:s,height:l,bottom:o,right:i}}function tO(e){return tB(e,{ignoreTransform:!0})}function tF(e,t){let r=[];return e?function a(n){var s,l;let o;if(null!=t&&r.length>=t||!n)return r;if(e8(n)&&null!=n.scrollingElement&&!r.includes(n.scrollingElement))return r.push(n.scrollingElement),r;if(!e6(n)||e7(n)||r.includes(n))return r;let i=e5(e).getComputedStyle(n);return(n!==e&&(void 0===(s=i)&&(s=e5(n).getComputedStyle(n)),o=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(e=>{let t=s[e];return"string"==typeof t&&o.test(t)}))&&r.push(n),void 0===(l=i)&&(l=e5(n).getComputedStyle(n)),"fixed"===l.position)?r:a(n.parentNode)}(e):r}function tH(e){let[t]=tF(e,1);return null!=t?t:null}function t$(e){return e2&&e?e4(e)?e:e3(e)?e8(e)||e===e9(e).scrollingElement?window:e6(e)?e:null:null:null}function tW(e){return e4(e)?e.scrollX:e.scrollLeft}function tU(e){return e4(e)?e.scrollY:e.scrollTop}function tV(e){return{x:tW(e),y:tU(e)}}function t_(e){return!!e2&&!!e&&e===document.scrollingElement}function tK(e){let t={x:0,y:0},r=t_(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},n=e.scrollTop<=t.y,s=e.scrollLeft<=t.x;return{isTop:n,isLeft:s,isBottom:e.scrollTop>=a.y,isRight:e.scrollLeft>=a.x,maxScroll:a,minScroll:t}}(s=b||(b={}))[s.Forward=1]="Forward",s[s.Backward=-1]="Backward";let tY={x:.2,y:.2};function tG(e){return e.reduce((e,t)=>tc(e,tV(t)),tk)}function tX(e,t){if(void 0===t&&(t=tB),!e)return;let{top:r,left:a,bottom:n,right:s}=t(e);tH(e)&&(n<=0||s<=0||r>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}let tQ=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+tW(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+tU(t),0)}]];class tJ{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=tF(t),a=tG(r);for(const[t,n,s]of(this.rect={...e},this.width=e.width,this.height=e.height,tQ))for(const e of n)Object.defineProperty(this,e,{get:()=>{let n=s(r),l=a[t]-n;return this.rect[e]+l},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class tq{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var a;null==(a=this.target)||a.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function tZ(e,t){let r=Math.abs(e.x),a=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+a**2)>t:"x"in t&&"y"in t?r>t.x&&a>t.y:"x"in t?r>t.x:"y"in t&&a>t.y}function t0(e){e.preventDefault()}function t1(e){e.stopPropagation()}(l=v||(v={})).Click="click",l.DragStart="dragstart",l.Keydown="keydown",l.ContextMenu="contextmenu",l.Resize="resize",l.SelectionChange="selectionchange",l.VisibilityChange="visibilitychange",(o=y||(y={})).Space="Space",o.Down="ArrowDown",o.Right="ArrowRight",o.Left="ArrowLeft",o.Up="ArrowUp",o.Esc="Escape",o.Enter="Enter",o.Tab="Tab";let t2={start:[y.Space,y.Enter],cancel:[y.Esc],end:[y.Space,y.Enter,y.Tab]},t4=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case y.Right:return{...r,x:r.x+25};case y.Left:return{...r,x:r.x-25};case y.Down:return{...r,y:r.y+25};case y.Up:return{...r,y:r.y-25}}};class t3{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new tq(e9(t)),this.windowListeners=new tq(e5(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(v.Resize,this.handleCancel),this.windowListeners.add(v.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(v.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&tX(r),t(tk)}handleKeyDown(e){if(th(e)){let{active:t,context:r,options:a}=this.props,{keyboardCodes:n=t2,coordinateGetter:s=t4,scrollBehavior:l="smooth"}=a,{code:o}=e;if(n.end.includes(o))return void this.handleEnd(e);if(n.cancel.includes(o))return void this.handleCancel(e);let{collisionRect:i}=r.current,c=i?{x:i.left,y:i.top}:tk;this.referenceCoordinates||(this.referenceCoordinates=c);let d=s(e,{active:t,context:r.current,currentCoordinates:c});if(d){let t=td(d,c),a={x:0,y:0},{scrollableAncestors:n}=r.current;for(let r of n){let n=e.code,{isTop:s,isRight:o,isLeft:i,isBottom:c,maxScroll:h,minScroll:u}=tK(r),x=function(e){if(e===document.scrollingElement){let{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}let{top:t,left:r,right:a,bottom:n}=e.getBoundingClientRect();return{top:t,left:r,right:a,bottom:n,width:e.clientWidth,height:e.clientHeight}}(r),m={x:Math.min(n===y.Right?x.right-x.width/2:x.right,Math.max(n===y.Right?x.left:x.left+x.width/2,d.x)),y:Math.min(n===y.Down?x.bottom-x.height/2:x.bottom,Math.max(n===y.Down?x.top:x.top+x.height/2,d.y))},f=n===y.Right&&!o||n===y.Left&&!i,p=n===y.Down&&!c||n===y.Up&&!s;if(f&&m.x!==d.x){let e=r.scrollLeft+t.x,s=n===y.Right&&e<=h.x||n===y.Left&&e>=u.x;if(s&&!t.y)return void r.scrollTo({left:e,behavior:l});s?a.x=r.scrollLeft-e:a.x=n===y.Right?r.scrollLeft-h.x:r.scrollLeft-u.x,a.x&&r.scrollBy({left:-a.x,behavior:l});break}if(p&&m.y!==d.y){let e=r.scrollTop+t.y,s=n===y.Down&&e<=h.y||n===y.Up&&e>=u.y;if(s&&!t.x)return void r.scrollTo({top:e,behavior:l});s?a.y=r.scrollTop-e:a.y=n===y.Down?r.scrollTop-h.y:r.scrollTop-u.y,a.y&&r.scrollBy({top:-a.y,behavior:l});break}}this.handleMove(e,tc(td(d,this.referenceCoordinates),a))}}}handleMove(e,t){let{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){let{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){let{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function t5(e){return!!(e&&"distance"in e)}function t8(e){return!!(e&&"delay"in e)}t3.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:a=t2,onActivation:n}=t,{active:s}=r,{code:l}=e.nativeEvent;if(a.start.includes(l)){let t=s.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==n||n({event:e.nativeEvent}),!0)}return!1}}];class t6{constructor(e,t,r){var a;void 0===r&&(r=function(e){let{EventTarget:t}=e5(e);return e instanceof t?e:e9(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:n}=e,{target:s}=n;this.props=e,this.events=t,this.document=e9(s),this.documentListeners=new tq(this.document),this.listeners=new tq(r),this.windowListeners=new tq(e5(s)),this.initialCoordinates=null!=(a=tu(n))?a:tk,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(v.Resize,this.handleCancel),this.windowListeners.add(v.DragStart,t0),this.windowListeners.add(v.VisibilityChange,this.handleCancel),this.windowListeners.add(v.ContextMenu,t0),this.documentListeners.add(v.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(t8(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(t5(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){let{active:r,onPending:a}=this.props;a(r,e,this.initialCoordinates,t)}handleStart(){let{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(v.Click,t1,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(v.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;let{activated:r,initialCoordinates:a,props:n}=this,{onMove:s,options:{activationConstraint:l}}=n;if(!a)return;let o=null!=(t=tu(e))?t:tk,i=td(a,o);if(!r&&l){if(t5(l)){if(null!=l.tolerance&&tZ(i,l.tolerance))return this.handleCancel();if(tZ(i,l.distance))return this.handleStart()}return t8(l)&&tZ(i,l.tolerance)?this.handleCancel():void this.handlePending(l,i)}e.cancelable&&e.preventDefault(),s(o)}handleEnd(){let{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){let{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===y.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}let t7={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class t9 extends t6{constructor(e){const{event:t}=e;super(e,t7,e9(t.target))}}t9.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return!!r.isPrimary&&0===r.button&&(null==a||a({event:r}),!0)}}];(i=w||(w={}))[i.RightClick=2]="RightClick";(c=j||(j={}))[c.Pointer=0]="Pointer",c[c.DraggableRect=1]="DraggableRect",(d=C||(C={}))[d.TreeOrder=0]="TreeOrder",d[d.ReversedTreeOrder=1]="ReversedTreeOrder";let re={x:{[b.Backward]:!1,[b.Forward]:!1},y:{[b.Backward]:!1,[b.Forward]:!1}};(h=k||(k={}))[h.Always=0]="Always",h[h.BeforeDragging=1]="BeforeDragging",h[h.WhileDragging=2]="WhileDragging",(N||(N={})).Optimized="optimized";let rt=new Map;function rr(e,t){return ta(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function ra(e){let{callback:t,disabled:r}=e,a=tt(t),n=(0,L.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:e}=window;return new e(a)},[r]);return(0,L.useEffect)(()=>()=>null==n?void 0:n.disconnect(),[n]),n}function rn(e){return new tJ(tB(e),e)}function rs(e,t,r){void 0===t&&(t=rn);let[a,n]=(0,L.useState)(null);function s(){n(a=>{if(!e)return null;if(!1===e.isConnected){var n;return null!=(n=null!=a?a:r)?n:null}let s=t(e);return JSON.stringify(a)===JSON.stringify(s)?a:s})}let l=function(e){let{callback:t,disabled:r}=e,a=tt(t),n=(0,L.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;let{MutationObserver:e}=window;return new e(a)},[a,r]);return(0,L.useEffect)(()=>()=>null==n?void 0:n.disconnect(),[n]),n}({callback(t){if(e)for(let r of t){let{type:t,target:a}=r;if("childList"===t&&a instanceof HTMLElement&&a.contains(e)){s();break}}}}),o=ra({callback:s});return te(()=>{s(),e?(null==o||o.observe(e),null==l||l.observe(document.body,{childList:!0,subtree:!0})):(null==o||o.disconnect(),null==l||l.disconnect())},[e]),a}let rl=[];function ro(e,t){void 0===t&&(t=[]);let r=(0,L.useRef)(null);return(0,L.useEffect)(()=>{r.current=null},t),(0,L.useEffect)(()=>{let t=e!==tk;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?td(e,r.current):tk}function ri(e){return(0,L.useMemo)(()=>{let t,r;return e?(t=e.innerWidth,{top:0,left:0,right:t,bottom:r=e.innerHeight,width:t,height:r}):null},[e])}let rc=[];function rd(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return e6(t)?t:e}let rh=[{sensor:t9,options:{}},{sensor:t3,options:{}}],ru={current:{}},rx={draggable:{measure:tO},droppable:{measure:tO,strategy:k.WhileDragging,frequency:N.Optimized},dragOverlay:{measure:tB}};class rm extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}let rf={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new rm,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:tj},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:rx,measureDroppableContainers:tj,windowRect:null,measuringScheduled:!1},rp={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:tj,draggableNodes:new Map,over:null,measureDroppableContainers:tj},rg=(0,L.createContext)(rp),rb=(0,L.createContext)(rf);function rv(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new rm}}}function ry(e,t){switch(t.type){case g.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case g.DragMove:if(null==e.draggable.active)return e;return{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case g.DragEnd:case g.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case g.RegisterDroppable:{let{element:r}=t,{id:a}=r,n=new rm(e.droppable.containers);return n.set(a,r),{...e,droppable:{...e.droppable,containers:n}}}case g.SetDroppableDisabled:{let{id:r,key:a,disabled:n}=t,s=e.droppable.containers.get(r);if(!s||a!==s.key)return e;let l=new rm(e.droppable.containers);return l.set(r,{...s,disabled:n}),{...e,droppable:{...e.droppable,containers:l}}}case g.UnregisterDroppable:{let{id:r,key:a}=t,n=e.droppable.containers.get(r);if(!n||a!==n.key)return e;let s=new rm(e.droppable.containers);return s.delete(r),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function rw(e){let{disabled:t}=e,{active:r,activatorEvent:a,draggableNodes:n}=(0,L.useContext)(rg),s=ts(a),l=ts(null==r?void 0:r.id);return(0,L.useEffect)(()=>{if(!t&&!a&&s&&null!=l){if(!th(s)||document.activeElement===s.target)return;let e=n.get(l);if(!e)return;let{activatorNode:t,node:r}=e;(t.current||r.current)&&requestAnimationFrame(()=>{for(let e of[t.current,r.current]){if(!e)continue;let t=e.matches(tm)?e:e.querySelector(tm);if(t){t.focus();break}}})}},[a,t,n,l,s]),null}function rj(e,t){let{transform:r,...a}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...a}),r):r}let rC=(0,L.createContext)({...tk,scaleX:1,scaleY:1});(u=S||(S={}))[u.Uninitialized=0]="Uninitialized",u[u.Initializing=1]="Initializing",u[u.Initialized=2]="Initialized";let rk=(0,L.memo)(function(e){var t,r,a,n,s,l,o,i;let c,d,h,u,x,m,f,p,{id:v,accessibility:y,autoScroll:w=!0,children:N,sensors:M=rh,collisionDetection:E=tA,measuring:R,modifiers:D,...A}=e,[I,T]=(0,L.useReducer)(ry,void 0,rv),[z,P]=function(){let[e]=(0,L.useState)(()=>new Set),t=(0,L.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,L.useCallback)(t=>{let{type:r,event:a}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,a)})},[e]),t]}(),[B,F]=(0,L.useState)(S.Uninitialized),H=B===S.Initialized,{draggable:{active:$,nodes:W,translate:U},droppable:{containers:V}}=I,_=null!=$?W.get($):null,K=(0,L.useRef)({initial:null,translated:null}),Y=(0,L.useMemo)(()=>{var e;return null!=$?{id:$,data:null!=(e=null==_?void 0:_.data)?e:ru,rect:K}:null},[$,_]),G=(0,L.useRef)(null),[X,Q]=(0,L.useState)(null),[J,q]=(0,L.useState)(null),Z=tr(A,Object.values(A)),ee=to("DndDescribedBy",v),et=(0,L.useMemo)(()=>V.getEnabled(),[V]),er=(0,L.useMemo)(()=>({draggable:{...rx.draggable,...null==R?void 0:R.draggable},droppable:{...rx.droppable,...null==R?void 0:R.droppable},dragOverlay:{...rx.dragOverlay,...null==R?void 0:R.dragOverlay}}),[null==R?void 0:R.draggable,null==R?void 0:R.droppable,null==R?void 0:R.dragOverlay]),{droppableRects:ea,measureDroppableContainers:en,measuringScheduled:es}=function(e,t){let{dragging:r,dependencies:a,config:n}=t,[s,l]=(0,L.useState)(null),{frequency:o,measure:i,strategy:c}=n,d=(0,L.useRef)(e),h=function(){switch(c){case k.Always:return!1;case k.BeforeDragging:return r;default:return!r}}(),u=tr(h),x=(0,L.useCallback)(function(e){void 0===e&&(e=[]),u.current||l(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[u]),m=(0,L.useRef)(null),f=ta(t=>{if(h&&!r)return rt;if(!t||t===rt||d.current!==e||null!=s){let t=new Map;for(let r of e){if(!r)continue;if(s&&s.length>0&&!s.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}let e=r.node.current,a=e?new tJ(i(e),e):null;r.rect.current=a,a&&t.set(r.id,a)}return t}return t},[e,s,r,h,i]);return(0,L.useEffect)(()=>{d.current=e},[e]),(0,L.useEffect)(()=>{h||x()},[r,h]),(0,L.useEffect)(()=>{s&&s.length>0&&l(null)},[JSON.stringify(s)]),(0,L.useEffect)(()=>{h||"number"!=typeof o||null!==m.current||(m.current=setTimeout(()=>{x(),m.current=null},o))},[o,h,x,...a]),{droppableRects:f,measureDroppableContainers:x,measuringScheduled:null!=s}}(et,{dragging:H,dependencies:[U.x,U.y],config:er.droppable}),el=ta(e=>{var t;return null==$?null:null!=(t=null!=x?x:e)?t:null},[x=(u=null!=$?W.get($):void 0)?u.node.current:null,$]),eo=(0,L.useMemo)(()=>J?tu(J):null,[J]),ei=(c=(null==X?void 0:X.autoScrollEnabled)===!1,d="object"==typeof w?!1===w.enabled:!1===w,h=H&&!c&&!d,"object"==typeof w?{...w,enabled:h}:{enabled:h}),ec=rr(el,er.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:a,config:n=!0}=e,s=(0,L.useRef)(!1),{x:l,y:o}="boolean"==typeof n?{x:n,y:n}:n;te(()=>{if(!l&&!o||!t){s.current=!1;return}if(s.current||!a)return;let e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;let n=tI(r(e),a);if(l||(n.x=0),o||(n.y=0),s.current=!0,Math.abs(n.x)>0||Math.abs(n.y)>0){let t=tH(e);t&&t.scrollBy({top:n.y,left:n.x})}},[t,l,o,a,r])}({activeNode:null!=$?W.get($):null,config:ei.layoutShiftCompensation,initialRect:ec,measure:er.draggable.measure});let ed=rs(el,er.draggable.measure,ec),eh=rs(el?el.parentElement:null),eu=(0,L.useRef)({activatorEvent:null,active:null,activeNode:el,collisionRect:null,collisions:null,droppableRects:ea,draggableNodes:W,draggingNode:null,draggingNodeRect:null,droppableContainers:V,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ex=V.getNodeFor(null==(t=eu.current.over)?void 0:t.id),em=function(e){let{measure:t}=e,[r,a]=(0,L.useState)(null),n=ra({callback:(0,L.useCallback)(e=>{for(let{target:r}of e)if(e6(r)){a(e=>{let a=t(r);return e?{...e,width:a.width,height:a.height}:a});break}},[t])}),[s,l]=tn((0,L.useCallback)(e=>{let r=rd(e);null==n||n.disconnect(),r&&(null==n||n.observe(r)),a(r?t(r):null)},[t,n]));return(0,L.useMemo)(()=>({nodeRef:s,rect:r,setRef:l}),[r,s,l])}({measure:er.dragOverlay.measure}),ef=null!=(r=em.nodeRef.current)?r:el,ep=H?null!=(a=em.rect)?a:ed:null,eg=!!(em.nodeRef.current&&em.rect),eb=(m=rr(s=eg?null:ed),tI(s,m)),ev=ri(ef?e5(ef):null),ey=(l=H?null!=ex?ex:el:null,f=(0,L.useRef)(l),p=ta(e=>l?e&&e!==rl&&l&&f.current&&l.parentNode===f.current.parentNode?e:tF(l):rl,[l]),(0,L.useEffect)(()=>{f.current=l},[l]),p),ew=function(e,t){void 0===t&&(t=tB);let[r]=e,a=ri(r?e5(r):null),[n,s]=(0,L.useState)(rc);function l(){s(()=>e.length?e.map(e=>t_(e)?a:new tJ(t(e),e)):rc)}let o=ra({callback:l});return te(()=>{null==o||o.disconnect(),l(),e.forEach(e=>null==o?void 0:o.observe(e))},[e]),n}(ey),ej=rj(D,{transform:{x:U.x-eb.x,y:U.y-eb.y,scaleX:1,scaleY:1},activatorEvent:J,active:Y,activeNodeRect:ed,containerNodeRect:eh,draggingNodeRect:ep,over:eu.current.over,overlayNodeRect:em.rect,scrollableAncestors:ey,scrollableAncestorRects:ew,windowRect:ev}),eC=eo?tc(eo,U):null,ek=function(e){let[t,r]=(0,L.useState)(null),a=(0,L.useRef)(e),n=(0,L.useCallback)(e=>{let t=t$(e.target);t&&r(e=>e?(e.set(t,tV(t)),new Map(e)):null)},[]);return(0,L.useEffect)(()=>{let t=a.current;if(e!==t){s(t);let l=e.map(e=>{let t=t$(e);return t?(t.addEventListener("scroll",n,{passive:!0}),[t,tV(t)]):null}).filter(e=>null!=e);r(l.length?new Map(l):null),a.current=e}return()=>{s(e),s(t)};function s(e){e.forEach(e=>{let t=t$(e);null==t||t.removeEventListener("scroll",n)})}},[n,e]),(0,L.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>tc(e,t),tk):tG(e):tk,[e,t])}(ey),eN=ro(ek),eS=ro(ek,[ed]),eM=tc(ej,eN),eE=ep?tT(ep,ej):null,eL=Y&&eE?E({active:Y,collisionRect:eE,droppableRects:ea,droppableContainers:et,pointerCoordinates:eC}):null,eR=tL(eL,"id"),[eD,eA]=(0,L.useState)(null),eI=(o=eg?ej:tc(ej,eS),i=null!=(n=null==eD?void 0:eD.rect)?n:null,{...o,scaleX:i&&ed?i.width/ed.width:1,scaleY:i&&ed?i.height/ed.height:1}),eT=(0,L.useRef)(null),ez=(0,L.useCallback)((e,t)=>{let{sensor:r,options:a}=t;if(null==G.current)return;let n=W.get(G.current);if(!n)return;let s=e.nativeEvent,l=new r({active:G.current,activeNode:n,event:s,options:a,context:eu,onAbort(e){if(!W.get(e))return;let{onDragAbort:t}=Z.current,r={id:e};null==t||t(r),z({type:"onDragAbort",event:r})},onPending(e,t,r,a){if(!W.get(e))return;let{onDragPending:n}=Z.current,s={id:e,constraint:t,initialCoordinates:r,offset:a};null==n||n(s),z({type:"onDragPending",event:s})},onStart(e){let t=G.current;if(null==t)return;let r=W.get(t);if(!r)return;let{onDragStart:a}=Z.current,n={activatorEvent:s,active:{id:t,data:r.data,rect:K}};(0,O.unstable_batchedUpdates)(()=>{null==a||a(n),F(S.Initializing),T({type:g.DragStart,initialCoordinates:e,active:t}),z({type:"onDragStart",event:n}),Q(eT.current),q(s)})},onMove(e){T({type:g.DragMove,coordinates:e})},onEnd:o(g.DragEnd),onCancel:o(g.DragCancel)});function o(e){return async function(){let{active:t,collisions:r,over:a,scrollAdjustedTranslate:n}=eu.current,l=null;if(t&&n){let{cancelDrop:o}=Z.current;l={activatorEvent:s,active:t,collisions:r,delta:n,over:a},e===g.DragEnd&&"function"==typeof o&&await Promise.resolve(o(l))&&(e=g.DragCancel)}G.current=null,(0,O.unstable_batchedUpdates)(()=>{T({type:e}),F(S.Uninitialized),eA(null),Q(null),q(null),eT.current=null;let t=e===g.DragEnd?"onDragEnd":"onDragCancel";if(l){let e=Z.current[t];null==e||e(l),z({type:t,event:l})}})}}eT.current=l},[W]),eP=(0,L.useCallback)((e,t)=>(r,a)=>{let n=r.nativeEvent,s=W.get(a);null!==G.current||!s||n.dndKit||n.defaultPrevented||!0===e(r,t.options,{active:s})&&(n.dndKit={capturedBy:t.sensor},G.current=a,ez(r,t))},[W,ez]),eB=(0,L.useMemo)(()=>M.reduce((e,t)=>{let{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:eP(e.handler,t)}))]},[]),[M,eP]);(0,L.useEffect)(()=>{if(!e2)return;let e=M.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(let t of e)null==t||t()}},M.map(e=>{let{sensor:t}=e;return t})),te(()=>{ed&&B===S.Initializing&&F(S.Initialized)},[ed,B]),(0,L.useEffect)(()=>{let{onDragMove:e}=Z.current,{active:t,activatorEvent:r,collisions:a,over:n}=eu.current;if(!t||!r)return;let s={active:t,activatorEvent:r,collisions:a,delta:{x:eM.x,y:eM.y},over:n};(0,O.unstable_batchedUpdates)(()=>{null==e||e(s),z({type:"onDragMove",event:s})})},[eM.x,eM.y]),(0,L.useEffect)(()=>{let{active:e,activatorEvent:t,collisions:r,droppableContainers:a,scrollAdjustedTranslate:n}=eu.current;if(!e||null==G.current||!t||!n)return;let{onDragOver:s}=Z.current,l=a.get(eR),o=l&&l.rect.current?{id:l.id,rect:l.rect.current,data:l.data,disabled:l.disabled}:null,i={active:e,activatorEvent:t,collisions:r,delta:{x:n.x,y:n.y},over:o};(0,O.unstable_batchedUpdates)(()=>{eA(o),null==s||s(i),z({type:"onDragOver",event:i})})},[eR]),te(()=>{eu.current={activatorEvent:J,active:Y,activeNode:el,collisionRect:eE,collisions:eL,droppableRects:ea,draggableNodes:W,draggingNode:ef,draggingNodeRect:ep,droppableContainers:V,over:eD,scrollableAncestors:ey,scrollAdjustedTranslate:eM},K.current={initial:ep,translated:eE}},[Y,el,eL,eE,W,ef,ep,ea,V,eD,ey,eM]),function(e){let t,{acceleration:r,activator:a=j.Pointer,canScroll:n,draggingRect:s,enabled:l,interval:o=5,order:i=C.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:h,delta:u,threshold:x}=e,m=function(e){let{delta:t,disabled:r}=e,a=ts(t);return ta(e=>{if(r||!a||!e)return re;let n={x:Math.sign(t.x-a.x),y:Math.sign(t.y-a.y)};return{x:{[b.Backward]:e.x[b.Backward]||-1===n.x,[b.Forward]:e.x[b.Forward]||1===n.x},y:{[b.Backward]:e.y[b.Backward]||-1===n.y,[b.Forward]:e.y[b.Forward]||1===n.y}}},[r,t,a])}({delta:u,disabled:!l}),[f,p]=(t=(0,L.useRef)(null),[(0,L.useCallback)((e,r)=>{t.current=setInterval(e,r)},[]),(0,L.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]),g=(0,L.useRef)({x:0,y:0}),v=(0,L.useRef)({x:0,y:0}),y=(0,L.useMemo)(()=>{switch(a){case j.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case j.DraggableRect:return s}},[a,s,c]),w=(0,L.useRef)(null),k=(0,L.useCallback)(()=>{let e=w.current;if(!e)return;let t=g.current.x*v.current.x,r=g.current.y*v.current.y;e.scrollBy(t,r)},[]),N=(0,L.useMemo)(()=>i===C.TreeOrder?[...d].reverse():d,[i,d]);(0,L.useEffect)(()=>{if(!l||!d.length||!y)return void p();for(let e of N){if((null==n?void 0:n(e))===!1)continue;let t=h[d.indexOf(e)];if(!t)continue;let{direction:a,speed:s}=function(e,t,r,a,n){let{top:s,left:l,right:o,bottom:i}=r;void 0===a&&(a=10),void 0===n&&(n=tY);let{isTop:c,isBottom:d,isLeft:h,isRight:u}=tK(e),x={x:0,y:0},m={x:0,y:0},f={height:t.height*n.y,width:t.width*n.x};return!c&&s<=t.top+f.height?(x.y=b.Backward,m.y=a*Math.abs((t.top+f.height-s)/f.height)):!d&&i>=t.bottom-f.height&&(x.y=b.Forward,m.y=a*Math.abs((t.bottom-f.height-i)/f.height)),!u&&o>=t.right-f.width?(x.x=b.Forward,m.x=a*Math.abs((t.right-f.width-o)/f.width)):!h&&l<=t.left+f.width&&(x.x=b.Backward,m.x=a*Math.abs((t.left+f.width-l)/f.width)),{direction:x,speed:m}}(e,t,y,r,x);for(let e of["x","y"])m[e][a[e]]||(s[e]=0,a[e]=0);if(s.x>0||s.y>0){p(),w.current=e,f(k,o),g.current=s,v.current=a;return}}g.current={x:0,y:0},v.current={x:0,y:0},p()},[r,k,n,p,l,o,JSON.stringify(y),JSON.stringify(m),f,d,N,h,JSON.stringify(x)])}({...ei,delta:U,draggingRect:eE,pointerCoordinates:eC,scrollableAncestors:ey,scrollableAncestorRects:ew});let eO=(0,L.useMemo)(()=>({active:Y,activeNode:el,activeNodeRect:ed,activatorEvent:J,collisions:eL,containerNodeRect:eh,dragOverlay:em,draggableNodes:W,droppableContainers:V,droppableRects:ea,over:eD,measureDroppableContainers:en,scrollableAncestors:ey,scrollableAncestorRects:ew,measuringConfiguration:er,measuringScheduled:es,windowRect:ev}),[Y,el,ed,J,eL,eh,em,W,V,ea,eD,en,ey,ew,er,es,ev]),eF=(0,L.useMemo)(()=>({activatorEvent:J,activators:eB,active:Y,activeNodeRect:ed,ariaDescribedById:{draggable:ee},dispatch:T,draggableNodes:W,over:eD,measureDroppableContainers:en}),[J,eB,Y,ed,T,ee,W,eD,en]);return L.default.createElement(tb.Provider,{value:P},L.default.createElement(rg.Provider,{value:eF},L.default.createElement(rb.Provider,{value:eO},L.default.createElement(rC.Provider,{value:eI},N)),L.default.createElement(rw,{disabled:(null==y?void 0:y.restoreFocus)===!1})),L.default.createElement(tw,{...y,hiddenTextDescribedById:ee}))}),rN=(0,L.createContext)(null),rS="button";function rM(){return(0,L.useContext)(rb)}let rE={timeout:25};function rL(e){let{animation:t,children:r}=e,[a,n]=(0,L.useState)(null),[s,l]=(0,L.useState)(null),o=ts(r);return r||a||!o||n(o),te(()=>{if(!s)return;let e=null==a?void 0:a.key,r=null==a?void 0:a.props.id;null==e||null==r?n(null):Promise.resolve(t(r,s)).then(()=>{n(null)})},[t,a,s]),L.default.createElement(L.default.Fragment,null,r,a?(0,L.cloneElement)(a,{ref:l}):null)}let rR={x:0,y:0,scaleX:1,scaleY:1};function rD(e){let{children:t}=e;return L.default.createElement(rg.Provider,{value:rp},L.default.createElement(rC.Provider,{value:rR},t))}let rA={position:"fixed",touchAction:"none"},rI=e=>th(e)?"transform 250ms ease":void 0,rT=(0,L.forwardRef)((e,t)=>{let{as:r,activatorEvent:a,adjustScale:n,children:s,className:l,rect:o,style:i,transform:c,transition:d=rI}=e;if(!o)return null;let h=n?c:{...c,scaleX:1,scaleY:1},u={...rA,width:o.width,height:o.height,top:o.top,left:o.left,transform:tx.Transform.toString(h),transformOrigin:n&&a?function(e,t){let r=tu(e);if(!r)return"0 0";let a={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return a.x+"% "+a.y+"%"}(a,o):void 0,transition:"function"==typeof d?d(a):d,...i};return L.default.createElement(r,{className:l,style:u,ref:t},s)}),rz={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:tx.Transform.toString(t)},{transform:tx.Transform.toString(r)}]},sideEffects:(t={styles:{active:{opacity:"0"}}},e=>{let{active:r,dragOverlay:a}=e,n={},{styles:s,className:l}=t;if(null!=s&&s.active)for(let[e,t]of Object.entries(s.active))void 0!==t&&(n[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=s&&s.dragOverlay)for(let[e,t]of Object.entries(s.dragOverlay))void 0!==t&&a.node.style.setProperty(e,t);return null!=l&&l.active&&r.node.classList.add(l.active),null!=l&&l.dragOverlay&&a.node.classList.add(l.dragOverlay),function(){for(let[e,t]of Object.entries(n))r.node.style.setProperty(e,t);null!=l&&l.active&&r.node.classList.remove(l.active)}})},rP=0,rB=L.default.memo(e=>{var t;let{adjustScale:r=!1,children:a,dropAnimation:n,style:s,transition:l,modifiers:o,wrapperElement:i="div",className:c,zIndex:d=999}=e,{activatorEvent:h,active:u,activeNodeRect:x,containerNodeRect:m,draggableNodes:f,droppableContainers:p,dragOverlay:g,over:b,measuringConfiguration:v,scrollableAncestors:y,scrollableAncestorRects:w,windowRect:j}=rM(),C=(0,L.useContext)(rC),k=(t=null==u?void 0:u.id,(0,L.useMemo)(()=>{if(null!=t)return++rP},[t])),N=rj(o,{activatorEvent:h,active:u,activeNodeRect:x,containerNodeRect:m,draggingNodeRect:g.rect,over:b,overlayNodeRect:g.rect,scrollableAncestors:y,scrollableAncestorRects:w,transform:C,windowRect:j}),S=rr(x),M=function(e){let{config:t,draggableNodes:r,droppableContainers:a,measuringConfiguration:n}=e;return tt((e,s)=>{if(null===t)return;let l=r.get(e);if(!l)return;let o=l.node.current;if(!o)return;let i=rd(s);if(!i)return;let{transform:c}=e5(s).getComputedStyle(s),d=tz(c);if(!d)return;let h="function"==typeof t?t:function(e){let{duration:t,easing:r,sideEffects:a,keyframes:n}={...rz,...e};return e=>{let{active:s,dragOverlay:l,transform:o,...i}=e;if(!t)return;let c={x:l.rect.left-s.rect.left,y:l.rect.top-s.rect.top},d={scaleX:1!==o.scaleX?s.rect.width*o.scaleX/l.rect.width:1,scaleY:1!==o.scaleY?s.rect.height*o.scaleY/l.rect.height:1},h={x:o.x-c.x,y:o.y-c.y,...d},u=n({...i,active:s,dragOverlay:l,transform:{initial:o,final:h}}),[x]=u,m=u[u.length-1];if(JSON.stringify(x)===JSON.stringify(m))return;let f=null==a?void 0:a({active:s,dragOverlay:l,...i}),p=l.node.animate(u,{duration:t,easing:r,fill:"forwards"});return new Promise(e=>{p.onfinish=()=>{null==f||f(),e()}})}}(t);return tX(o,n.draggable.measure),h({active:{id:e,data:l.data,node:o,rect:n.draggable.measure(o)},draggableNodes:r,dragOverlay:{node:s,rect:n.dragOverlay.measure(i)},droppableContainers:a,measuringConfiguration:n,transform:d})})}({config:n,draggableNodes:f,droppableContainers:p,measuringConfiguration:v}),E=S?g.setRef:void 0;return L.default.createElement(rD,null,L.default.createElement(rL,{animation:M},u&&k?L.default.createElement(rT,{key:k,id:u.id,ref:E,as:i,activatorEvent:h,adjustScale:r,className:c,transition:l,rect:S,style:{zIndex:d,...s},transform:N},a):null))});function rO(e,t,r){let a=e.slice();return a.splice(r<0?a.length+r:r,0,a.splice(t,1)[0]),a}function rF(e){return null!==e&&e>=0}let rH=e=>{let{rects:t,activeIndex:r,overIndex:a,index:n}=e,s=rO(t,a,r),l=t[n],o=s[n];return o&&l?{x:o.left-l.left,y:o.top-l.top,scaleX:o.width/l.width,scaleY:o.height/l.height}:null},r$="Sortable",rW=L.default.createContext({activeIndex:-1,containerId:r$,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:rH,disabled:{draggable:!1,droppable:!1}});function rU(e){let{children:t,id:r,items:a,strategy:n=rH,disabled:s=!1}=e,{active:l,dragOverlay:o,droppableRects:i,over:c,measureDroppableContainers:d}=rM(),h=to(r$,r),u=null!==o.rect,x=(0,L.useMemo)(()=>a.map(e=>"object"==typeof e&&"id"in e?e.id:e),[a]),m=null!=l,f=l?x.indexOf(l.id):-1,p=c?x.indexOf(c.id):-1,g=(0,L.useRef)(x),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(x,g.current),v=-1!==p&&-1===f||b,y="boolean"==typeof s?{draggable:s,droppable:s}:s;te(()=>{b&&m&&d(x)},[b,x,m,d]),(0,L.useEffect)(()=>{g.current=x},[x]);let w=(0,L.useMemo)(()=>({activeIndex:f,containerId:h,disabled:y,disableTransforms:v,items:x,overIndex:p,useDragOverlay:u,sortedRects:x.reduce((e,t,r)=>{let a=i.get(t);return a&&(e[r]=a),e},Array(x.length)),strategy:n}),[f,h,y.draggable,y.droppable,v,x,p,i,u,n]);return L.default.createElement(rW.Provider,{value:w},t)}let rV=e=>{let{id:t,items:r,activeIndex:a,overIndex:n}=e;return rO(r,a,n).indexOf(t)},r_=e=>{let{containerId:t,isSorting:r,wasDragging:a,index:n,items:s,newIndex:l,previousItems:o,previousContainerId:i,transition:c}=e;return!!c&&!!a&&(o===s||n!==l)&&(!!r||l!==n&&t===i)},rK={duration:200,easing:"ease"},rY="transform",rG=tx.Transition.toString({property:rY,duration:0,easing:"linear"}),rX={roleDescription:"sortable"};function rQ(e){if(!e)return!1;let t=e.data.current;return!!t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable}let rJ=[y.Down,y.Right,y.Up,y.Left],rq=(e,t)=>{let{context:{active:r,collisionRect:a,droppableRects:n,droppableContainers:s,over:l,scrollableAncestors:o}}=t;if(rJ.includes(e.code)){if(e.preventDefault(),!r||!a)return;let t=[];s.getEnabled().forEach(r=>{if(!r||null!=r&&r.disabled)return;let s=n.get(r.id);if(s)switch(e.code){case y.Down:a.top<s.top&&t.push(r);break;case y.Up:a.top>s.top&&t.push(r);break;case y.Left:a.left>s.left&&t.push(r);break;case y.Right:a.left<s.left&&t.push(r)}});let d=(e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e,n=tE(t),s=[];for(let e of a){let{id:t}=e,a=r.get(t);if(a){let r=tE(a),l=Number((n.reduce((e,t,a)=>e+tN(r[a],t),0)/4).toFixed(4));s.push({id:t,data:{droppableContainer:e,value:l}})}}return s.sort(tS)})({active:r,collisionRect:a,droppableRects:n,droppableContainers:t,pointerCoordinates:null}),h=tL(d,"id");if(h===(null==l?void 0:l.id)&&d.length>1&&(h=d[1].id),null!=h){let e=s.get(r.id),t=s.get(h),l=t?n.get(t.id):null,d=null==t?void 0:t.node.current;if(d&&l&&e&&t){var i,c;let r=tF(d).some((e,t)=>o[t]!==e),n=rZ(e,t),s=(i=e,c=t,!!rQ(i)&&!!rQ(c)&&!!rZ(i,c)&&i.data.current.sortable.index<c.data.current.sortable.index),h=r||!n?{x:0,y:0}:{x:s?a.width-l.width:0,y:s?a.height-l.height:0},u={x:l.left,y:l.top};return h.x&&h.y?u:td(u,h)}}}};function rZ(e,t){return!!rQ(e)&&!!rQ(t)&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}function r0({id:e,character:t,index:r}){let{attributes:a,listeners:n,setNodeRef:s,transform:l,transition:o,isDragging:i}=function(e){var t,r,a,n;let{animateLayoutChanges:s=r_,attributes:l,disabled:o,data:i,getNewIndex:c=rV,id:d,strategy:h,resizeObserverConfig:u,transition:x=rK}=e,{items:m,containerId:f,activeIndex:p,disabled:b,disableTransforms:v,sortedRects:y,overIndex:w,useDragOverlay:j,strategy:C}=(0,L.useContext)(rW),k=(t=o,r=b,"boolean"==typeof t?{draggable:t,droppable:!1}:{draggable:null!=(a=null==t?void 0:t.draggable)?a:r.draggable,droppable:null!=(n=null==t?void 0:t.droppable)?n:r.droppable}),N=m.indexOf(d),S=(0,L.useMemo)(()=>({sortable:{containerId:f,index:N,items:m},...i}),[f,i,N,m]),M=(0,L.useMemo)(()=>m.slice(m.indexOf(d)),[m,d]),{rect:E,node:R,isOver:D,setNodeRef:A}=function(e){let{data:t,disabled:r=!1,id:a,resizeObserverConfig:n}=e,s=to("Droppable"),{active:l,dispatch:o,over:i,measureDroppableContainers:c}=(0,L.useContext)(rg),d=(0,L.useRef)({disabled:r}),h=(0,L.useRef)(!1),u=(0,L.useRef)(null),x=(0,L.useRef)(null),{disabled:m,updateMeasurementsFor:f,timeout:p}={...rE,...n},b=tr(null!=f?f:a),v=ra({callback:(0,L.useCallback)(()=>{if(!h.current){h.current=!0;return}null!=x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{c(Array.isArray(b.current)?b.current:[b.current]),x.current=null},p)},[p]),disabled:m||!l}),[y,w]=tn((0,L.useCallback)((e,t)=>{v&&(t&&(v.unobserve(t),h.current=!1),e&&v.observe(e))},[v])),j=tr(t);return(0,L.useEffect)(()=>{v&&y.current&&(v.disconnect(),h.current=!1,v.observe(y.current))},[y,v]),(0,L.useEffect)(()=>(o({type:g.RegisterDroppable,element:{id:a,key:s,disabled:r,node:y,rect:u,data:j}}),()=>o({type:g.UnregisterDroppable,key:s,id:a})),[a]),(0,L.useEffect)(()=>{r!==d.current.disabled&&(o({type:g.SetDroppableDisabled,id:a,key:s,disabled:r}),d.current.disabled=r)},[a,s,r,o]),{active:l,rect:u,isOver:(null==i?void 0:i.id)===a,node:y,over:i,setNodeRef:w}}({id:d,data:S,disabled:k.droppable,resizeObserverConfig:{updateMeasurementsFor:M,...u}}),{active:I,activatorEvent:T,activeNodeRect:z,attributes:P,setNodeRef:B,listeners:O,isDragging:F,over:H,setActivatorNodeRef:$,transform:W}=function(e){let{id:t,data:r,disabled:a=!1,attributes:n}=e,s=to("Draggable"),{activators:l,activatorEvent:o,active:i,activeNodeRect:c,ariaDescribedById:d,draggableNodes:h,over:u}=(0,L.useContext)(rg),{role:x=rS,roleDescription:m="draggable",tabIndex:f=0}=null!=n?n:{},p=(null==i?void 0:i.id)===t,g=(0,L.useContext)(p?rC:rN),[b,v]=tn(),[y,w]=tn(),j=(0,L.useMemo)(()=>l.reduce((e,r)=>{let{eventName:a,handler:n}=r;return e[a]=e=>{n(e,t)},e},{}),[l,t]),C=tr(r);return te(()=>(h.set(t,{id:t,key:s,node:b,activatorNode:y,data:C}),()=>{let e=h.get(t);e&&e.key===s&&h.delete(t)}),[h,t]),{active:i,activatorEvent:o,activeNodeRect:c,attributes:(0,L.useMemo)(()=>({role:x,tabIndex:f,"aria-disabled":a,"aria-pressed":!!p&&x===rS||void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[a,x,f,p,m,d.draggable]),isDragging:p,listeners:a?void 0:j,node:b,over:u,setNodeRef:v,setActivatorNodeRef:w,transform:g}}({id:d,data:S,attributes:{...rX,...l},disabled:k.draggable}),U=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,L.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(A,B),V=!!I,_=V&&!v&&rF(p)&&rF(w),K=!j&&F,Y=K&&_?W:null,G=_?null!=Y?Y:(null!=h?h:C)({rects:y,activeNodeRect:z,activeIndex:p,overIndex:w,index:N}):null,X=rF(p)&&rF(w)?c({id:d,items:m,activeIndex:p,overIndex:w}):N,Q=null==I?void 0:I.id,J=(0,L.useRef)({activeId:Q,items:m,newIndex:X,containerId:f}),q=m!==J.current.items,Z=s({active:I,containerId:f,isDragging:F,isSorting:V,id:d,index:N,items:m,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:x,wasDragging:null!=J.current.activeId}),ee=function(e){let{disabled:t,index:r,node:a,rect:n}=e,[s,l]=(0,L.useState)(null),o=(0,L.useRef)(r);return te(()=>{if(!t&&r!==o.current&&a.current){let e=n.current;if(e){let t=tB(a.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&l(r)}}r!==o.current&&(o.current=r)},[t,r,a,n]),(0,L.useEffect)(()=>{s&&l(null)},[s]),s}({disabled:!Z,index:N,node:R,rect:E});return(0,L.useEffect)(()=>{V&&J.current.newIndex!==X&&(J.current.newIndex=X),f!==J.current.containerId&&(J.current.containerId=f),m!==J.current.items&&(J.current.items=m)},[V,X,f,m]),(0,L.useEffect)(()=>{if(Q===J.current.activeId)return;if(null!=Q&&null==J.current.activeId){J.current.activeId=Q;return}let e=setTimeout(()=>{J.current.activeId=Q},50);return()=>clearTimeout(e)},[Q]),{active:I,activeIndex:p,attributes:P,data:S,rect:E,index:N,newIndex:X,items:m,isOver:D,isSorting:V,isDragging:F,listeners:O,node:R,overIndex:w,over:H,setNodeRef:U,setActivatorNodeRef:$,setDroppableNodeRef:A,setDraggableNodeRef:B,transform:null!=ee?ee:G,transition:ee||q&&J.current.newIndex===N?rG:(!K||th(T))&&x&&(V||Z)?tx.Transition.toString({...x,property:rY}):void 0}}({id:e}),c={transform:tx.Transform.toString(l),transition:o};return(0,E.jsxs)("div",{ref:s,style:c,...a,...n,className:`
        p-1.5 rounded border-2 transition-all cursor-grab active:cursor-grabbing
        ${i?"border-retro-cyan bg-retro-cyan/20 opacity-50":"border-retro-grid/30 hover:border-retro-grid/50"}
      `,title:`Character ${r}`,children:[(0,E.jsx)(_.CharacterDisplay,{character:t,mode:"small",smallScale:3}),(0,E.jsx)("div",{className:"text-[8px] text-gray-500 text-center mt-0.5",children:r})]})}function r1({character:e}){return(0,E.jsx)("div",{className:"p-1.5 rounded border-2 border-retro-cyan bg-retro-navy shadow-lg",children:(0,E.jsx)(_.CharacterDisplay,{character:e,mode:"small",smallScale:3})})}function r2({isOpen:e,onClose:t,characters:r,onReorder:a}){let[n,s]=(0,L.useState)([]),[l,o]=(0,L.useState)(null);(0,L.useEffect)(()=>{e&&s([...r])},[e,r]);let i=(0,L.useMemo)(()=>n.map((e,t)=>`char-${t}`),[n]),c=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,L.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(tC(t9,{activationConstraint:{distance:8}}),tC(t3,{coordinateGetter:rq})),d=(0,L.useMemo)(()=>l&&n[parseInt(l.replace("char-",""),10)]||null,[l,n]),h=(0,L.useCallback)(e=>{o(e.active.id)},[]),u=(0,L.useCallback)(e=>{let{active:t,over:r}=e;if(o(null),r&&t.id!==r.id){let e=parseInt(t.id.replace("char-",""),10),a=parseInt(r.id.replace("char-",""),10);s(t=>rO(t,e,a))}},[]),x=(0,L.useCallback)(()=>{a(n),t()},[n,a,t]),m=(0,L.useMemo)(()=>n.length!==r.length||n.some((e,t)=>e!==r[t]),[n,r]);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,onConfirm:x,confirmOnEnter:!0,size:"3xl",maxHeight:"80vh",children:[(0,E.jsxs)(eA.ModalHeader,{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Reorder Characters"}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Drag and drop characters to reorder them"})]}),(0,E.jsx)(eA.ModalContent,{scrollable:!0,className:"p-4",children:(0,E.jsxs)(rk,{sensors:c,collisionDetection:tD,onDragStart:h,onDragEnd:u,children:[(0,E.jsx)(rU,{items:i,strategy:rH,children:(0,E.jsx)("div",{className:"grid gap-2 bg-black/30 rounded-lg p-3",style:{gridTemplateColumns:"repeat(auto-fill, minmax(50px, 1fr))"},children:n.map((e,t)=>(0,E.jsx)(r0,{id:i[t],character:e,index:t},i[t]))})}),(0,E.jsx)(rB,{children:d&&(0,E.jsx)(r1,{character:d})})]})}),(0,E.jsx)(eA.ModalActions,{onCancel:t,onConfirm:x,confirmDisabled:!m})]})}let r4=[{label:"0.25x",value:.25},{label:"0.5x",value:.5},{label:"0.75x",value:.75},{label:"1.5x",value:1.5},{label:"2x",value:2},{label:"3x",value:3},{label:"4x",value:4}],r3=[{id:"nearest",label:"Nearest Neighbor",description:"Fast, sharp edges"},{id:"threshold",label:"Threshold-based",description:"Smoother, considers pixel coverage"}];function r5({isOpen:e,onClose:t,onScale:r,characters:a,selectedIndices:n,config:s,foregroundColor:l="#ffffff",backgroundColor:o="#000000"}){let[i,c]=(0,L.useState)(2),[d,h]=(0,L.useState)("mc"),[u,x]=(0,L.useState)("nearest"),m=(0,L.useMemo)(()=>Array.from(n).slice(0,16).map(e=>a[e]).filter(e=>void 0!==e),[a,n]),f=(0,L.useMemo)(()=>m.map(e=>(0,ea.scaleCharacter)(e,i,d,u)),[m,i,d,u]),p=Math.max(0,n.size-16),g=(0,L.useCallback)(()=>{r(i,d,u),t()},[i,d,u,r,t]),b=Math.min(4,m.length);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,onConfirm:g,confirmOnEnter:!0,size:"lg",children:[(0,E.jsxs)(eA.ModalContent,{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Scale Characters"}),(0,E.jsx)("div",{className:"mb-6",children:(0,E.jsxs)("div",{className:"flex gap-4",children:[(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"Before"}),(0,E.jsx)("div",{className:"bg-retro-dark rounded border border-retro-grid/30 p-2 min-h-[80px] flex items-center justify-center",children:(0,E.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${b}, ${2*s.width}px)`},children:m.map((e,t)=>(0,E.jsx)(_.CharacterDisplay,{character:e,mode:"small",smallScale:2,foregroundColor:l,backgroundColor:o,interactive:!1},t))})}),p>0&&(0,E.jsxs)("p",{className:"text-[10px] text-gray-500 mt-1 text-center",children:["+",p," more"]})]}),(0,E.jsxs)("div",{className:"flex-1",children:[(0,E.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"After"}),(0,E.jsx)("div",{className:"bg-retro-dark rounded border border-retro-grid/30 p-2 min-h-[80px] flex items-center justify-center",children:(0,E.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${b}, ${2*s.width}px)`},children:f.map((e,t)=>(0,E.jsx)(_.CharacterDisplay,{character:e,mode:"small",smallScale:2,foregroundColor:l,backgroundColor:o,interactive:!1},t))})}),p>0&&(0,E.jsxs)("p",{className:"text-[10px] text-gray-500 mt-1 text-center",children:["+",p," more"]})]})]})}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Scale Factor"}),(0,E.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[r4.map(e=>(0,E.jsx)("button",{type:"button",onClick:()=>c(e.value),className:`
                  px-3 py-1.5 text-sm rounded border transition-all
                  ${i===e.value?"border-retro-pink bg-retro-pink/20 text-retro-pink":"border-retro-grid/50 bg-retro-dark text-gray-400 hover:border-retro-grid hover:text-white"}
                `,children:e.label},e.value)),(0,E.jsxs)("div",{className:"flex items-center gap-1.5 ml-2",children:[(0,E.jsx)("span",{className:"text-xs text-gray-500",children:"or"}),(0,E.jsx)("input",{type:"number",min:.1,max:10,step:.1,value:i,onChange:e=>{let t=parseFloat(e.target.value);!isNaN(t)&&t>0&&t<=10&&c(Math.round(100*t)/100)},className:"w-20 px-2 py-1.5 text-sm bg-retro-dark border border-retro-grid/50 rounded text-white text-center focus:outline-none focus:border-retro-pink"}),(0,E.jsx)("span",{className:"text-xs text-gray-500",children:"x"})]})]})]}),(0,E.jsx)("div",{className:"mb-4",children:(0,E.jsx)(eV,{value:d,onChange:h,description:"Select where to anchor content when scaling"})}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Algorithm"}),(0,E.jsx)("div",{className:"flex gap-2",children:r3.map(e=>(0,E.jsxs)("button",{type:"button",onClick:()=>x(e.id),className:`
                  flex-1 px-3 py-2 text-sm rounded border transition-all text-left
                  ${u===e.id?"border-retro-cyan bg-retro-cyan/20 text-retro-cyan":"border-retro-grid/50 bg-retro-dark text-gray-400 hover:border-retro-grid hover:text-white"}
                `,children:[(0,E.jsx)("div",{className:"font-medium",children:e.label}),(0,E.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]},e.id))})]}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mb-4 text-center h-4",children:i>1?"Content will be enlarged and clipped to fit":i<1?"Content will be reduced":"No scaling applied"})]}),(0,E.jsx)(eA.ModalActions,{onCancel:t,onConfirm:g,confirmDisabled:1===i||i<=0||i>10})]})}function r8({isOpen:e,onClose:t,totalCharacters:r,currentIndex:a,onGoTo:n}){let[s,l]=(0,L.useState)("");(0,L.useEffect)(()=>{e&&l("")},[e]);let o=(0,L.useMemo)(()=>(function(e){let t=e.trim().toLowerCase();if(!t)return null;if(t.startsWith("0x")){let e=parseInt(t.slice(2),16);return isNaN(e)?null:e}if(t.startsWith("$")){let e=parseInt(t.slice(1),16);return isNaN(e)?null:e}if(t.endsWith("h")){let e=parseInt(t.slice(0,-1),16);return isNaN(e)?null:e}let r=parseInt(t,10);return isNaN(r)?null:r})(s),[s]),i=null!==o&&o>=0&&o<r,c=(0,L.useCallback)(()=>{i&&null!==o&&(n(o),t())},[i,o,n,t]),d=null!==o&&ee(o),h=null!==o?Z(o):null;return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,onConfirm:c,confirmOnEnter:!0,size:"xs",children:[(0,E.jsxs)(eA.ModalContent,{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Go to Character"}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Character Index"}),(0,E.jsx)("input",{type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"e.g. 65, 0x41, $41",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan font-mono",autoFocus:!0}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter decimal (65) or hex (0x41, $41)"})]}),(0,E.jsxs)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30 min-h-[60px]",children:[null===o&&s&&(0,E.jsx)("p",{className:"text-xs text-red-400",children:"Invalid number format"}),null!==o&&!i&&(0,E.jsxs)("p",{className:"text-xs text-red-400",children:["Index out of range (0-",r-1,")"]}),i&&null!==o&&(0,E.jsxs)("div",{className:"space-y-1",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-xs text-gray-400",children:"Decimal:"}),(0,E.jsx)("span",{className:"text-sm text-retro-cyan font-mono",children:o})]}),(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-xs text-gray-400",children:"Hex:"}),(0,E.jsxs)("span",{className:"text-sm text-retro-cyan font-mono",children:["0x",o.toString(16).toUpperCase().padStart(2,"0")]})]}),d&&(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-xs text-gray-400",children:"ASCII:"}),(0,E.jsxs)("span",{className:"text-sm text-retro-pink font-mono",children:["'",String.fromCharCode(o),"'"]})]}),h&&(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-xs text-gray-400",children:"Control:"}),(0,E.jsxs)("span",{className:"text-sm text-retro-pink",children:[h.abbr," (",h.name,")"]})]})]}),!s&&(0,E.jsxs)("p",{className:"text-xs text-gray-500",children:["Current: ",a," (0x",a.toString(16).toUpperCase().padStart(2,"0"),")"]})]})]}),(0,E.jsx)(eA.ModalActions,{onCancel:t,onConfirm:c,confirmLabel:"Go",confirmDisabled:!i})]})}function r6({character:e,index:t,isSelected:r,onClick:a,foregroundColor:n,backgroundColor:s}){let l=e.pixels.length,o=e.pixels[0]?.length||0,i=ee(t),c=Z(t),d=(0,L.useMemo)(()=>{let e=[`#${t}`,`0x${t.toString(16).toUpperCase().padStart(2,"0")}`];return i?e.push(`'${String.fromCharCode(t)}'`):c&&e.push(`${c.abbr} (${c.name})`),e.join(" | ")},[t,i,c]);return(0,E.jsxs)("button",{onClick:a,className:`
        relative p-0.5 rounded transition-all
        hover:bg-retro-cyan/20 hover:ring-1 hover:ring-retro-cyan/50
        ${r?"bg-retro-cyan/30 ring-2 ring-retro-cyan":""}
      `,title:d,children:[(0,E.jsx)("div",{className:"grid",style:{gridTemplateColumns:`repeat(${o}, 2px)`,gridTemplateRows:`repeat(${l}, 2px)`,width:2*o,height:2*l},children:e.pixels.flat().map((e,t)=>(0,E.jsx)("div",{style:{backgroundColor:e?n:s,width:2,height:2}},t))}),(0,E.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-[6px] font-mono text-white opacity-0 hover:opacity-100 bg-black/60 rounded",children:t.toString(16).toUpperCase().padStart(2,"0")})]})}function r7({isOpen:e,onClose:t,characters:r,selectedIndex:a,onSelect:n,foregroundColor:s="#ffffff",backgroundColor:l="#000000"}){let o=(0,L.useCallback)(e=>{n(e),t()},[n,t]),i=Math.ceil(r.length/16);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,size:"2xl",maxHeight:"90vh",children:[(0,E.jsxs)(eA.ModalHeader,{onClose:t,showCloseButton:!0,children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Character Map"}),(0,E.jsxs)("p",{className:"text-xs text-gray-400",children:[r.length," characters â€¢ Click to select â€¢ Hover for details"]})]}),(0,E.jsxs)("div",{className:"flex px-4 pt-4 pb-0 gap-1",children:[(0,E.jsx)("div",{className:"w-8"})," ",(0,E.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:16}).map((e,t)=>(0,E.jsx)("div",{className:"w-[18px] text-center text-[8px] font-mono text-gray-500",children:t.toString(16).toUpperCase()},t))})]}),(0,E.jsx)(eA.ModalContent,{scrollable:!0,className:"p-4 pt-2",children:(0,E.jsx)("div",{className:"flex flex-col gap-0.5",children:Array.from({length:i}).map((e,t)=>{let n=16*t;return(0,E.jsxs)("div",{className:"flex gap-1",children:[(0,E.jsx)("div",{className:"w-8 flex items-center justify-end pr-1 text-[9px] font-mono text-gray-500",children:(16*t).toString(16).toUpperCase().padStart(2,"0")}),(0,E.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:16}).map((e,t)=>{let i=n+t;return i>=r.length?(0,E.jsx)("div",{className:"w-[18px] h-[18px] bg-retro-dark/30 rounded"},t):(0,E.jsx)(r6,{character:r[i],index:i,isSelected:i===a,onClick:()=>o(i),foregroundColor:s,backgroundColor:l},t)})})]},t)})})}),(0,E.jsxs)(eA.ModalFooter,{className:"flex items-center justify-between text-xs text-gray-400",children:[(0,E.jsxs)("div",{className:"flex items-center gap-4",children:[(0,E.jsxs)("span",{className:"flex items-center gap-1",children:[(0,E.jsx)("span",{className:"w-3 h-3 rounded bg-retro-cyan/30 ring-1 ring-retro-cyan"}),(0,E.jsx)("span",{children:"Selected"})]}),(0,E.jsxs)("span",{children:["Current: #",a," (0x",a.toString(16).toUpperCase().padStart(2,"0"),")",ee(a)&&(0,E.jsxs)("span",{className:"ml-1 text-retro-pink",children:["'",String.fromCharCode(a),"'"]})]})]}),(0,E.jsx)("span",{className:"font-mono",children:"Press M to toggle"})]})]})}function r9({settings:e,foregroundColor:t="#ffffff",children:r,className:a=""}){let n=(0,L.useMemo)(()=>{let t=["crt-container"];return e.scanlines&&t.push("crt-scanlines"),e.bloom&&t.push("crt-bloom"),"pal"===e.pixelAspectRatio?t.push("crt-pal"):"ntsc"===e.pixelAspectRatio&&t.push("crt-ntsc"),t.join(" ")},[e]),s=(0,L.useMemo)(()=>{let r={};return e.scanlines&&(r["--crt-scanlines-opacity"]=String(e.scanlinesIntensity/100*.5)),e.bloom&&(r["--crt-bloom-color"]=t),r},[e.scanlines,e.scanlinesIntensity,e.bloom,t]);return(0,E.jsx)("div",{className:`${n} ${a}`,style:s,children:(0,E.jsx)("div",{style:{...e.bloom?{overflow:"hidden"}:{}},children:r})})}r9.displayName="CRTEffectsOverlay";var ae=e.i(30717),at=e.i(60951);let ar={scanlines:!1,scanlinesIntensity:50,bloom:!0,bloomIntensity:40,pixelAspectRatio:"none"},aa=[{value:"none",label:"Square (1:1)"},{value:"pal",label:"PAL (1.09:1)"},{value:"ntsc",label:"NTSC (0.93:1)"}];function an({settings:e,onChange:t,defaultCollapsed:r=!0,className:a=""}){let[n,s]=(0,L.useState)(r),l=(0,L.useCallback)(()=>{s(e=>!e)},[]),o=(0,L.useCallback)((r,a)=>{t({...e,[r]:a})},[e,t]);return(0,E.jsxs)("div",{className:`border border-retro-grid/30 rounded bg-retro-dark/50 ${a}`,children:[(0,E.jsxs)("button",{onClick:l,className:"w-full flex items-center justify-between p-2 text-sm text-gray-300 hover:text-retro-cyan transition-colors","aria-expanded":!n,children:[(0,E.jsx)("span",{className:"font-medium",children:"CRT Effects"}),(0,E.jsx)("svg",{className:`w-4 h-4 transition-transform ${n?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!n&&(0,E.jsxs)("div",{className:"p-3 pt-1 space-y-4 border-t border-retro-grid/30",children:[(0,E.jsxs)("div",{className:"space-y-2",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsx)("label",{className:"text-xs text-gray-400",children:"Scanlines"}),(0,E.jsx)(eI.ToggleSwitch,{checked:e.scanlines,onChange:e=>o("scanlines",e)})]}),e.scanlines&&(0,E.jsxs)("div",{className:"space-y-1",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("label",{className:"text-[10px] text-gray-500",children:"Intensity"}),e.scanlinesIntensity!==ar.scanlinesIntensity&&(0,E.jsx)("button",{onClick:()=>o("scanlinesIntensity",ar.scanlinesIntensity),className:"text-[10px] text-retro-cyan hover:text-retro-pink",children:"Reset"})]}),(0,E.jsx)("input",{type:"range",min:"0",max:"100",value:e.scanlinesIntensity,onChange:e=>o("scanlinesIntensity",Number(e.target.value)),className:"w-full h-1.5 accent-retro-cyan"})]})]}),(0,E.jsxs)("div",{className:"space-y-2",children:[(0,E.jsxs)("div",{className:"flex items-center justify-between",children:[(0,E.jsx)("label",{className:"text-xs text-gray-400",children:"Bloom / Glow"}),(0,E.jsx)(eI.ToggleSwitch,{checked:e.bloom,onChange:e=>o("bloom",e)})]}),e.bloom&&(0,E.jsxs)("div",{className:"space-y-1",children:[(0,E.jsxs)("div",{className:"flex justify-between items-center",children:[(0,E.jsx)("label",{className:"text-[10px] text-gray-500",children:"Intensity"}),e.bloomIntensity!==ar.bloomIntensity&&(0,E.jsx)("button",{onClick:()=>o("bloomIntensity",ar.bloomIntensity),className:"text-[10px] text-retro-cyan hover:text-retro-pink",children:"Reset"})]}),(0,E.jsx)("input",{type:"range",min:"0",max:"100",value:e.bloomIntensity,onChange:e=>o("bloomIntensity",Number(e.target.value)),className:"w-full h-1.5 accent-retro-cyan"})]})]}),(0,E.jsxs)("div",{className:"space-y-1",children:[(0,E.jsx)("label",{className:"text-xs text-gray-400",children:"Pixel Aspect Ratio"}),(0,E.jsx)(ae.SingleSelectDropdown,{options:aa,value:e.pixelAspectRatio,onChange:e=>o("pixelAspectRatio",e),ariaLabel:"Select pixel aspect ratio"})]})]})]})}an.displayName="CRTEffectsPanel";let as=[{label:"Quick Fox",text:"The quick brown fox jumps over the lazy dog."},{label:"Hello World",text:"HELLO WORLD!\nHello World!\nhello world!"},{label:"Numbers",text:"0123456789\nABCDEF abcdef"},{label:"Symbols",text:"!@#$%^&*()_+-=[]{}\\|;':\",./<>?"},{label:"ASCII Art",text:"+------------------+\n|  RETRO COMPUTER  |\n+------------------+"}],al=[{value:1,label:"1x"},{value:2,label:"2x"},{value:3,label:"3x"},{value:4,label:"4x"}];function ao({character:e,scale:t,foregroundColor:r,backgroundColor:a,bloomIntensity:n=0}){let s=(0,L.useRef)(null);return((0,L.useEffect)(()=>{let l=s.current;if(!l||!e)return;let o=l.getContext("2d");if(!o)return;let i=e.pixels[0]?.length||8,c=e.pixels.length;l.width=i*t,l.height=c*t,o.fillStyle=a,o.fillRect(0,0,l.width,l.height),n>0&&(o.shadowColor=r,o.shadowBlur=n/100*t*2),o.fillStyle=r;for(let r=0;r<c;r++)for(let a=0;a<i;a++)e.pixels[r]?.[a]&&o.fillRect(a*t,r*t,t,t)},[e,t,r,a,n]),e)?(0,E.jsx)("canvas",{ref:s,className:"block"}):(0,E.jsx)("div",{style:{width:8*t,height:8*t,backgroundColor:a}})}function ai({isOpen:e,onClose:t,characters:r,config:a,colors:n}){let[s,l]=(0,L.useState)(""),[o,i]=(0,L.useState)(2),[c,d]=(0,L.useState)(n),[h,u]=(0,L.useState)(()=>(function(){try{let e=localStorage.getItem(at.CHARACTER_EDITOR_STORAGE_KEY_CRT_SETTINGS);if(e){let t=JSON.parse(e);return{...ar,...t}}}catch{}return{...ar}})()),x=(0,L.useRef)(null),m=(0,L.useCallback)(e=>{u(e);try{localStorage.setItem(at.CHARACTER_EDITOR_STORAGE_KEY_CRT_SETTINGS,JSON.stringify(e))}catch{}},[]),f=(0,L.useMemo)(()=>(function(e){let t=[];for(let r=0;r<e;r+=16){let a="";for(let t=r;t<Math.min(r+16,e);t++)a+=String.fromCharCode(t);t.push(a)}return t.join("\n")})(r.length),[r.length]);(0,L.useEffect)(()=>{e&&l(f)},[e,f]),(0,L.useEffect)(()=>{d(n)},[n]),(0,L.useEffect)(()=>{e&&x.current&&x.current.focus()},[e]);let p=(0,L.useMemo)(()=>s.split("\n").map(e=>{let t=[];for(let a of e){let e=a.charCodeAt(0);e>=0&&e<r.length?t.push(r[e]):t.push(r[0]||null)}return t}),[s,r]);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,size:"4xl",maxHeight:"90vh",children:[(0,E.jsx)(eA.ModalHeader,{onClose:t,showCloseButton:!0,children:(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Text Preview"})}),(0,E.jsx)(eA.ModalContent,{scrollable:!0,className:"p-4",children:(0,E.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,E.jsxs)("div",{className:"space-y-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Enter text to preview"}),(0,E.jsx)("textarea",{ref:x,value:s,onChange:e=>l(e.target.value),rows:6,className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white font-mono placeholder-gray-500 focus:outline-none focus:border-retro-cyan resize-none",placeholder:"Type your text here..."})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Sample texts"}),(0,E.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,E.jsx)("button",{onClick:()=>l(f),className:"px-2 py-1 text-xs bg-retro-dark border border-retro-pink/30 rounded text-retro-pink/70 hover:text-retro-pink hover:border-retro-pink/50 transition-colors",title:`Show all ${r.length} characters`,children:"All Characters"}),as.map(e=>(0,E.jsx)("button",{onClick:()=>l(e.text),className:"px-2 py-1 text-xs bg-retro-dark border border-retro-grid/30 rounded text-gray-400 hover:text-retro-cyan hover:border-retro-cyan/50 transition-colors",children:e.label},e.label))]})]}),(0,E.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Scale"}),(0,E.jsx)("div",{className:"flex gap-1",children:al.map(e=>(0,E.jsx)("button",{onClick:()=>i(e.value),className:`px-3 py-1 text-xs rounded transition-colors ${o===e.value?"bg-retro-cyan/20 border border-retro-cyan text-retro-cyan":"bg-retro-dark border border-retro-grid/30 text-gray-400 hover:text-white"}`,children:e.label},e.value))})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Character Set"}),(0,E.jsxs)("div",{className:"text-xs text-gray-500",children:[a.width,"x",a.height," pixels, ",r.length," chars"]})]})]}),(0,E.jsx)(an,{settings:h,onChange:m,defaultCollapsed:!0})]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Preview"}),(0,E.jsx)(r9,{settings:h,foregroundColor:c.foreground,className:"rounded border border-retro-grid/30 overflow-auto max-h-[500px]",children:(0,E.jsx)("div",{className:"p-4",style:{backgroundColor:c.background},children:0===p.length||1===p.length&&0===p[0].length?(0,E.jsx)("div",{className:"text-xs text-gray-500 italic",children:"Type something to see the preview..."}):(0,E.jsx)("div",{className:"space-y-0",children:p.map((e,t)=>(0,E.jsx)("div",{className:"flex flex-wrap",style:{minHeight:a.height*o},children:0===e.length?(0,E.jsx)("div",{style:{height:a.height*o,width:a.width*o}}):e.map((e,t)=>(0,E.jsx)(ao,{character:e,scale:o,foregroundColor:c.foreground,backgroundColor:c.background,bloomIntensity:h.bloom?h.bloomIntensity:0},t))},t))})})}),(0,E.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[s.length," characters, ",p.length," lines"]})]})]})}),(0,E.jsxs)(eA.ModalFooter,{className:"flex items-center justify-between gap-3",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-sm text-gray-400",children:"Colors:"}),(0,E.jsx)(J.ColorPresetSelector,{colors:c,onColorsChange:d,dropUp:!0})]}),(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)("button",{onClick:()=>l(""),className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Clear"}),(0,E.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors",children:"Close"})]})]})]})}var ac=e.i(59544),ad=e.i(98603),ah=e.i(20446);function au({character:e,comparisonCharacter:t,scale:r=2,foregroundColor:a="#ffffff",backgroundColor:n="#000000",diffColor:s="#ff3333",showDiffBorder:l=!0,index:o,className:i=""}){let c=(0,L.useMemo)(()=>t?(0,eX.findDifferingPixels)(e,t):new Set,[e,t]),d=c.size>0,h=(0,L.useMemo)(()=>l&&d?"ring-1 ring-amber-500/70":"",[l,d]);return(0,E.jsx)("div",{className:`relative inline-block ${h} ${i}`,"aria-label":void 0!==o?`Character ${o}${d?" (changed)":""}`:`Character${d?" (changed)":""}`,children:(0,E.jsx)(ah.PixelGrid,{pixels:e.pixels,scale:r,showGrid:!1,foregroundColor:a,backgroundColor:n,diffPixels:c,diffColor:s,interactive:!1})})}function ax({character:e,comparisonCharacter:t,index:r,isSelected:a,isSelectionMode:n,onClick:s,onLongPress:l,scale:o=3,foregroundColor:i,backgroundColor:c}){let d=(0,L.useMemo)(()=>!!t&&!(0,eX.areCharactersEqual)(e,t),[e,t]),h=(0,L.useCallback)(e=>{s(r,e.shiftKey,e.metaKey||e.ctrlKey)},[r,s]),u=(0,L.useCallback)(()=>{l?.(r)},[r,l]),x=(0,eQ.useLongPress)({onLongPress:u,disabled:!l}),m=(0,L.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),s(r,e.shiftKey,e.metaKey||e.ctrlKey))},[r,s]),f=(0,L.useMemo)(()=>a?"ring-2 ring-retro-cyan ring-offset-1 ring-offset-retro-dark":"",[a]);return(0,E.jsxs)("div",{onClick:h,onKeyDown:m,onMouseDown:x.onMouseDown,onMouseUp:x.onMouseUp,onMouseLeave:x.onMouseLeave,onTouchStart:x.onTouchStart,onTouchEnd:x.onTouchEnd,onTouchMove:x.onTouchMove,role:"option","aria-selected":a,tabIndex:0,"data-grid-index":r,"data-has-changes":d,className:`
        focus:outline-none focus-visible:ring-1 focus-visible:ring-retro-cyan
        rounded relative touch-manipulation cursor-pointer
        hover:opacity-80 transition-opacity
        ${f}
      `,style:{touchAction:"manipulation"},children:[(0,E.jsx)(au,{character:e,comparisonCharacter:t,scale:o,foregroundColor:i,backgroundColor:c,showDiffBorder:d,index:r}),n&&a&&(0,E.jsx)("div",{className:"absolute top-0 right-0 w-3 h-3 bg-retro-cyan rounded-bl flex items-center justify-center",children:(0,E.jsx)("svg",{className:"w-2 h-2 text-retro-dark",fill:"currentColor",viewBox:"0 0 20 20",children:(0,E.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),d&&(0,E.jsx)("div",{className:"absolute -bottom-0.5 -left-0.5 w-2 h-2 bg-amber-500 rounded-full",title:"Character has changes"})]})}function am({isOpen:e,onClose:t,snapshots:r,loading:a,error:n,isAtCapacity:s,maxSnapshots:l,currentCharacters:o,currentConfig:i,foregroundColor:c,backgroundColor:d,onSave:h,onRestore:u,onDelete:x,onRename:m,onRestoreApply:f}){let[p,g]=(0,L.useState)(""),[b,v]=(0,L.useState)(!1),[y,w]=(0,L.useState)(null),[j,C]=(0,L.useState)(null),[k,N]=(0,L.useState)(null),[S,M]=(0,L.useState)(""),[R,D]=(0,L.useState)(null),[A,I]=(0,L.useState)("list"),[T,z]=(0,L.useState)(new Set),[P,B]=(0,L.useState)(!1),[O,F]=(0,L.useState)(null),H=(0,L.useRef)(null);(0,L.useEffect)(()=>{if(e){let e=new Date().toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});g(`Snapshot - ${e}`),w(null),C(null),N(null),D(null),I("list"),z(new Set),B(!1),F(null)}},[e]);let $=(0,L.useMemo)(()=>j?(0,eX.findChangedCharacterIndices)(j,o):new Set,[j,o]),W=(0,L.useCallback)(async()=>{if(!p.trim())return;v(!0);let e=await h(p.trim());if(v(!1),e){let e=new Date().toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});g(`Snapshot - ${e}`)}},[p,h]),U=(0,L.useCallback)(async e=>{if(y===e){w(null),C(null);return}w(e);let t=await u(e);t&&C(t)},[y,u]),V=(0,L.useCallback)(()=>{j&&(z(new Set(j.map((e,t)=>t))),B(!0),I("select-chars"))},[j]),_=(0,L.useCallback)(()=>{I("list"),z(new Set),B(!1),F(null)},[]),K=(0,L.useCallback)(()=>{if(j&&y&&T.size>0){let e=r.find(e=>e.id===y);f(j,T,e?.name),t()}},[j,y,T,r,f,t]),Y=(0,L.useCallback)((e,t,r)=>{z(r=>{let a=new Set(r);if(t&&null!==O){let t=Math.min(O,e),r=Math.max(O,e);for(let e=t;e<=r;e++)a.add(e)}else a.has(e)?a.delete(e):a.add(e);return a}),F(e)},[O,P]),G=(0,L.useCallback)(e=>{B(!0),z(t=>{let r=new Set(t);return r.add(e),r})},[]),Q=(0,L.useCallback)(()=>{j&&z(new Set(j.map((e,t)=>t)))},[j]),J=(0,L.useCallback)(()=>{z(new Set)},[]),q=(0,L.useCallback)(()=>{B(!1)},[]),Z=(0,L.useCallback)((e,t)=>{let r=document.elementFromPoint(e,t);if(!r)return null;let a=r.closest("[data-grid-index]");if(!a)return null;let n=a.getAttribute("data-grid-index");return n?parseInt(n,10):null},[]),ee=(0,L.useCallback)(e=>{z(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),et=(0,eJ.useDragSelect)({enabled:P,onItemTouched:ee,getIndexFromPoint:Z}),er=(0,L.useCallback)(async e=>{await x(e),y===e&&(w(null),C(null)),D(null)},[x,y]),ea=(0,L.useCallback)(e=>{N(e.id),M(e.name)},[]),en=(0,L.useCallback)(async()=>{k&&S.trim()&&await m(k,S.trim()),N(null),M("")},[k,S,m]);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,size:"4xl",maxHeight:"90vh",children:[(0,E.jsx)(eA.ModalHeader,{onClose:"list"===A?t:_,showCloseButton:!0,children:(0,E.jsxs)("div",{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"list"===A?"Snapshots":"Select Characters"}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"list"===A?`Save and restore character set states (${r.length}/${l})`:`Choose which characters to restore from "${r.find(e=>e.id===y)?.name||"snapshot"}"`})]})}),(0,E.jsx)(eA.ModalContent,{className:"p-0 flex-1 overflow-hidden flex flex-col",children:"list"===A?(0,E.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[(0,E.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 border-r border-retro-grid/30",children:[(0,E.jsxs)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30",children:[(0,E.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Create New Snapshot"}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),placeholder:"Snapshot name",className:"flex-1 px-2 py-1.5 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",onKeyDown:e=>{"Enter"===e.key&&p.trim()&&!s&&W()}}),(0,E.jsx)(ac.Button,{onClick:W,disabled:!p.trim()||b||s||!!n,variant:"cyan",size:"sm",children:b?"Saving...":"Save"})]}),s&&(0,E.jsx)("p",{className:"text-xs text-orange-400 mt-1",children:"Maximum snapshots reached. Delete one to save a new one."})]}),n?(0,E.jsxs)("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded text-center",children:[(0,E.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,E.jsx)("p",{className:"text-sm text-red-400 mb-1",children:"Failed to load snapshots"}),(0,E.jsx)("p",{className:"text-xs text-gray-500",children:n})]}):a?(0,E.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,E.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"})}):0===r.length?(0,E.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,E.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),(0,E.jsx)("p",{className:"text-sm",children:"No snapshots yet"}),(0,E.jsx)("p",{className:"text-xs mt-1",children:"Create one to save your progress"})]}):(0,E.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,E.jsx)("div",{className:`p-3 rounded border transition-colors cursor-pointer ${y===e.id?"bg-retro-cyan/10 border-retro-cyan":"bg-retro-dark/30 border-retro-grid/30 hover:border-retro-grid/50"}`,onClick:()=>U(e.id),children:(0,E.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[k===e.id?(0,E.jsx)("input",{type:"text",value:S,onChange:e=>M(e.target.value),className:"w-full px-2 py-1 bg-retro-dark border border-retro-cyan rounded text-sm text-white focus:outline-none",autoFocus:!0,onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key?en():"Escape"===e.key&&N(null)},onBlur:en}):(0,E.jsx)("h3",{className:"text-sm text-white font-medium truncate",children:e.name}),(0,E.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,E.jsx)("span",{className:"text-xs text-gray-500",children:(0,eX.formatTimestamp)(e.createdAt)}),(0,E.jsx)("span",{className:"text-xs text-gray-600",children:"|"}),(0,E.jsxs)("span",{className:"text-xs text-gray-500",children:[e.characterCount," chars"]}),(0,E.jsx)("span",{className:"text-xs text-gray-600",children:"|"}),(0,E.jsxs)("span",{className:"text-xs text-gray-500",children:[e.config.width,"x",e.config.height]})]})]}),(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)("button",{onClick:t=>{t.stopPropagation(),ea(e)},className:"p-1 text-gray-500 hover:text-white transition-colors",title:"Rename",children:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),R===e.id?(0,E.jsxs)("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),children:[(0,E.jsx)("button",{onClick:()=>er(e.id),className:"px-2 py-0.5 text-xs bg-red-500/20 border border-red-500 rounded text-red-400 hover:bg-red-500/30",children:"Delete"}),(0,E.jsx)("button",{onClick:()=>D(null),className:"px-2 py-0.5 text-xs border border-retro-grid/50 rounded text-gray-400 hover:text-white",children:"Cancel"})]}):(0,E.jsx)("button",{onClick:t=>{t.stopPropagation(),D(e.id)},className:"p-1 text-gray-500 hover:text-red-400 transition-colors",title:"Delete",children:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},e.id))})]}),(0,E.jsxs)("div",{className:"w-full md:w-72 p-4 bg-retro-dark/30 flex flex-col",children:[(0,E.jsx)("h3",{className:"text-sm font-medium text-gray-400 mb-3",children:"Preview"}),y&&j?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:"flex-1 overflow-auto bg-retro-dark rounded border border-retro-grid/30 p-2 mb-3",children:[(0,E.jsx)(ad.CharacterPreviewGrid,{characters:j.slice(0,64),config:i,foregroundColor:c,backgroundColor:d,smallScale:2,maxCharacters:64}),j.length>64&&(0,E.jsxs)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:["+",j.length-64," more characters"]})]}),(0,E.jsx)("div",{className:"flex gap-2",children:(0,E.jsx)(ac.Button,{onClick:V,variant:"cyan",size:"sm",className:"flex-1",children:"Restore This Snapshot"})}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Click to select characters to restore"})]}):(0,E.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsxs)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),(0,E.jsx)("p",{className:"text-sm",children:"Select a snapshot to preview"})]})})]})]}):(0,E.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:[(0,E.jsxs)("div",{className:"p-4 border-b border-retro-grid/30 flex items-center justify-between",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("h3",{className:"text-sm font-medium text-white",children:"Select Characters to Restore"}),(0,E.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:[T.size," of ",j?.length||0," selected",$.size>0&&(0,E.jsxs)("span",{className:"ml-2 text-amber-500",children:["(",$.size," changed)"]})]})]}),(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("button",{onClick:Q,className:"px-2 py-1 text-xs text-gray-400 hover:text-retro-cyan transition-colors",children:"Select All"}),(0,E.jsx)("button",{onClick:J,className:"px-2 py-1 text-xs text-gray-400 hover:text-retro-pink transition-colors",children:"Select None"})]})]}),(0,E.jsx)("div",{ref:H,className:"flex-1 overflow-auto p-4",onTouchStart:et.onTouchStart,onTouchMove:et.onTouchMove,onTouchEnd:et.onTouchEnd,onMouseDown:et.onMouseDown,onMouseMove:et.onMouseMove,onMouseUp:et.onMouseUp,onClickCapture:et.onClickCapture,children:(0,E.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${3*i.width+8}px, max-content))`},children:j?.map((e,t)=>(0,E.jsx)(ax,{character:e,comparisonCharacter:o[t],index:t,isSelected:T.has(t),isSelectionMode:P,onClick:Y,onLongPress:G,scale:3,foregroundColor:c,backgroundColor:d},t))})}),(0,E.jsxs)("div",{className:"p-4 border-t border-retro-grid/30 flex items-center justify-between bg-retro-dark/50",children:[(0,E.jsx)(ac.Button,{onClick:_,variant:"ghost",size:"sm",children:"Back"}),(0,E.jsxs)(ac.Button,{onClick:K,variant:"cyan",size:"sm",disabled:0===T.size,children:["Restore ",T.size," Character",1!==T.size?"s":""]})]}),(0,E.jsx)(X,{isVisible:P,selectionCount:T.size,totalItems:j?.length||0,onSelectAll:Q,onClearSelection:J,onExitMode:q,fixed:!1})]})}),"list"===A&&(0,E.jsx)(eA.ModalFooter,{className:"bg-retro-dark/30",children:(0,E.jsxs)("div",{className:"flex items-center gap-4",children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("h4",{className:"text-xs text-gray-400 mb-1",children:"Current State"}),(0,E.jsx)(ad.CharacterPreviewGrid,{characters:o.slice(0,16),config:i,foregroundColor:c,backgroundColor:d,smallScale:2,maxCharacters:16})]}),(0,E.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,E.jsxs)("p",{children:[o.length," characters"]}),(0,E.jsxs)("p",{children:[i.width,"x",i.height," px"]})]})]})})]})}var af=Object.defineProperty,ap=Object.getOwnPropertySymbols,ag=Object.prototype.hasOwnProperty,ab=Object.prototype.propertyIsEnumerable,av=(e,t,r)=>t in e?af(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ay=(e,t)=>{for(var r in t||(t={}))ag.call(t,r)&&av(e,r,t[r]);if(ap)for(var r of ap(t))ab.call(t,r)&&av(e,r,t[r]);return e},aw=(e,t)=>{var r={};for(var a in e)ag.call(e,a)&&0>t.indexOf(a)&&(r[a]=e[a]);if(null!=e&&ap)for(var a of ap(e))0>t.indexOf(a)&&ab.call(e,a)&&(r[a]=e[a]);return r};(e=>{let t=class t{constructor(e,r,a,s){if(this.version=e,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version value out of range");if(s<-1||s>7)throw RangeError("Mask value out of range");this.size=4*e+17;let l=[];for(let e=0;e<this.size;e++)l.push(!1);for(let e=0;e<this.size;e++)this.modules.push(l.slice()),this.isFunction.push(l.slice());this.drawFunctionPatterns();const o=this.addEccAndInterleave(a);if(this.drawCodewords(o),-1==s){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const r=this.getPenaltyScore();r<e&&(s=t,e=r),this.applyMask(t)}}n(0<=s&&s<=7),this.mask=s,this.applyMask(s),this.drawFormatBits(s),this.isFunction=[]}static encodeText(r,a){let n=e.QrSegment.makeSegments(r);return t.encodeSegments(n,a)}static encodeBinary(r,a){let n=e.QrSegment.makeBytes(r);return t.encodeSegments([n],a)}static encodeSegments(e,a,s=1,o=40,i=-1,c=!0){let d,h;if(!(t.MIN_VERSION<=s&&s<=o&&o<=t.MAX_VERSION)||i<-1||i>7)throw RangeError("Invalid value");for(d=s;;d++){let r=8*t.getNumDataCodewords(d,a),n=l.getTotalBits(e,d);if(n<=r){h=n;break}if(d>=o)throw RangeError("Data too long")}for(let e of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])c&&h<=8*t.getNumDataCodewords(d,e)&&(a=e);let u=[];for(let t of e)for(let e of(r(t.mode.modeBits,4,u),r(t.numChars,t.mode.numCharCountBits(d),u),t.getData()))u.push(e);n(u.length==h);let x=8*t.getNumDataCodewords(d,a);n(u.length<=x),r(0,Math.min(4,x-u.length),u),r(0,(8-u.length%8)%8,u),n(u.length%8==0);for(let e=236;u.length<x;e^=253)r(e,8,u);let m=[];for(;8*m.length<u.length;)m.push(0);return u.forEach((e,t)=>m[t>>>3]|=e<<7-(7&t)),new t(d,a,m,i)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let e=this.getAlignmentPatternPositions(),t=e.length;for(let r=0;r<t;r++)for(let a=0;a<t;a++)(0!=r||0!=a)&&(0!=r||a!=t-1)&&(r!=t-1||0!=a)&&this.drawAlignmentPattern(e[r],e[a]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){let t=this.errorCorrectionLevel.formatBits<<3|e,r=t;for(let e=0;e<10;e++)r=r<<1^(r>>>9)*1335;let s=(t<<10|r)^21522;n(s>>>15==0);for(let e=0;e<=5;e++)this.setFunctionModule(8,e,a(s,e));this.setFunctionModule(8,7,a(s,6)),this.setFunctionModule(8,8,a(s,7)),this.setFunctionModule(7,8,a(s,8));for(let e=9;e<15;e++)this.setFunctionModule(14-e,8,a(s,e));for(let e=0;e<8;e++)this.setFunctionModule(this.size-1-e,8,a(s,e));for(let e=8;e<15;e++)this.setFunctionModule(8,this.size-15+e,a(s,e));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;let t=this.version<<12|e;n(t>>>18==0);for(let e=0;e<18;e++){let r=a(t,e),n=this.size-11+e%3,s=Math.floor(e/3);this.setFunctionModule(n,s,r),this.setFunctionModule(s,n,r)}}drawFinderPattern(e,t){for(let r=-4;r<=4;r++)for(let a=-4;a<=4;a++){let n=Math.max(Math.abs(a),Math.abs(r)),s=e+a,l=t+r;0<=s&&s<this.size&&0<=l&&l<this.size&&this.setFunctionModule(s,l,2!=n&&4!=n)}}drawAlignmentPattern(e,t){for(let r=-2;r<=2;r++)for(let a=-2;a<=2;a++)this.setFunctionModule(e+a,t+r,1!=Math.max(Math.abs(a),Math.abs(r)))}setFunctionModule(e,t,r){this.modules[t][e]=r,this.isFunction[t][e]=!0}addEccAndInterleave(e){let r=this.version,a=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(r,a))throw RangeError("Invalid argument");let s=t.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][r],l=t.ECC_CODEWORDS_PER_BLOCK[a.ordinal][r],o=Math.floor(t.getNumRawDataModules(r)/8),i=s-o%s,c=Math.floor(o/s),d=[],h=t.reedSolomonComputeDivisor(l);for(let r=0,a=0;r<s;r++){let n=e.slice(a,a+c-l+(r<i?0:1));a+=n.length;let s=t.reedSolomonComputeRemainder(n,h);r<i&&n.push(0),d.push(n.concat(s))}let u=[];for(let e=0;e<d[0].length;e++)d.forEach((t,r)=>{(e!=c-l||r>=i)&&u.push(t[e])});return n(u.length==o),u}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw RangeError("Invalid argument");let r=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let n=0;n<this.size;n++)for(let s=0;s<2;s++){let l=t-s,o=(t+1&2)==0?this.size-1-n:n;!this.isFunction[o][l]&&r<8*e.length&&(this.modules[o][l]=a(e[r>>>3],7-(7&r)),r++)}}n(r==8*e.length)}applyMask(e){if(e<0||e>7)throw RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let r=0;r<this.size;r++){let a;switch(e){case 0:a=(r+t)%2==0;break;case 1:a=t%2==0;break;case 2:a=r%3==0;break;case 3:a=(r+t)%3==0;break;case 4:a=(Math.floor(r/3)+Math.floor(t/2))%2==0;break;case 5:a=r*t%2+r*t%3==0;break;case 6:a=(r*t%2+r*t%3)%2==0;break;case 7:a=((r+t)%2+r*t%3)%2==0;break;default:throw Error("Unreachable")}!this.isFunction[t][r]&&a&&(this.modules[t][r]=!this.modules[t][r])}}getPenaltyScore(){let e=0;for(let r=0;r<this.size;r++){let a=!1,n=0,s=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[r][l]==a?5==++n?e+=t.PENALTY_N1:n>5&&e++:(this.finderPenaltyAddHistory(n,s),a||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),a=this.modules[r][l],n=1);e+=this.finderPenaltyTerminateAndCount(a,n,s)*t.PENALTY_N3}for(let r=0;r<this.size;r++){let a=!1,n=0,s=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][r]==a?5==++n?e+=t.PENALTY_N1:n>5&&e++:(this.finderPenaltyAddHistory(n,s),a||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),a=this.modules[l][r],n=1);e+=this.finderPenaltyTerminateAndCount(a,n,s)*t.PENALTY_N3}for(let r=0;r<this.size-1;r++)for(let a=0;a<this.size-1;a++){let n=this.modules[r][a];n==this.modules[r][a+1]&&n==this.modules[r+1][a]&&n==this.modules[r+1][a+1]&&(e+=t.PENALTY_N2)}let r=0;for(let e of this.modules)r=e.reduce((e,t)=>e+ +!!t,r);let a=this.size*this.size,s=Math.ceil(Math.abs(20*r-10*a)/a)-1;return n(0<=s&&s<=9),n(0<=(e+=s*t.PENALTY_N4)&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{let e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),r=[6];for(let a=this.size-7;r.length<e;a-=t)r.splice(1,0,a);return r}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version number out of range");let r=(16*e+128)*e+64;if(e>=2){let t=Math.floor(e/7)+2;r-=(25*t-10)*t-55,e>=7&&(r-=36)}return n(208<=r&&r<=29648),r}static getNumDataCodewords(e,r){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[r.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw RangeError("Degree out of range");let r=[];for(let t=0;t<e-1;t++)r.push(0);r.push(1);let a=1;for(let n=0;n<e;n++){for(let e=0;e<r.length;e++)r[e]=t.reedSolomonMultiply(r[e],a),e+1<r.length&&(r[e]^=r[e+1]);a=t.reedSolomonMultiply(a,2)}return r}static reedSolomonComputeRemainder(e,r){let a=r.map(e=>0);for(let n of e){let e=n^a.shift();a.push(0),r.forEach((r,n)=>a[n]^=t.reedSolomonMultiply(r,e))}return a}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw RangeError("Byte out of range");let r=0;for(let a=7;a>=0;a--)r=r<<1^(r>>>7)*285^(t>>>a&1)*e;return n(r>>>8==0),r}finderPenaltyCountPatterns(e){let t=e[1];n(t<=3*this.size);let r=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(r&&e[0]>=4*t&&e[6]>=t?1:0)+(r&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};function r(e,t,r){if(t<0||t>31||e>>>t!=0)throw RangeError("Value out of range");for(let a=t-1;a>=0;a--)r.push(e>>>a&1)}function a(e,t){return(e>>>t&1)!=0}function n(e){if(!e)throw Error("Assertion error")}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;let s=class e{constructor(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw RangeError("Invalid argument");this.bitData=r.slice()}static makeBytes(t){let a=[];for(let e of t)r(e,8,a);return new e(e.Mode.BYTE,t.length,a)}static makeNumeric(t){if(!e.isNumeric(t))throw RangeError("String contains non-numeric characters");let a=[];for(let e=0;e<t.length;){let n=Math.min(t.length-e,3);r(parseInt(t.substring(e,e+n),10),3*n+1,a),e+=n}return new e(e.Mode.NUMERIC,t.length,a)}static makeAlphanumeric(t){let a;if(!e.isAlphanumeric(t))throw RangeError("String contains unencodable characters in alphanumeric mode");let n=[];for(a=0;a+2<=t.length;a+=2){let s=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a));r(s+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a+1)),11,n)}return a<t.length&&r(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(a)),6,n),new e(e.Mode.ALPHANUMERIC,t.length,n)}static makeSegments(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]}static makeEci(t){let a=[];if(t<0)throw RangeError("ECI assignment value out of range");if(t<128)r(t,8,a);else if(t<16384)r(2,2,a),r(t,14,a);else if(t<1e6)r(6,3,a),r(t,21,a);else throw RangeError("ECI assignment value out of range");return new e(e.Mode.ECI,0,a)}static isNumeric(t){return e.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return e.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let r=0;for(let a of e){let e=a.mode.numCharCountBits(t);if(a.numChars>=1<<e)return 1/0;r+=4+e+a.bitData.length}return r}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let r=0;r<e.length;r++)"%"!=e.charAt(r)?t.push(e.charCodeAt(r)):(t.push(parseInt(e.substring(r+1,r+3),16)),r+=2);return t}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=s;e.QrSegment=s})(M||(M={})),m=(x=M||(M={})).QrCode||(x.QrCode={}),(r=class{constructor(e,t){this.ordinal=e,this.formatBits=t}}).LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),m.Ecc=r,p=(f=M||(M={})).QrSegment||(f.QrSegment={}),(a=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}}).NUMERIC=new a(1,[10,12,14]),a.ALPHANUMERIC=new a(2,[9,11,13]),a.BYTE=new a(4,[8,16,16]),a.KANJI=new a(8,[8,10,12]),a.ECI=new a(7,[0,0,0]),p.Mode=a;var aj=M,aC={L:aj.QrCode.Ecc.LOW,M:aj.QrCode.Ecc.MEDIUM,Q:aj.QrCode.Ecc.QUARTILE,H:aj.QrCode.Ecc.HIGH},ak="#FFFFFF",aN="#000000";function aS(e,t=0){let r=[];return e.forEach(function(e,a){let n=null;e.forEach(function(s,l){if(!s&&null!==n){r.push(`M${n+t} ${a+t}h${l-n}v1H${n+t}z`),n=null;return}if(l===e.length-1){if(!s)return;null===n?r.push(`M${l+t},${a+t} h1v1H${l+t}z`):r.push(`M${n+t},${a+t} h${l+1-n}v1H${n+t}z`);return}s&&null===n&&(n=l)})}),r.join("")}function aM(e,t){return e.slice().map((e,r)=>r<t.y||r>=t.y+t.h?e:e.map((e,r)=>(r<t.x||r>=t.x+t.w)&&e))}function aE({value:e,level:t,minVersion:r,includeMargin:a,marginSize:n,imageSettings:s,size:l,boostLevel:o}){let i=L.default.useMemo(()=>{let a=(Array.isArray(e)?e:[e]).reduce((e,t)=>(e.push(...aj.QrSegment.makeSegments(t)),e),[]);return aj.QrCode.encodeSegments(a,aC[t],r,void 0,void 0,o)},[e,t,r,o]),{cells:c,margin:d,numCells:h,calculatedImageSettings:u}=L.default.useMemo(()=>{let e=i.getModules(),t=null!=n?Math.max(Math.floor(n),0):4*!!a,r=e.length+2*t,o=function(e,t,r,a){if(null==a)return null;let n=e.length+2*r,s=Math.floor(.1*t),l=n/t,o=(a.width||s)*l,i=(a.height||s)*l,c=null==a.x?e.length/2-o/2:a.x*l,d=null==a.y?e.length/2-i/2:a.y*l,h=null==a.opacity?1:a.opacity,u=null;if(a.excavate){let e=Math.floor(c),t=Math.floor(d),r=Math.ceil(o+c-e),a=Math.ceil(i+d-t);u={x:e,y:t,w:r,h:a}}return{x:c,y:d,h:i,w:o,excavation:u,opacity:h,crossOrigin:a.crossOrigin}}(e,l,t,s);return{cells:e,margin:t,numCells:r,calculatedImageSettings:o}},[i,l,s,a,n]);return{qrcode:i,margin:d,cells:c,numCells:h,calculatedImageSettings:u}}var aL=function(){try{new Path2D().addPath(new Path2D)}catch(e){return!1}return!0}();L.default.forwardRef(function(e,t){let{value:r,size:a=128,level:n="L",bgColor:s=ak,fgColor:l=aN,includeMargin:o=!1,minVersion:i=1,boostLevel:c,marginSize:d,imageSettings:h}=e,u=aw(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:x}=u,m=aw(u,["style"]),f=null==h?void 0:h.src,p=L.default.useRef(null),g=L.default.useRef(null),b=L.default.useCallback(e=>{p.current=e,"function"==typeof t?t(e):t&&(t.current=e)},[t]),[v,y]=L.default.useState(!1),{margin:w,cells:j,numCells:C,calculatedImageSettings:k}=aE({value:r,level:n,minVersion:i,boostLevel:c,includeMargin:o,marginSize:d,imageSettings:h,size:a});L.default.useEffect(()=>{if(null!=p.current){let e=p.current,t=e.getContext("2d");if(!t)return;let r=j,n=g.current,o=null!=k&&null!==n&&n.complete&&0!==n.naturalHeight&&0!==n.naturalWidth;o&&null!=k.excavation&&(r=aM(j,k.excavation));let i=window.devicePixelRatio||1;e.height=e.width=a*i;let c=a/C*i;t.scale(c,c),t.fillStyle=s,t.fillRect(0,0,C,C),t.fillStyle=l,aL?t.fill(new Path2D(aS(r,w))):j.forEach(function(e,r){e.forEach(function(e,a){e&&t.fillRect(a+w,r+w,1,1)})}),k&&(t.globalAlpha=k.opacity),o&&t.drawImage(n,k.x+w,k.y+w,k.w,k.h)}}),L.default.useEffect(()=>{y(!1)},[f]);let N=ay({height:a,width:a},x),S=null;return null!=f&&(S=L.default.createElement("img",{src:f,key:f,style:{display:"none"},onLoad:()=>{y(!0)},ref:g,crossOrigin:null==k?void 0:k.crossOrigin})),L.default.createElement(L.default.Fragment,null,L.default.createElement("canvas",ay({style:N,height:a,width:a,ref:b,role:"img"},m)),S)}).displayName="QRCodeCanvas";var aR=L.default.forwardRef(function(e,t){let{value:r,size:a=128,level:n="L",bgColor:s=ak,fgColor:l=aN,includeMargin:o=!1,minVersion:i=1,boostLevel:c,title:d,marginSize:h,imageSettings:u}=e,x=aw(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:m,cells:f,numCells:p,calculatedImageSettings:g}=aE({value:r,level:n,minVersion:i,boostLevel:c,includeMargin:o,marginSize:h,imageSettings:u,size:a}),b=f,v=null;null!=u&&null!=g&&(null!=g.excavation&&(b=aM(f,g.excavation)),v=L.default.createElement("image",{href:u.src,height:g.h,width:g.w,x:g.x+m,y:g.y+m,preserveAspectRatio:"none",opacity:g.opacity,crossOrigin:g.crossOrigin}));let y=aS(b,m);return L.default.createElement("svg",ay({height:a,width:a,viewBox:`0 0 ${p} ${p}`,ref:t,role:"img"},x),!!d&&L.default.createElement("title",null,d),L.default.createElement("path",{fill:s,d:`M0,0 h${p}v${p}H0z`,shapeRendering:"crispEdges"}),L.default.createElement("path",{fill:l,d:y,shapeRendering:"crispEdges"}),v)});aR.displayName="QRCodeSVG";var aD=e.i(33491);function aA({isOpen:e,onClose:t,name:r,description:a,characters:n,config:s}){let[l,o]=(0,L.useState)(null),[i,c]=(0,L.useState)(!1),[d,h]=(0,L.useState)(null),u=(0,L.useRef)(null),x=(0,aD.canShare)(n.length,s.width,s.height);(0,L.useEffect)(()=>{if(!e||!x.canShare)return void o(null);try{let e=(0,aD.encodeCharacterSet)(r,a,n,s),t=(0,aD.createShareUrl)(e);o(t),h(null)}catch(e){h(e instanceof Error?e.message:"Failed to generate share URL"),o(null)}},[e,r,a,n,s,x.canShare]);let m=(0,L.useCallback)(async()=>{if(l)try{await navigator.clipboard.writeText(l),c(!0),setTimeout(()=>c(!1),2e3)}catch{let e=document.createElement("textarea");e.value=l,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),c(!0),setTimeout(()=>c(!1),2e3)}},[l]),f=(0,L.useCallback)(()=>{if(!u.current||!l)return;let e=u.current,t=new Blob([new XMLSerializer().serializeToString(e)],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(t),n=new Image;n.onload=()=>{let e=document.createElement("canvas");e.width=480,e.height=480;let t=e.getContext("2d");t&&(t.fillStyle="#0a0a1a",t.fillRect(0,0,e.width,e.height),t.drawImage(n,0,0,e.width,e.height),e.toBlob(e=>{if(!e)return;let t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`${r.replace(/[^a-z0-9]/gi,"-").toLowerCase()}-qr.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)},"image/png"),URL.revokeObjectURL(a))},n.src=a},[l,r]),p=l?(0,aD.getUrlLengthStatus)(l):"error",g=l&&l.length<=4e3;return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,size:"lg",children:[(0,E.jsxs)(eA.ModalHeader,{onClose:t,showCloseButton:!0,children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Share Character Set"}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Share via URL - no account needed"})]}),(0,E.jsxs)(eA.ModalContent,{className:"p-4",children:[(0,E.jsx)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30",children:(0,E.jsxs)("div",{className:"flex items-center gap-3",children:[(0,E.jsx)("div",{className:"w-10 h-10 rounded bg-retro-cyan/10 flex items-center justify-center",children:(0,E.jsx)("svg",{className:"w-5 h-5 text-retro-cyan",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsx)("h3",{className:"text-sm text-white font-medium truncate",children:r}),(0,E.jsxs)("p",{className:"text-xs text-gray-500",children:[n.length," characters | ",s.width,"x",s.height," px"]})]})]})}),!x.canShare&&(0,E.jsx)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded",children:(0,E.jsxs)("div",{className:"flex items-start gap-2",children:[(0,E.jsx)("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-sm text-red-400",children:x.message}),(0,E.jsx)("p",{className:"text-xs text-red-400/70 mt-1",children:"Try exporting to a file instead, or reduce the number of characters."})]})]})}),x.canShare&&"warning"===p&&(0,E.jsx)("div",{className:"mb-4 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded",children:(0,E.jsxs)("div",{className:"flex items-start gap-2",children:[(0,E.jsx)("svg",{className:"w-5 h-5 text-yellow-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("p",{className:"text-sm text-yellow-400",children:"Long URL Warning"}),(0,E.jsx)("p",{className:"text-xs text-yellow-400/70 mt-1",children:"This URL may not work on all platforms (email, social media). Consider exporting to a file for reliability."})]})]})}),d&&(0,E.jsx)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded",children:(0,E.jsx)("p",{className:"text-sm text-red-400",children:d})}),l&&(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Share URL"}),(0,E.jsxs)("div",{className:"flex gap-2",children:[(0,E.jsxs)("div",{className:"flex-1 relative",children:[(0,E.jsx)("input",{type:"text",value:l,readOnly:!0,className:"w-full h-full px-3 py-2 pr-20 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white font-mono truncate focus:outline-none focus:border-retro-cyan",onClick:e=>e.target.select()}),(0,E.jsx)("div",{className:"absolute top-0 bottom-0 right-0 w-20 pointer-events-none bg-gradient-to-r from-transparent via-retro-dark/80 to-retro-dark"}),(0,E.jsxs)("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:[l.length," chars"]})]}),(0,E.jsx)(ac.Button,{onClick:m,variant:"cyan",size:"sm",className:"whitespace-nowrap",children:i?"Copied!":"Copy"})]})]}),g&&(0,E.jsx)("div",{className:"mb-4 p-4 bg-retro-dark/30 rounded border border-retro-grid/20",children:(0,E.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,E.jsx)("div",{className:"bg-white p-3 rounded-lg shadow-lg",children:(0,E.jsx)(aR,{ref:u,value:l,size:240,bgColor:"#ffffff",fgColor:"#0a0a1a",level:"M"})}),(0,E.jsx)("p",{className:"text-xs text-gray-400 mt-3 mb-2",children:"Scan with your phone to open the character set"}),(0,E.jsxs)(ac.Button,{onClick:f,variant:"ghost",size:"sm",className:"text-retro-cyan hover:text-retro-cyan/80",children:[(0,E.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download QR"]})]})}),(0,E.jsxs)("div",{className:"mt-4 p-3 bg-retro-dark/30 rounded border border-retro-grid/20",children:[(0,E.jsx)("h4",{className:"text-xs font-medium text-gray-400 mb-2",children:"How sharing works"}),(0,E.jsxs)("ul",{className:"text-xs text-gray-500 space-y-1",children:[(0,E.jsxs)("li",{className:"flex items-start gap-2",children:[(0,E.jsx)("span",{className:"text-retro-cyan",children:"1."}),"Your character set is encoded into the URL"]}),(0,E.jsxs)("li",{className:"flex items-start gap-2",children:[(0,E.jsx)("span",{className:"text-retro-cyan",children:"2."}),"Anyone with the link can view and import it"]}),(0,E.jsxs)("li",{className:"flex items-start gap-2",children:[(0,E.jsx)("span",{className:"text-retro-cyan",children:"3."}),"No data is stored on any server"]})]})]})]}),(0,E.jsx)(eA.ModalFooter,{className:"flex justify-end gap-2 bg-retro-dark/30",children:(0,E.jsx)(ac.Button,{onClick:t,variant:"ghost",size:"sm",children:"Close"})})]})}function aI({isOpen:e,onClose:t,onSelectSet:r,excludeId:a}){let{characterSets:n,loading:s}=(0,eY.useCharacterLibrary)(),[l,o]=(0,L.useState)("");(0,L.useEffect)(()=>{e||o("")},[e]);let i=(0,L.useMemo)(()=>n.filter(e=>{if(a&&e.metadata.id===a)return!1;if(l){let t=l.toLowerCase();return e.metadata.name.toLowerCase().includes(t)||e.metadata.description?.toLowerCase().includes(t)||e.metadata.manufacturer?.toLowerCase().includes(t)||e.metadata.system?.toLowerCase().includes(t)}return!0}),[n,a,l]),c=(0,L.useCallback)(e=>{try{let a=(0,eG.deserializeCharacterSet)(e);r(a),t()}catch(e){console.error("Failed to deserialize character set:",e)}},[r,t]),d=(0,L.useCallback)(()=>{o(""),t()},[t]);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:d,size:"2xl",maxHeight:"80vh",className:"bg-retro-dark rounded-xl",children:[(0,E.jsxs)(eA.ModalHeader,{onClose:d,showCloseButton:!0,children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Select Overlay Character Set"}),(0,E.jsx)("p",{className:"text-xs text-gray-400 mt-0.5",children:"Choose a character set to overlay for tracing"})]}),(0,E.jsx)("div",{className:"px-4 py-4 border-b border-retro-grid/30",children:(0,E.jsxs)("div",{className:"relative",children:[(0,E.jsx)("input",{type:"text",value:l,onChange:e=>o(e.target.value),placeholder:"Search character sets...",className:"w-full px-3 py-2 pl-10 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",autoFocus:!0}),(0,E.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),(0,E.jsx)(eA.ModalContent,{scrollable:!0,className:"p-4",children:s?(0,E.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,E.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"})}):0===i.length?(0,E.jsx)("div",{className:"text-center py-8 text-gray-500",children:l?"No character sets match your search":"No character sets available"}):(0,E.jsx)("div",{className:"grid gap-2",children:i.map(e=>(0,E.jsx)(aT,{characterSet:e,onSelect:()=>c(e)},e.metadata.id))})})]})}function aT({characterSet:e,onSelect:t}){let r=e.metadata,a=e.config,n=Math.ceil(a.width/8)*a.height,s=e.binaryData?Math.ceil(3*e.binaryData.length/4):0,l=n>0?Math.floor(s/n):0;return(0,E.jsxs)("button",{onClick:t,className:"w-full flex items-center gap-3 p-3 rounded-lg border border-retro-grid/30 hover:border-retro-amber/50 hover:bg-retro-amber/5 text-left transition-colors",children:[(0,E.jsx)("div",{className:"w-12 h-12 bg-black/50 rounded flex-shrink-0 flex items-center justify-center",children:(0,E.jsxs)("span",{className:"text-xs text-gray-400 font-mono",children:[a.width,"x",a.height]})}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-sm text-white truncate",children:r.name}),r.isBuiltIn&&(0,E.jsx)("span",{className:"px-1.5 py-0.5 text-[10px] bg-retro-purple/30 text-retro-pink rounded",children:"Built-in"})]}),(0,E.jsxs)("div",{className:"flex items-center gap-2 mt-0.5 text-xs text-gray-500",children:[(0,E.jsxs)("span",{children:[l," chars"]}),r.manufacturer&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{children:"Â·"}),(0,E.jsx)("span",{className:"truncate",children:r.manufacturer})]}),r.system&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{children:"Â·"}),(0,E.jsx)("span",{className:"truncate",children:r.system})]}),r.chip&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{children:"Â·"}),(0,E.jsx)("span",{className:"truncate",children:r.chip})]})]})]}),(0,E.jsx)("svg",{className:"w-5 h-5 text-retro-amber/50 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}function az(e){let t=(0,ea.getBoundingBox)(e);if(!t)return{pixels:[[!1]]};let r=[];for(let a=t.minRow;a<=t.maxRow;a++){let n=[];for(let r=t.minCol;r<=t.maxCol;r++)n.push(e.pixels[a][r]);r.push(n)}return{pixels:r}}let aP="rgba(255, 51, 51, 0.6)";function aB({isOpen:e,onClose:t,currentCharacters:r,currentConfig:a,excludeId:n,foregroundColor:s,backgroundColor:l,onSelectForOverlay:o}){let{characterSets:i,loading:c}=(0,eY.useCharacterLibrary)(),[d,h]=(0,L.useState)(null),[u,x]=(0,L.useState)(!1),[m,f]=(0,L.useState)([]);(0,L.useEffect)(()=>{e||h(null)},[e]),(0,L.useEffect)(()=>{if(!e||c||0===i.length)return;x(!0);let t=requestAnimationFrame(()=>{f(function(e,t,r,a){let n=[];for(let t of r)if(!a||t.metadata.id!==a)try{let r=(0,eG.deserializeCharacterSet)(t).characters,a=Math.min(e.length,r.length);if(0===a)continue;let s=0,l=0;for(let t=0;t<a;t++){let a=function(e,t){let r=az(e),a=az(t),n=r.pixels.length,s=r.pixels[0]?.length||0,l=a.pixels.length,o=a.pixels[0]?.length||0,i=Math.max(n,l),c=Math.max(s,o),d=Math.floor((i-n)/2),h=Math.floor((c-s)/2),u=Math.floor((i-l)/2),x=Math.floor((c-o)/2),m=0;for(let e=0;e<i;e++)for(let t=0;t<c;t++){let i=e-d,c=t-h,f=i>=0&&i<n&&c>=0&&c<s&&r.pixels[i][c],p=e-u,g=t-x;f!==(p>=0&&p<l&&g>=0&&g<o&&a.pixels[p][g])&&m++}return{differingPixels:m,totalPixels:i*c}}(e[t],r[t]);s+=a.differingPixels,l+=a.totalPixels}let o=s/a,i=l>0?Math.floor((1-s/l)*100):100;n.push({characterSetId:t.metadata.id,characterSetName:t.metadata.name,metadata:t.metadata,config:t.config,averageDifference:o,matchedCharacters:a,totalCharacters:r.length,matchPercentage:i,characters:r})}catch(e){console.error(`Failed to deserialize character set ${t.metadata.id}:`,e);continue}return n.sort((e,t)=>e.averageDifference-t.averageDifference),n}(r,0,i,n)),x(!1)});return()=>cancelAnimationFrame(t)},[e,c,i,r,a,n]);let p=(0,L.useMemo)(()=>m.find(e=>e.characterSetId===d)||null,[m,d]),g=(0,L.useCallback)(e=>{h(t=>t===e?null:e)},[]),b=(0,L.useCallback)(()=>{p&&(o({metadata:p.metadata,config:p.config,characters:p.characters}),t())},[p,o,t]),v=c||u;return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,size:"4xl",maxHeight:"90vh",children:[(0,E.jsx)(eA.ModalHeader,{onClose:t,showCloseButton:!0,children:(0,E.jsxs)("div",{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Similar Character Sets"}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Find character sets similar to your current work"})]})}),(0,E.jsx)(eA.ModalContent,{className:"p-0 flex-1 overflow-hidden flex flex-col",children:(0,E.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[(0,E.jsx)("div",{className:"w-full md:w-72 overflow-y-auto p-4 border-r border-retro-grid/30",children:v?(0,E.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[(0,E.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"}),(0,E.jsx)("p",{className:"text-sm text-gray-500",children:c?"Loading character sets...":"Calculating similarities..."})]}):0===m.length?(0,E.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,E.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,E.jsx)("p",{className:"text-sm",children:"No other character sets found"}),(0,E.jsx)("p",{className:"text-xs mt-1",children:"Create or import more character sets to compare"})]}):(0,E.jsx)("div",{className:"space-y-2",children:m.map(e=>(0,E.jsx)(aO,{similarity:e,isSelected:d===e.characterSetId,onClick:()=>g(e.characterSetId)},e.characterSetId))})}),(0,E.jsxs)("div",{className:"w-full md:flex-1 p-4 bg-retro-dark/30 flex flex-col",children:[(0,E.jsx)("h3",{className:"text-sm font-medium text-gray-400 mb-3",children:"Preview"}),p?(0,E.jsx)(aF,{similarity:p,currentCharacters:r,foregroundColor:s,backgroundColor:l,onUseAsOverlay:b}):(0,E.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,E.jsxs)("div",{className:"text-center",children:[(0,E.jsxs)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),(0,E.jsx)("p",{className:"text-sm",children:"Select a character set to preview"})]})})]})]})})]})}function aO({similarity:e,isSelected:t,onClick:r}){let a=e.metadata,n=e.config,s=(0,L.useMemo)(()=>e.matchPercentage>=90?"high":e.matchPercentage>=70?"medium":"low",[e.matchPercentage]);return(0,E.jsxs)("button",{onClick:r,className:`w-full flex items-center gap-3 p-3 rounded-lg border text-left transition-colors ${t?"bg-retro-cyan/10 border-retro-cyan":"bg-retro-dark/30 border-retro-grid/30 hover:border-retro-grid/50"}`,children:[(0,E.jsxs)("div",{className:"w-14 h-14 bg-black/50 rounded flex-shrink-0 flex flex-col items-center justify-center",children:[(0,E.jsxs)("span",{className:`text-lg font-bold ${{high:"text-green-400",medium:"text-amber-400",low:"text-red-400"}[s]}`,children:[e.matchPercentage,"%"]}),(0,E.jsx)("span",{className:"text-[10px] text-gray-500",children:"match"})]}),(0,E.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,E.jsxs)("div",{className:"flex items-center gap-2",children:[(0,E.jsx)("span",{className:"text-sm text-white truncate",children:a.name}),a.isBuiltIn&&(0,E.jsx)("span",{className:"px-1.5 py-0.5 text-[10px] bg-retro-purple/30 text-retro-pink rounded",children:"Built-in"})]}),(0,E.jsxs)("div",{className:"flex items-center gap-2 mt-0.5 text-xs text-gray-500",children:[(0,E.jsxs)("span",{children:[e.totalCharacters," chars"]}),(0,E.jsx)("span",{children:"Â·"}),(0,E.jsxs)("span",{children:[n.width,"x",n.height]}),a.manufacturer&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{children:"Â·"}),(0,E.jsx)("span",{className:"truncate",children:a.manufacturer})]})]}),(0,E.jsxs)("p",{className:"text-xs text-gray-600 mt-0.5",children:[e.matchedCharacters," characters compared"]})]}),(0,E.jsx)("svg",{className:`w-5 h-5 flex-shrink-0 transition-colors ${t?"text-retro-cyan":"text-gray-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}function aF({similarity:e,currentCharacters:t,foregroundColor:r,backgroundColor:a,onUseAsOverlay:n}){let s=e.metadata,l=e.config,o=(0,L.useMemo)(()=>{let r=new Map;for(let a=0;a<e.characters.length;a++)if(a<t.length){let n=(0,eX.findDifferingPixels)(t[a],e.characters[a]);n.size>0&&r.set(a,n)}return r},[e.characters,t]);return(0,E.jsxs)("div",{className:"flex flex-col h-full",children:[(0,E.jsxs)("div",{className:"mb-3",children:[(0,E.jsx)("h4",{className:"text-sm font-medium text-white truncate",children:s.name}),(0,E.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 flex-wrap",children:[(0,E.jsxs)("span",{children:[e.totalCharacters," chars"]}),(0,E.jsx)("span",{children:"Â·"}),(0,E.jsxs)("span",{children:[l.width,"x",l.height]}),s.manufacturer&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{children:"Â·"}),(0,E.jsx)("span",{children:s.manufacturer})]}),s.system&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{children:"Â·"}),(0,E.jsx)("span",{children:s.system})]})]}),(0,E.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,E.jsxs)("span",{className:`text-lg font-bold ${e.matchPercentage>=90?"text-green-400":e.matchPercentage>=70?"text-amber-400":"text-red-400"}`,children:[e.matchPercentage,"% match"]}),(0,E.jsxs)("span",{className:"text-xs text-gray-600",children:["(",e.matchedCharacters," chars compared)"]})]})]}),(0,E.jsx)("div",{className:"flex-1 overflow-auto bg-retro-dark rounded border border-retro-grid/30 p-2 mb-3",children:(0,E.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(16, ${2*l.width+4}px)`},children:e.characters.map((e,n)=>{let s=o.get(n),l=s&&s.size>0;return(0,E.jsx)("div",{className:`relative ${l?"ring-1 ring-amber-500/50 rounded-sm":""}`,title:`Character ${n}${l?` (${s?.size} pixels differ)`:""}`,children:(0,E.jsx)(au,{character:e,comparisonCharacter:t[n],scale:2,foregroundColor:r,backgroundColor:a,diffColor:aP,showDiffBorder:!1,index:n})},n)})})}),(0,E.jsx)("div",{className:"mb-3 flex items-center gap-3 text-xs text-gray-500",children:(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:aP}}),(0,E.jsx)("span",{children:"Different pixels"})]})}),(0,E.jsx)(ac.Button,{onClick:n,variant:"cyan",size:"sm",className:"w-full",children:"Use as Overlay"}),(0,E.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Use this set as a tracing overlay in the editor"})]})}function aH({isOpen:e,onClose:t,notes:r,loading:a,error:n,characterSetName:s,onAdd:l,onUpdate:o,onDelete:i}){let[c,d]=(0,L.useState)(""),[h,u]=(0,L.useState)(!1),[x,m]=(0,L.useState)(null),[f,p]=(0,L.useState)(""),[g,b]=(0,L.useState)(null);(0,L.useEffect)(()=>{e&&(d(""),m(null),b(null))},[e]);let v=(0,L.useCallback)(async()=>{if(!c.trim())return;u(!0);let e=await l(c.trim());u(!1),e&&d("")},[c,l]),y=(0,L.useCallback)(e=>{m(e.id),p(e.text),b(null)},[]),w=(0,L.useCallback)(async()=>{x&&f.trim()&&await o(x,f.trim()),m(null),p("")},[x,f,o]),j=(0,L.useCallback)(()=>{m(null),p("")},[]),C=(0,L.useCallback)(async e=>{await i(e),b(null)},[i]);return(0,E.jsxs)(eA.Modal,{isOpen:e,onClose:t,size:"lg",maxHeight:"80vh",children:[(0,E.jsx)(eA.ModalHeader,{onClose:t,showCloseButton:!0,children:(0,E.jsxs)("div",{children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white",children:"Notes"}),(0,E.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:[r.length," note",1!==r.length?"s":""," for ",s]})]})}),(0,E.jsxs)(eA.ModalContent,{className:"p-4",children:[(0,E.jsxs)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30",children:[(0,E.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Add New Note"}),(0,E.jsx)("textarea",{value:c,onChange:e=>d(e.target.value),placeholder:"Type your note here...",className:"w-full px-2 py-1.5 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan resize-none",rows:3,onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&c.trim()&&v()}}),(0,E.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,E.jsx)("span",{className:"text-xs text-gray-500",children:"Ctrl+Enter to save"}),(0,E.jsx)(ac.Button,{onClick:v,disabled:!c.trim()||h||!!n,variant:"cyan",size:"sm",children:h?"Adding...":"Add Note"})]})]}),n?(0,E.jsxs)("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded text-center",children:[(0,E.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,E.jsx)("p",{className:"text-sm text-red-400 mb-1",children:"Failed to load notes"}),(0,E.jsx)("p",{className:"text-xs text-gray-500",children:n})]}):a?(0,E.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,E.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"})}):0===r.length?(0,E.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,E.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),(0,E.jsx)("p",{className:"text-sm",children:"No notes yet"}),(0,E.jsx)("p",{className:"text-xs mt-1",children:"Add a note to keep track of your work"})]}):(0,E.jsx)("div",{className:"space-y-3",children:r.map(e=>(0,E.jsx)("div",{className:"p-3 rounded border bg-retro-dark/30 border-retro-grid/30",children:x===e.id?(0,E.jsxs)("div",{children:[(0,E.jsx)("textarea",{value:f,onChange:e=>p(e.target.value),className:"w-full px-2 py-1.5 bg-retro-dark border border-retro-cyan rounded text-sm text-white focus:outline-none resize-none",rows:3,autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey?w():"Escape"===e.key&&j()}}),(0,E.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,E.jsx)(ac.Button,{onClick:j,variant:"ghost",size:"sm",children:"Cancel"}),(0,E.jsx)(ac.Button,{onClick:w,disabled:!f.trim(),variant:"cyan",size:"sm",children:"Save"})]})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("p",{className:"text-sm text-gray-200 whitespace-pre-wrap",children:e.text}),(0,E.jsxs)("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-retro-grid/20",children:[(0,E.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,E.jsxs)("span",{children:["Created ",(0,eX.formatTimestamp)(e.createdAt)]}),e.updatedAt!==e.createdAt&&(0,E.jsxs)("span",{className:"ml-2",children:["(edited ",(0,eX.formatTimestamp)(e.updatedAt),")"]})]}),(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)("button",{onClick:()=>y(e),className:"p-1 text-gray-500 hover:text-white transition-colors",title:"Edit",children:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),g===e.id?(0,E.jsxs)("div",{className:"flex items-center gap-1",children:[(0,E.jsx)("button",{onClick:()=>C(e.id),className:"px-2 py-0.5 text-xs bg-red-500/20 border border-red-500 rounded text-red-400 hover:bg-red-500/30",children:"Delete"}),(0,E.jsx)("button",{onClick:()=>b(null),className:"px-2 py-0.5 text-xs border border-retro-grid/50 rounded text-gray-400 hover:text-white",children:"Cancel"})]}):(0,E.jsx)("button",{onClick:()=>b(e.id),className:"p-1 text-gray-500 hover:text-red-400 transition-colors",title:"Delete",children:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})},e.id))})]})]})}var a$=e.i(93582),aW=e.i(92832),aU=e.i(64358),aV=e.i(33712);let a_=at.CHARACTER_EDITOR_SNAPSHOTS_STORE;async function aK(){let e=await (0,aW.getSharedDatabase)();return e?e.objectStoreNames.contains(a_)?e:(console.warn("Snapshots store not found in database. Please refresh the page to trigger database migration."),null):null}async function aY(e){let t=await aK();if(!t)throw Error("Snapshots not available. Please refresh the page.");if((await aG(e.characterSetId)).length>=10)throw Error("Maximum of 10 snapshots per character set. Delete an existing snapshot first.");return new Promise((r,a)=>{let n=t.transaction([a_],"readwrite").objectStore(a_).put(e);n.onsuccess=()=>r(),n.onerror=()=>a(Error("Failed to save snapshot"))})}async function aG(e){let t=await aK();return t?new Promise((r,a)=>{let n=t.transaction([a_],"readonly").objectStore(a_).index("by-character-set").getAll(e);n.onsuccess=()=>{let e=n.result;e.sort((e,t)=>t.createdAt-e.createdAt),r(e)},n.onerror=()=>{a(Error("Failed to get snapshots"))}}):[]}async function aX(e){let t=await aK();return t?new Promise((r,a)=>{let n=t.transaction([a_],"readonly").objectStore(a_).get(e);n.onsuccess=()=>{r(n.result||null)},n.onerror=()=>{a(Error("Failed to get snapshot"))}}):null}async function aQ(e){let t=await aK();if(!t)throw Error("Snapshots not available. Please refresh the page.");return new Promise((r,a)=>{let n=t.transaction([a_],"readwrite").objectStore(a_).delete(e);n.onsuccess=()=>r(),n.onerror=()=>a(Error("Failed to delete snapshot"))})}async function aJ(e,t){let r=await aK();if(!r)throw Error("Snapshots not available. Please refresh the page.");let a=await aX(e);if(!a)throw Error("Snapshot not found");let n={...a,name:t};return new Promise((e,t)=>{let a=r.transaction([a_],"readwrite").objectStore(a_).put(n);a.onsuccess=()=>e(),a.onerror=()=>t(Error("Failed to rename snapshot"))})}function aq(){return 10}let aZ={showOnFirstVisit:!0,hasSeen:!1,lastDismissedAt:null,expandedCategories:[]},a0={getItem:e=>localStorage.getItem(e),setItem:(e,t)=>{localStorage.setItem(e,t)},removeItem:e=>{localStorage.removeItem(e)}};function a1(e,t){try{e.setItem(at.CHARACTER_EDITOR_STORAGE_KEY_TIPS_OVERLAY,JSON.stringify(t))}catch{}}function a2(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}var a4=e.i(45048),a3=e.i(44254);function a5(){let e=(0,R.useRouter)(),t=(0,R.useSearchParams)().get("id"),{getById:r,save:a,deleteSet:n,loading:s}=(0,eY.useCharacterLibrary)(),l=(0,a3.useToast)(),[o,i]=(0,L.useState)(!0),[c,d]=(0,L.useState)(null),[h,u]=(0,L.useState)(!1),[x,m]=(0,L.useState)(null),f=function(e){let{state:t,setState:r,resetState:a,undo:n,redo:s,canUndo:l,canRedo:o,history:i,historyIndex:c,jumpToHistory:d,totalHistoryEntries:h,startBatch:u,endBatch:x,clearHistory:m}=function(e,t=1/0){let[r,a]=(0,L.useState)(()=>({past:[],present:{state:e,label:"Initial state",timestamp:Date.now()},future:[]})),n=(0,L.useRef)(!1),s=(0,L.useRef)(null),l=(0,L.useCallback)((e,r)=>{n.current?a(t=>({...t,present:{state:e,label:r,timestamp:Date.now()}})):a(a=>{let n=[...a.past,a.present];return n.length>t&&(n=n.slice(-t)),{past:n,present:{state:e,label:r,timestamp:Date.now()},future:[]}})},[t]),o=(0,L.useCallback)(()=>{n.current||(s.current=r.present,n.current=!0)},[r.present]),i=(0,L.useCallback)(e=>{if(!n.current||!s.current){s.current=null,n.current=!1;return}let r=s.current;s.current=null,n.current=!1,a(a=>{if(JSON.stringify(r.state)!==JSON.stringify(a.present.state)){let n=[...a.past,r];return n.length>t&&(n=n.slice(-t)),{past:n,present:{...a.present,label:e||a.present.label},future:[]}}return a})},[t]),c=(0,L.useCallback)(e=>{a({past:[],present:{state:e,label:"Initial state",timestamp:Date.now()},future:[]})},[]),d=(0,L.useCallback)(()=>{a(e=>{if(0===e.past.length)return e;let t=e.past[e.past.length-1];return{past:e.past.slice(0,-1),present:t,future:[e.present,...e.future]}})},[]),h=(0,L.useCallback)(()=>{a(e=>{if(0===e.future.length)return e;let t=e.future[0],r=e.future.slice(1);return{past:[...e.past,e.present],present:t,future:r}})},[]),u=(0,L.useCallback)(()=>{a(e=>({...e,past:[],future:[]}))},[]),x=(0,L.useCallback)(e=>{a(t=>{let r=Math.max(0,Math.min(e,t.past.length+1+t.future.length-1));if(r===t.past.length)return t;let a=[...t.past,t.present,...t.future],n=a[r];return n?{past:a.slice(0,r),present:n,future:a.slice(r+1)}:t})},[]),{past:m,present:f,future:p}=r,g=(0,L.useMemo)(()=>[...m,f,...p],[m,f,p]),b=m.length+1+p.length,v=m.length;return{state:f.state,setState:l,resetState:c,undo:d,redo:h,canUndo:m.length>0,canRedo:p.length>0,historyLength:m.length+p.length,clearHistory:u,history:g,historyIndex:v,jumpToHistory:x,totalHistoryEntries:b,startBatch:o,endBatch:i}}(e?{characters:e.characters.map(aV.cloneCharacter),config:{...e.config}}:{characters:[],config:{width:8,height:8,padding:"right",bitDirection:"msb"}}),[f,p]=(0,L.useState)(!1),[,g]=(0,L.useState)(null),b=(0,L.useCallback)((e,a)=>{r(e(a2(t)),a),p(!0)},[t,r]),v=function({characterCount:e,initialIndex:t=0}){let[r,a]=(0,L.useState)(t),[n,s]=(0,L.useState)(new Set),[l,o]=(0,L.useState)(null),i=(0,L.useMemo)(()=>{let e=new Set(n);return e.add(r),e},[r,n]),c=(0,L.useCallback)((e,t,n=!1)=>{if(n)s(t=>{let n=new Set(t);if(e===r){if(n.size>0){let[e]=n;n.delete(e),n.add(r),a(e)}}else n.has(e)?n.delete(e):n.add(e);return n});else if(t){let t=l??r,n=Math.min(t,e),o=Math.max(t,e),i=new Set;for(let e=n;e<=o;e++)i.add(e);a(e),i.delete(e),s(i)}else a(e),o(e),s(new Set)},[r,l]),d=(0,L.useCallback)(()=>{s(new Set)},[]),h=(0,L.useCallback)(()=>{let t=new Set(Array.from({length:e},(e,t)=>t));t.delete(r),s(t)},[e,r]),u=(0,L.useCallback)((e=0)=>{a(e),o(null),s(new Set)},[]),x=(0,L.useCallback)(t=>{a(Math.min(r,Math.max(0,e-t-1))),s(new Set)},[e,r]);return{selectedIndex:r,setSelectedIndex:a,batchSelection:n,toggleBatchSelection:c,clearBatchSelection:d,selectAll:h,selectedIndices:i,resetSelection:u,adjustSelectionAfterDelete:x}}({characterCount:t.characters.length,initialIndex:0}),y=function({updateState:e,selectedIndices:t,selectedIndex:r,characters:a}){let n=(0,L.useCallback)((a,n)=>{e(e=>{if(t.size>1)e.characters=(0,ea.batchTogglePixel)(e.characters,t,a,n);else{let t=e.characters[r];t&&(e.characters[r]=(0,ea.togglePixel)(t,a,n))}return e})},[e,r,t]),s=(0,L.useCallback)((r,a,n)=>{e(e=>{for(let s of t){let t=e.characters[s];t&&(e.characters[s]=(0,ea.setPixel)(t,r,a,n))}return e})},[e,t]),l=(0,L.useCallback)((e,r)=>(0,ea.getPixelState)(a,t,e,r),[a,t]),o=(0,L.useCallback)(r=>{e(e=>(e.characters=(0,ea.batchTransform)(e.characters,t,e=>(0,ea.rotateCharacter)(e,r)),e))},[e,t]),i=(0,L.useCallback)((r,a=!0)=>{e(e=>(e.characters=(0,ea.batchTransform)(e.characters,t,e=>(0,ea.shiftCharacter)(e,r,a)),e))},[e,t]),c=(0,L.useCallback)(()=>{e(e=>(e.characters=(0,ea.batchTransform)(e.characters,t,ea.invertCharacter),e))},[e,t]),d=(0,L.useCallback)(()=>{e(e=>(e.characters=(0,ea.batchTransform)(e.characters,t,ea.flipHorizontal),e))},[e,t]),h=(0,L.useCallback)(()=>{e(e=>(e.characters=(0,ea.batchTransform)(e.characters,t,ea.flipVertical),e))},[e,t]),u=(0,L.useCallback)(()=>{e(e=>{let{width:r,height:a}=e.config;return e.characters=(0,ea.batchTransform)(e.characters,t,()=>(0,aV.createEmptyCharacter)(r,a)),e})},[e,t]),x=(0,L.useCallback)(()=>{e(e=>{let{width:r,height:a}=e.config;return e.characters=(0,ea.batchTransform)(e.characters,t,()=>({pixels:Array.from({length:a},()=>Array(r).fill(!0))})),e})},[e,t]);return{toggleSelectedPixel:n,setSelectedPixel:s,getSelectedPixelState:l,rotateSelected:o,shiftSelected:i,invertSelected:c,flipSelectedHorizontal:d,flipSelectedVertical:h,clearSelected:u,fillSelected:x,centerSelected:(0,L.useCallback)(()=>{e(e=>(e.characters=(0,ea.batchTransform)(e.characters,t,ea.centerCharacter),e))},[e,t]),scaleSelected:(0,L.useCallback)((r,a,n)=>{e(e=>(e.characters=(0,ea.batchTransform)(e.characters,t,e=>(0,ea.scaleCharacter)(e,r,a,n)),e))},[e,t])}}({updateState:b,selectedIndices:v.selectedIndices,selectedIndex:v.selectedIndex,characters:t.characters}),w=function({updateState:e,selectedIndices:t,selectedIndex:r,characterCount:a,onSelectionChange:n,onClearBatchSelection:s}){let l=(0,L.useCallback)(()=>{e(e=>{let{width:t,height:r}=e.config;return e.characters=[...e.characters,(0,aV.createEmptyCharacter)(t,r)],e}),n(a),s()},[e,a,n,s]),o=(0,L.useCallback)(()=>{e(e=>{let{width:t,height:a}=e.config,n=(0,aV.createEmptyCharacter)(t,a),s=r+1;return e.characters=[...e.characters.slice(0,s),n,...e.characters.slice(s)],e}),n(r+1),s()},[e,r,n,s]),i=(0,L.useCallback)(t=>{0!==t.length&&(e(e=>(e.characters=[...e.characters,...t.map(e=>(0,aV.cloneCharacter)(e))],e)),n(a),s())},[e,a,n,s]),c=(0,L.useCallback)(()=>{let a=Array.from(t).sort((e,t)=>e-t);0!==a.length&&(e(e=>{let t=a.map(t=>(0,aV.cloneCharacter)(e.characters[t])),n=r+1;return e.characters=[...e.characters.slice(0,n),...t,...e.characters.slice(n)],e},"Duplicate characters"),n(r+1),s())},[e,t,r,n,s]),d=(0,L.useCallback)(()=>{a<=1||(e(e=>(e.characters=e.characters.filter((e,r)=>!t.has(r)),e)),n(Math.min(r,a-t.size-1)),s())},[e,t,a,r,n,s]),h=(0,L.useCallback)((t,r)=>{e(e=>{let a=e.characters[t];return a&&r>=0&&r<e.characters.length&&(e.characters[r]=(0,aV.cloneCharacter)(a)),e})},[e]),u=(0,L.useCallback)((t,r,a)=>{e(e=>(e.characters=e.characters.map(e=>(0,ea.resizeCharacter)(e,t,r,a)),e.config={...e.config,width:t,height:r},e))},[e]),x=(0,L.useCallback)((t,r)=>{e(e=>(t>=0&&t<e.characters.length&&(e.characters[t]=(0,aV.cloneCharacter)(r)),e))},[e]);return{addCharacter:l,insertCharacterAfter:o,addCharacters:i,duplicateSelected:c,deleteSelected:d,copyCharacter:h,resizeCharacters:u,updateCharacter:x,setCharacters:(0,L.useCallback)(t=>{e(e=>(e.characters=t.map(aV.cloneCharacter),e))},[e]),replaceCharactersAtIndices:(0,L.useCallback)((t,r,a)=>{0!==r.size&&e(e=>{let a=[...e.characters];for(let e of r)e>=0&&e<t.length&&e<a.length&&(a[e]=(0,aV.cloneCharacter)(t[e]));return e.characters=a,e},a??"Partial restore")},[e])}}({updateState:b,selectedIndices:v.selectedIndices,selectedIndex:v.selectedIndex,characterCount:t.characters.length,onSelectionChange:v.setSelectedIndex,onClearBatchSelection:v.clearBatchSelection}),j=(0,L.useCallback)(()=>{p(!1),g(a2(t))},[t]),C=(0,L.useCallback)(e=>{a({characters:e.characters.map(aV.cloneCharacter),config:{...e.config}}),v.resetSelection(0),p(!1),g(null)},[a,v]);return{characters:t.characters,config:t.config,selectedIndex:v.selectedIndex,setSelectedIndex:v.setSelectedIndex,batchSelection:v.batchSelection,toggleBatchSelection:v.toggleBatchSelection,clearBatchSelection:v.clearBatchSelection,selectAll:v.selectAll,selectedIndices:v.selectedIndices,toggleSelectedPixel:y.toggleSelectedPixel,setSelectedPixel:y.setSelectedPixel,getSelectedPixelState:y.getSelectedPixelState,rotateSelected:y.rotateSelected,shiftSelected:y.shiftSelected,invertSelected:y.invertSelected,flipSelectedHorizontal:y.flipSelectedHorizontal,flipSelectedVertical:y.flipSelectedVertical,clearSelected:y.clearSelected,fillSelected:y.fillSelected,centerSelected:y.centerSelected,scaleSelected:y.scaleSelected,addCharacter:w.addCharacter,insertCharacterAfter:w.insertCharacterAfter,addCharacters:w.addCharacters,duplicateSelected:w.duplicateSelected,deleteSelected:w.deleteSelected,copyCharacter:w.copyCharacter,resizeCharacters:w.resizeCharacters,updateCharacter:w.updateCharacter,setCharacters:w.setCharacters,replaceCharactersAtIndices:w.replaceCharactersAtIndices,undo:n,redo:s,canUndo:l,canRedo:o,history:i,historyIndex:c,jumpToHistory:d,totalHistoryEntries:h,startBatch:u,endBatch:x,clearHistory:m,isDirty:f,markSaved:j,reset:C}}(x),[p,g]=(0,L.useState)((0,a4.getActiveColors)()),[b,v]=(0,L.useState)(20),y=(0,L.useRef)(null),w=(0,L.useCallback)(()=>{let e=y.current;if(!e)return;let t=e.getBoundingClientRect(),r=t.width,a=t.height,n=f.config.width,s=f.config.height;0===r||0===a||v(Math.max(8,Math.min(100,Math.floor(Math.min((r-40)/n,(a-40)/s)))))},[f.config.width,f.config.height]),[j,C]=(0,L.useState)(null),[k,N]=(0,L.useState)(!1),[S,M]=(0,L.useState)(!1),[A,I]=(0,L.useState)(!1),[T,z]=(0,L.useState)(!1),[P,B]=(0,L.useState)(!1),[O,F]=(0,L.useState)(!1),[H,$]=(0,L.useState)(!1),[W,Y]=(0,L.useState)(!1),[G,X]=(0,L.useState)(""),[J,q]=(0,L.useState)(!1),[Z,ee]=(0,L.useState)(!1),[en,es]=(0,L.useState)(""),[el,eo]=(0,L.useState)(!1),[ei,ec]=(0,L.useState)(!1),[ed,eh]=(0,L.useState)(!1),[eu,ex]=(0,L.useState)(!1),[em,ef]=(0,L.useState)(!1),[ep,eg]=(0,L.useState)(!1),[eb,ev]=(0,L.useState)(!1),[ey,ew]=(0,L.useState)(!1),[eC,ek]=(0,L.useState)(!1),[eN,eS]=(0,L.useState)(!1),[eM,eA]=(0,L.useState)(!1),[eI,eT]=(0,L.useState)(!1),[ez,eP]=(0,L.useState)(null),[eB,eO]=(0,L.useState)(!1),[eF,eW]=(0,L.useState)(!1),[eU,eV]=(0,L.useState)("pixel"),[eK,eX]=(0,L.useState)(!1),{contextMenu:eQ,showContextMenu:eJ,hideContextMenu:eq}=function(){let[e,t]=(0,L.useState)(null);return{contextMenu:e,showContextMenu:(0,L.useCallback)((e,r,a)=>{t({x:e,y:r,index:a})},[]),hideContextMenu:(0,L.useCallback)(()=>{t(null)},[])}}(),eZ=function(e){let{characterSetId:t,characters:r,config:a,selectedIndex:n,isDirty:s,enabled:l=!0,kvStorage:o}=e,i=(0,L.useMemo)(()=>o??(0,aW.createLocalStorageWrapper)(),[o]),[c,d]=(0,L.useState)(null),h=(0,L.useRef)(0),u=(0,aU.useTimer)();(0,L.useEffect)(()=>{if(t)try{let e=i.getItem(at.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE);if(e){let r=JSON.parse(e);r.characterSetId===t&&r.isDirty&&d(r)}}catch{}},[t,i]);let x=(0,L.useCallback)(()=>{if(t&&l&&0!==r.length)try{let e=(0,eG.binaryToBase64)((0,eG.serializeCharacterRom)(r,a)),l={characterSetId:t,binaryData:e,config:a,selectedIndex:n,timestamp:Date.now(),isDirty:s};i.setItem(at.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE,JSON.stringify(l)),h.current=Date.now()}catch(e){console.error("Auto-save failed:",e)}},[t,r,a,n,s,l,i]);(0,L.useEffect)(()=>{if(!l||!s||!t)return void u.clear();let e=Math.max(0,3e4-(Date.now()-h.current));u.set(x,e)},[l,s,t,x,u]),(0,L.useEffect)(()=>{if(!l||!s)return;let e=e=>{x(),e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[l,s,x]);let m=(0,L.useCallback)(()=>(d(null),c),[c]);return{hasRecoveryData:null!==c,recoveryData:c,recover:m,discard:(0,L.useCallback)(()=>{d(null);try{i.removeItem(at.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE)}catch{}},[i]),clearAutoSave:(0,L.useCallback)(()=>{try{i.removeItem(at.CHARACTER_EDITOR_STORAGE_KEY_AUTOSAVE)}catch{}},[i]),saveNow:x}}({characterSetId:t,characters:f.characters,config:f.config,selectedIndex:f.selectedIndex,isDirty:f.isDirty,enabled:!!x}),e2=function(e){let{characterSetId:t,enabled:r=!0,storage:a}=e,n=(0,L.useMemo)(()=>a??{save:aY,getForCharacterSet:aG,getById:async e=>(await aG("")).find(t=>t.id===e)??null,delete:aQ,deleteAllForCharacterSet:async e=>{for(let t of(await aG(e)))await aQ(t.id)},rename:aJ,getCount:async e=>(await aG(e)).length,isAtCapacity:async e=>(await aG(e)).length>=10,getMaxSnapshots:aq},[a]),[s,l]=(0,L.useState)([]),[o,i]=(0,L.useState)(!1),[c,d]=(0,L.useState)(null),h=n.getMaxSnapshots(),u=(0,L.useCallback)(async()=>{if(!t||!r)return void l([]);i(!0),d(null);try{let e=await n.getForCharacterSet(t);l(e)}catch(e){console.error("Failed to load snapshots:",e),d(e instanceof Error?e.message:"Failed to load snapshots"),l([])}finally{i(!1)}},[t,r,n]);(0,L.useEffect)(()=>{u()},[u]);let x=(0,L.useCallback)(async(e,r,a)=>{if(!t)return d("No character set ID"),!1;try{let s,l=(s=(0,eG.binaryToBase64)((0,eG.serializeCharacterRom)(r,a)),{id:(0,aV.generateId)(),characterSetId:t,name:e,createdAt:Date.now(),binaryData:s,config:a,characterCount:r.length});return await n.save(l),await u(),!0}catch(e){return console.error("Failed to save snapshot:",e),d(e instanceof Error?e.message:"Failed to save snapshot"),!1}},[t,u,n]),m=(0,L.useCallback)(async e=>{try{let t,r=s.find(t=>t.id===e);if(!r)return d("Snapshot not found"),null;return t=(0,eG.base64ToBinary)(r.binaryData),(0,eG.parseCharacterRom)(t,r.config)}catch(e){return console.error("Failed to restore snapshot:",e),d(e instanceof Error?e.message:"Failed to restore snapshot"),null}},[s]);return{snapshots:s,loading:o,error:c,saveNewSnapshot:x,restore:m,remove:(0,L.useCallback)(async e=>{try{return await n.delete(e),await u(),!0}catch(e){return console.error("Failed to delete snapshot:",e),d(e instanceof Error?e.message:"Failed to delete snapshot"),!1}},[u,n]),rename:(0,L.useCallback)(async(e,t)=>{try{return await n.rename(e,t),await u(),!0}catch(e){return console.error("Failed to rename snapshot:",e),d(e instanceof Error?e.message:"Failed to rename snapshot"),!1}},[u,n]),refresh:u,isAtCapacity:s.length>=h,maxSnapshots:h}}({characterSetId:t,enabled:!!x}),e4=function(e){let{characterSetId:t,enabled:r=!0,storage:a}=e,n=(0,L.useMemo)(()=>a??aW.characterStorage,[a]),[s,l]=(0,L.useState)([]),[o,i]=(0,L.useState)(!1),[c,d]=(0,L.useState)(null),h=(0,L.useCallback)(async()=>{if(!t||!r)return void l([]);i(!0),d(null);try{let e=[...await n.getNotes(t)].sort((e,t)=>t.createdAt-e.createdAt);l(e)}catch(e){console.error("Failed to load notes:",e),d(e instanceof Error?e.message:"Failed to load notes"),l([])}finally{i(!1)}},[t,r,n]);(0,L.useEffect)(()=>{h()},[h]);let u=(0,L.useCallback)(async e=>{if(!t)return d("No character set ID"),!1;if(!e.trim())return d("Note text cannot be empty"),!1;try{return await n.addNote(t,e.trim()),await h(),!0}catch(e){return console.error("Failed to add note:",e),d(e instanceof Error?e.message:"Failed to add note"),!1}},[t,h,n]);return{notes:s,loading:o,error:c,addNote:u,updateNote:(0,L.useCallback)(async(e,r)=>{if(!t)return d("No character set ID"),!1;if(!r.trim())return d("Note text cannot be empty"),!1;try{return await n.updateNote(t,e,r.trim()),await h(),!0}catch(e){return console.error("Failed to update note:",e),d(e instanceof Error?e.message:"Failed to update note"),!1}},[t,h,n]),deleteNote:(0,L.useCallback)(async e=>{if(!t)return d("No character set ID"),!1;try{return await n.deleteNote(t,e),await h(),!0}catch(e){return console.error("Failed to delete note:",e),d(e instanceof Error?e.message:"Failed to delete note"),!1}},[t,h,n]),refresh:h,hasNotes:s.length>0}}({characterSetId:t,enabled:!!x}),e3=function(e={}){let{enabled:t=!0,storage:r=a0}=e,[a,n]=(0,L.useState)(!1),[s,l]=(0,L.useState)(()=>({...aZ})),[o,i]=(0,L.useState)(!1);(0,L.useEffect)(()=>{l(function(e){try{let t=e.getItem(at.CHARACTER_EDITOR_STORAGE_KEY_TIPS_OVERLAY);if(t)return JSON.parse(t)}catch{}return{...aZ}}(r)),i(!0)},[r]),(0,L.useEffect)(()=>{if(o&&t&&!s.hasSeen&&s.showOnFirstVisit){let e=setTimeout(()=>{n(!0)},1e3);return()=>clearTimeout(e)}},[o,t,s.hasSeen,s.showOnFirstVisit]);let c=(0,L.useCallback)(()=>{n(!0)},[]),d=(0,L.useCallback)(()=>{n(!1)},[]),h=(0,L.useCallback)(()=>{if(!s.hasSeen){let e={...s,hasSeen:!0,lastDismissedAt:Date.now()};l(e),a1(r,e)}},[s,r]),u=(0,L.useCallback)(e=>{let t={...s,showOnFirstVisit:e};l(t),a1(r,t)},[s,r]),x=(0,L.useCallback)(()=>{let e={...aZ};l(e),a1(r,e)},[r]),m=(0,L.useCallback)(e=>{let t=s.expandedCategories.includes(e)?s.expandedCategories.filter(t=>t!==e):[...s.expandedCategories,e],a={...s,expandedCategories:t};l(a),a1(r,a)},[s,r]),f=(0,L.useCallback)(e=>{if(!s.expandedCategories.includes(e)){let t={...s,expandedCategories:[...s.expandedCategories,e]};l(t),a1(r,t)}},[s,r]),p=(0,L.useCallback)(e=>{if(s.expandedCategories.includes(e)){let t={...s,expandedCategories:s.expandedCategories.filter(t=>t!==e)};l(t),a1(r,t)}},[s,r]),g=!s.hasSeen&&s.showOnFirstVisit;return{isOpen:a,open:c,close:d,autoShowEnabled:s.showOnFirstVisit,setAutoShowEnabled:u,shouldAutoShow:g,markAsSeen:h,resetPreferences:x,expandedCategories:s.expandedCategories,toggleCategory:m,expandCategory:f,collapseCategory:p}}({enabled:!!x}),e5=(0,L.useCallback)(async e=>{let t=await e2.saveNewSnapshot(e,f.characters,f.config);return t&&l.success("Snapshot saved"),t},[e2,f.characters,f.config,l]),e8=(0,L.useCallback)((e,t,r)=>{if(x){let a=t.size;a===e.length?(f.reset({...x,characters:e}),l.info(r?`Restored: ${r}`:"Snapshot restored")):(f.replaceCharactersAtIndices(e,t,"Partial snapshot restore"),l.info(r?`Restored ${a} character${1!==a?"s":""} from: ${r}`:`Restored ${a} character${1!==a?"s":""}`))}},[x,f,l]),e6=(0,L.useCallback)(async e=>{let t=await e2.remove(e);return t&&l.success("Snapshot deleted"),t},[e2,l]);(0,L.useEffect)(()=>{!async function(){if(!s){if(!t){d("No character set ID provided"),i(!1);return}try{let e=await r(t);e?(m(e),f.reset(e)):d("Character set not found")}catch(e){d(e instanceof Error?e.message:"Failed to load character set")}finally{i(!1)}}}()},[t,s]);let e7=(0,L.useCallback)(async()=>{if(x){if(x.metadata.isBuiltIn)return void l.info("Built-in sets are read-only. Use 'Save As' to create a copy.");try{u(!0);let e={metadata:{...x.metadata,updatedAt:Date.now()},config:f.config,characters:f.characters};await a(e),f.markSaved(),m(e),eZ.clearAutoSave(),l.success("Saved successfully")}catch(e){console.error("Failed to save:",e),l.error("Failed to save changes")}finally{u(!1)}}},[x,f,a,eZ,l]),e9=(0,L.useCallback)(()=>{f.isDirty?eX(!0):e.push("/tools/character-rom-editor")},[f.isDirty,e]),te=(0,L.useCallback)(()=>{eZ.clearAutoSave(),eX(!1),e.push("/tools/character-rom-editor")},[eZ,e]),tt=(0,L.useCallback)(()=>{t&&e.push(`/tools/character-rom-editor/export?id=${t}&from=editor&editId=${t}`)},[t,e]),tr=(0,L.useCallback)(()=>{B(!0)},[]),ta=(0,L.useCallback)(()=>{x&&(f.reset(x),l.info("Changes discarded")),B(!1)},[x,f,l]),tn=(0,L.useCallback)(()=>{F(!0)},[]),ts=(0,L.useCallback)(()=>{f.clearHistory(),l.info("History cleared"),F(!1)},[f,l]),tl=(0,L.useCallback)((e,t,r)=>{f.resizeCharacters(e,t,r)},[f]),to=(0,L.useCallback)(()=>{let e=eZ.recover();if(e&&x)try{let t=(0,eG.base64ToBinary)(e.binaryData),r=(0,eG.parseCharacterRom)(t,e.config);f.reset({...x,characters:r,config:e.config}),f.setSelectedIndex(e.selectedIndex),l.success("Changes recovered")}catch(e){console.error("Failed to recover:",e),eZ.discard(),l.error("Failed to recover changes")}},[eZ,x,f,l]),ti=(0,L.useCallback)(async()=>{if(x&&G.trim())try{q(!0);let t={metadata:{...x.metadata,id:crypto.randomUUID(),name:G.trim(),createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1,origin:"copied",copiedFromId:x.metadata.id,copiedFromName:x.metadata.name},config:f.config,characters:f.characters};await a(t),eZ.clearAutoSave(),l.success(`Saved as "${G.trim()}"`),e.push(`/tools/character-rom-editor/edit?id=${t.metadata.id}`)}catch(e){console.error("Failed to save as:",e),l.error("Failed to save copy")}finally{q(!1),Y(!1),X("")}},[x,G,f,a,eZ,e,l]),tc=(0,L.useCallback)(async()=>{if(t)try{z(!0),await n(t),l.success("Character set deleted"),e.push("/tools/character-rom-editor")}catch(e){console.error("Failed to delete:",e),l.error("Failed to delete character set")}finally{z(!1),I(!1)}},[t,n,e,l]),td=(0,L.useCallback)(async e=>{if(x)try{let t={...x,metadata:{...x.metadata,...e,updatedAt:Date.now()}};await a(t),m(t),l.success("Info updated")}catch(e){console.error("Failed to update metadata:",e),l.error("Failed to update info")}},[x,a,l]),th=(0,L.useCallback)(()=>{X(x?.metadata.name?`${x.metadata.name} (copy)`:""),Y(!0)},[x?.metadata.name]),tu=(0,L.useCallback)(()=>{es(x?.metadata.name?`${x.metadata.name} (copy)`:""),ee(!0)},[x?.metadata.name]),tx=(0,L.useCallback)(async()=>{if(x&&en.trim())try{eo(!0);let t={metadata:{...x.metadata,id:(0,aV.generateId)(),name:en.trim(),createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1,origin:"copied",copiedFromId:x.metadata.id,copiedFromName:x.metadata.name},config:f.config,characters:f.characters};await a(t),l.success(`Duplicated as "${en.trim()}"`),e.push(`/tools/character-rom-editor/edit?id=${t.metadata.id}`)}catch(e){console.error("Failed to duplicate:",e),l.error("Failed to duplicate character set")}finally{eo(!1),ee(!1),es("")}},[x,en,f,a,e,l]),tm=f.characters.length,tf=(0,L.useCallback)(()=>{f.selectedIndex>0&&f.setSelectedIndex(f.selectedIndex-1)},[f]),tp=(0,L.useCallback)(()=>{f.selectedIndex<tm-1&&f.setSelectedIndex(f.selectedIndex+1)},[f,tm]),tg=(0,L.useCallback)(()=>{let e=Math.max(0,f.selectedIndex-16);f.setSelectedIndex(e)},[f]),tb=(0,L.useCallback)(()=>{let e=Math.min(tm-1,f.selectedIndex+16);f.setSelectedIndex(e)},[f,tm]),tv=(0,L.useCallback)(()=>{f.setSelectedIndex(0)},[f]),ty=(0,L.useCallback)(()=>{f.setSelectedIndex(tm-1)},[f,tm]),tw=(0,L.useMemo)(()=>{var e;return[{key:"z",ctrl:!0,action:(e={undo:f.undo,redo:f.redo,save:e7,rotateLeft:()=>f.rotateSelected("left"),rotateRight:()=>f.rotateSelected("right"),shiftUp:()=>f.shiftSelected("up"),shiftDown:()=>f.shiftSelected("down"),shiftLeft:()=>f.shiftSelected("left"),shiftRight:()=>f.shiftSelected("right"),invert:f.invertSelected,flipHorizontal:f.flipSelectedHorizontal,flipVertical:f.flipSelectedVertical,selectAll:f.selectAll,deleteSelected:()=>$(!0),addCharacter:f.addCharacter,duplicateSelected:f.duplicateSelected,showHelp:()=>N(!0),navigatePrev:tf,navigateNext:tp,navigatePageUp:tg,navigatePageDown:tb,navigateFirst:tv,navigateLast:ty,goToCharacter:()=>ev(!0),showAsciiMap:()=>ew(!0),showTextPreview:()=>ek(!0),showSnapshots:()=>eS(!0),showNotes:()=>eT(!0),exportSet:tt,importSet:()=>eh(!0),shareSet:()=>eA(!0),saveAs:th,editMetadata:()=>M(!0),resetChanges:tr,reorderCharacters:()=>ef(!0),zoomToFit:w}).undo,description:"Undo",context:"Editor"},{key:"z",ctrl:!0,shift:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"y",ctrl:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"s",ctrl:!0,action:e.save,description:"Save",context:"Editor"},{key:"r",action:e.rotateRight,description:"Rotate right",context:"Editor"},{key:"r",shift:!0,action:e.rotateLeft,description:"Rotate left",context:"Editor"},{key:"w",action:e.shiftUp,description:"Shift up",context:"Editor"},{key:"s",action:e.shiftDown,description:"Shift down",context:"Editor"},{key:"a",action:e.shiftLeft,description:"Shift left",context:"Editor"},{key:"d",action:e.shiftRight,description:"Shift right",context:"Editor"},{key:"i",action:e.invert,description:"Invert colors",context:"Editor"},{key:"h",action:e.flipHorizontal,description:"Flip horizontal",context:"Editor"},{key:"v",action:e.flipVertical,description:"Flip vertical",context:"Editor"},{key:"a",ctrl:!0,action:e.selectAll,description:"Select all",context:"Sidebar"},{key:"Delete",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"Backspace",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"n",ctrl:!0,action:e.addCharacter,description:"Add new character",context:"Editor"},...e.duplicateSelected?[{key:"d",ctrl:!0,action:e.duplicateSelected,description:"Duplicate selected characters",context:"Editor"}]:[],{key:"?",action:e.showHelp,description:"Show keyboard shortcuts",context:"Global"},...e.navigatePrev?[{key:"ArrowUp",action:e.navigatePrev,description:"Previous character",context:"Navigation"}]:[],...e.navigateNext?[{key:"ArrowDown",action:e.navigateNext,description:"Next character",context:"Navigation"}]:[],...e.navigatePageUp?[{key:"PageUp",action:e.navigatePageUp,description:"Jump 16 characters up",context:"Navigation"}]:[],...e.navigatePageDown?[{key:"PageDown",action:e.navigatePageDown,description:"Jump 16 characters down",context:"Navigation"}]:[],...e.navigateFirst?[{key:"Home",action:e.navigateFirst,description:"First character",context:"Navigation"}]:[],...e.navigateLast?[{key:"End",action:e.navigateLast,description:"Last character",context:"Navigation"}]:[],...e.goToCharacter?[{key:"g",action:e.goToCharacter,description:"Go to character",context:"Navigation"}]:[],...e.showAsciiMap?[{key:"m",action:e.showAsciiMap,description:"Show ASCII map",context:"Navigation"}]:[],...e.showTextPreview?[{key:"t",action:e.showTextPreview,description:"Text preview",context:"View"}]:[],...e.showSnapshots?[{key:"s",ctrl:!0,shift:!0,action:e.showSnapshots,description:"Snapshots",context:"Editor"}]:[],...e.showNotes?[{key:"n",action:e.showNotes,description:"Notes",context:"View"}]:[],...e.exportSet?[{key:"e",action:e.exportSet,description:"Export character set",context:"File"}]:[],...e.importSet?[{key:"i",ctrl:!0,action:e.importSet,description:"Import characters",context:"File"}]:[],...e.shareSet?[{key:"e",ctrl:!0,shift:!0,action:e.shareSet,description:"Share character set",context:"File"}]:[],...e.saveAs?[{key:"s",ctrl:!0,alt:!0,action:e.saveAs,description:"Save as new",context:"File"}]:[],...e.editMetadata?[{key:"F2",action:e.editMetadata,description:"Edit info",context:"File"}]:[],...e.resetChanges?[{key:"r",ctrl:!0,alt:!0,action:e.resetChanges,description:"Reset changes",context:"Editor"}]:[],...e.reorderCharacters?[{key:"o",action:e.reorderCharacters,description:"Reorder characters",context:"Editor"}]:[],...e.zoomToFit?[{key:"0",action:e.zoomToFit,description:"Zoom to fit",context:"View"}]:[]]},[f,e7,tt,tr,w,th,tf,tp,tg,tb,tv,ty]);!function(e,t={}){let{enabled:r=!0,target:a=null}=t,n=(0,L.useRef)(e);(0,L.useEffect)(()=>{n.current=e},[e]);let s=(0,L.useCallback)(e=>{let t=e.target?.tagName?.toLowerCase();if("input"!==t&&"textarea"!==t&&"select"!==t||e.ctrlKey||e.metaKey)for(let t of n.current){let r=e.key.toLowerCase()===t.key.toLowerCase(),a=!!t.ctrl===(e.ctrlKey||e.metaKey),n=!!t.shift===e.shiftKey,s=!!t.alt===e.altKey;if(r&&a&&n&&s){e.preventDefault(),t.action();return}}},[]);(0,L.useEffect)(()=>{if(!r)return;let e=a||window;return e.addEventListener("keydown",s),()=>{e.removeEventListener("keydown",s)}},[r,a,s])}(tw,{enabled:!k});let tj=(0,L.useMemo)(()=>{if(!eQ)return[];let e=eQ.index,t=f.batchSelection.size>0,r=t?f.batchSelection.size+1:1;return[{label:"Edit",onClick:()=>f.setSelectedIndex(e)},{label:"Copy From...",shortcut:"C",onClick:()=>ex(!0)},{label:"",onClick:()=>{},divider:!0},{label:"Invert",shortcut:"I",onClick:f.invertSelected},{label:"Clear",onClick:f.clearSelected},{label:"Fill",onClick:f.fillSelected},{label:"",onClick:()=>{},divider:!0},{label:`Delete${t?` (${r})`:""}`,shortcut:"Del",onClick:()=>{$(!0)},danger:!0}]},[eQ,f]),tC=[{id:"new",label:"New Set",tooltip:"Create a new character set",icon:(0,E.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 2v6h6"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11v6m-3-3h6"})]}),onClick:()=>e.push(`/tools/character-rom-editor/add?from=editor&editId=${t}`),priority:3},{id:"save",label:h?"Saving...":"Save Set",tooltip:x?.metadata.isBuiltIn?"Cannot save built-in character set (use Save As)":"Save character set to browser storage",shortcut:"Ctrl+S",icon:(0,E.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10l4 4v12a2 2 0 01-2 2H7a2 2 0 01-2-2V5z"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 3v5h8V3"}),(0,E.jsx)("rect",{x:"14",y:"3",width:"2",height:"5",rx:"0.5",fill:"currentColor",stroke:"none"}),(0,E.jsx)("rect",{x:"8",y:"12",width:"8",height:"6",rx:"1",strokeWidth:2})]}),onClick:e7,disabled:h||!f.isDirty||x?.metadata.isBuiltIn,active:f.isDirty&&!x?.metadata.isBuiltIn,priority:3},{id:"save-as",label:"Save Set As",tooltip:"Save as a new character set with a different name",shortcut:"Ctrl+Alt+S",icon:(0,E.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10l4 4v12a2 2 0 01-2 2H7a2 2 0 01-2-2V5z"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 3v5h6V3"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M18 8v4m-2-2h4"}),(0,E.jsx)("rect",{x:"8",y:"12",width:"8",height:"6",rx:"1",strokeWidth:2})]}),onClick:th,priority:1},{id:"duplicate",label:"Duplicate Set",tooltip:"Create a copy of this character set",icon:(0,E.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2"}),(0,E.jsx)("rect",{x:"8",y:"8",width:"12",height:"12",rx:"2",strokeWidth:2})]}),onClick:tu,priority:1},{id:"delete",label:"Delete Set",tooltip:"Delete this character set from browser storage",icon:(0,E.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 3h4"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 6v14a2 2 0 002 2h8a2 2 0 002-2V6"}),(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 10v8M14 10v8"})]}),onClick:()=>I(!0),disabled:x?.metadata.isBuiltIn,priority:1},{type:"separator",id:"sep-0"},{id:"edit-metadata",label:"Edit Info",tooltip:"Edit character set name and description",shortcut:"F2",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),onClick:()=>M(!0),priority:3},{id:"resize",label:"Resize Set",tooltip:"Change character dimensions (width Ã— height)",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),onClick:()=>ec(!0),priority:0},{id:"reorder",label:"Reorder",tooltip:"Drag and drop to reorder characters",shortcut:"O",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),onClick:()=>ef(!0),priority:0},{id:"notes",label:"Notes",tooltip:"Add notes and annotations",shortcut:"N",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),onClick:()=>eT(!0),priority:1,active:e4.hasNotes,activeVariant:"amber"},{type:"separator",id:"sep-1"},{id:"undo",label:"Undo",tooltip:"Undo last change",shortcut:"Ctrl+Z",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),onClick:f.undo,disabled:!f.canUndo,priority:3},{id:"redo",label:"Redo",tooltip:"Redo last undone change",shortcut:"Ctrl+Y",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})}),onClick:f.redo,disabled:!f.canRedo,priority:3},{id:"reset",label:"Reset Set",tooltip:"Discard all unsaved changes",shortcut:"Ctrl+Alt+R",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),onClick:tr,disabled:!f.isDirty,priority:2},{type:"separator",id:"sep-2"},{id:"goto",label:"Go to",tooltip:"Jump to a specific character by index",shortcut:"G",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),onClick:()=>ev(!0),priority:0},{id:"ascii-map",label:"ASCII Map",tooltip:"View all characters in a grid with ASCII codes",shortcut:"M",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),onClick:()=>ew(!0),priority:0},{type:"separator",id:"sep-3"},{id:"overlay",label:"Overlay",tooltip:"Overlay another character set for tracing",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),onClick:()=>{ez?eP(null):eO(!0)},active:!!ez,activeVariant:"amber",priority:0},{id:"similar-characters",label:"Similar",tooltip:"Find similar character sets to compare and use as overlay",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),onClick:()=>eW(!0),priority:0},{id:"text-preview",label:"Preview",tooltip:"Preview text rendered with this character set",shortcut:"T",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})}),onClick:()=>ek(!0),priority:2},{id:"snapshots",label:`Snapshots (${e2.snapshots.length})`,tooltip:"Save and restore named versions of your work",shortcut:"Ctrl+Shift+S",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),onClick:()=>eS(!0),priority:1,active:e2.snapshots.length>0,activeVariant:"amber"},{type:"separator",id:"sep-4"},{id:"import-set",label:"Import Set",tooltip:"Import a character set from file",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5v14a2 2 0 002 2h10a2 2 0 002-2V5M12 3v12m0 0l4-4m-4 4l-4-4"})}),onClick:()=>e.push(`/tools/character-rom-editor/import?from=editor&editId=${t}`),priority:1},{id:"export",label:"Export Set",tooltip:"Export character set as ROM binary file",shortcut:"E",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5v14a2 2 0 002 2h10a2 2 0 002-2V5M12 21V9m0 0l4 4m-4-4l-4 4"})}),onClick:tt,priority:1},{id:"share",label:"Share",tooltip:"Generate a shareable link to this character set",shortcut:"Ctrl+Shift+E",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),onClick:()=>eA(!0),priority:0},{type:"separator",id:"sep-5"},{id:"tips",label:"Tips",tooltip:"Tips & tricks for using the editor",icon:(0,E.jsx)(ej,{className:"w-4 h-4"}),onClick:()=>e3.open(),priority:0},{id:"help",label:"Help",tooltip:"View all keyboard shortcuts and help",shortcut:"?",icon:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),onClick:()=>N(!0),priority:3}];if(o)return(0,E.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-retro-dark",children:(0,E.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,E.jsx)("div",{className:"w-12 h-12 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"}),(0,E.jsx)("span",{className:"text-sm text-gray-400",children:"Loading character set..."})]})});if(c)return(0,E.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-retro-dark",children:(0,E.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,E.jsx)("svg",{className:"w-16 h-16 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,E.jsx)("h2",{className:"text-lg font-medium text-red-400",children:c}),(0,E.jsx)(D.default,{href:"/tools/character-rom-editor",className:"text-sm text-retro-cyan hover:text-retro-pink transition-colors",children:"Back to Library"})]})});let tk=f.characters[f.selectedIndex]||null,tN=f.batchSelection.size>0;return(0,E.jsxs)(U,{title:x?.metadata.name||"Character Editor",toolbar:tC,children:[(0,E.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,E.jsx)(et,{characterSetName:x?.metadata.name||"Untitled",isBuiltIn:x?.metadata.isBuiltIn,isDirty:f.isDirty,characterIndex:f.selectedIndex,totalCharacters:f.characters.length,batchMode:tN,zoom:b,onZoomChange:v,onZoomToFit:w,colors:p,onColorsChange:g,onBack:e9,className:"flex-shrink-0"}),(0,E.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,E.jsx)(V,{leftSidebar:(0,E.jsx)(Q,{characters:f.characters,config:f.config,selectedIndex:f.selectedIndex,batchSelection:f.batchSelection,onSelect:f.toggleBatchSelection,onAddCharacter:f.addCharacter,onDeleteSelected:()=>$(!0),onSelectAll:f.selectAll,onSelectNone:()=>f.toggleBatchSelection(f.selectedIndex,!1),onContextMenu:eJ,foregroundColor:p.foreground,backgroundColor:p.background}),leftSidebarWidth:"240px",rightSidebar:(0,E.jsx)(eE,{character:tk,characterWidth:f.config.width,characterHeight:f.config.height,onShift:f.shiftSelected,onRotate:f.rotateSelected,onFlipHorizontal:f.flipSelectedHorizontal,onFlipVertical:f.flipSelectedVertical,onInvert:f.invertSelected,onClear:f.clearSelected,onFill:f.fillSelected,onCenter:f.centerSelected,onScale:()=>eg(!0),onDelete:()=>$(!0),onCopy:()=>ex(!0),onAdd:f.insertCharacterAfter,onDuplicate:f.duplicateSelected,onImport:()=>eh(!0),disabled:!tk,className:"h-full"}),rightSidebarWidth:"120px",rightSidebarCollapsible:!1,children:(0,E.jsxs)("div",{className:"w-full h-full flex flex-col",children:[ez&&(0,E.jsxs)("div",{className:"flex-shrink-0 flex items-center gap-2 px-4 py-1.5 bg-retro-navy/80 backdrop-blur-sm border-b border-retro-grid/30 text-xs z-10",children:[(0,E.jsx)("span",{className:"text-gray-400",children:"Overlay:"}),(0,E.jsx)("span",{className:"text-retro-amber truncate max-w-[150px]",children:ez.metadata.name}),(0,E.jsx)("span",{className:"text-gray-500",children:"|"}),(0,E.jsx)("button",{onClick:()=>eV("pixel"),className:`px-2 py-0.5 rounded transition-colors ${"pixel"===eU?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:text-white"}`,children:"1:1 Pixels"}),(0,E.jsx)("button",{onClick:()=>eV("stretch"),className:`px-2 py-0.5 rounded transition-colors ${"stretch"===eU?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:text-white"}`,children:"Stretch"}),(0,E.jsx)("button",{onClick:()=>eV("side-by-side"),className:`px-2 py-0.5 rounded transition-colors ${"side-by-side"===eU?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:text-white"}`,children:"Side by Side"}),(0,E.jsx)("div",{className:"flex-1"}),(0,E.jsx)("button",{onClick:()=>eP(null),className:"text-gray-400 hover:text-red-400 transition-colors",title:"Remove overlay",children:(0,E.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,E.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,E.jsxs)("div",{className:"relative flex-1 min-h-0 w-full",children:[(0,E.jsx)("div",{ref:y,className:"absolute inset-0 pointer-events-none"}),"side-by-side"===eU&&ez?(0,E.jsxs)("div",{className:"w-full h-full grid grid-cols-2 gap-4",children:[(0,E.jsx)("div",{className:"flex items-center justify-center",children:(0,E.jsxs)("div",{className:"flex flex-col items-center",children:[(0,E.jsxs)("div",{className:"text-xs text-gray-400 mb-2",children:[x?.metadata.name," #",f.selectedIndex]}),(0,E.jsx)(K,{character:tk,config:f.config,onPixelToggle:f.toggleSelectedPixel,onPixelSet:f.setSelectedPixel,onDragStart:f.startBatch,onDragEnd:()=>f.endBatch("Paint pixels"),getPixelState:f.getSelectedPixelState,batchMode:tN,foregroundColor:p.foreground,backgroundColor:p.background,gridColor:p.gridColor,zoom:b,minZoom:8,maxZoom:100,onZoomChange:v,onPixelHover:(e,t)=>C({x:t,y:e}),onPixelLeave:()=>C(null),overlayCharacter:null,overlayConfig:void 0,overlayMode:eU})]})}),(0,E.jsx)("div",{className:"flex items-center justify-center",children:(0,E.jsxs)("div",{className:"flex flex-col items-center",children:[(0,E.jsxs)("div",{className:"text-xs text-gray-400 mb-2",children:[ez.metadata.name," #",f.selectedIndex]}),(0,E.jsx)("div",{className:"border border-retro-amber/30 rounded p-1 bg-black/30",children:(0,E.jsx)(_.CharacterDisplay,{character:ez.characters[f.selectedIndex]||{pixels:Array(ez.config.height).fill(null).map(()=>Array(ez.config.width).fill(!1))},mode:"large",scale:b,foregroundColor:p.foreground,backgroundColor:p.background,gridColor:p.gridColor,gridThickness:1,interactive:!1})}),!ez.characters[f.selectedIndex]&&(0,E.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"No character at this index"})]})})]}):(0,E.jsx)("div",{className:"w-full h-full",children:(0,E.jsx)(K,{character:tk,config:f.config,onPixelToggle:f.toggleSelectedPixel,onPixelSet:f.setSelectedPixel,onDragStart:f.startBatch,onDragEnd:()=>f.endBatch("Paint pixels"),getPixelState:f.getSelectedPixelState,batchMode:tN,foregroundColor:p.foreground,backgroundColor:p.background,gridColor:p.gridColor,zoom:b,minZoom:8,maxZoom:100,onZoomChange:v,onPixelHover:(e,t)=>C({x:t,y:e}),onPixelLeave:()=>C(null),overlayCharacter:ez?.characters[f.selectedIndex]||null,overlayConfig:ez?.config,overlayMode:eU})})]})]})})}),(0,E.jsx)(eL,{history:f.history,currentIndex:f.historyIndex,onJump:f.jumpToHistory,canRedo:f.canRedo,totalEntries:f.totalHistoryEntries,onClear:tn}),(0,E.jsx)(er,{hoverCoords:j})]}),(0,E.jsx)(a$.ConfirmDialog,{isOpen:eZ.hasRecoveryData,title:"Recover Unsaved Changes?",message:"We found unsaved changes from a previous session. Would you like to recover them?",details:eZ.recoveryData&&(0,E.jsxs)(E.Fragment,{children:["Last saved: ",new Date(eZ.recoveryData.timestamp).toLocaleString()]}),confirmLabel:"Recover",cancelLabel:"Discard",variant:"info",onConfirm:to,onCancel:eZ.discard}),(0,E.jsx)(eD,{isOpen:k,onClose:()=>N(!1),shortcuts:tw}),(0,E.jsx)(eH,{isOpen:e3.isOpen,onClose:e3.close,autoShowEnabled:e3.autoShowEnabled,onAutoShowChange:e3.setAutoShowEnabled,expandedCategories:e3.expandedCategories,onToggleCategory:e3.toggleCategory,onFirstClose:e3.markAsSeen}),x&&(0,E.jsx)(e$.MetadataEditModal,{isOpen:S,onClose:()=>M(!1),metadata:x.metadata,onSave:td}),(0,E.jsx)(e_,{isOpen:ei,onClose:()=>ec(!1),currentWidth:f.config.width,currentHeight:f.config.height,onResize:tl}),(0,E.jsx)(e0,{isOpen:ed,onClose:()=>eh(!1),currentConfig:f.config,onImport:e=>{f.addCharacters(e)}}),(0,E.jsx)(e1,{isOpen:eu,onClose:()=>ex(!1),characters:f.characters,currentIndex:f.selectedIndex,onCopy:e=>{[f.selectedIndex,...Array.from(f.batchSelection)].forEach(t=>{f.copyCharacter(e,t)})}}),(0,E.jsx)(r2,{isOpen:em,onClose:()=>ef(!1),characters:f.characters,onReorder:e=>{f.setCharacters(e)}}),(0,E.jsx)(r5,{isOpen:ep,onClose:()=>eg(!1),onScale:(e,t,r)=>{f.scaleSelected(e,t,r),eg(!1)},characters:f.characters,selectedIndices:f.selectedIndices,config:f.config,foregroundColor:p.foreground,backgroundColor:p.background}),(0,E.jsx)(r8,{isOpen:eb,onClose:()=>ev(!1),totalCharacters:tm,currentIndex:f.selectedIndex,onGoTo:e=>f.setSelectedIndex(e)}),(0,E.jsx)(r7,{isOpen:ey,onClose:()=>ew(!1),characters:f.characters,selectedIndex:f.selectedIndex,onSelect:e=>f.setSelectedIndex(e),foregroundColor:p.foreground,backgroundColor:p.background}),(0,E.jsx)(ai,{isOpen:eC,onClose:()=>ek(!1),characters:f.characters,config:f.config,colors:p}),(0,E.jsx)(am,{isOpen:eN,onClose:()=>eS(!1),snapshots:e2.snapshots,loading:e2.loading,error:e2.error,isAtCapacity:e2.isAtCapacity,maxSnapshots:e2.maxSnapshots,currentCharacters:f.characters,currentConfig:f.config,foregroundColor:p.foreground,backgroundColor:p.background,onSave:e5,onRestore:e2.restore,onDelete:e6,onRename:e2.rename,onRestoreApply:e8}),(0,E.jsx)(aH,{isOpen:eI,onClose:()=>eT(!1),notes:e4.notes,loading:e4.loading,error:e4.error,characterSetName:x?.metadata.name??"",onAdd:e4.addNote,onUpdate:e4.updateNote,onDelete:e4.deleteNote}),x&&(0,E.jsx)(aA,{isOpen:eM,onClose:()=>eA(!1),name:x.metadata.name,description:x.metadata.description,characters:f.characters,config:f.config}),(0,E.jsx)(aI,{isOpen:eB,onClose:()=>eO(!1),excludeId:t||void 0,onSelectSet:eP}),x&&(0,E.jsx)(aB,{isOpen:eF,onClose:()=>eW(!1),currentCharacters:f.characters,currentConfig:f.config,excludeId:t||void 0,foregroundColor:p.foreground,backgroundColor:p.background,onSelectForOverlay:eP}),eQ&&(0,E.jsx)(eR,{x:eQ.x,y:eQ.y,items:tj,onClose:eq}),W&&(0,E.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,E.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>Y(!1)}),(0,E.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Save As"}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"New name"}),(0,E.jsx)("input",{type:"text",value:G,onChange:e=>X(e.target.value),placeholder:"Character set name",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&G.trim()?ti():"Escape"===e.key&&Y(!1)}})]}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:()=>Y(!1),className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,E.jsx)("button",{onClick:ti,disabled:!G.trim()||J,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:J?"Saving...":"Save"})]})]})]}),Z&&(0,E.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,E.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>ee(!1)}),(0,E.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Duplicate Character Set"}),(0,E.jsxs)("div",{className:"mb-4",children:[(0,E.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Name for duplicate"}),(0,E.jsx)("input",{type:"text",value:en,onChange:e=>es(e.target.value),placeholder:"Character set name",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&en.trim()?tx():"Escape"===e.key&&ee(!1)}})]}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:()=>ee(!1),className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,E.jsx)("button",{onClick:tx,disabled:!en.trim()||el,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:el?"Duplicating...":"Duplicate"})]})]})]}),A&&(0,E.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,E.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>I(!1)}),(0,E.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white mb-2",children:"Delete Character Set?"}),(0,E.jsxs)("p",{className:"text-sm text-gray-400 mb-4",children:['Are you sure you want to delete "',x?.metadata.name,'"? This action cannot be undone.']}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:()=>I(!1),className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,E.jsx)("button",{onClick:tc,disabled:T,className:"flex-1 px-4 py-2 text-sm bg-red-500/20 border border-red-500 rounded text-red-400 hover:bg-red-500/30 transition-colors disabled:opacity-50",children:T?"Deleting...":"Delete"})]})]})]}),P&&(0,E.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,E.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>B(!1)}),(0,E.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,E.jsx)("h2",{className:"text-lg font-medium text-white mb-2",children:"Reset to Last Saved?"}),(0,E.jsxs)("p",{className:"text-sm text-gray-400 mb-4",children:['This will discard all unsaved changes and restore "',x?.metadata.name,'" to its last saved state. This action cannot be undone.']}),(0,E.jsxs)("div",{className:"flex gap-3",children:[(0,E.jsx)("button",{onClick:()=>B(!1),className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,E.jsx)("button",{onClick:ta,className:"flex-1 px-4 py-2 text-sm bg-orange-500/20 border border-orange-500 rounded text-orange-400 hover:bg-orange-500/30 transition-colors",children:"Reset"})]})]})]}),(0,E.jsx)(a$.ConfirmDialog,{isOpen:O,title:"Clear History?",message:"This will clear all undo/redo history. You will not be able to undo any previous changes after this action.",confirmLabel:"Clear History",cancelLabel:"Cancel",variant:"warning",onConfirm:ts,onCancel:()=>F(!1)}),(0,E.jsx)(a$.ConfirmDialog,{isOpen:eK,title:"Unsaved Changes",message:"You have unsaved changes. Are you sure you want to leave? Your changes will be lost.",confirmLabel:"Leave",cancelLabel:"Stay",variant:"warning",onConfirm:te,onCancel:()=>eX(!1)}),(0,E.jsx)(a$.ConfirmDialog,{isOpen:H,title:f.batchSelection.size>0?"Delete Characters?":"Delete Character?",message:f.batchSelection.size>0?`Are you sure you want to delete ${f.batchSelection.size+1} selected characters? This action cannot be undone.`:"Are you sure you want to delete this character? This action cannot be undone.",confirmLabel:"Delete",cancelLabel:"Cancel",variant:"danger",onConfirm:()=>{let e=f.batchSelection.size>0?f.batchSelection.size+1:1;f.deleteSelected(),$(!1),l.success(e>1?`${e} characters deleted`:"Character deleted")},onCancel:()=>$(!1)})]})}e.s(["EditView",()=>a5],53454)}]);