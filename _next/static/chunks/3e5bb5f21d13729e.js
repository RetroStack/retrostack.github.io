(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},58234,e=>{"use strict";var t=e.i(43476),r=e.i(22016),a=e.i(28540),s=e.i(85149);function n(){let e=new Date().getFullYear();return(0,t.jsx)("footer",{className:"bg-retro-navy border-t border-retro-grid safe-bottom safe-x",children:(0,t.jsx)(a.Container,{children:(0,t.jsxs)("div",{className:"py-8 sm:py-12",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8 mb-8 sm:mb-12",children:[(0,t.jsxs)("div",{className:"sm:col-span-2 lg:col-span-1",children:[(0,t.jsx)(r.default,{href:"/",className:"inline-block touch-target",children:(0,t.jsx)("span",{className:"font-display text-base sm:text-lg text-retro-pink",children:s.SITE_CONFIG.name})}),(0,t.jsx)("p",{className:"mt-3 sm:mt-4 text-sm text-gray-400 max-w-xs",children:s.SITE_CONFIG.description})]}),s.NAV_ITEMS.filter(e=>e.children).map(e=>(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-ui text-xs sm:text-sm uppercase tracking-wider text-retro-cyan mb-3 sm:mb-4",children:e.label}),(0,t.jsx)("ul",{className:"space-y-1 sm:space-y-2",children:e.children?.map(e=>(0,t.jsx)("li",{children:(0,t.jsx)(r.default,{href:e.href,className:"inline-flex items-center min-h-[36px] sm:min-h-[32px] text-sm text-gray-400 hover:text-retro-pink transition-colors duration-200",children:e.label})},e.href))})]},e.label))]}),(0,t.jsxs)("div",{className:"pt-6 sm:pt-8 border-t border-retro-grid/50 flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 text-center sm:text-left",children:["Â© ",e," ",s.SITE_CONFIG.name,". All rights reserved."]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("a",{href:s.SOCIAL_LINKS.github,target:"_blank",rel:"noopener noreferrer",className:"touch-target flex items-center justify-center text-gray-400 hover:text-retro-cyan transition-colors duration-200 rounded-md hover:bg-retro-purple/30","aria-label":"GitHub",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"})})}),(0,t.jsx)("a",{href:s.SOCIAL_LINKS.patreon,target:"_blank",rel:"noopener noreferrer",className:"touch-target flex items-center justify-center text-gray-400 hover:text-retro-pink transition-colors duration-200 rounded-md hover:bg-retro-purple/30","aria-label":"Patreon",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M15.386.524c-4.764 0-8.64 3.876-8.64 8.64 0 4.75 3.876 8.613 8.64 8.613 4.75 0 8.614-3.864 8.614-8.613C24 4.4 20.136.524 15.386.524M.003 23.537h4.22V.524H.003"})})})]})]})]})})})}e.s(["Footer",()=>n])},72547,79724,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(22016);function s(e,t=!0){let a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!t)return;let r=t=>{a.current&&!a.current.contains(t.target)&&e()},s=t=>{"Escape"===t.key&&e()};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),document.addEventListener("keydown",s),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r),document.removeEventListener("keydown",s)}},[e,t]),a}function n({items:e,trigger:n,align:i="right",className:o="",label:l="More options"}){let[c,d]=(0,r.useState)(!1),u=s((0,r.useCallback)(()=>{d(!1)},[]),c),h=e=>{e.disabled||(e.onClick?.(),d(!1))};return 0===e.length?null:(0,t.jsxs)("div",{ref:u,className:`relative ${o}`,children:[(0,t.jsx)("button",{onClick:()=>{d(!c)},className:"touch-target flex items-center justify-center p-2 text-gray-400 hover:text-retro-cyan transition-colors rounded-md hover:bg-retro-purple/30","aria-label":l,"aria-expanded":c,"aria-haspopup":"menu",children:n||(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})}),c&&(0,t.jsx)("div",{className:`absolute top-full mt-2 z-50 min-w-[180px] glass rounded-md py-1 shadow-lg shadow-retro-purple/20 ${"right"===i?"right-0":"left-0"}`,role:"menu","aria-orientation":"vertical",children:e.map(e=>{let r=`
              w-full flex items-center gap-3 px-4 py-3 text-sm text-left
              transition-colors touch-target
              ${e.disabled?"text-gray-600 cursor-not-allowed":"danger"===e.variant?"text-red-400 hover:bg-red-500/10 hover:text-red-300":"text-gray-300 hover:bg-retro-purple/30 hover:text-retro-cyan"}
            `;return e.href&&!e.disabled?(0,t.jsxs)(a.default,{href:e.href,className:r,role:"menuitem",onClick:()=>d(!1),children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id):(0,t.jsxs)("button",{className:r,role:"menuitem",disabled:e.disabled,onClick:()=>h(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),h(e))},children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id)})})]})}e.s(["useOutsideClick",()=>s],79724),e.s(["OverflowMenu",()=>n],72547)},16015,(e,t,r)=>{},98547,(e,t,r)=>{var a=e.i(47167);e.r(16015);var s=e.r(71645),n=s&&"object"==typeof s&&"default"in s?s:{default:s},i=void 0!==a.default&&a.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,r=t.name,a=void 0===r?"stylesheet":r,s=t.optimizeForSpeed,n=void 0===s?i:s;c(o(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",c("boolean"==typeof n,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=n,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(i||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(c(o(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return i||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var r="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(a){i||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];c(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},r.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&c(o(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return r?s.insertBefore(a,r):s.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},u={};function h(e,t){if(!t)return"jsx-"+e;var r=String(t),a=e+r;return u[a]||(u[a]="jsx-"+d(e+"-"+r)),u[a]}function X(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return u[r]||(u[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[r]}var f=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,a=void 0===r?null:r,s=t.optimizeForSpeed,n=void 0!==s&&s;this._sheet=a||new l({name:"styled-jsx",optimizeForSpeed:n}),this._sheet.inject(),a&&"boolean"==typeof n&&(this._sheet.setOptimizeForSpeed(n),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),a=r.styleId,s=r.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var n=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=n,this._instancesCounts[a]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var a=this._fromServer&&this._fromServer[r];a?(a.parentNode.removeChild(a),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],a=e[1];return n.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,a=e.id;if(r){var s=h(a,r);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return X(s,e)}):[X(s,t)]}}return{styleId:h(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),p=s.createContext(null);function m(){return new f}function x(){return s.useContext(p)}p.displayName="StyleSheetContext";var g=n.default.useInsertionEffect||n.default.useLayoutEffect,b="undefined"!=typeof window?m():void 0;function y(e){var t=b||x();return t&&("undefined"==typeof window?t.add(e):g(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}y.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,a=s.useContext(p),i=s.useState(function(){return a||t||m()})[0];return n.default.createElement(p.Provider,{value:i},r)},r.createStyleRegistry=m,r.style=y,r.useStyleRegistry=x},37902,(e,t,r)=>{t.exports=e.r(98547).style},89043,49738,32267,29493,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function a({pixels:e,scale:a=1,showGrid:s=!1,gridColor:n="#333333",gridThickness:i=1,foregroundColor:o="#ffffff",backgroundColor:l="#000000",onPixelClick:c,onPixelDrag:d,onDragEnd:u,className:h="",interactive:X=!0,mixedPixels:f,mixedColor:p="#666666"}){let m=(0,r.useRef)(null),[x,g]=(0,r.useState)(!1),b=(0,r.useRef)(null),y=e.length,v=e[0]?.length||0,w=s?i:0,k=v*a+(s?(v+1)*i:0),j=y*a+(s?(y+1)*i:0);(0,r.useEffect)(()=>{let t=m.current;if(!t)return;let r=t.getContext("2d");if(r){r.fillStyle=s?n:l,r.fillRect(0,0,k,j);for(let t=0;t<y;t++)for(let n=0;n<v;n++){let c=s?n*(a+i)+i:n*a,d=s?t*(a+i)+i:t*a,u=`${t},${n}`,h=f?.has(u),X=e[t]?.[n]||!1;if(h){let e=Math.floor(a/2);r.fillStyle=o,r.fillRect(c,d,e,e),r.fillRect(c+e,d+e,a-e,a-e),r.fillStyle=l,r.fillRect(c+e,d,a-e,e),r.fillRect(c,d+e,e,a-e)}else r.fillStyle=X?o:l,r.fillRect(c,d,a,a)}}},[e,a,s,n,i,o,l,k,j,v,y,f,p]);let C=(0,r.useCallback)(e=>{let t,r,n=m.current;if(!n)return null;let o=n.getBoundingClientRect();if("touches"in e){if(0===e.touches.length)return null;t=e.touches[0].clientX,r=e.touches[0].clientY}else t=e.clientX,r=e.clientY;let l=t-o.left,c=r-o.top,d=n.width/o.width,u=n.height/o.height,h=a+(s?i:0),X=Math.floor((l*d-w)/h),f=Math.floor((c*u-w)/h);return f>=0&&f<y&&X>=0&&X<v?{row:f,col:X}:null},[a,s,i,w,y,v]),N=(0,r.useCallback)(e=>{if(!X)return;let t=C(e);t&&c&&(c(t.row,t.col),b.current=t,g(!0))},[X,C,c]),S=(0,r.useCallback)(e=>{if(!X||!x||!d)return;let t=C(e);t&&(!b.current||b.current.row!==t.row||b.current.col!==t.col)&&(d(t.row,t.col),b.current=t)},[X,x,C,d]),_=(0,r.useCallback)(()=>{x&&(g(!1),b.current=null,u?.())},[x,u]),A=(0,r.useCallback)(()=>{x&&(g(!1),b.current=null,u?.())},[x,u]),R=(0,r.useCallback)(e=>{if(!X)return;e.preventDefault();let t=C(e);t&&c&&(c(t.row,t.col),b.current=t,g(!0))},[X,C,c]),E=(0,r.useCallback)(e=>{if(!X||!x||!d)return;e.preventDefault();let t=C(e);t&&(!b.current||b.current.row!==t.row||b.current.col!==t.col)&&(d(t.row,t.col),b.current=t)},[X,x,C,d]),L=(0,r.useCallback)(()=>{x&&(g(!1),b.current=null,u?.())},[x,u]);return(0,t.jsx)("canvas",{ref:m,width:k,height:j,className:`${X?"cursor-crosshair":""} ${h}`,style:{imageRendering:"pixelated",touchAction:"none"},onMouseDown:N,onMouseMove:S,onMouseUp:_,onMouseLeave:A,onTouchStart:R,onTouchMove:E,onTouchEnd:L})}function s({character:e,mode:s="small",scale:n=20,smallScale:i=2,selected:o=!1,batchSelected:l=!1,onClick:c,onPixelClick:d,onPixelDrag:u,onDragEnd:h,foregroundColor:X="#ffffff",backgroundColor:f="#000000",gridColor:p="#333333",gridThickness:m=1,interactive:x=!0,className:g="",mixedPixels:b,index:y,showIndex:v=!1}){let w="large"===s,k=w?n:i,j=["relative inline-block",!w&&x?"cursor-pointer":"",!w&&x?"hover:opacity-80 transition-opacity":"",(0,r.useMemo)(()=>o?"ring-2 ring-retro-cyan ring-offset-2 ring-offset-retro-dark":l?"ring-2 ring-retro-pink/50 ring-offset-1 ring-offset-retro-dark":"",[o,l]),g].filter(Boolean).join(" ");return(0,t.jsxs)("div",{className:j,onClick:e=>{c&&!w&&(e.stopPropagation(),c())},onKeyDown:e=>{c&&!w&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),c())},role:!w&&x?"button":void 0,tabIndex:!w&&x?0:void 0,"aria-pressed":o||l,"aria-label":void 0!==y?`Character ${y}`:"Character",children:[(0,t.jsx)(a,{pixels:e.pixels,scale:k,showGrid:w,gridColor:p,gridThickness:w?m:0,foregroundColor:X,backgroundColor:f,onPixelClick:w?d:void 0,onPixelDrag:w?u:void 0,onDragEnd:w?h:void 0,interactive:w&&x,mixedPixels:b}),v&&void 0!==y&&(0,t.jsx)("div",{className:"absolute -top-1 -right-1 bg-retro-navy/90 text-[8px] text-gray-400 px-1 rounded font-mono",children:y}),l&&!o&&(0,t.jsx)("div",{className:"absolute -top-1 -left-1 w-4 h-4 bg-retro-pink rounded-full flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})}function n({width:e,height:r,mode:a="small",scale:s=20,smallScale:n=2,onClick:i,className:o=""}){let l="large"===a,c=l?s:n;return(0,t.jsx)("div",{className:`relative inline-flex items-center justify-center bg-retro-navy/50 border border-dashed border-retro-grid/50 cursor-pointer hover:border-retro-cyan/50 transition-colors ${o}`,style:{width:e*c+(l?(e+1)*1:0),height:r*c+(l?(r+1)*1:0)},onClick:i,role:"button",tabIndex:0,onKeyDown:e=>{i&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),i())},"aria-label":"Add new character",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}function i({characters:e,config:a,selectedIndex:i,batchSelection:o,onSelect:l,showAddButton:c=!1,onAdd:d,foregroundColor:u="#ffffff",backgroundColor:h="#000000",showIndices:X=!1,minColumns:f=8,maxColumns:p=32,gap:m=4,className:x="",smallScale:g=2}){let b=(0,r.useRef)(null),{size:y}=function(e){let t=(0,r.useRef)(null),[a,s]=(0,r.useState)({width:0,height:0}),n=(0,r.useCallback)(e=>{for(let t of e){let{width:e,height:r}=t.contentRect;s({width:e,height:r})}},[void 0]);return(0,r.useEffect)(()=>{let e=t.current;if(!e)return;let r=new ResizeObserver(n);r.observe(e);let a=e.getBoundingClientRect();return s({width:a.width,height:a.height}),()=>{r.disconnect()}},[n]),{ref:t,size:a}}(),v=a.width*g,w=(0,r.useMemo)(()=>{if(!y.width)return f;let e=v+m+8;return Math.max(f,Math.min(p,Math.floor((y.width-m)/e)))},[y.width,v,m,f,p]);return(0,t.jsx)("div",{ref:b,className:`overflow-auto p-2 ${x}`,role:"listbox","aria-label":"Character selection grid",children:(0,t.jsxs)("div",{className:"grid",style:{gridTemplateColumns:`repeat(${w}, auto)`,gap:`${m}px`},children:[e.map((e,r)=>(0,t.jsx)("div",{onClick:e=>l?.(r,e.shiftKey),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),l?.(r,e.shiftKey))},role:"option","aria-selected":i===r||o?.has(r),tabIndex:0,className:"focus:outline-none focus-visible:ring-1 focus-visible:ring-retro-cyan rounded",children:(0,t.jsx)(s,{character:e,mode:"small",smallScale:g,selected:i===r,batchSelected:o?.has(r)&&i!==r,foregroundColor:u,backgroundColor:h,interactive:!1,index:r,showIndex:X})},r)),c&&(0,t.jsx)(n,{width:a.width,height:a.height,mode:"small",smallScale:g,onClick:d})]})})}function o({characters:e,config:s,maxCharacters:n=32,maxWidth:i=128,maxHeight:o=64,foregroundColor:l="#ffffff",backgroundColor:c="#000000",className:d=""}){let{displayChars:u,columns:h,rows:X}=(0,r.useMemo)(()=>{let t=s.width,r=s.height,a=Math.floor(i/t),l=Math.floor(o/r),c=Math.min(n,a*l,e.length),d=a,u=Math.ceil(c/d);for(;u>l&&d>1;)u=Math.ceil(c/--d);let h=Math.min(d*u,c);return{displayChars:e.slice(0,h),columns:d,rows:u}},[e,s,n,i,o]),f=(0,r.useMemo)(()=>{let{width:e,height:t}=s,r=h*e,a=Array.from({length:X*t},()=>Array(r).fill(!1));return u.forEach((r,s)=>{let n=s%h*e,i=Math.floor(s/h)*t;for(let s=0;s<t;s++)for(let t=0;t<e;t++)r.pixels[s]?.[t]&&(a[i+s][n+t]=!0)}),a},[u,s,h,X]),p=e.length-u.length;return(0,t.jsxs)("div",{className:`relative inline-block ${d}`,children:[(0,t.jsx)(a,{pixels:f,scale:1,showGrid:!1,foregroundColor:l,backgroundColor:c,interactive:!1}),p>0&&(0,t.jsxs)("div",{className:"absolute bottom-0 right-0 bg-retro-dark/90 text-[9px] text-gray-400 px-1 rounded-tl font-mono",children:["+",p]})]})}e.s(["PixelGrid",()=>a],89043),e.s(["CharacterDisplay",()=>s,"EmptyCharacterDisplay",()=>n],49738),e.i(37902),e.s(["InteractiveCharacterGrid",()=>i],32267),e.s(["CharacterPreview",()=>o],29493)},3813,33712,38152,82906,92921,44824,79086,4941,93949,25544,73581,60441,42187,95879,3573,43237,66811,83621,54750,7259,e=>{"use strict";e.i(89043);var t=e.i(49738),r=e.i(32267),a=e.i(29493),s=e.i(43476),n=e.i(71645),i=e.i(72547);function o(e){return Math.ceil(e/8)}function l(e){return o(e.width)*e.height}function c(e,t){let r=[];for(let a=0;a<t;a++)r.push(Array(e).fill(!1));return{pixels:r}}function d(e){return{pixels:e.pixels.map(e=>[...e])}}function u(){return{width:8,height:8,padding:"right",bitDirection:"ltr"}}function h(){return crypto.randomUUID()}function X(e,t){let{width:r,height:a,padding:s,bitDirection:n}=t,i=o(r),l=new Uint8Array(a*i);for(let t=0;t<a;t++){let a=8*i,o=a-r,c=Array(a).fill(!1);if("left"===s)for(let a=0;a<r;a++)c[o+a]=e.pixels[t]?.[a]||!1;else for(let a=0;a<r;a++)c[a]=e.pixels[t]?.[a]||!1;for(let e=0;e<i;e++){let r=0;for(let t=0;t<8;t++)c[8*e+t]&&(r|=1<<("ltr"===n?7-t:t));l[t*i+e]=r}}return l}function f(e,t){let r=e instanceof Uint8Array?e:new Uint8Array(e),a=l(t),s=Math.floor(r.length/a),n=[];for(let e=0;e<s;e++){let s=r.slice(e*a,(e+1)*a);n.push(function(e,t){let{width:r,height:a,padding:s,bitDirection:n}=t,i=o(r),l=[];for(let t=0;t<a;t++){let a=[],o=t*i,c=[];for(let t=0;t<i;t++){let r=e[o+t]||0;for(let e=0;e<8;e++){let t=(r&1<<("ltr"===n?7-e:e))!=0;c.push(t)}}let d=8*i,u=d-r;if("left"===s)for(let e=u;e<d;e++)a.push(c[e]);else for(let e=0;e<r;e++)a.push(c[e]);l.push(a)}return{pixels:l}}(s,t))}return n}function p(e,t){let r=l(t),a=new Uint8Array(e.length*r);for(let s=0;s<e.length;s++){let n=X(e[s],t);a.set(n,s*r)}return a}function m(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function x(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function g(e){let t=p(e.characters,e.config);return{metadata:e.metadata,config:e.config,binaryData:m(t)}}function b(e){let t=f(x(e.binaryData),e.config);return{metadata:e.metadata,config:e.config,characters:t}}function y(e,t,r){return new Blob([p(e,{...t,...r}).buffer],{type:"application/octet-stream"})}function v(e,t){let r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}e.s(["bytesPerCharacter",()=>l,"bytesPerLine",()=>o,"cloneCharacter",()=>d,"createDefaultConfig",()=>u,"createEmptyCharacter",()=>c,"generateId",()=>h],33712),e.s(["base64ToBinary",()=>x,"binaryToBase64",()=>m,"characterToBytes",()=>X,"createDownloadBlob",()=>y,"deserializeCharacterSet",()=>b,"downloadBlob",()=>v,"parseCharacterRom",()=>f,"serializeCharacterRom",()=>p,"serializeCharacterSet",()=>g],38152);let w="character-sets",k="retrostack-character-sets",j=new class{db=null;initialized=!1;initPromise=null;async initialize(){if(!this.initialized){if(this.initPromise)return this.initPromise;this.initPromise=this._initialize(),await this.initPromise,this.initialized=!0}}async _initialize(){return!function(){try{return!!window.indexedDB}catch{return!1}}()?void console.log("IndexedDB not available, using localStorage fallback"):new Promise((e,t)=>{let r=indexedDB.open("retrostack-character-editor",1);r.onerror=()=>{console.error("Failed to open IndexedDB, using localStorage fallback"),e()},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains(w)){let e=t.createObjectStore(w,{keyPath:"metadata.id"});e.createIndex("by-name","metadata.name",{unique:!1}),e.createIndex("by-updated","metadata.updatedAt",{unique:!1}),e.createIndex("by-size","sizeKey",{unique:!1})}}})}useFallback(){return null===this.db}fallbackGetAll(){try{let e=localStorage.getItem(k);if(!e)return[];return JSON.parse(e)}catch{return[]}}fallbackSaveAll(e){try{localStorage.setItem(k,JSON.stringify(e))}catch(e){throw console.error("Failed to save to localStorage:",e),Error("Storage quota exceeded")}}async getAll(){return(await this.initialize(),this.useFallback())?this.fallbackGetAll():new Promise((e,t)=>{let r=this.db.transaction([w],"readonly").objectStore(w).getAll();r.onsuccess=()=>{let t=r.result;t.sort((e,t)=>t.metadata.updatedAt-e.metadata.updatedAt),e(t)},r.onerror=()=>{t(Error("Failed to get character sets"))}})}async getById(e){return(await this.initialize(),this.useFallback())?this.fallbackGetAll().find(t=>t.metadata.id===e)||null:new Promise((t,r)=>{let a=this.db.transaction([w],"readonly").objectStore(w).get(e);a.onsuccess=()=>{t(a.result||null)},a.onerror=()=>{r(Error("Failed to get character set"))}})}async save(e){await this.initialize();let t={...e,sizeKey:`${e.config.width}x${e.config.height}`};if(this.useFallback()){let t=this.fallbackGetAll(),r=t.findIndex(t=>t.metadata.id===e.metadata.id);return r>=0?t[r]=e:t.push(e),this.fallbackSaveAll(t),e.metadata.id}return new Promise((r,a)=>{let s=this.db.transaction([w],"readwrite").objectStore(w).put(t);s.onsuccess=()=>{r(e.metadata.id)},s.onerror=()=>{a(Error("Failed to save character set"))}})}async saveAs(e,t){let r=h(),a=Date.now(),s={...e,metadata:{...e.metadata,id:r,name:t,createdAt:a,updatedAt:a,isBuiltIn:!1,source:"yourself"}};return await this.save(s),r}async delete(e){if(await this.initialize(),this.useFallback()){let t=this.fallbackGetAll().filter(t=>t.metadata.id!==e);this.fallbackSaveAll(t);return}return new Promise((t,r)=>{let a=this.db.transaction([w],"readwrite").objectStore(w).delete(e);a.onsuccess=()=>{t()},a.onerror=()=>{r(Error("Failed to delete character set"))}})}async search(e){let t=await this.getAll(),r=e.toLowerCase();return t.filter(e=>e.metadata.name.toLowerCase().includes(r)||e.metadata.description.toLowerCase().includes(r)||e.metadata.source.toLowerCase().includes(r))}async filterBySize(e,t){return(await this.getAll()).filter(r=>(null===e||r.config.width===e)&&(null===t||r.config.height===t))}async getAvailableSizes(){let e=await this.getAll(),t=new Map;for(let r of e){let e=`${r.config.width}x${r.config.height}`;t.has(e)||t.set(e,{width:r.config.width,height:r.config.height})}return Array.from(t.values()).sort((e,t)=>e.width!==t.width?e.width-t.width:e.height-t.height)}async nameExists(e,t){return(await this.getAll()).some(r=>r.metadata.name.toLowerCase()===e.toLowerCase()&&r.metadata.id!==t)}async count(){return(await this.getAll()).length}async isEmpty(){return 0===(await this.getAll()).length}async clear(){return(await this.initialize(),this.useFallback())?void localStorage.removeItem(k):new Promise((e,t)=>{let r=this.db.transaction([w],"readwrite").objectStore(w).clear();r.onsuccess=()=>{e()},r.onerror=()=>{t(Error("Failed to clear storage"))}})}};function C(e){return{pixels:e.pixels.map(e=>e.map(e=>!e))}}function N(e){return{pixels:e.pixels.map(e=>[...e].reverse())}}function S(e){return{pixels:[...e.pixels].reverse().map(e=>[...e])}}function _(e,t,r,a){return{pixels:e.pixels.map((e,s)=>s===t?e.map((e,t)=>t===r?a:e):[...e])}}function A(e,t,r){return e.map((e,a)=>t.has(a)?r(e):e)}function R(e,t,r,a){let s=Array.from(t).map(t=>e[t]);if(0===s.length)return"same-off";let n=s[0]?.pixels[r]?.[a]||!1;for(let e=1;e<s.length;e++)if((s[e]?.pixels[r]?.[a]||!1)!==n)return"mixed";return n?"same-on":"same-off"}let E=[{id:"classic",name:"Classic (White/Black)",foreground:"#ffffff",background:"#000000",gridColor:"#333333"},{id:"green",name:"Green Phosphor",foreground:"#33ff33",background:"#001100",gridColor:"#004400"},{id:"amber",name:"Amber Phosphor",foreground:"#ffb000",background:"#1a0a00",gridColor:"#4d2e00"},{id:"c64-blue",name:"C64 Blue",foreground:"#6c5eb5",background:"#40318d",gridColor:"#2e2266"},{id:"c64-cyan",name:"C64 Light Blue",foreground:"#70a4b2",background:"#352879",gridColor:"#493f99"},{id:"apple-green",name:"Apple II Green",foreground:"#14f53c",background:"#000000",gridColor:"#0a4d15"},{id:"zx-spectrum",name:"ZX Spectrum",foreground:"#ffffff",background:"#0000d7",gridColor:"#0000aa"},{id:"ibm-cga",name:"IBM CGA Cyan",foreground:"#55ffff",background:"#000000",gridColor:"#005555"},{id:"vt100",name:"VT100",foreground:"#00ff00",background:"#000000",gridColor:"#003300"},{id:"custom",name:"Custom...",foreground:"",background:"",gridColor:""}],L="character-editor-color-preset",D="character-editor-custom-colors";function M(e){return E.find(t=>t.id===e)}function I(e){try{localStorage.setItem(L,e)}catch{}}function z(){try{return localStorage.getItem(L)||"classic"}catch{return"classic"}}function B(e){try{localStorage.setItem(D,JSON.stringify(e))}catch{}}function $(){try{let e=localStorage.getItem(D);if(e)return JSON.parse(e)}catch{}return{foreground:"#ffffff",background:"#000000",gridColor:"#333333"}}function F(){let e=z();if("custom"===e)return $();let t=M(e);return t?{foreground:t.foreground,background:t.background,gridColor:t.gridColor}:{foreground:"#ffffff",background:"#000000",gridColor:"#333333"}}function P(){let e=[];e.push(["........","........","........","........","........","........","........","........"]),e.push(["...XX...","...XX...","...XX...","...XX...","...XX...","........","...XX...","........"]),e.push([".XX..XX.",".XX..XX.",".XX..XX.","........","........","........","........","........"]),e.push([".XX..XX.","XXXXXXXX",".XX..XX.",".XX..XX.","XXXXXXXX",".XX..XX.","........","........"]),e.push(["...XX...",".XXXXXX.","XX......",".XXXXX..","....XX..","XXXXXX..","...XX...","........"]),e.push(["XX....XX","XX...XX.","....XX..","...XX...","..XX....",".XX...XX","XX....XX","........"]),e.push(["..XXX...",".XX.XX..","..XXX...",".XXX.XX.","XX..XX..","XX..XX..",".XXX.XX.","........"]),e.push(["...XX...","...XX...","..XX....","........","........","........","........","........"]),e.push(["....XX..","...XX...","..XX....","..XX....","..XX....","...XX...","....XX..","........"]),e.push(["..XX....","...XX...","....XX..","....XX..","....XX..","...XX...","..XX....","........"]),e.push(["........","..X..X..","...XX...",".XXXXXX.","...XX...","..X..X..","........","........"]),e.push(["........","...XX...","...XX...",".XXXXXX.","...XX...","...XX...","........","........"]),e.push(["........","........","........","........","........","...XX...","...XX...","..XX...."]),e.push(["........","........","........",".XXXXXX.","........","........","........","........"]),e.push(["........","........","........","........","........","...XX...","...XX...","........"]),e.push(["......XX",".....XX.","....XX..","...XX...","..XX....",".XX.....","XX......","........"]),e.push([".XXXXX..","XX...XX.","XX..XXX.","XX.X.XX.","XXX..XX.","XX...XX.",".XXXXX..","........"]),e.push(["...XX...","..XXX...","...XX...","...XX...","...XX...","...XX...",".XXXXXX.","........"]),e.push([".XXXXX..","XX...XX.",".....XX.","...XXX..","..XX....",".XX.....","XXXXXXX.","........"]),e.push([".XXXXX..","XX...XX.",".....XX.","..XXXX..",".....XX.","XX...XX.",".XXXXX..","........"]),e.push(["....XXX.","...XXXX.","..XX.XX.",".XX..XX.","XXXXXXX.",".....XX.",".....XX.","........"]),e.push(["XXXXXXX.","XX......","XXXXXX..",".....XX.",".....XX.","XX...XX.",".XXXXX..","........"]),e.push(["..XXXX..",".XX.....","XX......","XXXXXX..","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XXXXXXX.",".....XX.","....XX..","...XX...","..XX....","..XX....","..XX....","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.",".XXXXX..","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.",".XXXXXX.",".....XX.","....XX..",".XXXX...","........"]),e.push(["........","...XX...","...XX...","........","...XX...","...XX...","........","........"]),e.push(["........","...XX...","...XX...","........","...XX...","...XX...","..XX....","........"]),e.push([".....XX.","....XX..","...XX...","..XX....","...XX...","....XX..",".....XX.","........"]),e.push(["........","........",".XXXXXX.","........",".XXXXXX.","........","........","........"]),e.push([".XX.....","..XX....","...XX...","....XX..","...XX...","..XX....",".XX.....","........"]),e.push([".XXXXX..","XX...XX.",".....XX.","...XXX..","...XX...","........","...XX...","........"]),e.push([".XXXXX..","XX...XX.","XX.XXXX.","XX.XXXX.","XX.XXX..","XX......",".XXXXX..","........"]),e.push(["..XXX...",".XX.XX..","XX...XX.","XXXXXXX.","XX...XX.","XX...XX.","XX...XX.","........"]),e.push(["XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","........"]),e.push([".XXXXX..","XX...XX.","XX......","XX......","XX......","XX...XX.",".XXXXX..","........"]),e.push(["XXXXX...","XX..XX..","XX...XX.","XX...XX.","XX...XX.","XX..XX..","XXXXX...","........"]),e.push(["XXXXXXX.","XX......","XX......","XXXXX...","XX......","XX......","XXXXXXX.","........"]),e.push(["XXXXXXX.","XX......","XX......","XXXXX...","XX......","XX......","XX......","........"]),e.push([".XXXXX..","XX...XX.","XX......","XX..XXX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XXXXXXX.","XX...XX.","XX...XX.","XX...XX.","........"]),e.push([".XXXXXX.","...XX...","...XX...","...XX...","...XX...","...XX...",".XXXXXX.","........"]),e.push(["...XXXX.",".....XX.",".....XX.",".....XX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XX...XX.","XX..XX..","XX.XX...","XXXX....","XX.XX...","XX..XX..","XX...XX.","........"]),e.push(["XX......","XX......","XX......","XX......","XX......","XX......","XXXXXXX.","........"]),e.push(["XX...XX.","XXX.XXX.","XXXXXXX.","XX.X.XX.","XX...XX.","XX...XX.","XX...XX.","........"]),e.push(["XX...XX.","XXX..XX.","XXXX.XX.","XX.XXXX.","XX..XXX.","XX...XX.","XX...XX.","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.","XX...XX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","XX......","XX......","XX......","........"]),e.push([".XXXXX..","XX...XX.","XX...XX.","XX...XX.","XX.X.XX.","XX..XX..",".XXX.XX.","........"]),e.push(["XXXXXX..","XX...XX.","XX...XX.","XXXXXX..","XX.XX...","XX..XX..","XX...XX.","........"]),e.push([".XXXXX..","XX...XX.","XX......",".XXXXX..",".....XX.","XX...XX.",".XXXXX..","........"]),e.push(["XXXXXXX.","...XX...","...XX...","...XX...","...XX...","...XX...","...XX...","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XX...XX.","XX...XX.","XX...XX.",".XXXXX..","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XX...XX.",".XX.XX..","..XXX...","...X....","........"]),e.push(["XX...XX.","XX...XX.","XX...XX.","XX.X.XX.","XXXXXXX.","XXX.XXX.","XX...XX.","........"]),e.push(["XX...XX.",".XX.XX..","..XXX...","...X....","..XXX...",".XX.XX..","XX...XX.","........"]),e.push(["XX...XX.",".XX.XX..","..XXX...","...XX...","...XX...","...XX...","...XX...","........"]),e.push(["XXXXXXX.",".....XX.","....XX..","...XX...","..XX....",".XX.....","XXXXXXX.","........"]),e.push(["..XXXX..","..XX....","..XX....","..XX....","..XX....","..XX....","..XXXX..","........"]),e.push(["XX......",".XX.....","..XX....","...XX...","....XX..",".....XX.","......XX","........"]),e.push(["..XXXX..","....XX..","....XX..","....XX..","....XX..","....XX..","..XXXX..","........"]),e.push(["...X....","..XXX...",".XX.XX..","XX...XX.","........","........","........","........"]),e.push(["........","........","........","........","........","........","XXXXXXXX","........"]);let t=new Uint8Array(8*e.length);for(let r=0;r<e.length;r++){let a=function(e){let t=new Uint8Array(8);for(let r=0;r<8&&r<e.length;r++){let a=0;for(let t=0;t<8;t++){let s=e[r]?.[t]||".";("X"===s||"#"===s||"*"===s)&&(a|=1<<7-t)}t[r]=a}return t}(e[r]);t.set(a,8*r)}return t}function O(e){return e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`}function T(e){return`${e.width}x${e.height}`}function G(e){let t=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");return`${t||"charset"}.bin`}function K(e){let t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return[".bin",".rom",".chr",".fnt",".dat"].includes(t)||!t||t===e.name.toLowerCase()}function U(e,t){return Math.floor(e/(Math.ceil(t.width/8)*t.height))}function H(e){let t=new Date(e),r=Math.floor((new Date().getTime()-e)/864e5);return 0===r?"Today":1===r?"Yesterday":r<7?`${r} days ago`:t.toLocaleDateString()}function W(e){return{arrayName:e.replace(/[^a-zA-Z0-9_]/g,"_").replace(/^[0-9]/,"_$&").toUpperCase()||"CHARSET",includeGuards:!0,includeComments:!0,bytesPerLine:8}}function V(e){return{labelName:e.replace(/[^a-zA-Z0-9_]/g,"_").replace(/^[0-9]/,"_$&").toLowerCase()||"charset",directive:".byte",useHex:!0,includeComments:!0,bytesPerLine:8}}function Z(){return{columns:16,scale:4,showGrid:!0,gridColor:"#333333",foregroundColor:"#ffffff",backgroundColor:"#000000",transparent:!1}}function q(e,t,r){let a=[],s=`${r.arrayName}_H`,n=l(t);r.includeComments&&(a.push("/**"),a.push(` * ${r.arrayName} - Character ROM Data`),a.push(" * Generated by RetroStack Character ROM Editor"),a.push(" * "),a.push(` * Character dimensions: ${t.width}x${t.height}`),a.push(` * Total characters: ${e.length}`),a.push(` * Bytes per character: ${n}`),a.push(" */"),a.push("")),r.includeGuards&&(a.push(`#ifndef ${s}`),a.push(`#define ${s}`),a.push(""));let i=e.length*n;a.push(`const unsigned char ${r.arrayName}[${i}] = {`);for(let s=0;s<e.length;s++){let n=X(e[s],t),i=[];for(let e=0;e<n.length;e++)i.push(`0x${n[e].toString(16).padStart(2,"0").toUpperCase()}`);for(let t=0;t<i.length;t+=r.bytesPerLine){let n=i.slice(t,t+r.bytesPerLine),o=s===e.length-1&&t+r.bytesPerLine>=i.length,l=`  ${n.join(", ")}${o?"":","}`;r.includeComments&&0===t?a.push(`${l}  /* Char ${s} */`):a.push(l)}}return a.push("};"),a.push(""),r.includeGuards&&(a.push(`#endif /* ${s} */`),a.push("")),a.join("\n")}function J(e,t,r){let a=[],s=l(t);r.includeComments&&(a.push("; "+"=".repeat(60)),a.push(`; ${r.labelName} - Character ROM Data`),a.push("; Generated by RetroStack Character ROM Editor"),a.push("; "),a.push(`; Character dimensions: ${t.width}x${t.height}`),a.push(`; Total characters: ${e.length}`),a.push(`; Bytes per character: ${s}`),a.push("; "+"=".repeat(60)),a.push("")),a.push(`${r.labelName}:`);for(let s=0;s<e.length;s++){let n=X(e[s],t),i=[];for(let e=0;e<n.length;e++)r.useHex?i.push(`$${n[e].toString(16).padStart(2,"0").toUpperCase()}`):i.push(n[e].toString());for(let e=0;e<i.length;e+=r.bytesPerLine){let t=i.slice(e,e+r.bytesPerLine),n=`    ${r.directive} ${t.join(", ")}`;r.includeComments&&0===e?a.push(`${n}  ; Char ${s}`):a.push(n)}}return a.push(""),a.join("\n")}async function Y(e,t,r){let{columns:a,scale:s,showGrid:n,gridColor:i,foregroundColor:o,backgroundColor:l,transparent:c}=r,d=Math.ceil(e.length/a),u=t.width,h=t.height,X=+!!n,f=a*u*s+(n?(a+1)*X:0),p=d*h*s+(n?(d+1)*X:0),m=document.createElement("canvas");m.width=f,m.height=p;let x=m.getContext("2d");if(!x)throw Error("Could not create canvas context");if(c?x.clearRect(0,0,f,p):(x.fillStyle=l,x.fillRect(0,0,f,p)),n){x.fillStyle=i;for(let e=0;e<=a;e++){let t=e*(u*s+X);x.fillRect(t,0,X,p)}for(let e=0;e<=d;e++){let t=e*(h*s+X);x.fillRect(0,t,f,X)}}for(let t=0;t<e.length;t++){let r=e[t],i=t%a,d=Math.floor(t/a),f=n?i*(u*s+X)+X:i*u*s,p=n?d*(h*s+X)+X:d*h*s;for(let e=0;e<h;e++)for(let t=0;t<u;t++)r.pixels[e]?.[t]?(x.fillStyle=o,x.fillRect(f+t*s,p+e*s,s,s)):c||(x.fillStyle=l,x.fillRect(f+t*s,p+e*s,s,s))}return new Promise((e,t)=>{m.toBlob(r=>{r?e(r):t(Error("Failed to create PNG blob"))},"image/png")})}function Q(e,t,r=16){if(0===e.length)return"";let a=[],s=0;for(;a.length<r&&s<e.length;){let n=X(e[s],t);for(let e=0;e<n.length&&a.length<r;e++)a.push(n[e]);s++}return a.map(e=>e.toString(16).padStart(2,"0").toUpperCase()).join(" ")}function ee(e,t,r=0){let a=X(e,t),s=o(t.width),n=a.slice(r*s,(r+1)*s),i="";for(let e of n)i+=e.toString(2).padStart(8,"0");let l=8*s-t.width,c="";return c="left"===t.padding?"P".repeat(l)+"D".repeat(t.width):"D".repeat(t.width)+"P".repeat(l),{bits:i,hex:Array.from(n).map(e=>e.toString(16).padStart(2,"0").toUpperCase()).join(" "),padding:c}}function et({characterSet:e,onEdit:t,onExport:r,onDelete:o,onDuplicate:l,onRename:c}){let{metadata:d,config:u}=e,h=(0,n.useMemo)(()=>{try{return b(e).characters}catch{return[]}},[e]),X=h.length,f=(0,n.useMemo)(()=>{let e=[];return t&&e.push({id:"edit",label:"Edit",onClick:t}),c&&!d.isBuiltIn&&e.push({id:"rename",label:"Rename",onClick:c}),r&&e.push({id:"export",label:"Export",onClick:r}),l&&e.push({id:"duplicate",label:"Duplicate",onClick:l}),o&&!d.isBuiltIn&&e.push({id:"delete",label:"Delete",onClick:o,variant:"danger"}),e},[t,c,r,l,o,d.isBuiltIn]);return(0,s.jsxs)("div",{className:"card-retro p-4 flex flex-col gap-3 hover-glow-cyan transition-all",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-retro-cyan truncate",children:d.name}),d.description&&(0,s.jsx)("p",{className:"text-xs text-gray-400 line-clamp-2 mt-0.5",children:d.description})]}),f.length>0&&(0,s.jsx)(i.OverflowMenu,{items:f,align:"right",label:"Character set actions"})]}),(0,s.jsx)("div",{className:"flex justify-center py-2 bg-black/30 rounded",children:(0,s.jsx)(a.CharacterPreview,{characters:h,config:u,maxCharacters:128,maxWidth:256,maxHeight:128})}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-[10px]",children:[(0,s.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-pink rounded",children:T(u)}),(0,s.jsxs)("span",{className:"text-gray-500",children:[X," char",1!==X?"s":""]}),d.isBuiltIn&&(0,s.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-navy text-gray-400 rounded",children:"Built-in"}),!d.isBuiltIn&&d.source&&(0,s.jsxs)("span",{className:"text-gray-500 truncate max-w-[100px]",title:d.source,children:["by ",d.source]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-retro-grid/30",children:[(0,s.jsx)("span",{className:"text-[10px] text-gray-500",children:H(d.updatedAt)}),(0,s.jsxs)("div",{className:"flex gap-1",children:[t&&(0,s.jsx)("button",{onClick:t,className:"px-2 py-1 text-xs bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Edit"}),r&&(0,s.jsx)("button",{onClick:r,className:"px-2 py-1 text-xs bg-retro-pink/20 text-retro-pink rounded hover:bg-retro-pink/30 transition-colors",children:"Export"})]})]})]})}function er({onImport:e,onCreate:t}){return(0,s.jsxs)("div",{className:"card-retro p-6 flex flex-col items-center justify-center gap-4 border-dashed",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-retro-purple/20 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-retro-pink",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-300",children:"Add a character set"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Import a ROM file or create from scratch"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[e&&(0,s.jsx)("button",{onClick:e,className:"px-3 py-1.5 text-xs bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Import"}),t&&(0,s.jsx)("button",{onClick:t,className:"px-3 py-1.5 text-xs bg-retro-pink/20 text-retro-pink rounded hover:bg-retro-pink/30 transition-colors",children:"Create New"})]})]})}function ea({characterSets:e,loading:t=!1,onEdit:r,onExport:a,onDelete:n,onDuplicate:i,onRename:o,onImport:l,onCreate:c,className:d=""}){return t?(0,s.jsx)("div",{className:`grid-fluid gap-4 ${d}`,children:Array.from({length:4}).map((e,t)=>(0,s.jsx)(es,{},t))}):0===e.length?(0,s.jsx)("div",{className:`flex flex-col items-center justify-center py-12 ${d}`,children:(0,s.jsx)(er,{onImport:l,onCreate:c})}):(0,s.jsxs)("div",{className:`grid-fluid gap-4 ${d}`,children:[e.map(e=>(0,s.jsx)(et,{characterSet:e,onEdit:r?()=>r(e.metadata.id):void 0,onExport:a?()=>a(e.metadata.id):void 0,onDelete:n?()=>n(e.metadata.id):void 0,onDuplicate:i?()=>i(e.metadata.id):void 0,onRename:o?()=>o(e.metadata.id):void 0},e.metadata.id)),(l||c)&&(0,s.jsx)(er,{onImport:l,onCreate:c})]})}function es(){return(0,s.jsxs)("div",{className:"card-retro p-4 animate-pulse",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"h-4 bg-retro-grid/30 rounded w-3/4"}),(0,s.jsx)("div",{className:"h-3 bg-retro-grid/20 rounded w-full mt-2"})]}),(0,s.jsx)("div",{className:"w-6 h-6 bg-retro-grid/20 rounded"})]}),(0,s.jsx)("div",{className:"h-16 bg-black/30 rounded mb-3"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,s.jsx)("div",{className:"h-4 w-12 bg-retro-grid/20 rounded"}),(0,s.jsx)("div",{className:"h-4 w-16 bg-retro-grid/20 rounded"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-retro-grid/30",children:[(0,s.jsx)("div",{className:"h-3 w-20 bg-retro-grid/20 rounded"}),(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)("div",{className:"h-6 w-12 bg-retro-grid/20 rounded"}),(0,s.jsx)("div",{className:"h-6 w-14 bg-retro-grid/20 rounded"})]})]})]})}function en({onClearFilters:e}){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-retro-navy/50 flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:"No results found"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your search or filters"}),e&&(0,s.jsx)("button",{onClick:e,className:"px-4 py-2 text-sm bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Clear all filters"})]})}function ei({error:e,onRetry:t}){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Failed to load library"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:e}),t&&(0,s.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors",children:"Try again"})]})}function eo({searchQuery:e,onSearchChange:t,availableSizes:r,widthFilter:a,heightFilter:i,onSizeFilterChange:o,totalCount:l,filteredCount:c}){let[d,u]=(0,n.useState)(e),h=(0,n.useCallback)(e=>{e.preventDefault(),t(d)},[d,t]),X=(0,n.useCallback)(e=>{"Enter"===e.key&&t(d)},[d,t]),f=(0,n.useCallback)(()=>{u(""),t(""),o(null,null)},[t,o]),p=e.length>0||null!==a||null!==i;return(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,s.jsx)("form",{onSubmit:h,className:"flex-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),onKeyDown:X,onBlur:()=>t(d),placeholder:"Search character sets...",className:"w-full px-4 py-2 pl-10 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50 transition-colors","aria-label":"Search character sets"}),(0,s.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),d&&(0,s.jsx)("button",{type:"button",onClick:()=>{u(""),t("")},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300","aria-label":"Clear search",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("select",{value:a??"",onChange:e=>{o(e.target.value?parseInt(e.target.value,10):null,i)},className:"px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 focus:outline-none focus:border-retro-cyan/50 cursor-pointer","aria-label":"Filter by width",children:[(0,s.jsx)("option",{value:"",children:"Width"}),Array.from(new Set(r.map(e=>e.width))).sort((e,t)=>e-t).map(e=>(0,s.jsxs)("option",{value:e,children:[e,"px"]},e))]}),(0,s.jsxs)("select",{value:i??"",onChange:e=>{o(a,e.target.value?parseInt(e.target.value,10):null)},className:"px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 focus:outline-none focus:border-retro-cyan/50 cursor-pointer","aria-label":"Filter by height",children:[(0,s.jsx)("option",{value:"",children:"Height"}),Array.from(new Set(r.map(e=>e.height))).sort((e,t)=>e-t).map(e=>(0,s.jsxs)("option",{value:e,children:[e,"px"]},e))]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[(0,s.jsx)("span",{children:p?`Showing ${c} of ${l} character sets`:`${l} character set${1!==l?"s":""}`}),p&&(0,s.jsx)("button",{onClick:f,className:"text-retro-cyan hover:text-retro-pink transition-colors",children:"Clear filters"})]})]})}function el({onFileSelect:e,selectedFile:t,loading:r=!1,error:a=null,className:i=""}){let[o,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null),u=(0,n.useRef)(null),h=a||c,X=(0,n.useCallback)(async t=>{if(d(null),!K(t))return void d("Invalid file type. Please select a binary ROM file (.bin, .rom, .chr, .fnt, .dat)");if(t.size>1048576)return void d("File too large. Maximum size is 1MB.");try{let r=await t.arrayBuffer();e(t,r)}catch(e){d("Failed to read file. Please try again.")}},[e]),f=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(!1);let t=e.dataTransfer.files;t.length>0&&X(t[0])},[X]),p=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(!0)},[]),m=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(!1)},[]),x=(0,n.useCallback)(()=>{u.current?.click()},[]),g=(0,n.useCallback)(e=>{let t=e.target.files;t&&t.length>0&&X(t[0])},[X]),b=(0,n.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),x())},[x]);return(0,s.jsxs)("div",{className:i,children:[(0,s.jsx)("input",{ref:u,type:"file",accept:".bin,.rom,.chr,.fnt,.dat",onChange:g,className:"hidden","aria-hidden":"true"}),(0,s.jsx)("div",{onClick:x,onDrop:f,onDragOver:p,onDragLeave:m,onKeyDown:b,role:"button",tabIndex:0,"aria-label":"Drop a ROM file or click to browse",className:`
          relative flex flex-col items-center justify-center
          p-8 sm:p-12
          border-2 border-dashed rounded-lg
          cursor-pointer
          transition-all
          ${o?"border-retro-cyan bg-retro-cyan/10":t?"border-retro-pink/50 bg-retro-pink/5":"border-retro-grid/50 hover:border-retro-cyan/50 bg-retro-navy/30"}
          ${h?"border-red-500/50 bg-red-500/5":""}
          ${r?"pointer-events-none opacity-50":""}
        `,children:r?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:"Reading file..."})]}):t?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-lg bg-retro-pink/20 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-retro-pink",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-200 truncate max-w-[200px]",children:t.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:O(t.size)})]}),(0,s.jsx)("button",{type:"button",className:"text-xs text-retro-cyan hover:text-retro-pink transition-colors",children:"Choose a different file"})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-retro-purple/20 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-retro-pink",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-sm text-gray-300",children:"Drag and drop a ROM file here"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"or click to browse"})]}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Accepts: .bin, .rom, .chr, .fnt, .dat"})]})}),h&&(0,s.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-sm text-red-400",children:[(0,s.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,s.jsx)("span",{children:h})]})]})}function ec({config:e,onConfigChange:t,fileSize:r,name:a,onNameChange:i,description:o,onDescriptionChange:l,disabled:c=!1}){let d=(0,n.useMemo)(()=>r?U(r,e):0,[r,e]),u=(0,n.useMemo)(()=>Math.ceil(e.width/8)*e.height,[e.width,e.height]),h=r=>{t({...e,padding:r})},X=r=>{t({...e,bitDirection:r})};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),(0,s.jsx)("input",{type:"text",id:"name",value:a,onChange:e=>i(e.target.value),placeholder:"My Character Set",disabled:c,className:"w-full px-4 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50 disabled:opacity-50"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),(0,s.jsx)("textarea",{id:"description",value:o,onChange:e=>l(e.target.value),placeholder:"Optional description...",rows:2,disabled:c,className:"w-full px-4 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded-lg text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50 resize-none disabled:opacity-50"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Character Dimensions"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"width",className:"block text-xs text-gray-500 mb-1",children:"Width (pixels)"}),(0,s.jsx)("input",{type:"number",id:"width",min:1,max:16,value:e.width,onChange:r=>{let a=parseInt(r.target.value,10);!isNaN(a)&&a>=1&&a<=16&&t({...e,width:a})},disabled:c,className:"w-full px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded text-sm text-gray-200 focus:outline-none focus:border-retro-cyan/50 disabled:opacity-50"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"height",className:"block text-xs text-gray-500 mb-1",children:"Height (pixels)"}),(0,s.jsx)("input",{type:"number",id:"height",min:1,max:16,value:e.height,onChange:r=>{let a=parseInt(r.target.value,10);!isNaN(a)&&a>=1&&a<=16&&t({...e,height:a})},disabled:c,className:"w-full px-3 py-2 bg-retro-navy/50 border border-retro-grid/50 rounded text-sm text-gray-200 focus:outline-none focus:border-retro-cyan/50 disabled:opacity-50"})]})]}),r&&(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[u," bytes/char = ",d," character",1!==d?"s":""," (",O(r)," file)"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Bit Padding"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>h("right"),disabled:c,className:`
              flex-1 px-3 py-2 text-sm rounded border transition-colors
              ${"right"===e.padding?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
              disabled:opacity-50
            `,children:"Right (default)"}),(0,s.jsx)("button",{type:"button",onClick:()=>h("left"),disabled:c,className:`
              flex-1 px-3 py-2 text-sm rounded border transition-colors
              ${"left"===e.padding?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
              disabled:opacity-50
            `,children:"Left"})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"Determines which side unused bits are padded in each byte"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Bit Direction"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>X("ltr"),disabled:c,className:`
              flex-1 px-3 py-2 text-sm rounded border transition-colors
              ${"ltr"===e.bitDirection?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
              disabled:opacity-50
            `,children:"Left to Right (default)"}),(0,s.jsx)("button",{type:"button",onClick:()=>X("rtl"),disabled:c,className:`
              flex-1 px-3 py-2 text-sm rounded border transition-colors
              ${"rtl"===e.bitDirection?"border-retro-cyan bg-retro-cyan/10 text-retro-cyan":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
              disabled:opacity-50
            `,children:"Right to Left"})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"The order bits are read within each byte (MSB vs LSB first)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Quick Presets"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:[{label:"8x8",width:8,height:8},{label:"8x16",width:8,height:16},{label:"5x7",width:5,height:7},{label:"5x8",width:5,height:8},{label:"6x8",width:6,height:8},{label:"6x10",width:6,height:10}].map(r=>(0,s.jsx)("button",{type:"button",onClick:()=>t({...e,width:r.width,height:r.height}),disabled:c,className:`
                px-3 py-1 text-xs rounded border transition-colors
                ${e.width===r.width&&e.height===r.height?"border-retro-pink bg-retro-pink/10 text-retro-pink":"border-retro-grid/50 text-gray-400 hover:border-retro-grid"}
                disabled:opacity-50
              `,children:r.label},r.label))})]})]})}function ed({character:e,config:r,onPixelToggle:a,onPixelSet:i,onDragEnd:o,getPixelState:l,batchMode:c=!1,foregroundColor:d="#ffffff",backgroundColor:u="#000000",gridColor:h="#333333",gridThickness:X=1,zoom:f=20,onZoomChange:p,characterIndex:m,totalCharacters:x,className:g=""}){let b=(0,n.useRef)(null),[y,v]=(0,n.useState)(!1),[w,k]=(0,n.useState)(null),j=(0,n.useMemo)(()=>{if(!c||!l||!e)return;let t=new Set;for(let e=0;e<r.height;e++)for(let a=0;a<r.width;a++)"mixed"===l(e,a)&&t.add(`${e},${a}`);return t.size>0?t:void 0},[c,l,e,r.height,r.width]),C=(0,n.useCallback)((t,r)=>{y||(a?.(t,r),k(!e?.pixels[t]?.[r]),v(!0))},[y,a,e]),N=(0,n.useCallback)((e,t)=>{y&&null!==w&&i&&i(e,t,w)},[y,w,i]),S=(0,n.useCallback)(()=>{y&&(v(!1),k(null),o?.())},[y,o]),_=(0,n.useCallback)(()=>{p&&f<40&&p(Math.min(f+4,40))},[f,p]),A=(0,n.useCallback)(()=>{p&&f>8&&p(Math.max(f-4,8))},[f,p]);return((0,n.useEffect)(()=>{let e=e=>{b.current?.contains(document.activeElement)&&("+"===e.key||"="===e.key?(e.preventDefault(),_()):("-"===e.key||"_"===e.key)&&(e.preventDefault(),A()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[_,A]),e)?(0,s.jsxs)("div",{ref:b,className:`flex flex-col h-full ${g}`,tabIndex:0,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-retro-grid/30",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:[void 0!==m&&void 0!==x?(0,s.jsxs)("span",{children:["Character ",(0,s.jsx)("span",{className:"text-retro-cyan",children:m})," ","of ",x]}):(0,s.jsx)("span",{children:"Editor"}),c&&(0,s.jsx)("span",{className:"ml-2 px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",children:"Batch"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:A,disabled:f<=8,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Zoom out (-)",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 w-12 text-center",children:[f,"x"]}),(0,s.jsx)("button",{onClick:_,disabled:f>=40,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",title:"Zoom in (+)",children:(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center p-4 overflow-auto bg-black/20",children:(0,s.jsx)("div",{className:"inline-block",onMouseLeave:S,onMouseUp:S,children:(0,s.jsx)(t.CharacterDisplay,{character:e,mode:"large",scale:f,foregroundColor:d,backgroundColor:u,gridColor:h,gridThickness:X,onPixelClick:C,onPixelDrag:N,onDragEnd:S,interactive:!0,mixedPixels:j})})}),(0,s.jsxs)("div",{className:"px-4 py-2 border-t border-retro-grid/30 text-xs text-gray-500",children:[r.width,"x",r.height," pixels"]})]}):(0,s.jsx)("div",{className:`flex items-center justify-center h-full ${g}`,children:(0,s.jsxs)("div",{className:"text-center text-gray-500",children:[(0,s.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6z"})}),(0,s.jsx)("p",{children:"No character selected"})]})})}function eu({characters:e,config:t,selectedIndex:a,batchSelection:i,onSelect:o,onAddCharacter:l,onDeleteSelected:c,showAddButton:d=!0,foregroundColor:u="#ffffff",backgroundColor:h="#000000",className:X=""}){let f=i.size+1,p=(0,n.useCallback)(t=>{let r=e.length;if(0!==r)switch(t.key){case"ArrowUp":case"ArrowLeft":t.preventDefault(),o(a>0?a-1:r-1,t.shiftKey);break;case"ArrowDown":case"ArrowRight":t.preventDefault(),o(a<r-1?a+1:0,t.shiftKey);break;case"Delete":case"Backspace":t.preventDefault(),c?.();break;case"a":case"A":(t.ctrlKey||t.metaKey)&&t.preventDefault()}},[e.length,a,o,c]);return(0,s.jsxs)("div",{className:`flex flex-col h-full ${X}`,onKeyDown:p,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border-b border-retro-grid/30",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-300",children:["Characters",(0,s.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",e.length,")"]})]}),l&&(0,s.jsx)("button",{onClick:l,className:"p-1 text-gray-400 hover:text-retro-cyan transition-colors",title:"Add new character",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),f>1&&(0,s.jsx)("div",{className:"px-3 py-2 bg-retro-pink/10 border-b border-retro-grid/30",children:(0,s.jsxs)("span",{className:"text-xs text-retro-pink",children:[f," characters selected"]})}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,s.jsx)(r.InteractiveCharacterGrid,{characters:e,config:t,selectedIndex:a,batchSelection:i,onSelect:o,showAddButton:d&&!!l,onAdd:l,foregroundColor:u,backgroundColor:h,showIndices:!0,minColumns:4,maxColumns:16,gap:4,className:"h-full"})}),(0,s.jsx)("div",{className:"p-3 border-t border-retro-grid/30",children:(0,s.jsxs)("div",{className:"text-[10px] text-gray-500 space-y-1",children:[(0,s.jsx)("div",{children:"Click to select â¢ Shift+click to multi-select"}),(0,s.jsx)("div",{children:"Arrow keys to navigate â¢ Del to delete"})]})})]})}e.s(["COLOR_PRESETS",0,E,"getActiveColors",()=>F,"getCustomColors",()=>$,"getPresetById",()=>M,"getSavedPresetId",()=>z,"saveCustomColors",()=>B,"saveSelectedPreset",()=>I],82906),e.s(["calculateCharacterCount",()=>U,"formatFileSize",()=>O,"formatSize",()=>T,"formatTimestamp",()=>H,"getSuggestedFilename",()=>G,"isValidBinaryFile",()=>K],92921),e.s(["EXPORT_FORMATS",0,[{id:"binary",name:"Binary ROM",description:"Raw binary data for direct ROM programming",extension:".bin",mimeType:"application/octet-stream"},{id:"c-header",name:"C/C++ Header",description:"Byte array for embedded development",extension:".h",mimeType:"text/x-c"},{id:"assembly",name:"Assembly Include",description:"Data bytes for 6502/Z80 assembly",extension:".asm",mimeType:"text/plain"},{id:"png",name:"PNG Image",description:"Character sheet image",extension:".png",mimeType:"image/png"}],"exportToAssembly",()=>J,"exportToCHeader",()=>q,"exportToPng",()=>Y,"getBitLayoutVisualization",()=>ee,"getDefaultAssemblyOptions",()=>V,"getDefaultCHeaderOptions",()=>W,"getDefaultPngOptions",()=>Z,"getHexPreview",()=>Q],44824),e.s([],79086),e.s(["LibraryGrid",()=>ea,"LibraryGridEmptyResults",()=>en,"LibraryGridError",()=>ei],4941),e.s(["LibraryFilters",()=>eo],93949),e.s(["ImportDropZone",()=>el],25544),e.s(["ImportConfigForm",()=>ec],73581),e.s(["EditorCanvas",()=>ed],60441),e.s(["EditorSidebar",()=>eu],42187);var eh=e.i(79724);function eX({colors:e,onColorsChange:t,className:r=""}){let[a,i]=(0,n.useState)(!1),[o,l]=(0,n.useState)(()=>z()),[c,d]=(0,n.useState)(()=>$()),[u,h]=(0,n.useState)(!1),X=(0,eh.useOutsideClick)(()=>{i(!1),h(!1)},a),f=(0,n.useCallback)(e=>{"custom"===e.id?h(!0):(l(e.id),I(e.id),t({foreground:e.foreground,background:e.background,gridColor:e.gridColor}),i(!1))},[t]),p=(0,n.useCallback)((e,r)=>{let a={...c,[e]:r};d(a),B(a),l("custom"),I("custom"),t(a)},[c,t]),m=M(o),x=m?.name||"Custom";return(0,s.jsxs)("div",{className:`relative ${r}`,ref:X,children:[(0,s.jsxs)("button",{onClick:()=>i(!a),className:"flex items-center gap-2 px-3 py-1.5 bg-retro-navy/50 border border-retro-grid/50 rounded text-sm text-gray-300 hover:border-retro-grid transition-colors","aria-expanded":a,"aria-haspopup":"listbox",children:[(0,s.jsxs)("div",{className:"flex gap-0.5",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-sm border border-white/20",style:{backgroundColor:e.foreground}}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-sm border border-white/20",style:{backgroundColor:e.background}})]}),(0,s.jsx)("span",{className:"hidden sm:inline",children:x}),(0,s.jsx)("svg",{className:`w-3 h-3 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&(0,s.jsx)("div",{className:"absolute right-0 mt-1 w-64 bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl z-50 overflow-hidden",children:u?(0,s.jsxs)("div",{className:"p-3 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-300",children:"Custom Colors"}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"text-xs text-gray-500 hover:text-gray-300",children:"Back"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Foreground"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"color",value:c.foreground,onChange:e=>p("foreground",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,s.jsx)("input",{type:"text",value:c.foreground,onChange:e=>p("foreground",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Background"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"color",value:c.background,onChange:e=>p("background",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,s.jsx)("input",{type:"text",value:c.background,onChange:e=>p("background",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"Grid Lines"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"color",value:c.gridColor,onChange:e=>p("gridColor",e.target.value),className:"w-8 h-8 rounded cursor-pointer border-0 bg-transparent"}),(0,s.jsx)("input",{type:"text",value:c.gridColor,onChange:e=>p("gridColor",e.target.value),className:"flex-1 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-xs text-gray-300 font-mono"})]})]})]}):(0,s.jsx)("div",{className:"py-1 max-h-80 overflow-y-auto",children:E.map(e=>(0,s.jsxs)("button",{onClick:()=>f(e),className:`
                    w-full flex items-center gap-3 px-3 py-2 text-left text-sm
                    transition-colors
                    ${o===e.id?"bg-retro-cyan/10 text-retro-cyan":"text-gray-300 hover:bg-retro-purple/20"}
                  `,role:"option","aria-selected":o===e.id,children:["custom"!==e.id?(0,s.jsxs)("div",{className:"flex gap-0.5 flex-shrink-0",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border border-white/20",style:{backgroundColor:e.foreground}}),(0,s.jsx)("div",{className:"w-4 h-4 rounded-sm border border-white/20",style:{backgroundColor:e.background}})]}):(0,s.jsx)("div",{className:"w-[34px] h-4 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),(0,s.jsx)("span",{className:"flex-1",children:e.name}),o===e.id&&(0,s.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})]},e.id))})})]})}function ef(e,t={}){let{enabled:r=!0,target:a=null}=t,s=(0,n.useRef)(e);s.current=e;let i=(0,n.useCallback)(e=>{let t=e.target?.tagName?.toLowerCase();if("input"!==t&&"textarea"!==t&&"select"!==t||e.ctrlKey||e.metaKey)for(let t of s.current){let r=e.key.toLowerCase()===t.key.toLowerCase(),a=!!t.ctrl===(e.ctrlKey||e.metaKey),s=!!t.shift===e.shiftKey,n=!!t.alt===e.altKey;if(r&&a&&s&&n){e.preventDefault(),t.action();return}}},[]);(0,n.useEffect)(()=>{if(!r)return;let e=a||window;return e.addEventListener("keydown",i),()=>{e.removeEventListener("keydown",i)}},[r,a,i])}function ep(e){let t=[],r="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);e.ctrl&&t.push(r?"â":"Ctrl"),e.alt&&t.push(r?"â¥":"Alt"),e.shift&&t.push(r?"â§":"Shift");let a=e.key;return t.push(a=" "===a?"Space":"ArrowUp"===a?"â":"ArrowDown"===a?"â":"ArrowLeft"===a?"â":"ArrowRight"===a?"â":"Escape"===a?"Esc":"Delete"===a?"Del":"Backspace"===a?"â«":a.toUpperCase()),t.join(r?"":"+")}function em(e){return[{key:"z",ctrl:!0,action:e.undo,description:"Undo",context:"Editor"},{key:"z",ctrl:!0,shift:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"y",ctrl:!0,action:e.redo,description:"Redo",context:"Editor"},{key:"s",ctrl:!0,action:e.save,description:"Save",context:"Editor"},{key:"r",action:e.rotateRight,description:"Rotate right",context:"Editor"},{key:"r",shift:!0,action:e.rotateLeft,description:"Rotate left",context:"Editor"},{key:"w",action:e.shiftUp,description:"Shift up",context:"Editor"},{key:"s",action:e.shiftDown,description:"Shift down",context:"Editor"},{key:"a",action:e.shiftLeft,description:"Shift left",context:"Editor"},{key:"d",action:e.shiftRight,description:"Shift right",context:"Editor"},{key:"i",action:e.invert,description:"Invert colors",context:"Editor"},{key:"h",action:e.flipHorizontal,description:"Flip horizontal",context:"Editor"},{key:"v",action:e.flipVertical,description:"Flip vertical",context:"Editor"},{key:"a",ctrl:!0,action:e.selectAll,description:"Select all",context:"Sidebar"},{key:"Delete",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"Backspace",action:e.deleteSelected,description:"Delete selected",context:"Sidebar"},{key:"n",ctrl:!0,action:e.addCharacter,description:"Add new character",context:"Editor"},{key:"?",action:e.showHelp,description:"Show keyboard shortcuts",context:"Global"}]}function ex({isOpen:e,onClose:t,shortcuts:r}){if((0,n.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&(e.preventDefault(),t())};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e,t]),(0,n.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;let a=r.reduce((e,t)=>{let r=t.context||"General";return e[r]||(e[r]=[]),e[r].push(t),e},{}),i=["Editor","Sidebar","Global"],o=Object.keys(a).sort((e,t)=>{let r=i.indexOf(e),a=i.indexOf(t);return -1===r&&-1===a?e.localeCompare(t):-1===r?1:-1===a?-1:r-a});return(0,s.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,s.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-retro-grid/30",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-white",children:"Keyboard Shortcuts"}),(0,s.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsx)("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-6",children:o.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-retro-cyan mb-2",children:e}),(0,s.jsx)("div",{className:"space-y-1",children:a[e].map((t,r)=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-retro-purple/10",children:[(0,s.jsx)("span",{className:"text-sm text-gray-300",children:t.description}),(0,s.jsx)("kbd",{className:"px-2 py-0.5 text-xs font-mono bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:ep(t)})]},`${e}-${r}`))})]},e))}),(0,s.jsx)("div",{className:"px-4 py-3 border-t border-retro-grid/30 text-center",children:(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Press ",(0,s.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"Esc"})," or ",(0,s.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"?"})," to close"]})})]})]})}function eg(){let[e,t]=(0,n.useState)([]),[r,a]=(0,n.useState)(!0),[s,i]=(0,n.useState)(null),[o,l]=(0,n.useState)([]),c=(0,n.useCallback)(async()=>{try{if(a(!0),i(null),await j.initialize(),await j.isEmpty()){let e,t,r,a;for(let s of[(e=Date.now(),{metadata:{id:"c64-uppercase",name:"C64 Uppercase",description:"Commodore 64 uppercase character set (representative sample)",source:"RetroStack",createdAt:e,updatedAt:e,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:m(P())}),(t=Date.now(),{metadata:{id:"apple2-charset",name:"Apple II",description:"Apple II character set (representative sample)",source:"RetroStack",createdAt:t,updatedAt:t,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:m(P())}),(r=Date.now(),{metadata:{id:"zx-spectrum-charset",name:"ZX Spectrum",description:"ZX Spectrum character set (representative sample)",source:"RetroStack",createdAt:r,updatedAt:r,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:m(P())}),(a=Date.now(),{metadata:{id:"ibm-cga-charset",name:"IBM PC CGA",description:"IBM PC CGA 8x8 character set (representative sample)",source:"RetroStack",createdAt:a,updatedAt:a,isBuiltIn:!0},config:{width:8,height:8,padding:"right",bitDirection:"ltr"},binaryData:m(P())})])await j.save(s)}let e=await j.getAll();t(e);let r=await j.getAvailableSizes();l(r)}catch(e){i(e instanceof Error?e.message:"Failed to load library")}finally{a(!1)}},[]);(0,n.useEffect)(()=>{c()},[c]);let d=(0,n.useCallback)(async()=>{await c()},[c]),u=(0,n.useCallback)(async e=>{try{let t=await j.getById(e);if(!t)return null;return b(t)}catch(e){return console.error("Failed to get character set:",e),null}},[]),X=(0,n.useCallback)(async e=>{try{let t=g(e),r=await j.save(t);return await d(),r}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[d]),f=(0,n.useCallback)(async(e,t)=>{try{let r={...e,metadata:{...e.metadata,id:h(),name:t,createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1,source:"yourself"}},a=g(r),s=await j.save(a);return await d(),s}catch(e){throw Error(e instanceof Error?e.message:"Failed to save character set")}},[d]),p=(0,n.useCallback)(async(e,t)=>{try{let r=await j.getById(e);if(!r)throw Error("Character set not found");let a={...r,metadata:{...r.metadata,name:t,updatedAt:Date.now()}};await j.save(a),await d()}catch(e){throw Error(e instanceof Error?e.message:"Failed to rename character set")}},[d]),x=(0,n.useCallback)(async e=>{try{await j.delete(e),await d()}catch(e){throw Error(e instanceof Error?e.message:"Failed to delete character set")}},[d]),y=(0,n.useCallback)(async t=>t.trim()?j.search(t):e,[e]),v=(0,n.useCallback)(async(t,r)=>null===t&&null===r?e:j.filterBySize(t,r),[e]);return{characterSets:e,loading:r,error:s,refresh:d,getById:u,save:X,saveAs:f,rename:p,deleteSet:x,search:y,filterBySize:v,availableSizes:o,nameExists:(0,n.useCallback)(async(e,t)=>j.nameExists(e,t),[])}}function eb(e){return JSON.parse(JSON.stringify(e))}function ey(e){let{state:t,setState:r,resetState:a,undo:s,redo:i,canUndo:o,canRedo:l}=function(e,t=1/0){let r=(0,n.useRef)([]),a=(0,n.useRef)([]),[s,i]=(0,n.useState)(e),[,o]=(0,n.useState)({}),l=(0,n.useCallback)(e=>{r.current=[...r.current,s],r.current.length>t&&(r.current=r.current.slice(-t)),a.current=[],i(e),o({})},[s,t]),c=(0,n.useCallback)(e=>{r.current=[],a.current=[],i(e),o({})},[]),d=(0,n.useCallback)(()=>{if(0===r.current.length)return;a.current=[s,...a.current];let e=r.current[r.current.length-1];r.current=r.current.slice(0,-1),i(e),o({})},[s]),u=(0,n.useCallback)(()=>{if(0===a.current.length)return;r.current=[...r.current,s];let e=a.current[0];a.current=a.current.slice(1),i(e),o({})},[s]),h=(0,n.useCallback)(()=>{r.current=[],a.current=[],o({})},[]);return{state:s,setState:l,resetState:c,undo:d,redo:u,canUndo:r.current.length>0,canRedo:a.current.length>0,historyLength:r.current.length+a.current.length,clearHistory:h}}(e?{characters:e.characters.map(d),config:{...e.config}}:{characters:[],config:{width:8,height:8,padding:"right",bitDirection:"ltr"}}),[u,h]=(0,n.useState)(0),[X,f]=(0,n.useState)(new Set),[p,m]=(0,n.useState)(!1),[x,g]=(0,n.useState)(null),b=(0,n.useMemo)(()=>{let e=new Set(X);return e.add(u),e},[u,X]),y=(0,n.useCallback)(e=>{r(e(eb(t))),m(!0)},[t,r]),[v,w]=(0,n.useState)(null),k=(0,n.useCallback)((e,t)=>{if(t){let t=v??u,r=Math.min(t,e),a=Math.max(t,e),s=new Set;for(let e=r;e<=a;e++)s.add(e);h(e),s.delete(e),f(s)}else h(e),w(e),f(new Set)},[u,v]),j=(0,n.useCallback)(()=>{f(new Set)},[]),E=(0,n.useCallback)(()=>{f(new Set(Array.from({length:t.characters.length},(e,t)=>t)))},[t.characters.length]),L=(0,n.useCallback)((e,t)=>{y(r=>{var a;if(b.size>1){let s;s="same-on"!==R(a=r.characters,b,e,t),r.characters=a.map((r,a)=>b.has(a)?_(r,e,t,s):r)}else{let a=r.characters[u];a&&(r.characters[u]={pixels:a.pixels.map((r,a)=>a===e?r.map((e,r)=>r===t?!e:e):[...r])})}return r})},[y,u,b]),D=(0,n.useCallback)((e,t,r)=>{y(a=>{for(let s of b){let n=a.characters[s];n&&(a.characters[s]=_(n,e,t,r))}return a})},[y,b]),M=(0,n.useCallback)((e,r)=>R(t.characters,b,e,r),[t.characters,b]),I=(0,n.useCallback)(e=>{y(t=>(t.characters=A(t.characters,b,t=>(function(e,t){let r=e.pixels.length,a=e.pixels[0]?.length||0,s=[];for(let n=0;n<r;n++){let i=[];for(let s=0;s<a;s++){let o,l;"right"===t?(o=a-1-s,l=n):(o=s,l=r-1-n),o>=0&&o<r&&l>=0&&l<a?i.push(e.pixels[o]?.[l]||!1):i.push(!1)}s.push(i)}return{pixels:s}})(t,e)),t))},[y,b]),z=(0,n.useCallback)((e,t=!0)=>{y(r=>(r.characters=A(r.characters,b,r=>(function(e,t,r=!0){let a=e.pixels.length,s=e.pixels[0]?.length||0,n=[];for(let i=0;i<a;i++){let o=[];for(let n=0;n<s;n++){let l=i,c=n;switch(t){case"up":if((l=i+1)>=a&&(l=r?0:a-1,!r)){o.push(!1);continue}break;case"down":if((l=i-1)<0&&(l=r?a-1:0,!r)){o.push(!1);continue}break;case"left":if((c=n+1)>=s&&(c=r?0:s-1,!r)){o.push(!1);continue}break;case"right":if((c=n-1)<0&&(c=r?s-1:0,!r)){o.push(!1);continue}}o.push(e.pixels[l]?.[c]||!1)}n.push(o)}return{pixels:n}})(r,e,t)),r))},[y,b]),B=(0,n.useCallback)(()=>{y(e=>(e.characters=A(e.characters,b,C),e))},[y,b]),$=(0,n.useCallback)(()=>{y(e=>(e.characters=A(e.characters,b,N),e))},[y,b]),F=(0,n.useCallback)(()=>{y(e=>(e.characters=A(e.characters,b,S),e))},[y,b]),P=(0,n.useCallback)(()=>{y(e=>{let{width:t,height:r}=e.config;return e.characters=A(e.characters,b,()=>c(t,r)),e})},[y,b]),O=(0,n.useCallback)(()=>{y(e=>{let{width:t,height:r}=e.config;return e.characters=A(e.characters,b,()=>({pixels:Array.from({length:r},()=>Array(t).fill(!0))})),e})},[y,b]),T=(0,n.useCallback)(()=>{y(e=>{let{width:t,height:r}=e.config;return e.characters=[...e.characters,c(t,r)],e}),h(t.characters.length),f(new Set)},[y,t.characters.length]),G=(0,n.useCallback)(()=>{t.characters.length<=1||(y(e=>(e.characters=e.characters.filter((e,t)=>!b.has(t)),e)),h(Math.min(u,t.characters.length-b.size-1)),f(new Set))},[y,b,t.characters.length,u]),K=(0,n.useCallback)((e,t)=>{y(r=>{let a=r.characters[e];return a&&t>=0&&t<r.characters.length&&(r.characters[t]=d(a)),r})},[y]),U=(0,n.useCallback)((e,t,r)=>{y(a=>(a.characters=a.characters.map(a=>(function(e,t,r,a){let s=e.pixels.length,n=e.pixels[0]?.length||0,i=0,o=0;switch(a){case"tl":i=0,o=0;break;case"tr":i=t-n,o=0;break;case"bl":i=0,o=r-s;break;case"br":i=t-n,o=r-s}let l=[];for(let a=0;a<r;a++){let r=[];for(let l=0;l<t;l++){let t=a-o,c=l-i;t>=0&&t<s&&c>=0&&c<n?r.push(e.pixels[t][c]):r.push(!1)}l.push(r)}return{pixels:l}})(a,e,t,r)),a.config={...a.config,width:e,height:t},a))},[y]),H=(0,n.useCallback)((e,t)=>{y(r=>(e>=0&&e<r.characters.length&&(r.characters[e]=d(t)),r))},[y]),W=(0,n.useCallback)(e=>{y(t=>(t.characters=e.map(d),t))},[y]),V=(0,n.useCallback)(()=>{m(!1),g(eb(t))},[t]),Z=(0,n.useCallback)(e=>{a({characters:e.characters.map(d),config:{...e.config}}),h(0),w(null),f(new Set),m(!1),g(null)},[a]);return{characters:t.characters,config:t.config,selectedIndex:u,setSelectedIndex:h,batchSelection:X,toggleBatchSelection:k,clearBatchSelection:j,selectAll:E,toggleSelectedPixel:L,setSelectedPixel:D,getSelectedPixelState:M,rotateSelected:I,shiftSelected:z,invertSelected:B,flipSelectedHorizontal:$,flipSelectedVertical:F,clearSelected:P,fillSelected:O,addCharacter:T,deleteSelected:G,copyCharacter:K,resizeCharacters:U,updateCharacter:H,setCharacters:W,undo:s,redo:i,canUndo:o,canRedo:l,isDirty:p,markSaved:V,reset:Z}}e.s(["ColorPresetSelector",()=>eX],95879),e.s(["createEditorShortcuts",()=>em,"formatShortcut",()=>ep,"useKeyboardShortcuts",()=>ef],3573),e.s(["KeyboardShortcutsHelp",()=>ex],43237),e.s([],3813),e.s(["useCharacterLibrary",()=>eg],66811),e.s(["useCharacterEditor",()=>ey],83621);let ev="character-editor-autosave";function ew(e){let{characterSetId:t,characters:r,config:a,selectedIndex:s,isDirty:i,enabled:o=!0}=e,[l,c]=(0,n.useState)(null),d=(0,n.useRef)(0),u=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(t)try{let e=localStorage.getItem(ev);if(e){let r=JSON.parse(e);r.characterSetId===t&&r.isDirty&&c(r)}}catch{}},[t]);let h=(0,n.useCallback)(()=>{if(t&&o&&0!==r.length)try{let e=m(p(r,a)),n={characterSetId:t,binaryData:e,config:a,selectedIndex:s,timestamp:Date.now(),isDirty:i};localStorage.setItem(ev,JSON.stringify(n)),d.current=Date.now()}catch(e){console.error("Auto-save failed:",e)}},[t,r,a,s,i,o]);(0,n.useEffect)(()=>{if(o&&i&&t)return u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{h()},Math.max(0,3e4-(Date.now()-d.current))),()=>{u.current&&clearTimeout(u.current)}},[o,i,t,h]),(0,n.useEffect)(()=>{if(!o||!i)return;let e=e=>{h(),e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[o,i,h]);let X=(0,n.useCallback)(()=>(c(null),l),[l]);return{hasRecoveryData:null!==l,recoveryData:l,recover:X,discard:(0,n.useCallback)(()=>{c(null);try{localStorage.removeItem(ev)}catch{}},[]),clearAutoSave:(0,n.useCallback)(()=>{try{localStorage.removeItem(ev)}catch{}},[]),saveNow:h}}e.s(["useAutoSave",()=>ew],54750),e.s([],7259)}]);