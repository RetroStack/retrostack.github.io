(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,38749,e=>{"use strict";var t=e.i(43476);function r({checked:e,onChange:r,id:n,disabled:s=!1,className:i=""}){return(0,t.jsx)("button",{type:"button",id:n,role:"switch","aria-checked":e,disabled:s,onClick:()=>r(!e),className:`
        relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full
        border-2 transition-colors duration-200 ease-in-out
        focus:outline-none focus:ring-2 focus:ring-retro-cyan focus:ring-offset-2 focus:ring-offset-retro-dark
        ${e?"bg-retro-pink border-retro-pink":"bg-retro-purple/50 border-retro-purple"}
        ${s?"opacity-50 cursor-not-allowed":""}
        ${i}
      `,children:(0,t.jsx)("span",{className:`
          pointer-events-none inline-block h-5 w-5 transform rounded-full
          shadow ring-0 transition duration-200 ease-in-out
          ${e?"translate-x-5 bg-white":"translate-x-0 bg-gray-400"}
        `})})}e.s(["ToggleSwitch",()=>r])},7506,e=>{"use strict";var t=e.i(71645);function r(e){let r=(0,t.useRef)(null),[n,s]=(0,t.useState)({width:0,height:0}),i=(0,t.useCallback)(t=>{s(t),e?.(t)},[e]);return(0,t.useEffect)(()=>{let e=r.current;if(e){let t,r;return(t=new ResizeObserver(e=>{for(let t of e){let{width:e,height:r}=t.contentRect;i({width:e,height:r})}})).observe(e),i({width:(r=e.getBoundingClientRect()).width,height:r.height}),()=>t.disconnect()}},[i]),{ref:r,size:n}}e.s(["useResizeObserver",()=>r])},16015,(e,t,r)=>{},98547,(e,t,r)=>{var n=e.i(47167);e.r(16015);var s=e.r(71645),i=s&&"object"==typeof s&&"default"in s?s:{default:s},a=void 0!==n.default&&n.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,r=t.name,n=void 0===r?"stylesheet":r,s=t.optimizeForSpeed,i=void 0===s?a:s;c(o(n),"`name` must be a string"),this._name=n,this._deletedRulePlaceholder="#"+n+"-deleted-rule____{}",c("boolean"==typeof i,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=i,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(a||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(c(o(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return a||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var n=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,n))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var r="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(n){a||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var n=this._tags[e];c(n,"old rule at index `"+e+"` not found"),n.textContent=t}return e},r.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&c(o(t),"makeStyleTag accepts only strings as second parameter");var n=document.createElement("style");this._nonce&&n.setAttribute("nonce",this._nonce),n.type="text/css",n.setAttribute("data-"+e,""),t&&n.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return r?s.insertBefore(n,r):s.appendChild(n),n},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var u=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},d={};function h(e,t){if(!t)return"jsx-"+e;var r=String(t),n=e+r;return d[n]||(d[n]="jsx-"+u(e+"-"+r)),d[n]}function f(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return d[r]||(d[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),d[r]}var m=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,n=void 0===r?null:r,s=t.optimizeForSpeed,i=void 0!==s&&s;this._sheet=n||new l({name:"styled-jsx",optimizeForSpeed:i}),this._sheet.inject(),n&&"boolean"==typeof i&&(this._sheet.setOptimizeForSpeed(i),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),n=r.styleId,s=r.rules;if(n in this._instancesCounts){this._instancesCounts[n]+=1;return}var i=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[n]=i,this._instancesCounts[n]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var n=this._fromServer&&this._fromServer[r];n?(n.parentNode.removeChild(n),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],n=e[1];return i.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:n}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,n=e.id;if(r){var s=h(n,r);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return f(s,e)}):[f(s,t)]}}return{styleId:h(n),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),p=s.createContext(null);function x(){return new m}function g(){return s.useContext(p)}p.displayName="StyleSheetContext";var v=i.default.useInsertionEffect||i.default.useLayoutEffect,b="undefined"!=typeof window?x():void 0;function y(e){var t=b||g();return t&&("undefined"==typeof window?t.add(e):v(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}y.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,n=s.useContext(p),a=s.useState(function(){return n||t||x()})[0];return i.default.createElement(p.Provider,{value:a},r)},r.createStyleRegistry=x,r.style=y,r.useStyleRegistry=g},37902,(e,t,r)=>{t.exports=e.r(98547).style},37559,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(38749),s=e.i(32098),i=e.i(28339);function a({isOpen:e,onClose:a,metadata:o,onSave:l}){let[c,u]=(0,r.useState)(o.name),[d,h]=(0,r.useState)(o.description),[f,m]=(0,r.useState)(o.source),[p,x]=(0,r.useState)(o.manufacturer),[g,v]=(0,r.useState)(o.system),[b,y]=(0,r.useState)(o.chip),[C,w]=(0,r.useState)(o.locale),[j,k]=(0,r.useState)(o.tags??[]),[S,_]=(0,r.useState)(o.isPinned??!1),[M,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e&&(u(o.name),h(o.description),m(o.source),x(o.manufacturer),v(o.system),y(o.chip),w(o.locale),k(o.tags??[]),_(o.isPinned??!1))},[e,o]);let R=async()=>{if(c.trim()){N(!0);try{await l({name:c.trim(),description:d.trim(),source:f.trim()||"yourself",manufacturer:p,system:g,chip:b,locale:C.trim(),tags:j,isPinned:S}),a()}finally{N(!1)}}};return(0,t.jsxs)(s.Modal,{isOpen:e,onClose:a,size:"md",children:[(0,t.jsx)(s.ModalHeader,{onClose:a,showCloseButton:!0,children:(0,t.jsx)("h2",{className:"text-lg font-medium text-white",children:"Edit Metadata"})}),(0,t.jsxs)(s.ModalContent,{children:[(0,t.jsx)(i.MetadataFormFields,{name:c,onNameChange:u,description:d,onDescriptionChange:h,manufacturer:p,onManufacturerChange:x,system:g,onSystemChange:v,chip:b,onChipChange:y,locale:C,onLocaleChange:w,source:f,onSourceChange:m,tags:j,onTagsChange:k,autoFocusName:!0,compact:!0,idPrefix:"metadata-edit"}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm text-gray-300",children:"Pin to top"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Pinned items appear first in search results"})]}),(0,t.jsx)(n.ToggleSwitch,{checked:S,onChange:_})]})]}),(0,t.jsx)(s.ModalActions,{onCancel:a,onConfirm:R,confirmLabel:M?"Saving...":"Save",confirmDisabled:!c.trim()||M})]})}e.s(["MetadataEditModal",()=>a])},93582,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(18645);let s={danger:"bg-red-500/20 border-red-500 text-red-400 hover:bg-red-500/30",warning:"bg-orange-500/20 border-orange-500 text-orange-400 hover:bg-orange-500/30",info:"bg-retro-cyan/20 border-retro-cyan text-retro-cyan hover:bg-retro-cyan/30"};function i({isOpen:e,title:i,message:a,details:o,confirmLabel:l="Confirm",cancelLabel:c="Cancel",variant:u="info",onConfirm:d,onCancel:h}){let f=(0,r.useRef)(null),m=(0,n.useFocusTrap)({isActive:e,restoreFocus:!0,autoFocus:!1});return((0,r.useEffect)(()=>{e&&f.current&&f.current.focus()},[e]),(0,r.useEffect)(()=>{if(!e)return;let t=e=>{"Escape"===e.key&&h()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,h]),e)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:h,"aria-hidden":"true"}),(0,t.jsxs)("div",{ref:m,className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-message",children:[(0,t.jsx)("h2",{id:"confirm-dialog-title",className:"text-lg font-medium text-white mb-2",children:i}),(0,t.jsx)("p",{id:"confirm-dialog-message",className:"text-sm text-gray-400 mb-4",children:a}),o&&(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-6",children:o}),(0,t.jsxs)("div",{className:`flex gap-3 ${!o?"mt-2":""}`,children:[(0,t.jsx)("button",{onClick:h,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:c}),(0,t.jsx)("button",{ref:f,onClick:d,className:`flex-1 px-4 py-2 text-sm border rounded transition-colors ${s[u]}`,children:l})]})]})]}):null}e.s(["ConfirmDialog",()=>i])},44254,e=>{"use strict";var t=e.i(71645),r=e.i(70273);function n(){let e=(0,t.useContext)(r.ToastContext);if(!e)throw Error("useToast must be used within a ToastProvider");return e}e.s(["useToast",()=>n])},92921,e=>{"use strict";function t(e){return e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`}function r(e){return`${e.width}x${e.height}`}function n(e){let t=e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");return`${t||"charset"}.bin`}function s(e){let t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return[".bin",".rom",".chr",".fnt",".dat"].includes(t)||!t||t===e.name.toLowerCase()}function i(e,t){return Math.floor(e/(Math.ceil(t.width/8)*t.height))}function a(e){let t=new Date(e),r=Math.floor((new Date().getTime()-e)/864e5);return 0===r?"Today":1===r?"Yesterday":r<7?`${r} days ago`:t.toLocaleDateString()}function o(e,t){if(e.pixels.length!==t.pixels.length)return!1;if(0===e.pixels.length)return!0;if(e.pixels[0].length!==t.pixels[0].length)return!1;for(let r=0;r<e.pixels.length;r++)for(let n=0;n<e.pixels[0].length;n++)if(e.pixels[r][n]!==t.pixels[r][n])return!1;return!0}function l(e,t){let r=new Set,n=Math.max(e.length,t.length);for(let s=0;s<n;s++)s>=e.length||s>=t.length?r.add(s):o(e[s],t[s])||r.add(s);return r}function c(e,t){let r=new Set,n=Math.max(e.pixels.length,t.pixels.length),s=Math.max(e.pixels[0]?.length||0,t.pixels[0]?.length||0);for(let i=0;i<n;i++)for(let n=0;n<s;n++)(e.pixels[i]?.[n]??!1)!==(t.pixels[i]?.[n]??!1)&&r.add(`${i},${n}`);return r}e.s(["areCharactersEqual",()=>o,"calculateCharacterCount",()=>i,"findChangedCharacterIndices",()=>l,"findDifferingPixels",()=>c,"formatFileSize",()=>t,"formatSize",()=>r,"formatTimestamp",()=>a,"getSuggestedFilename",()=>n,"isValidBinaryFile",()=>s])},76849,72547,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(19208),s=e.i(22016),i=e.i(7540);function a({items:e,trigger:r,align:n="right",className:a="",label:o="More options"}){let{ref:l,isOpen:c,toggle:u,close:d}=(0,i.useDropdown)(),h=e=>{e.disabled||(e.onClick?.(),d())};return 0===e.length?null:(0,t.jsxs)("div",{ref:l,className:`relative ${a}`,children:[(0,t.jsx)("button",{onClick:u,className:"touch-target flex items-center justify-center p-2 text-gray-400 hover:text-white bg-retro-dark/50 hover:bg-retro-dark rounded-md transition-colors","aria-label":o,"aria-expanded":c,"aria-haspopup":"menu",children:r||(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})}),c&&(0,t.jsx)("div",{className:`absolute top-full mt-2 z-50 min-w-[180px] bg-retro-navy/95 backdrop-blur-md border border-retro-grid/50 rounded-lg py-1 shadow-xl shadow-black/50 ${"right"===n?"right-0":"left-0"}`,role:"menu","aria-orientation":"vertical",children:e.map(e=>{let r=`
              w-full flex items-center gap-3 px-4 py-3 text-sm text-left
              transition-colors touch-target
              ${e.disabled?"text-gray-500 cursor-not-allowed":"danger"===e.variant?"text-red-400 hover:bg-red-500/20 hover:text-red-300":"text-gray-200 hover:bg-retro-purple/40 hover:text-retro-cyan"}
            `;return e.href&&!e.disabled?(0,t.jsxs)(s.default,{href:e.href,className:r,role:"menuitem",onClick:d,children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id):(0,t.jsxs)("button",{className:r,role:"menuitem",disabled:e.disabled,onClick:()=>h(e),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),h(e))},children:[e.icon&&(0,t.jsx)("span",{className:"w-5 h-5 flex-shrink-0",children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id)})})]})}e.s(["OverflowMenu",()=>a],72547);var o=e.i(74080),l=e.i(32098),c=e.i(92921);function u({isOpen:e,onClose:r,notes:n,characterSetName:s}){if("undefined"==typeof document||!e)return null;let i=(0,t.jsxs)(l.Modal,{isOpen:e,onClose:r,size:"md",maxHeight:"70vh",children:[(0,t.jsx)(l.ModalHeader,{onClose:r,showCloseButton:!0,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-medium text-white",children:"Notes"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:[n.length," note",1!==n.length?"s":""," for ",s]})]})}),(0,t.jsx)(l.ModalContent,{className:"p-4",children:0===n.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),(0,t.jsx)("p",{className:"text-sm",children:"No notes"})]}):(0,t.jsx)("div",{className:"space-y-3",children:n.map(e=>(0,t.jsxs)("div",{className:"p-3 rounded border bg-retro-dark/30 border-retro-grid/30",children:[(0,t.jsx)("p",{className:"text-sm text-gray-200 whitespace-pre-wrap",children:e.text}),(0,t.jsxs)("div",{className:"mt-2 pt-2 border-t border-retro-grid/20 text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Created ",(0,c.formatTimestamp)(e.createdAt)]}),e.updatedAt!==e.createdAt&&(0,t.jsxs)("span",{className:"ml-2",children:["(edited ",(0,c.formatTimestamp)(e.updatedAt),")"]})]})]},e.id))})})]});return(0,o.createPortal)(i,document.body)}var d=e.i(94136);function h({characterSet:e,onEdit:s,onExport:i,onDelete:o,onDuplicate:l,onRename:h,onEditMetadata:f,onTogglePinned:m}){let{metadata:p,config:x}=e,g=(0,r.useMemo)(()=>{try{return(0,d.deserializeCharacterSet)(e).characters}catch{return[]}},[e]),v=g.length,[b,y]=(0,r.useState)(!1),C=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),w=(0,r.useMemo)(()=>{let e=[];return m&&e.push({id:"pin",label:p.isPinned?"Unpin":"Pin to top",onClick:m}),s&&e.push({id:"edit",label:"Edit",onClick:s}),h&&!p.isBuiltIn&&e.push({id:"rename",label:"Rename",onClick:h}),f&&!p.isBuiltIn&&e.push({id:"edit-metadata",label:"Edit Metadata",onClick:f}),i&&e.push({id:"export",label:"Export",onClick:i}),l&&e.push({id:"duplicate",label:"Duplicate",onClick:l}),o&&!p.isBuiltIn&&e.push({id:"delete",label:"Delete",onClick:o,variant:"danger"}),e},[s,h,f,i,l,o,m,p.isBuiltIn,p.isPinned]);return(0,t.jsxs)("div",{className:`card-retro p-4 flex flex-col gap-3 hover-glow-cyan transition-all h-full relative has-[[aria-expanded=true]]:z-50 ${p.isPinned?"ring-1 ring-retro-yellow/50":""}`,children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-retro-cyan truncate flex items-center gap-1.5",children:[p.isPinned&&(0,t.jsx)("svg",{className:"w-3.5 h-3.5 text-retro-yellow flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M16 12V4h1V2H7v2h1v8l-2 2v2h5.2v6h1.6v-6H18v-2l-2-2z"})}),p.notes&&p.notes.length>0&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),y(!0)},className:"flex items-center gap-0.5 text-retro-amber flex-shrink-0 hover:text-retro-amber/80 transition-colors",title:`${p.notes.length} note${1!==p.notes.length?"s":""} - Click to view`,children:(0,t.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})})}),p.name]}),(p.manufacturer||p.system||p.chip||p.locale)&&(0,t.jsxs)("p",{className:"text-[10px] text-gray-500 mt-0.5",children:[p.manufacturer,p.manufacturer&&p.system?" ":"",p.system,p.chip&&(p.manufacturer||p.system)?" · ":"",p.chip,p.locale&&(p.manufacturer||p.system||p.chip)?" · ":"",p.locale]}),p.description&&(0,t.jsx)("p",{className:"text-xs text-gray-400 line-clamp-2 mt-0.5",children:p.description}),p.tags&&p.tags.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:p.tags.map((e,r)=>(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-amber/15 text-retro-amber/80 rounded text-[10px]",children:e},`tag-${r}`))})]}),(0,t.jsx)("div",{className:"flex-shrink-0",children:w.length>0&&(0,t.jsx)(a,{items:w,align:"right",label:"Character set actions"})})]}),(0,t.jsx)("div",{className:"flex justify-center py-2 bg-black/30 rounded mt-auto",children:(0,t.jsx)(n.CharacterPreview,{characters:g,config:x,maxCharacters:512,maxWidth:256,maxHeight:4096})}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 pt-2 border-t border-retro-grid/30 text-[10px]",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-pink rounded",children:(0,c.formatSize)(x)}),(0,t.jsxs)("span",{className:"text-gray-500",children:[v," char",1!==v?"s":""]}),p.isBuiltIn&&(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-retro-navy text-gray-400 rounded",children:"Built-in"})]}),s&&(0,t.jsx)("button",{onClick:s,className:"px-2 py-1 text-xs bg-retro-amber/20 text-retro-amber rounded transition-all shadow-[0_0_8px_rgba(255,184,0,0.25)] hover:bg-retro-amber hover:text-retro-dark hover:shadow-[0_0_8px_var(--retro-amber),0_0_15px_var(--retro-amber),0_0_30px_var(--retro-amber)]",children:"Edit"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-gray-500",children:[(0,t.jsxs)("span",{title:"Date created",children:[(0,t.jsx)("span",{className:"text-[8px] text-gray-600",children:"Created:"})," ",C(p.createdAt)]}),(0,t.jsxs)("span",{title:"Date modified",children:[(0,t.jsx)("span",{className:"text-[8px] text-gray-600",children:"Modified:"})," ",C(p.updatedAt)]})]})]}),(0,t.jsx)(u,{isOpen:b,onClose:()=>y(!1),notes:p.notes??[],characterSetName:p.name})]})}function f({characterSet:e,selected:s=!1,onClick:i}){let{metadata:a,config:o}=e,l=(0,r.useMemo)(()=>{try{return(0,d.deserializeCharacterSet)(e).characters}catch{return[]}},[e]);return(0,t.jsx)("button",{onClick:i,className:`
        w-full p-3 rounded border text-left transition-all
        ${s?"border-retro-cyan bg-retro-cyan/10":"border-retro-grid/30 bg-retro-navy/30 hover:border-retro-grid/50"}
      `,children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 bg-black/30 p-1 rounded",children:(0,t.jsx)(n.CharacterPreview,{characters:l,config:o,maxCharacters:8,maxWidth:48,maxHeight:24})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-200 truncate",children:a.name}),(0,t.jsxs)("div",{className:"text-[10px] text-gray-500",children:[(0,c.formatSize)(o)," - ",l.length," chars"]})]}),s&&(0,t.jsx)("svg",{className:"w-4 h-4 text-retro-cyan flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})})]})})}function m({onImport:e,onCreate:r}){return(0,t.jsxs)("div",{className:"card-retro p-6 flex flex-col items-center justify-center gap-4 border-dashed",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-retro-cyan/20 flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-retro-cyan",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-gray-300",children:"Add a character set"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Import a ROM file or create from scratch"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[r&&(0,t.jsxs)("button",{onClick:r,className:"px-3 py-1.5 text-xs bg-retro-pink/20 text-retro-pink rounded hover:bg-retro-pink/30 transition-colors flex items-center gap-1",children:[(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add"]}),e&&(0,t.jsxs)("button",{onClick:e,className:"px-3 py-1.5 text-xs bg-retro-cyan/20 text-retro-cyan rounded hover:bg-retro-cyan/30 transition-colors flex items-center gap-1",children:[(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import"]})]})]})}e.s(["LibraryCard",()=>h,"LibraryCardCompact",()=>f,"LibraryCardEmpty",()=>m],76849)},20371,e=>{"use strict";var t=e.i(33712);function r(e,t){let r=e.pixels.length,n=e.pixels[0]?.length||0,s=[];for(let i=0;i<r;i++){let a=[];for(let s=0;s<n;s++){let o,l;"right"===t?(o=n-1-s,l=i):(o=s,l=r-1-i),o>=0&&o<r&&l>=0&&l<n?a.push(e.pixels[o]?.[l]||!1):a.push(!1)}s.push(a)}return{pixels:s}}function n(e,t,r=!0){let s=e.pixels.length,i=e.pixels[0]?.length||0,a=[];for(let n=0;n<s;n++){let o=[];for(let a=0;a<i;a++){let l=n,c=a;switch(t){case"up":if((l=n+1)>=s&&(l=r?0:s-1,!r)){o.push(!1);continue}break;case"down":if((l=n-1)<0&&(l=r?s-1:0,!r)){o.push(!1);continue}break;case"left":if((c=a+1)>=i&&(c=r?0:i-1,!r)){o.push(!1);continue}break;case"right":if((c=a-1)<0&&(c=r?i-1:0,!r)){o.push(!1);continue}}o.push(e.pixels[l]?.[c]||!1)}a.push(o)}return{pixels:a}}function s(e,t,r,n){let s=e.pixels.length,i=e.pixels[0]?.length||0,a=0,o=0;n.endsWith("l")?a=0:n.endsWith("c")?a=Math.floor((t-i)/2):n.endsWith("r")&&(a=t-i),n.startsWith("t")?o=0:n.startsWith("m")?o=Math.floor((r-s)/2):n.startsWith("b")&&(o=r-s);let l=[];for(let n=0;n<r;n++){let r=[];for(let l=0;l<t;l++){let t=n-o,c=l-a;t>=0&&t<s&&c>=0&&c<i?r.push(e.pixels[t][c]):r.push(!1)}l.push(r)}return{pixels:l}}function i(e){return{pixels:e.pixels.map(e=>e.map(e=>!e))}}function a(e){return{pixels:e.pixels.map(e=>[...e].reverse())}}function o(e){return{pixels:[...e.pixels].reverse().map(e=>[...e])}}function l(e,r){return(0,t.createEmptyCharacter)(e,r)}function c(e,t){let r=[];for(let n=0;n<t;n++)r.push(Array(e).fill(!0));return{pixels:r}}function u(e,t,r){return{pixels:e.pixels.map((e,n)=>n===t?e.map((e,t)=>t===r?!e:e):[...e])}}function d(e,t,r,n){return{pixels:e.pixels.map((e,s)=>s===t?e.map((e,t)=>t===r?n:e):[...e])}}function h(e,t,r){return e.map((e,n)=>t.has(n)?r(e):e)}function f(e,t,r,n){let s=Array.from(t).map(t=>e[t]);if(0===s.length)return"same-off";let i=s[0]?.pixels[r]?.[n]||!1;for(let e=1;e<s.length;e++)if((s[e]?.pixels[r]?.[n]||!1)!==i)return"mixed";return i?"same-on":"same-off"}function m(e,t,r,n){let s="same-on"!==f(e,t,r,n);return e.map((e,i)=>t.has(i)?d(e,r,n,s):e)}function p(e){let t=e.pixels.length,r=e.pixels[0]?.length||0,n=t,s=-1,i=r,a=-1;for(let o=0;o<t;o++)for(let t=0;t<r;t++)e.pixels[o][t]&&(n=Math.min(n,o),s=Math.max(s,o),i=Math.min(i,t),a=Math.max(a,t));return -1===s?null:{minRow:n,maxRow:s,minCol:i,maxCol:a}}function x(e){let t=e.pixels.length,r=e.pixels[0]?.length||0,n=p(e);if(!n)return e;let s=n.maxCol-n.minCol+1,i=Math.floor((t-(n.maxRow-n.minRow+1))/2),a=Math.floor((r-s)/2)-n.minCol,o=i-n.minRow;if(0===a&&0===o)return e;let l=[];for(let n=0;n<t;n++){let s=[];for(let i=0;i<r;i++){let l=n-o,c=i-a;l>=0&&l<t&&c>=0&&c<r?s.push(e.pixels[l][c]):s.push(!1)}l.push(s)}return{pixels:l}}function g(e,t,r,n){return 1===t?e:"nearest"===n?function(e,t,r){let n=e.pixels.length,s=e.pixels[0]?.length||0,i=Math.round(s*t),a=Math.round(n*t),o=[];for(let r=0;r<a;r++){let a=[];for(let o=0;o<i;o++){let i=Math.min(Math.floor(r/t),n-1),l=Math.min(Math.floor(o/t),s-1);a.push(e.pixels[i]?.[l]||!1)}o.push(a)}let l=s-i,c=n-a,u=0,d=0;r.endsWith("l")?u=0:r.endsWith("c")?u=Math.floor(l/2):r.endsWith("r")&&(u=l),r.startsWith("t")?d=0:r.startsWith("m")?d=Math.floor(c/2):r.startsWith("b")&&(d=c);let h=[];for(let e=0;e<n;e++){let t=[];for(let r=0;r<s;r++){let n=e-d,s=r-u;n>=0&&n<a&&s>=0&&s<i?t.push(o[n][s]):t.push(!1)}h.push(t)}return{pixels:h}}(e,t,r):function(e,t,r,n=.5){let s=e.pixels.length,i=e.pixels[0]?.length||0,a=Math.round(i*t),o=Math.round(s*t),l=[];for(let r=0;r<o;r++){let s=[];for(let i=0;i<a;i++){let a=r/t,o=(r+1)/t,l=i/t,c=(i+1)/t,u=function(e,t,r,n,s){let i=e.length,a=e[0]?.length||0,o=0,l=0,c=Math.max(0,Math.floor(t)),u=Math.min(i-1,Math.floor(r)),d=Math.max(0,Math.floor(n)),h=Math.min(a-1,Math.floor(s));for(let i=c;i<=u;i++)for(let a=d;a<=h;a++){let c=Math.max(i,t),u=Math.max(a,n),d=(Math.min(i+1,r)-c)*(Math.min(a+1,s)-u);o+=d,e[i][a]&&(l+=d)}return 0===o?0:l/o}(e.pixels,a,o,l,c);s.push(u>=n)}l.push(s)}let c=i-a,u=s-o,d=0,h=0;r.endsWith("l")?d=0:r.endsWith("c")?d=Math.floor(c/2):r.endsWith("r")&&(d=c),r.startsWith("t")?h=0:r.startsWith("m")?h=Math.floor(u/2):r.startsWith("b")&&(h=u);let f=[];for(let e=0;e<s;e++){let t=[];for(let r=0;r<i;r++){let n=e-h,s=r-d;n>=0&&n<o&&s>=0&&s<a?t.push(l[n][s]):t.push(!1)}f.push(t)}return{pixels:f}}(e,t,r)}e.s(["batchTogglePixel",()=>m,"batchTransform",()=>h,"centerCharacter",()=>x,"clearCharacter",()=>l,"fillCharacter",()=>c,"flipHorizontal",()=>a,"flipVertical",()=>o,"getBoundingBox",()=>p,"getPixelState",()=>f,"invertCharacter",()=>i,"resizeCharacter",()=>s,"rotateCharacter",()=>r,"scaleCharacter",()=>g,"setPixel",()=>d,"shiftCharacter",()=>n,"togglePixel",()=>u])},85984,88419,98603,64358,81553,40674,96174,33491,e=>{"use strict";var t=e.i(43476);e.i(37902);var r=e.i(71645),n=e.i(20446);function s({character:e,mode:s="small",scale:i=20,smallScale:a=2,selected:o=!1,batchSelected:l=!1,onClick:c,onPixelClick:u,onPixelDrag:d,onDragEnd:h,onPixelHover:f,onPixelLeave:m,foregroundColor:p="#ffffff",backgroundColor:x="#000000",gridColor:g="#4a4a4a",gridThickness:v=1,interactive:b=!0,className:y="",mixedPixels:C,index:w,showIndex:j=!1}){let k="large"===s,S=k?i:a,_=["relative inline-block",!k&&b?"cursor-pointer":"",!k&&b?"hover:opacity-80 transition-opacity":"",(0,r.useMemo)(()=>o?"ring-2 ring-retro-cyan ring-offset-2 ring-offset-retro-dark":l?"ring-2 ring-retro-pink/50 ring-offset-1 ring-offset-retro-dark":"",[o,l]),y].filter(Boolean).join(" ");return(0,t.jsxs)("div",{className:_,onClick:e=>{c&&!k&&(e.stopPropagation(),c())},onKeyDown:e=>{c&&!k&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),c())},role:!k&&b?"button":void 0,tabIndex:!k&&b?0:void 0,"aria-pressed":o||l,"aria-label":void 0!==w?`Character ${w}`:"Character",children:[(0,t.jsx)(n.PixelGrid,{pixels:e.pixels,scale:S,showGrid:k,gridColor:g,gridThickness:k?v:0,foregroundColor:p,backgroundColor:x,onPixelClick:k?u:void 0,onPixelDrag:k?d:void 0,onDragEnd:k?h:void 0,onPixelHover:k?f:void 0,onPixelLeave:k?m:void 0,interactive:k&&b,mixedPixels:C}),j&&void 0!==w&&(0,t.jsx)("div",{className:"absolute -top-1 -right-1 bg-retro-navy/90 text-[8px] text-gray-400 px-1 rounded font-mono",children:w})]})}function i({width:e,height:r,mode:n="small",scale:s=20,smallScale:i=2,onClick:a,className:o=""}){let l="large"===n,c=l?s:i;return(0,t.jsx)("div",{className:`relative inline-flex items-center justify-center bg-retro-navy/50 border border-dashed border-retro-grid/50 cursor-pointer hover:border-retro-cyan/50 transition-colors ${o}`,style:{width:e*c+(l?(e+1)*1:0),height:r*c+(l?(r+1)*1:0)},onClick:a,role:"button",tabIndex:0,onKeyDown:e=>{a&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),a())},"aria-label":"Add new character",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}e.s(["CharacterDisplay",()=>s,"EmptyCharacterDisplay",()=>i],88419);var a=e.i(7506);function o({characters:e,config:r,maxCharacters:n=16,foregroundColor:i="#ffffff",backgroundColor:a="#000000",smallScale:o=1,className:l=""}){let c=e.slice(0,n),u=e.length-n,d=Math.ceil(Math.sqrt(n)),h=r.width*o;return(0,t.jsxs)("div",{className:`relative ${l}`,children:[(0,t.jsx)("div",{className:"grid gap-0.5",style:{gridTemplateColumns:`repeat(${d}, ${h}px)`},children:c.map((e,r)=>(0,t.jsx)(s,{character:e,mode:"small",smallScale:o,foregroundColor:i,backgroundColor:a,interactive:!1},r))}),u>0&&(0,t.jsxs)("div",{className:"absolute bottom-0 right-0 bg-retro-navy/90 text-[10px] text-gray-400 px-1 rounded",children:["+",u]})]})}function l(){let e=(0,r.useRef)(null),t=(0,r.useRef)(!1),n=(0,r.useCallback)(()=>{null!==e.current&&(clearTimeout(e.current),e.current=null,t.current=!1)},[]),s=(0,r.useCallback)((r,s)=>{n(),t.current=!0,e.current=setTimeout(()=>{t.current=!1,e.current=null,r()},s)},[n]);return(0,r.useEffect)(()=>()=>{n()},[n]),{set:s,clear:n,get isActive(){return t.current}}}function c({threshold:e=500,onLongPress:t,onPress:n,disabled:s=!1,moveThreshold:i=10}){let a=l(),o=(0,r.useRef)(!1),c=(0,r.useRef)(null),u=(0,r.useRef)(!1),d=(0,r.useCallback)((r,n)=>{s||(o.current=!1,c.current={x:r,y:n},u.current=!1,a.set(()=>{o.current=!0,u.current=!0,t()},e))},[s,e,t,a]),h=(0,r.useCallback)(()=>{a.clear(),!o.current&&n&&c.current&&n(),c.current=null},[a,n]),f=(0,r.useCallback)(()=>{a.clear(),c.current=null},[a]),m=(0,r.useCallback)((e,t)=>{if(!c.current)return;let r=Math.abs(e-c.current.x),n=Math.abs(t-c.current.y);(r>i||n>i)&&f()},[i,f]),p=(0,r.useCallback)(e=>{0===e.button&&d(e.clientX,e.clientY)},[d]),x=(0,r.useCallback)(()=>{h()},[h]),g=(0,r.useCallback)(()=>{f()},[f]),v=(0,r.useCallback)(e=>{if(1!==e.touches.length)return void f();let t=e.touches[0];d(t.clientX,t.clientY)},[d,f]),b=(0,r.useCallback)(()=>{h()},[h]);return{onMouseDown:p,onMouseUp:x,onMouseLeave:g,onTouchStart:v,onTouchEnd:b,onTouchMove:(0,r.useCallback)(e=>{if(1!==e.touches.length)return void f();let t=e.touches[0];m(t.clientX,t.clientY)},[m,f]),onContextMenu:(0,r.useCallback)(e=>{u.current&&e.preventDefault()},[])}}function u({character:e,index:n,selectedIndex:i,batchSelection:a,onSelect:o,onContextMenu:l,onLongPress:u,isSelectionMode:d,smallScale:h,foregroundColor:f,backgroundColor:m,showIndices:p}){let x=i===n||a?.has(n),g=(0,r.useCallback)(e=>{o?.(n,e.shiftKey,e.metaKey||e.ctrlKey)},[n,o]),v=c({onLongPress:(0,r.useCallback)(()=>{u?.(n)},[n,u]),disabled:!u}),b=(0,r.useCallback)(e=>{l&&(e.preventDefault(),i===n||a?.has(n)||o?.(n,!1,!1),l(e.clientX,e.clientY,n))},[n,i,a,o,l]),y=(0,r.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),o?.(n,e.shiftKey,e.metaKey||e.ctrlKey))},[n,o]),C=(0,r.useCallback)(e=>{v.onContextMenu(e),e.defaultPrevented||b(e)},[v,b]);return(0,t.jsxs)("div",{onClick:g,onContextMenu:C,onKeyDown:y,onMouseDown:v.onMouseDown,onMouseUp:v.onMouseUp,onMouseLeave:v.onMouseLeave,onTouchStart:v.onTouchStart,onTouchEnd:v.onTouchEnd,onTouchMove:v.onTouchMove,role:"option","aria-selected":x,tabIndex:0,"data-grid-index":n,className:"focus:outline-none focus-visible:ring-1 focus-visible:ring-retro-cyan rounded relative touch-manipulation",style:{touchAction:"manipulation"},children:[(0,t.jsx)(s,{character:e,mode:"small",smallScale:h,selected:i===n,batchSelected:a?.has(n)&&i!==n,foregroundColor:f,backgroundColor:m,interactive:!1,index:n,showIndex:p}),d&&x&&(0,t.jsx)("div",{className:"absolute top-0 right-0 w-3 h-3 bg-retro-cyan rounded-bl flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-2 h-2 text-retro-dark",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}function d({enabled:e,onItemTouched:t,getIndexFromPoint:n,onDragStart:s,onDragEnd:i,dragThreshold:a=5}){let[o,l]=(0,r.useState)(!1),c=(0,r.useRef)({startPos:null,touchedIndices:new Set,isActive:!1,hasMoved:!1}),u=(0,r.useRef)(!1),d=(0,r.useRef)(!1),h=(0,r.useCallback)((t,r)=>{if(!e)return;let s=n(t,r);c.current={startPos:{x:t,y:r},touchedIndices:new Set,isActive:!0,hasMoved:!1},null!==s&&c.current.touchedIndices.add(s)},[e,n]),f=(0,r.useCallback)((r,i)=>{let o=c.current;if(!e||!o.isActive||!o.startPos)return;if(!o.hasMoved){let e=Math.abs(r-o.startPos.x),n=Math.abs(i-o.startPos.y);if(e<a&&n<a)return;o.hasMoved=!0,l(!0),s?.();let c=Array.from(o.touchedIndices)[0];void 0!==c&&t(c)}let u=n(r,i);null===u||o.touchedIndices.has(u)||(o.touchedIndices.add(u),t(u))},[e,a,n,t,s]),m=(0,r.useCallback)(()=>{c.current.hasMoved&&(l(!1),i?.(),u.current=!0),c.current={startPos:null,touchedIndices:new Set,isActive:!1,hasMoved:!1}},[i]),p=(0,r.useCallback)(e=>{if(1!==e.touches.length)return void m();let t=e.touches[0];h(t.clientX,t.clientY)},[h,m]),x=(0,r.useCallback)(e=>{if(1!==e.touches.length)return void m();let t=e.touches[0];f(t.clientX,t.clientY)},[f,m]),g=(0,r.useCallback)(()=>{m()},[m]),v=(0,r.useCallback)(t=>{0===t.button&&(d.current=!0,e&&t.preventDefault(),h(t.clientX,t.clientY))},[h,e]),b=(0,r.useCallback)(e=>{d.current&&f(e.clientX,e.clientY)},[f]);return{onTouchStart:p,onTouchMove:x,onTouchEnd:g,onMouseDown:v,onMouseMove:b,onMouseUp:(0,r.useCallback)(()=>{d.current=!1,m()},[m]),onClickCapture:(0,r.useCallback)(e=>{u.current&&(e.stopPropagation(),e.preventDefault(),u.current=!1)},[]),isDragging:o}}function h({characters:e,config:n,selectedIndex:s,batchSelection:o,onSelect:l,showAddButton:c=!1,onAdd:h,foregroundColor:f="#ffffff",backgroundColor:m="#000000",showIndices:p=!1,minColumns:x=8,maxColumns:g=32,gap:v=4,className:b="",smallScale:y=2,onContextMenu:C,isSelectionMode:w=!1,onLongPress:j}){let k=(0,r.useRef)(null),S=(0,r.useRef)(null),{size:_}=(0,a.useResizeObserver)(),M=n.width*y+v+8,N=(0,r.useMemo)(()=>_.width?Math.max(x,Math.min(g,Math.floor((_.width-v)/M))):x,[_.width,M,v,x,g]),R=(0,r.useCallback)((e,t)=>{l?.(e,t,!1)},[l]),{handleKeyDown:T,focusItem:z}=function({itemCount:e,columns:t,currentIndex:n,onNavigate:s,pageSize:i,itemSelector:a='[role="option"]',containerRef:o}){let l=(0,r.useRef)(null),c=o??l,u=i??3*t,d=(0,r.useCallback)(e=>{if(!c.current)return;let t=c.current.querySelectorAll(a)[e];t&&t.focus()},[c,a]),h=(0,r.useCallback)((r,n)=>{if(0===e)return null;let s=n%t,i=Math.ceil(e/t);switch(r){case"ArrowRight":{let t=n+1;return t<e?t:n}case"ArrowLeft":{let e=n-1;return e>=0?e:n}case"ArrowDown":{let r=n+t;if(r>=e){let r=(i-1)*t+s;return r<e?r:e-1}return r}case"ArrowUp":{let e=n-t;return e>=0?e:s}case"Home":return 0;case"End":return e-1;case"PageDown":return Math.min(n+u,e-1);case"PageUp":return Math.max(n-u,0);default:return null}},[e,t,u]);return{handleKeyDown:(0,r.useCallback)(e=>{if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(e.key))return;let t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName)return;let r=h(e.key,n);null!==r&&r!==n&&(e.preventDefault(),s(r,e.shiftKey),d(r))},[n,h,s,d]),containerRef:c,focusItem:d}}({itemCount:e.length,columns:N,currentIndex:s??0,onNavigate:R,containerRef:k});(0,r.useEffect)(()=>{void 0!==s&&document.activeElement?.closest('[role="listbox"]')===k.current&&z(s)},[s,z]);let A=d({enabled:w,onItemTouched:e=>l?.(e,!1,!0),getIndexFromPoint:(0,r.useCallback)((t,r)=>{let n=document.elementFromPoint(t,r);if(!n)return null;let s=n;for(;s&&s!==document.body;){let t=s.getAttribute("data-grid-index");if(null!==t){let r=parseInt(t,10);return r>=0&&r<e.length?r:null}s=s.parentElement}return null},[e.length])});return(0,t.jsx)("div",{ref:k,className:`overflow-auto p-2 ${b} ${w?"ring-4 ring-retro-cyan rounded bg-retro-cyan/10":""} ${A.isDragging?"ring-4 ring-retro-pink bg-retro-pink/20":""}`,role:"listbox","aria-label":"Character selection grid","aria-multiselectable":w||void 0!==o,onKeyDown:T,children:(0,t.jsxs)("div",{ref:S,className:"grid select-none",style:{gridTemplateColumns:`repeat(${N}, auto)`,gap:`${v}px`},onTouchStartCapture:A.onTouchStart,onTouchMoveCapture:A.onTouchMove,onTouchEndCapture:A.onTouchEnd,onMouseDownCapture:A.onMouseDown,onMouseMoveCapture:A.onMouseMove,onMouseUpCapture:A.onMouseUp,onClickCapture:A.onClickCapture,children:[e.map((e,r)=>(0,t.jsx)(u,{character:e,index:r,selectedIndex:s,batchSelection:o,onSelect:l,onContextMenu:C,onLongPress:j,isSelectionMode:w,smallScale:y,foregroundColor:f,backgroundColor:m,showIndices:p},r)),c&&(0,t.jsx)(i,{width:n.width,height:n.height,mode:"small",smallScale:y,onClick:h})]})})}e.s(["CharacterPreviewGrid",()=>o],98603),e.s(["useTimer",()=>l],64358),e.s(["useLongPress",()=>c],81553),e.s(["useDragSelect",()=>d],40674),e.s(["InteractiveCharacterGrid",()=>h],96174),e.s([],85984);var f=e.i(94136),m=e.i(29969);function p(e,t,r,n){let s=(0,f.serializeCharacterRom)(r,n),i=new TextEncoder,a=i.encode(e),o=i.encode(t),l="left"===n.padding|2*("lsb"===n.bitDirection),c=new Uint8Array(3+a.length+1+o.length+1+s.length),u=0;return c[u++]=n.width,c[u++]=n.height,c[u++]=l,c.set(a,u),u+=a.length,c[u++]=0,c.set(o,u),u+=o.length,c[u++]=0,c.set(s,u),"2:"+function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}((0,m.deflateSync)(c,{level:9}))}function x(e){try{var t;if(!e.startsWith("2:"))throw Error("Invalid share format: missing version prefix");let r=e.slice(2),n=(t=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=atob(t+="=".repeat(r)),s=new Uint8Array(n.length);for(let e=0;e<n.length;e++)s[e]=n.charCodeAt(e);return s}(r),(0,m.inflateSync)(t)),s=n[0],i=n[1],a=n[2],o=new TextDecoder,l=3,c=n.indexOf(0,l);if(-1===c)throw Error("Invalid share format: name not terminated");let u=o.decode(n.slice(l,c));l=c+1;let d=n.indexOf(0,l);if(-1===d)throw Error("Invalid share format: description not terminated");let h=o.decode(n.slice(l,d));l=d+1;let p=n.slice(l),x={width:s,height:i,padding:1&a?"left":"right",bitDirection:2&a?"lsb":"msb"},g=(0,f.parseCharacterRom)(p,x);return{name:u,description:h,characters:g,config:x}}catch(e){throw Error(`Failed to decode shared character set: ${e}`)}}function g(e){let t=`${window.location.origin}/tools/character-rom-editor/shared`;return`${t}#${e}`}function v(){let e=window.location.hash;return e?e.slice(1):null}function b(e){return e.length<=2e3?"ok":e.length<=8e3?"warning":"error"}function y(e,t,r){let n=Math.ceil(1.34*Math.ceil((e*Math.ceil(t*r/8)+53)*.5))+2+50;return n<=2e3?{canShare:!0,estimatedLength:n,status:"ok",message:"Character set can be shared"}:n<=8e3?{canShare:!0,estimatedLength:n,status:"warning",message:"URL may be too long for some platforms. Consider reducing characters."}:{canShare:!1,estimatedLength:n,status:"error",message:`Character set is too large to share (${e} characters). Maximum shareable size depends on character dimensions.`}}e.s(["canShare",()=>y,"createShareUrl",()=>g,"decodeCharacterSet",()=>x,"encodeCharacterSet",()=>p,"getHashFromUrl",()=>v,"getUrlLengthStatus",()=>b],33491)}]);