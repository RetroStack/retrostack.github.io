(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53454,e=>{"use strict";let t;var r,n,l,a,s,o,i,c,d,u,h,x,m,f,p,g,b,v,y,j=e.i(43476),w=e.i(71645),k=e.i(18566),C=e.i(22016),N=e.i(3374),S=e.i(58234),M=e.i(72547),L=e.i(21745);function E(e){return"type"in e&&"separator"===e.type}function D({actions:e,minVisibleItems:t=2,className:r="",sticky:n=!1}){let l=(0,w.useRef)(null),[a,s]=(0,w.useState)(new Set),o=(0,w.useCallback)(()=>{if(!l.current)return;let r=l.current.offsetWidth-32-48,n=e.filter(e=>!E(e)).map((t,r)=>({item:t,priority:t.priority??1,originalIndex:e.indexOf(t)})),a=[...n].sort((e,t)=>e.priority-t.priority),o=0;for(let t of e)o+=E(t)?16:48;let i=new Set,c=o,d=n.length;for(let{item:e}of a){if(c<=r||d<=t)break;i.add(e.id),c-=48,d--}s(i)},[e,t]);(0,w.useEffect)(()=>{o();let e=new ResizeObserver(()=>{o()});return l.current&&e.observe(l.current),()=>e.disconnect()},[o]);let i=[],c=[];for(let t of e)if(E(t)){let r=e.slice(e.indexOf(t)+1).some(e=>!E(e)&&!a.has(e.id)),n=e.slice(0,e.indexOf(t)).some(e=>!E(e)&&!a.has(e.id));r&&n&&i.push(t)}else a.has(t.id)?c.push(t):i.push(t);let d=c.map(e=>({id:e.id,label:e.label,icon:e.icon,onClick:e.onClick,disabled:e.disabled}));return(0,j.jsxs)("div",{ref:l,className:`
        flex items-center justify-between
        bg-retro-navy/80 backdrop-blur-sm
        border-b border-retro-grid/50
        px-2 sm:px-4
        ${n?"sticky top-[var(--header-height)] z-40":""}
        ${r}
      `,style:{minHeight:"var(--toolbar-height)"},children:[(0,j.jsx)("div",{className:"flex items-center gap-1 sm:gap-2 flex-nowrap overflow-hidden",children:i.map(e=>E(e)?(0,j.jsx)("div",{className:"h-6 w-px bg-retro-grid/50 mx-1","aria-hidden":"true"},e.id):(0,j.jsx)(L.Tooltip,{content:e.tooltip||e.label,shortcut:e.shortcut,position:"bottom",children:(0,j.jsx)("button",{onClick:e.onClick,disabled:e.disabled,"aria-label":e.label,className:`
                  touch-target flex items-center justify-center p-2 rounded-md
                  text-sm font-ui transition-colors flex-shrink-0
                  ${e.disabled?"text-gray-600 cursor-not-allowed":e.active?"amber"===e.activeVariant?"text-retro-amber bg-retro-amber/20":"text-retro-cyan bg-retro-purple/40":"text-gray-300 hover:text-retro-cyan hover:bg-retro-purple/30"}
                `,children:(0,j.jsx)("span",{className:"w-6 h-6 flex-shrink-0 [&>svg]:w-full [&>svg]:h-full",children:e.icon})})},e.id))}),d.length>0&&(0,j.jsx)(M.OverflowMenu,{items:d,align:"right",label:"More actions"})]})}function R({title:e,children:t,toolbar:r,showFooter:n=!1,fullHeight:l=!0,className:a=""}){return(0,j.jsxs)("div",{className:`flex flex-col safe-top ${l?"viewport-locked":"min-h-screen"}`,children:[(0,j.jsx)(N.Header,{}),r&&r.length>0&&(0,j.jsx)(D,{actions:r,sticky:!0,className:"mt-[var(--header-height)]"}),(0,j.jsxs)("main",{className:`
          flex-1 bg-retro-dark
          ${!r?"mt-[var(--header-height)]":""}
          ${l?"tool-canvas overflow-hidden":""}
          ${a}
        `,children:[(0,j.jsx)("h1",{className:"sr-only",children:e}),t]}),n&&(0,j.jsx)(S.Footer,{})]})}function I({children:e,sidebar:t,sidebarPosition:r="left",sidebarWidth:n="280px",leftSidebar:l,leftSidebarWidth:a="220px",rightSidebar:s,rightSidebarWidth:o="80px",leftSidebarCollapsible:i=!0,rightSidebarCollapsible:c=!0,className:d=""}){let u=l??("left"===r?t:void 0),h=s??("right"===r?t:void 0),x=l?a:n,m=s?o:n;return u||h?(0,j.jsxs)("div",{className:"h-full flex flex-col lg:flex-row",children:[u&&(0,j.jsx)("aside",{className:`
            w-full lg:w-auto lg:flex-shrink-0
            ${i?"border-b lg:border-b-0":""}
            lg:border-r border-retro-grid/50
            bg-retro-navy/50
            overflow-y-auto
            ${i?"max-h-[30vh] lg:max-h-none":""}
          `,style:{"--sidebar-width":x},children:(0,j.jsx)("div",{className:"lg:w-[var(--sidebar-width)] h-full",children:u})}),(0,j.jsx)("div",{className:`
          flex-1 overflow-auto
          flex items-center justify-center
          ${d}
        `,children:e}),h&&(0,j.jsx)("aside",{className:`
            w-full lg:w-auto lg:flex-shrink-0
            ${c?"border-t lg:border-t-0":""}
            lg:border-l border-retro-grid/50
            bg-retro-navy/50
            overflow-y-auto
            ${c?"max-h-[30vh] lg:max-h-none":""}
          `,style:{"--sidebar-width":m},children:(0,j.jsx)("div",{className:"lg:w-[var(--sidebar-width)] h-full",children:h})})]}):(0,j.jsx)("div",{className:`h-full overflow-auto ${d}`,children:e})}var T=e.i(88419);function A({character:e,config:t,onPixelToggle:r,onPixelSet:n,onDragStart:l,onDragEnd:a,getPixelState:s,batchMode:o=!1,foregroundColor:i="#ffffff",backgroundColor:c="#000000",gridColor:d="#333333",gridThickness:u=1,zoom:h=20,minZoom:x=8,maxZoom:m=40,onZoomChange:f,onPixelHover:p,onPixelLeave:g,className:b="",overlayCharacter:v,overlayConfig:y,overlayMode:k="pixel"}){let C,N,S,M=(0,w.useRef)(null),L=(0,w.useRef)(null),[E,D]=(0,w.useState)(!1),[R,I]=(0,w.useState)(null),A=(0,w.useRef)(null),B=(0,w.useMemo)(()=>{if(!o||!s||!e)return;let r=new Set;for(let e=0;e<t.height;e++)for(let n=0;n<t.width;n++)"mixed"===s(e,n)&&r.add(`${e},${n}`);return r.size>0?r:void 0},[o,s,e,t.height,t.width]);(0,w.useEffect)(()=>{let e=L.current;if(!e||!y)return;let r=e.getContext("2d");if(!r)return;let n=t.width,l=t.height,a=y.width,s=y.height,o=h+u,i=n*o+u,c=l*o+u;if(e.width=i,e.height=c,r.clearRect(0,0,i,c),v)if(r.fillStyle="rgba(255, 0, 128, 0.5)","stretch"===k){let e=n*o/a,t=l*o/s;for(let n=0;n<s;n++)for(let l=0;l<a;l++)if(v.pixels[n]?.[l]){let a=u+l*e,s=u+n*t;r.fillRect(a,s,e,t)}}else{let e=Math.min(s,l),t=Math.min(a,n);for(let n=0;n<e;n++)for(let e=0;e<t;e++)if(v.pixels[n]?.[e]){let t=e*o+u,l=n*o+u;r.fillRect(t,l,h,h)}}},[v,y,k,t.width,t.height,h,u]);let z=(0,w.useCallback)((t,a,s)=>{E||(l?.(),s?(n?.(t,a,!1),I(!1)):(r?.(t,a),I(!e?.pixels[t]?.[a])),D(!0))},[E,r,n,l,e]),W=(0,w.useCallback)((e,t)=>{E&&null!==R&&n&&n(e,t,R)},[E,R,n]),O=(0,w.useCallback)(()=>{E&&(D(!1),I(null),a?.())},[E,a]),$=(0,w.useCallback)(e=>{if((e.ctrlKey||e.metaKey)&&(e.preventDefault(),f)){let t=Math.min(m,Math.max(x,h+(e.deltaY>0?-4:4)));t!==h&&f(t)}},[h,x,m,f]),P=(0,w.useCallback)(e=>{if(e.length<2)return null;let t=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(t*t+r*r)},[]),F=(0,w.useCallback)(e=>{2===e.touches.length&&(e.preventDefault(),A.current=P(e.touches))},[P]),H=(0,w.useCallback)(e=>{if(2===e.touches.length&&null!==A.current&&f){e.preventDefault();let t=P(e.touches);if(null!==t){let e=Math.min(m,Math.max(x,h+(t-A.current)/20));Math.abs(e-h)>=1&&(f(Math.round(e)),A.current=t)}}},[P,h,x,m,f]),U=(0,w.useCallback)(()=>{A.current=null},[]);return((0,w.useEffect)(()=>{let e=M.current;if(!e)return;let t=e=>{2===e.touches.length&&e.preventDefault()};return e.addEventListener("touchmove",t,{passive:!1}),()=>{e.removeEventListener("touchmove",t)}},[]),e)?(0,j.jsx)("div",{ref:M,className:`flex items-center justify-center w-full h-full overflow-hidden bg-black/20 ${b}`,tabIndex:0,onWheel:$,onTouchStart:F,onTouchMove:H,onTouchEnd:U,children:(0,j.jsx)("div",{className:"inline-block",onMouseLeave:O,onMouseUp:O,children:(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)(T.CharacterDisplay,{character:e,mode:"large",scale:h,foregroundColor:i,backgroundColor:c,gridColor:d,gridThickness:u,onPixelClick:z,onPixelDrag:W,onDragEnd:O,onPixelHover:p,onPixelLeave:g,interactive:!0,mixedPixels:B}),y&&"side-by-side"!==k&&(C=h+u,N=t.width*C+u,S=t.height*C+u,(0,j.jsx)("canvas",{ref:L,className:"absolute top-0 left-0 pointer-events-none",style:{imageRendering:"pixelated",zIndex:10,width:N,height:S}}))]})})}):(0,j.jsx)("div",{className:`flex items-center justify-center h-full ${b}`,children:(0,j.jsxs)("div",{className:"text-center text-gray-500",children:[(0,j.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6z"})}),(0,j.jsx)("p",{children:"No character selected"})]})})}var B=e.i(31465);function z({characters:e,config:t,selectedIndex:r,batchSelection:n,onSelect:l,foregroundColor:a="#ffffff",backgroundColor:s="#000000",selectionColor:o="#00ffff",batchSelectionColor:i="#ff69b4",maxWidth:c=200,pixelScale:d=1,gap:u=1,collapsible:h=!0,defaultCollapsed:x=!1,className:m="",isSelectionMode:f=!1,onLongPress:p,onToggleSelection:g}){let b=(0,w.useRef)(null),v=(0,w.useRef)(null),[y,k]=(0,w.useState)(x),[C,N]=(0,w.useState)(null),S=(0,w.useRef)(null),M=(0,w.useRef)(null),L=(0,w.useRef)(!1),E=(0,w.useRef)({isActive:!1,hasMoved:!1,touchedIndices:new Set}),D=t.width*d,R=t.height*d,I=D+u,T=R+u,A=Math.max(1,Math.floor(c/I)),B=Math.ceil(e.length/A),z=A*I-u,W=B*T-u;(0,w.useEffect)(()=>{let t=b.current;if(!t||y)return;let l=t.getContext("2d");l&&(t.width=z,t.height=W,l.fillStyle=s,l.fillRect(0,0,z,W),e.forEach((e,t)=>{let c=t%A*I,u=Math.floor(t/A)*T;l.fillStyle=s,l.fillRect(c,u,D,R),l.fillStyle=a,e.pixels.forEach((e,t)=>{e.forEach((e,r)=>{e&&l.fillRect(c+r*d,u+t*d,d,d)})}),n?.has(t)&&t!==r&&(l.strokeStyle=i,l.lineWidth=1,l.globalAlpha=.7,l.strokeRect(c+.5,u+.5,D-1,R-1),l.globalAlpha=1),t===r?(l.strokeStyle=o,l.lineWidth=2,l.strokeRect(c+1,u+1,D-2,R-2)):t!==C||n?.has(t)||(l.strokeStyle=o,l.lineWidth=1,l.globalAlpha=.5,l.strokeRect(c+.5,u+.5,D-1,R-1),l.globalAlpha=1);let h=t===r||n?.has(t);if(f&&h){let e=Math.max(3,Math.min(6,D/3)),t=c+D-e;l.fillStyle=o,l.beginPath(),l.moveTo(t+e,u),l.lineTo(t+e,u+e),l.lineTo(t,u+e),l.closePath(),l.fill(),l.strokeStyle=s,l.lineWidth=1,l.beginPath();let r=t+.65*e,n=u+.55*e;l.moveTo(r-.25*e,n),l.lineTo(r,n+.2*e),l.lineTo(r+.25*e,n-.2*e),l.stroke()}}))},[e,t,r,n,C,a,s,o,i,d,u,A,z,W,D,R,I,T,y,f]);let O=(0,w.useCallback)(t=>{if(!l)return;let r=b.current;if(!r)return;let n=r.getBoundingClientRect(),a=t.clientX-n.left,s=t.clientY-n.top,o=r.width/n.width,i=Math.floor(s*(r.height/n.height)/T)*A+Math.floor(a*o/I);i>=0&&i<e.length&&l(i)},[l,I,T,A,e.length]),$=(0,w.useCallback)(t=>{let r=b.current;if(!r)return;let n=r.getBoundingClientRect(),l=t.clientX-n.left,a=t.clientY-n.top,s=r.width/n.width,o=Math.floor(a*(r.height/n.height)/T)*A+Math.floor(l*s/I);o>=0&&o<e.length?N(o):N(null)},[I,T,A,e.length]),P=(0,w.useCallback)(()=>{N(null)},[]),F=(0,w.useCallback)((t,r)=>{let n=b.current;if(!n)return null;let l=n.getBoundingClientRect(),a=t-l.left,s=r-l.top,o=n.width/l.width,i=Math.floor(s*(n.height/l.height)/T)*A+Math.floor(a*o/I);return i>=0&&i<e.length?i:null},[I,T,A,e.length]),H=(0,w.useCallback)(()=>{M.current&&(clearTimeout(M.current),M.current=null)},[]),U=(0,w.useCallback)(e=>{if(1!==e.touches.length){H(),E.current={isActive:!1,hasMoved:!1,touchedIndices:new Set};return}let t=e.touches[0],r=F(t.clientX,t.clientY);null!==r&&(L.current=!1,S.current={x:t.clientX,y:t.clientY,time:Date.now(),index:r},E.current={isActive:f,hasMoved:!1,touchedIndices:new Set([r])},p&&(H(),M.current=setTimeout(()=>{L.current=!0,p(r)},500)))},[F,p,H,f]),V=(0,w.useCallback)(e=>{if(1!==e.touches.length||!S.current){H(),E.current={isActive:!1,hasMoved:!1,touchedIndices:new Set};return}let t=e.touches[0],r=Math.abs(t.clientX-S.current.x),n=Math.abs(t.clientY-S.current.y);(r>10||n>10)&&H();let l=E.current;if(l.isActive&&g){if(!l.hasMoved&&(r>=5||n>=5)){l.hasMoved=!0;let e=S.current.index;void 0!==e&&g(e)}if(l.hasMoved){let e=F(t.clientX,t.clientY);null===e||l.touchedIndices.has(e)||(l.touchedIndices.add(e),g(e))}}},[H,F,g]),K=(0,w.useCallback)(e=>{H();let t=E.current.hasMoved;if(E.current={isActive:!1,hasMoved:!1,touchedIndices:new Set},!S.current)return;let r=S.current;(S.current=null,L.current||t)?e.preventDefault():f&&g?(e.preventDefault(),g(r.index)):l&&l(r.index)},[f,g,l,H]),X=(0,w.useCallback)(e=>{L.current&&e.preventDefault()},[]),Y=(0,w.useCallback)(()=>{k(e=>!e)},[]);return(0,j.jsxs)("div",{className:`${m}`,ref:v,children:[h&&(0,j.jsxs)("button",{onClick:Y,className:"w-full flex items-center justify-between p-2 text-sm text-gray-300 hover:text-retro-cyan transition-colors",children:[(0,j.jsx)("span",{className:"font-medium",children:"Overview"}),(0,j.jsx)("svg",{className:`w-4 h-4 transition-transform ${y?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!y&&(0,j.jsx)("div",{className:`p-2 bg-black/30 rounded overflow-auto ${f?"ring-1 ring-retro-cyan/30":""}`,style:{maxHeight:"150px"},children:(0,j.jsx)("canvas",{ref:b,onClick:O,onMouseMove:$,onMouseLeave:P,onTouchStart:U,onTouchMove:V,onTouchEnd:K,onContextMenu:X,className:"cursor-pointer",style:{width:z,height:W,imageRendering:"pixelated",touchAction:"manipulation"}})})]})}function W({isVisible:e,selectionCount:t,totalItems:r,onSelectAll:n,onClearSelection:l,onExitMode:a,actions:s=[],className:o=""}){return e?(0,j.jsxs)("div",{className:`
        absolute bottom-0 left-0 right-0
        bg-retro-navy/95 backdrop-blur-sm
        border-t border-retro-cyan/50
        px-3 py-2
        flex items-center justify-between gap-2
        animate-slide-up
        safe-bottom
        z-10
        ${o}
      `,role:"toolbar","aria-label":"Selection actions",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,j.jsx)("span",{className:"inline-flex items-center justify-center min-w-[1.5rem] h-6 px-1.5 rounded-full bg-retro-cyan/20 text-retro-cyan text-sm font-medium",children:t}),(0,j.jsx)("span",{className:"text-sm text-gray-400",children:"selected"})]}),(0,j.jsxs)("div",{className:"flex items-center gap-1 border-l border-retro-grid/30 pl-3",children:[(0,j.jsx)("button",{onClick:n,disabled:t>=r,className:"px-2 py-1 text-xs text-gray-400 hover:text-retro-cyan disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"All"}),(0,j.jsx)("button",{onClick:l,disabled:t<=1,className:"px-2 py-1 text-xs text-gray-400 hover:text-retro-pink disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"None"})]})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[s.map(e=>(0,j.jsxs)("button",{onClick:e.onClick,disabled:e.disabled,className:`
              flex items-center gap-1.5 px-2.5 py-1.5 rounded text-xs font-medium
              transition-colors
              disabled:opacity-50 disabled:cursor-not-allowed
              ${"danger"===e.variant?"text-retro-pink hover:bg-retro-pink/20":"text-gray-300 hover:bg-retro-grid/30"}
            `,title:e.label,children:[e.icon&&(0,j.jsx)("span",{className:"w-4 h-4",children:e.icon}),(0,j.jsx)("span",{className:"hidden sm:inline",children:e.label})]},e.id)),(0,j.jsx)("button",{onClick:a,className:"px-3 py-1.5 rounded text-xs font-medium bg-retro-cyan/20 text-retro-cyan hover:bg-retro-cyan/30 transition-colors",children:"Done"})]})]}):null}function O({characters:e,config:t,selectedIndex:r,batchSelection:n,onSelect:l,onAddCharacter:a,onDeleteSelected:s,onSelectAll:o,onSelectNone:i,onContextMenu:c,showAddButton:d=!0,foregroundColor:u="#ffffff",backgroundColor:h="#000000",className:x=""}){let m=n.size+1,f=m>1,[p,g]=(0,w.useState)(!1),b=function({itemCount:e,selectedIndex:t,batchSelection:r,onSelect:n,onSelectionModeChange:l}){let[a,s]=(0,w.useState)(!1),o=r.size+1,i=(0,w.useMemo)(()=>{let e=new Set(r);return e.add(t),e},[t,r]),c=(0,w.useCallback)(e=>{s(!0),l?.(!0),void 0===e||e===t||r.has(e)||n(e,!1,!0)},[t,r,n,l]),d=(0,w.useCallback)(()=>{s(!1),l?.(!1),n(t,!1,!1)},[t,n,l]),u=(0,w.useCallback)(()=>{a?d():c()},[a,c,d]),h=(0,w.useCallback)(e=>{n(e,!1,!0)},[n]),x=(0,w.useCallback)(()=>{for(let l=0;l<e;l++)l===t||r.has(l)||n(l,!1,!0)},[e,t,r,n]),m=(0,w.useCallback)(()=>{n(t,!1,!1)},[t,n]),f=(0,w.useCallback)((e,t,r)=>{a?h(e):n(e,t,r)},[a,h,n]),p=(0,w.useCallback)(e=>{a||c(e)},[a,c]);return{isSelectionMode:a,enterSelectionMode:c,exitSelectionMode:d,toggleSelectionMode:u,toggleItem:h,selectAll:x,clearSelection:m,handleItemInteraction:f,handleLongPress:p,selectionCount:o,hasMultipleSelected:o>1,selectedIndices:i}}({itemCount:e.length,selectedIndex:r,batchSelection:n,onSelect:l}),v=(0,w.useCallback)(t=>{let n=e.length;if(0!==n)switch(t.key){case"ArrowUp":case"ArrowLeft":t.preventDefault(),l(r>0?r-1:n-1,t.shiftKey,t.metaKey||t.ctrlKey);break;case"ArrowDown":case"ArrowRight":t.preventDefault(),l(r<n-1?r+1:0,t.shiftKey,t.metaKey||t.ctrlKey);break;case"Delete":case"Backspace":t.preventDefault(),s?.();break;case"a":case"A":(t.ctrlKey||t.metaKey)&&t.preventDefault()}},[e.length,r,l,s]);return(0,j.jsxs)("div",{className:`flex flex-col relative ${x}`,onKeyDown:v,children:[(0,j.jsxs)("div",{className:"p-3 border-b border-retro-grid/30",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-sm font-medium text-gray-300",children:"Characters"}),(0,j.jsxs)("span",{className:"text-xs text-gray-500",children:["(",e.length,")"]})]}),(0,j.jsxs)("button",{onClick:b.toggleSelectionMode,className:`flex items-center gap-1 px-2 py-1 rounded text-xs transition-colors ${b.isSelectionMode?"bg-retro-cyan/20 text-retro-cyan":"text-gray-400 hover:text-retro-cyan hover:bg-retro-cyan/10"}`,title:b.isSelectionMode?"Exit selection mode":"Enter selection mode",children:[b.isSelectionMode?(0,j.jsx)("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,j.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,j.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,j.jsx)("span",{className:"hidden sm:inline",children:"Select"})]})]}),f&&!b.isSelectionMode&&(0,j.jsxs)("div",{className:"mt-1 text-xs text-retro-pink",children:[m," characters selected"]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"border-b border-retro-grid/30",children:(0,j.jsx)(z,{characters:e,config:t,selectedIndex:r,batchSelection:n,onSelect:e=>b.handleItemInteraction(e,!1,!1),foregroundColor:u,backgroundColor:h,maxWidth:200,pixelScale:1,collapsible:!0,defaultCollapsed:!1,isSelectionMode:b.isSelectionMode,onLongPress:b.handleLongPress,onToggleSelection:b.toggleItem})}),(0,j.jsxs)("div",{className:"border-b border-retro-grid/30",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-2",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"font-medium text-sm text-gray-300",children:"Characters"}),!b.isSelectionMode&&o&&(0,j.jsx)("button",{onClick:e=>{e.stopPropagation(),o()},className:"text-[10px] text-gray-500 hover:text-retro-cyan transition-colors",children:"All"}),!b.isSelectionMode&&i&&f&&(0,j.jsx)("button",{onClick:e=>{e.stopPropagation(),i()},className:"text-[10px] text-gray-500 hover:text-retro-pink transition-colors",children:"None"})]}),(0,j.jsx)("button",{onClick:()=>g(!p),className:"p-1 text-gray-400 hover:text-retro-cyan transition-colors","aria-label":p?"Expand characters":"Collapse characters",children:(0,j.jsx)("svg",{className:`w-4 h-4 transition-transform ${p?"":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!p&&(0,j.jsx)("div",{className:"p-2 pb-14",children:(0,j.jsx)(B.InteractiveCharacterGrid,{characters:e,config:t,selectedIndex:r,batchSelection:n,onSelect:b.handleItemInteraction,showAddButton:d&&!!a&&!b.isSelectionMode,onAdd:a,foregroundColor:u,backgroundColor:h,showIndices:!1,smallScale:2,minColumns:8,maxColumns:10,gap:4,onContextMenu:b.isSelectionMode?void 0:c,isSelectionMode:b.isSelectionMode,onLongPress:b.handleLongPress})})]})]}),(0,j.jsx)(W,{isVisible:b.isSelectionMode,selectionCount:b.selectionCount,totalItems:e.length,onSelectAll:b.selectAll,onClearSelection:b.clearSelection,onExitMode:b.exitSelectionMode,actions:s?[{id:"delete",label:"Delete",icon:(0,j.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),onClick:()=>{s(),b.exitSelectionMode()},variant:"danger"}]:[]})]})}var $=e.i(58240);let P={0:{abbr:"NUL",name:"Null"},1:{abbr:"SOH",name:"Start of Heading"},2:{abbr:"STX",name:"Start of Text"},3:{abbr:"ETX",name:"End of Text"},4:{abbr:"EOT",name:"End of Transmission"},5:{abbr:"ENQ",name:"Enquiry"},6:{abbr:"ACK",name:"Acknowledgement"},7:{abbr:"BEL",name:"Bell"},8:{abbr:"BS",name:"Backspace"},9:{abbr:"HT",name:"Horizontal Tab"},10:{abbr:"LF",name:"Line Feed"},11:{abbr:"VT",name:"Vertical Tab"},12:{abbr:"FF",name:"Form Feed"},13:{abbr:"CR",name:"Carriage Return"},14:{abbr:"SO",name:"Shift Out"},15:{abbr:"SI",name:"Shift In"},16:{abbr:"DLE",name:"Data Link Escape"},17:{abbr:"DC1",name:"Device Control 1 (XON)"},18:{abbr:"DC2",name:"Device Control 2"},19:{abbr:"DC3",name:"Device Control 3 (XOFF)"},20:{abbr:"DC4",name:"Device Control 4"},21:{abbr:"NAK",name:"Negative Acknowledgement"},22:{abbr:"SYN",name:"Synchronous Idle"},23:{abbr:"ETB",name:"End of Transmission Block"},24:{abbr:"CAN",name:"Cancel"},25:{abbr:"EM",name:"End of Medium"},26:{abbr:"SUB",name:"Substitute"},27:{abbr:"ESC",name:"Escape"},28:{abbr:"FS",name:"File Separator"},29:{abbr:"GS",name:"Group Separator"},30:{abbr:"RS",name:"Record Separator"},31:{abbr:"US",name:"Unit Separator"},127:{abbr:"DEL",name:"Delete"}};function F(e){return P[e]||null}function H(e){return e>=32&&e<=126}function U({characterSetName:e,isDirty:t,characterIndex:r,totalCharacters:n,batchMode:l=!1,zoom:a,minZoom:s=8,maxZoom:o=40,zoomStep:i=4,onZoomChange:c,colors:d,onColorsChange:u,onBack:h,className:x=""}){let m=H(r),f=F(r);return(0,j.jsxs)("div",{className:`flex items-center gap-4 px-4 py-2 bg-retro-navy/50 border-b border-retro-grid/50 ${x}`,children:[(0,j.jsxs)("button",{onClick:h,className:"flex items-center gap-1 text-xs text-gray-400 hover:text-retro-cyan transition-colors whitespace-nowrap",children:[(0,j.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,j.jsx)("span",{className:"hidden sm:inline",children:"Back"})]}),(0,j.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,j.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-300 min-w-0",children:[(0,j.jsx)("span",{className:"truncate max-w-[150px] sm:max-w-[200px]",title:e,children:e}),t&&(0,j.jsxs)("span",{className:"flex items-center gap-1.5 flex-shrink-0",title:"Unsaved changes",children:[(0,j.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,j.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-retro-pink opacity-75"}),(0,j.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-retro-pink"})]}),(0,j.jsx)("span",{className:"hidden sm:inline text-xs text-retro-pink font-medium",children:"Unsaved"})]})]}),(0,j.jsx)("div",{className:"w-px h-4 bg-retro-grid/50 hidden sm:block"}),(0,j.jsxs)("div",{className:"hidden sm:flex items-center gap-2 text-sm text-gray-400",children:[(0,j.jsxs)("span",{className:"whitespace-nowrap",children:["Char ",(0,j.jsx)("span",{className:"text-retro-cyan",children:r}),(0,j.jsxs)("span",{className:"text-gray-500",children:["/",n]})]}),m&&(0,j.jsxs)("span",{className:"px-1.5 py-0.5 bg-retro-purple/30 text-retro-cyan rounded text-xs font-mono",title:"Printable ASCII Character",children:["'",String.fromCharCode(r),"'"]}),f&&(0,j.jsxs)("span",{className:"px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",children:[f.abbr," (",f.name,")"]}),l&&(0,j.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-retro-pink/20 text-retro-pink rounded",children:"Batch"})]}),(0,j.jsx)("div",{className:"flex-1"}),(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)(L.Tooltip,{content:"Zoom out",shortcut:"-",children:(0,j.jsx)("button",{onClick:()=>{a>s&&c(Math.max(a-i,s))},disabled:a<=s,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",children:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})}),(0,j.jsxs)("span",{className:"text-xs text-gray-500 w-10 text-center",children:[a,"x"]}),(0,j.jsx)(L.Tooltip,{content:"Zoom in",shortcut:"+",children:(0,j.jsx)("button",{onClick:()=>{a<o&&c(Math.min(a+i,o))},disabled:a>=o,className:"p-1 text-gray-400 hover:text-white disabled:opacity-30 disabled:cursor-not-allowed",children:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]}),(0,j.jsx)("div",{className:"w-px h-4 bg-retro-grid/50"}),(0,j.jsx)($.ColorPresetSelector,{colors:d,onColorsChange:u})]})}function V({hoverCoords:e,className:t=""}){return(0,j.jsxs)("div",{className:`flex-shrink-0 flex items-center px-4 py-1.5 bg-retro-navy/50 border-t border-retro-grid/50 ${t}`,children:[(0,j.jsx)("div",{className:"w-24 flex-shrink-0"}),(0,j.jsx)("div",{className:"flex-1 flex justify-center",children:(0,j.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-x-4 gap-y-1 text-[10px] text-gray-500",children:[{keys:"Arrow keys",action:"Navigate"},{keys:"Click",action:"Select"},{keys:"Shift+Click",action:"Multi-select"},{keys:"Del",action:"Delete"},{keys:"Ctrl+S",action:"Save"},{keys:"Ctrl+Z/Y",action:"Undo/Redo"},{keys:"?",action:"Help"}].map(({keys:e,action:t},r)=>(0,j.jsxs)("div",{className:"flex items-center gap-1 whitespace-nowrap",children:[(0,j.jsx)("span",{className:"text-gray-400",children:e}),(0,j.jsxs)("span",{className:"hidden sm:inline",children:[": ",t]})]},r))})}),(0,j.jsx)("div",{className:"w-24 flex-shrink-0 flex justify-end",children:e&&(0,j.jsxs)("div",{className:"hidden sm:flex items-center gap-1 text-[10px] text-gray-500 font-mono",children:[(0,j.jsx)("span",{className:"text-gray-400",children:"Pixel:"}),(0,j.jsxs)("span",{className:"text-retro-cyan",children:["(",e.x,", ",e.y,")"]})]})})]})}var K=e.i(20371);function X({pixels:e,label:t,foregroundColor:r="#ffffff",backgroundColor:n="#000000"}){let l=e.length,a=e[0]?.length||0;return(0,j.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,j.jsx)("span",{className:"text-[9px] text-gray-400 uppercase",children:t}),(0,j.jsx)("div",{className:"border border-gray-600",style:{width:3*a,height:3*l,display:"grid",gridTemplateColumns:`repeat(${a}, 3px)`,gridTemplateRows:`repeat(${l}, 3px)`},children:e.flat().map((e,t)=>(0,j.jsx)("div",{style:{backgroundColor:e?r:n,width:3,height:3}},t))})]})}function Y({before:e,after:t,label:r,shortcut:n}){return(0,j.jsxs)("div",{className:"flex flex-col gap-1.5 p-1",children:[(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)("span",{className:"text-xs font-medium",children:r}),n&&(0,j.jsx)("span",{className:"text-gray-400 font-mono text-[10px] bg-gray-700/50 px-1.5 py-0.5 rounded",children:n})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(X,{pixels:e,label:"Before"}),(0,j.jsx)("span",{className:"text-gray-500",children:"→"}),(0,j.jsx)(X,{pixels:t,label:"After"})]})]})}function G({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}function J({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}function q({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}function Z({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}function _({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function Q({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",style:{transform:"scaleX(-1)"},children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}function ee({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h8M8 12h8m-8 5h8M4 3v18m16-18v18"})})}function et({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8v8M12 8v8m5-8v8M3 4h18M3 20h18"})})}function er({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}function en({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"1",strokeWidth:2})})}function el({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,viewBox:"0 0 24 24",children:(0,j.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"1",fill:"currentColor"})})}function ea({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}function es({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}function eo({className:e="w-5 h-5"}){return(0,j.jsxs)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,j.jsx)("circle",{cx:"12",cy:"12",r:"3",strokeWidth:2}),(0,j.jsx)("path",{strokeLinecap:"round",strokeWidth:2,d:"M12 2v4m0 12v4M2 12h4m12 0h4"})]})}function ei({className:e="w-5 h-5"}){return(0,j.jsx)("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4l4 4m0-4H4v4m16-4l-4 4m4 0V4h-4m-12 16l4-4m-4 0v4h4m12 0l-4-4m4 0v4h-4"})})}function ec({onClick:e,disabled:t,tooltip:r,shortcut:n,previewContent:l,children:a,className:s=""}){return(0,j.jsx)(L.Tooltip,{content:l||r,shortcut:l?void 0:n,position:"left",children:(0,j.jsx)("button",{onClick:e,disabled:t,className:`
          p-2.5 rounded transition-colors touch-target
          ${t?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-retro-cyan hover:bg-retro-purple/30"}
          ${s}
        `,children:a})})}function ed(){return(0,j.jsx)("div",{className:"w-full h-px bg-retro-grid/30 my-1"})}function eu({children:e}){return(0,j.jsx)("div",{className:"text-[10px] text-gray-500 uppercase tracking-wider text-center mb-1",children:e})}function eh({character:e,characterWidth:t=8,characterHeight:r=8,onShift:n,onRotate:l,onFlipHorizontal:a,onFlipVertical:s,onInvert:o,onClear:i,onFill:c,onCenter:d,onScale:u,onDelete:h,onCopy:x,disabled:m=!1,className:f=""}){let p=(0,w.useCallback)(()=>n("up"),[n]),g=(0,w.useCallback)(()=>n("down"),[n]),b=(0,w.useCallback)(()=>n("left"),[n]),v=(0,w.useCallback)(()=>n("right"),[n]),y=(0,w.useCallback)(()=>l("left"),[l]),k=(0,w.useCallback)(()=>l("right"),[l]),C=(0,w.useMemo)(()=>{if(!e)return null;let n=e.pixels;return{shiftUp:(0,j.jsx)(Y,{before:n,after:(0,K.shiftCharacter)(e,"up").pixels,label:"Shift Up",shortcut:"W"}),shiftDown:(0,j.jsx)(Y,{before:n,after:(0,K.shiftCharacter)(e,"down").pixels,label:"Shift Down",shortcut:"S"}),shiftLeft:(0,j.jsx)(Y,{before:n,after:(0,K.shiftCharacter)(e,"left").pixels,label:"Shift Left",shortcut:"A"}),shiftRight:(0,j.jsx)(Y,{before:n,after:(0,K.shiftCharacter)(e,"right").pixels,label:"Shift Right",shortcut:"D"}),rotateLeft:(0,j.jsx)(Y,{before:n,after:(0,K.rotateCharacter)(e,"left").pixels,label:"Rotate Left",shortcut:"Shift+R"}),rotateRight:(0,j.jsx)(Y,{before:n,after:(0,K.rotateCharacter)(e,"right").pixels,label:"Rotate Right",shortcut:"R"}),flipHorizontal:(0,j.jsx)(Y,{before:n,after:(0,K.flipHorizontal)(e).pixels,label:"Flip Horizontal",shortcut:"H"}),flipVertical:(0,j.jsx)(Y,{before:n,after:(0,K.flipVertical)(e).pixels,label:"Flip Vertical",shortcut:"V"}),invert:(0,j.jsx)(Y,{before:n,after:(0,K.invertCharacter)(e).pixels,label:"Invert Colors",shortcut:"I"}),center:(0,j.jsx)(Y,{before:n,after:(0,K.centerCharacter)(e).pixels,label:"Center Content"}),clear:(0,j.jsx)(Y,{before:n,after:(0,K.clearCharacter)(t,r).pixels,label:"Clear"}),fill:(0,j.jsx)(Y,{before:n,after:(0,K.fillCharacter)(t,r).pixels,label:"Fill"})}},[e,t,r]);return(0,j.jsxs)("div",{className:`
        flex flex-col items-center py-1 px-2 bg-retro-navy/50 border-l border-retro-grid/30 overflow-hidden
        ${f}
      `,children:[(0,j.jsx)(eu,{children:"Shift"}),(0,j.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,j.jsx)(ec,{onClick:p,disabled:m,tooltip:"Shift Up",shortcut:"W",previewContent:C?.shiftUp,children:(0,j.jsx)(G,{})}),(0,j.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,j.jsx)(ec,{onClick:b,disabled:m,tooltip:"Shift Left",shortcut:"A",previewContent:C?.shiftLeft,children:(0,j.jsx)(q,{})}),(0,j.jsx)(ec,{onClick:()=>d?.(),disabled:m||!d,tooltip:"Center Content",previewContent:C?.center,children:(0,j.jsx)(eo,{})}),(0,j.jsx)(ec,{onClick:v,disabled:m,tooltip:"Shift Right",shortcut:"D",previewContent:C?.shiftRight,children:(0,j.jsx)(Z,{})})]}),(0,j.jsx)(ec,{onClick:g,disabled:m,tooltip:"Shift Down",shortcut:"S",previewContent:C?.shiftDown,children:(0,j.jsx)(J,{})})]}),(0,j.jsx)(ed,{}),(0,j.jsx)(eu,{children:"Rotate"}),(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)(ec,{onClick:y,disabled:m,tooltip:"Rotate Left",shortcut:"Shift+R",previewContent:C?.rotateLeft,children:(0,j.jsx)(_,{})}),(0,j.jsx)(ec,{onClick:k,disabled:m,tooltip:"Rotate Right",shortcut:"R",previewContent:C?.rotateRight,children:(0,j.jsx)(Q,{})})]}),(0,j.jsx)(ed,{}),(0,j.jsx)(eu,{children:"Flip"}),(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)(ec,{onClick:a,disabled:m,tooltip:"Flip Horizontal",shortcut:"H",previewContent:C?.flipHorizontal,children:(0,j.jsx)(ee,{})}),(0,j.jsx)(ec,{onClick:s,disabled:m,tooltip:"Flip Vertical",shortcut:"V",previewContent:C?.flipVertical,children:(0,j.jsx)(et,{})})]}),(0,j.jsx)(ed,{}),(0,j.jsx)(eu,{children:"Effects"}),(0,j.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,j.jsx)(ec,{onClick:o,disabled:m,tooltip:"Invert Colors",shortcut:"I",previewContent:C?.invert,children:(0,j.jsx)(er,{})}),(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)(ec,{onClick:i,disabled:m,tooltip:"Clear",previewContent:C?.clear,children:(0,j.jsx)(en,{})}),(0,j.jsx)(ec,{onClick:c,disabled:m,tooltip:"Fill",previewContent:C?.fill,children:(0,j.jsx)(el,{})})]})]}),u&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ed,{}),(0,j.jsx)(eu,{children:"Scale"}),(0,j.jsx)(ec,{onClick:u,disabled:m,tooltip:"Scale Character",children:(0,j.jsx)(ei,{})})]}),(x||h)&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(ed,{}),(0,j.jsx)(eu,{children:"Char"}),(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[x&&(0,j.jsx)(ec,{onClick:x,disabled:m,tooltip:"Copy from character set",shortcut:"C",children:(0,j.jsx)(es,{})}),h&&(0,j.jsx)(ec,{onClick:h,disabled:m,tooltip:"Delete character",shortcut:"Del",className:"hover:text-red-400",children:(0,j.jsx)(ea,{})})]})]})]})}function ex({history:e,currentIndex:t,onJump:r,canRedo:n=!1,totalEntries:l}){let a=(0,w.useRef)(null),s=(0,w.useRef)(!1),[o,i]=(0,w.useState)(!1),[c,d]=(0,w.useState)(null),[u,h]=(0,w.useState)(0),x=l??e.length,m=x-1,f=(0,w.useCallback)(e=>0===m?50:e/m*100,[m]),p=(0,w.useCallback)(e=>{if(!a.current||0===m)return 0;let t=a.current.getBoundingClientRect(),r=Math.round((e-t.left)/t.width*m);return Math.max(0,Math.min(m,r))},[m]),g=(0,w.useRef)(r);g.current=r;let b=(0,w.useRef)(p);b.current=p,(0,w.useEffect)(()=>{let e=e=>{if(!s.current)return;let t=b.current(e.clientX);g.current(t)},t=()=>{s.current&&(s.current=!1,i(!1))};return window.addEventListener("pointermove",e),window.addEventListener("pointerup",t),window.addEventListener("pointercancel",t),()=>{window.removeEventListener("pointermove",e),window.removeEventListener("pointerup",t),window.removeEventListener("pointercancel",t)}},[]);let v=(0,w.useCallback)(e=>{e.preventDefault(),s.current=!0,i(!0),r(p(e.clientX))},[p,r]),y=(0,w.useCallback)(e=>{if(!s.current&&(d(p(e.clientX)),a.current)){let t=a.current.getBoundingClientRect();h(e.clientX-t.left)}},[p]),k=(0,w.useCallback)(()=>{d(null)},[]),C=(0,w.useCallback)(t=>t<0||t>=e.length?null:e[t]?.label||`State ${t}`,[e]),N=(0,w.useCallback)(e=>{"ArrowLeft"===e.key&&t>0?(e.preventDefault(),r(t-1)):"ArrowRight"===e.key&&t<m?(e.preventDefault(),r(t+1)):"Home"===e.key?(e.preventDefault(),r(0)):"End"===e.key&&(e.preventDefault(),r(m))},[t,m,r]);if(e.length<=1&&!n)return(0,j.jsx)("div",{className:"h-10 flex-shrink-0 bg-retro-navy/50 border-t border-retro-grid/30 flex items-center justify-center",children:(0,j.jsx)("span",{className:"text-[10px] text-gray-500",children:"No history yet"})});let S=f(t),M=null!==c?C(c):null,L=C(t);return(0,j.jsxs)("div",{className:"h-10 flex-shrink-0 bg-retro-navy/50 border-t border-retro-grid/30 flex items-center px-4 gap-3",children:[(0,j.jsxs)("div",{className:"text-[10px] text-gray-400 w-12 flex-shrink-0 font-mono",children:[t+1,"/",x]}),(0,j.jsxs)("div",{ref:a,className:"flex-1 h-6 relative cursor-pointer select-none",style:{touchAction:"none"},onPointerDown:v,onPointerMove:y,onPointerLeave:k,onKeyDown:N,tabIndex:0,role:"slider","aria-valuemin":0,"aria-valuemax":m,"aria-valuenow":t,"aria-label":"History timeline",children:[(0,j.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 right-0 h-1 bg-retro-grid/30 rounded-full"}),(0,j.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 h-1 bg-retro-cyan/50 rounded-full transition-[width] duration-75",style:{width:`${S}%`}}),e.map((e,r)=>{let n=f(r),l=r===t,a=r<t,s=r>t;return(0,j.jsx)("div",{className:`absolute top-1/2 -translate-y-1/2 w-1 h-3 rounded-full transition-all duration-75 ${l?"bg-retro-cyan":a?"bg-retro-cyan/40":s?"bg-retro-pink/40":"bg-retro-grid/40"}`,style:{left:`${n}%`,transform:"translateX(-50%) translateY(-50%)"}},r)}),(0,j.jsx)("div",{className:`absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 transition-all duration-75 ${o?"bg-retro-cyan border-white scale-110":"bg-retro-navy border-retro-cyan hover:bg-retro-cyan/20"}`,style:{left:`${S}%`,transform:"translateX(-50%) translateY(-50%)"}}),M&&!o&&(0,j.jsx)("div",{className:"absolute bottom-full mb-2 px-2 py-1 bg-retro-dark border border-retro-grid/50 rounded text-[10px] text-white whitespace-nowrap pointer-events-none z-10",style:{left:u,transform:"translateX(-50%)"},children:M})]}),(0,j.jsx)("div",{className:"text-[10px] text-gray-400 w-32 flex-shrink-0 truncate text-right",title:L||void 0,children:L||"—"})]})}function em({x:e,y:t,items:r,onClose:n}){let l=(0,w.useRef)(null);(0,w.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()},t=e=>{l.current&&!l.current.contains(e.target)&&n()};return document.addEventListener("keydown",e),document.addEventListener("mousedown",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",t)}},[n]),(0,w.useEffect)(()=>{if(!l.current)return;let e=l.current.getBoundingClientRect(),t=window.innerWidth,r=window.innerHeight;e.right>t-8&&(l.current.style.left=`${t-e.width-8}px`),e.bottom>r-8&&(l.current.style.top=`${r-e.height-8}px`)},[e,t]);let a=(0,w.useCallback)(e=>{e.disabled||(e.onClick(),n())},[n]);return(0,j.jsx)("div",{ref:l,className:"fixed z-[100] min-w-[160px] py-1 bg-retro-navy/95 backdrop-blur-sm border border-retro-grid/50 rounded-lg shadow-xl",style:{left:e,top:t},children:r.map((e,t)=>e.divider?(0,j.jsx)("div",{className:"h-px bg-retro-grid/30 my-1"},t):(0,j.jsxs)("button",{onClick:()=>a(e),disabled:e.disabled,className:`
              w-full px-3 py-1.5 text-left text-sm flex items-center justify-between gap-4
              transition-colors
              ${e.disabled?"text-gray-600 cursor-not-allowed":e.danger?"text-red-400 hover:bg-red-500/20":"text-gray-200 hover:bg-retro-cyan/20 hover:text-retro-cyan"}
            `,children:[(0,j.jsx)("span",{children:e.label}),e.shortcut&&(0,j.jsx)("span",{className:"text-[10px] text-gray-500 font-mono",children:e.shortcut})]},t))})}var ef=e.i(3573);function ep({isOpen:e,onClose:t,shortcuts:r}){if((0,w.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&(e.preventDefault(),t())};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[e,t]),(0,w.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),!e)return null;let n=r.reduce((e,t)=>{let r=t.context||"General";return e[r]||(e[r]=[]),e[r].push(t),e},{}),l=["Editor","Sidebar","Global"],a=Object.keys(n).sort((e,t)=>{let r=l.indexOf(e),n=l.indexOf(t);return -1===r&&-1===n?e.localeCompare(t):-1===r?1:-1===n?-1:r-n});return(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-retro-grid/30",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Keyboard Shortcuts"}),(0,j.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsx)("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-6",children:a.map(e=>(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"text-sm font-medium text-retro-cyan mb-2",children:e}),(0,j.jsx)("div",{className:"space-y-1",children:n[e].map((t,r)=>(0,j.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-retro-purple/10",children:[(0,j.jsx)("span",{className:"text-sm text-gray-300",children:t.description}),(0,j.jsx)("kbd",{className:"px-2 py-0.5 text-xs font-mono bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:(0,ef.formatShortcut)(t)})]},`${e}-${r}`))})]},e))}),(0,j.jsx)("div",{className:"px-4 py-3 border-t border-retro-grid/30 text-center",children:(0,j.jsxs)("span",{className:"text-xs text-gray-500",children:["Press ",(0,j.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"Esc"})," or ",(0,j.jsx)("kbd",{className:"px-1 py-0.5 bg-retro-dark border border-retro-grid/50 rounded text-gray-400",children:"?"})," to close"]})})]})]})}var eg=e.i(37559),eb=e.i(47509);let ev=(0,eb.getAnchorPositions)();function ey({value:e,onChange:t,label:r="Anchor Position",description:n}){return(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:r}),n&&(0,j.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:n}),(0,j.jsx)("div",{className:"grid grid-cols-3 gap-1 w-32 mx-auto",children:ev.map(r=>{let n=e===r;return(0,j.jsx)("button",{type:"button",onClick:()=>t(r),className:`
                w-10 h-10 rounded border-2 transition-all
                flex items-center justify-center
                ${n?"border-retro-amber bg-retro-amber/20":"border-retro-grid/50 bg-retro-dark hover:border-retro-grid"}
              `,title:(0,eb.getAnchorPositionLabel)(r),children:(0,j.jsx)("div",{className:`
                  w-3 h-3 rounded-sm transition-colors
                  ${n?"bg-retro-amber":"bg-gray-600"}
                `})},r)})})]})}function ej({isOpen:e,onClose:t,currentWidth:r,currentHeight:n,onResize:l}){let[a,s]=(0,w.useState)(r),[o,i]=(0,w.useState)(n),[c,d]=(0,w.useState)("tl"),u=(0,w.useCallback)(()=>{a>0&&o>0&&(l(a,o,c),t())},[a,o,c,l,t]),h=(0,w.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&u()},[t,u]);if(!e)return null;let x=a!==r||o!==n;return(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:h,children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-sm bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Resize Characters"}),(0,j.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Width"}),(0,j.jsx)("input",{type:"number",min:1,max:32,value:a,onChange:e=>s(Math.max(1,Math.min(32,parseInt(e.target.value)||1))),className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan",autoFocus:!0})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Height"}),(0,j.jsx)("input",{type:"number",min:1,max:32,value:o,onChange:e=>i(Math.max(1,Math.min(32,parseInt(e.target.value)||1))),className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan"})]})]}),(0,j.jsx)("div",{className:"mb-6",children:(0,j.jsx)(ey,{value:c,onChange:d,description:"Select where to anchor existing content when resizing"})}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mb-4 text-center h-4",children:x?a>r||o>n?"New pixels will be added with background color":a<r||o<n?"Some pixels will be cropped":"No changes":"No changes"}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:u,disabled:!x||a<1||o<1,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply"})]})]})]})}var ew=e.i(76849);e.i(7259);var ek=e.i(66811),eC=e.i(94136),eN=e.i(92921),eS=e.i(81553),eM=e.i(40674);let eL=["tl","tc","tr","ml","mc","mr","bl","bc","br"];function eE({character:e,index:t,isSelected:r,isSelectionMode:n,onClick:l,onLongPress:a}){let s=(0,w.useCallback)(e=>{l(t,e.shiftKey,e.ctrlKey||e.metaKey)},[t,l]),o=(0,w.useCallback)(()=>{a(t)},[t,a]),i=(0,eS.useLongPress)({onLongPress:o});return(0,j.jsxs)("button",{onClick:s,onMouseDown:i.onMouseDown,onMouseUp:i.onMouseUp,onMouseLeave:i.onMouseLeave,onTouchStart:i.onTouchStart,onTouchEnd:i.onTouchEnd,onTouchMove:i.onTouchMove,onContextMenu:i.onContextMenu,"data-grid-index":t,className:`
        p-1 rounded border-2 transition-all relative touch-manipulation
        ${r?"border-retro-cyan bg-retro-cyan/20":"border-transparent hover:border-retro-grid/50"}
      `,style:{touchAction:"manipulation"},title:`Character ${t}`,children:[(0,j.jsx)(T.CharacterDisplay,{character:e,mode:"small",smallScale:3}),n&&r&&(0,j.jsx)("div",{className:"absolute top-0 right-0 w-3 h-3 bg-retro-cyan rounded-bl flex items-center justify-center",children:(0,j.jsx)("svg",{className:"w-2 h-2 text-retro-dark",fill:"currentColor",viewBox:"0 0 20 20",children:(0,j.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})}function eD({isOpen:e,onClose:t,currentConfig:r,onImport:n}){let{characterSets:l,loading:a}=(0,ek.useCharacterLibrary)(),[s,o]=(0,w.useState)("select-set"),[i,c]=(0,w.useState)(null),[d,u]=(0,w.useState)(""),[h,x]=(0,w.useState)(new Set),[m,f]=(0,w.useState)(null),[p,g]=(0,w.useState)("tl"),[b,v]=(0,w.useState)(!1),y=(0,w.useRef)(null);(0,w.useEffect)(()=>{e||(o("select-set"),c(null),u(""),x(new Set),f(null),g("tl"),v(!1))},[e]);let k=(0,w.useMemo)(()=>i&&l.find(e=>e.metadata.id===i)||null,[l,i]),C=(0,w.useMemo)(()=>{if(!k)return[];try{return(0,eC.deserializeCharacterSet)(k).characters}catch{return[]}},[k]),N=(0,w.useMemo)(()=>!!k&&(r.width!==k.config.width||r.height!==k.config.height),[k,r]),S=(0,w.useMemo)(()=>{if(!d.trim())return l;let e=d.toLowerCase();return l.filter(t=>t.metadata.name.toLowerCase().includes(e)||t.metadata.description.toLowerCase().includes(e))},[l,d]),M=(0,w.useCallback)((e,t)=>{let r=document.elementFromPoint(e,t);if(!r)return null;let n=r;for(;n&&n!==document.body;){let e=n.getAttribute("data-grid-index");if(null!==e){let t=parseInt(e,10);return t>=0&&t<C.length?t:null}n=n.parentElement}return null},[C.length]),L=(0,w.useCallback)(e=>{x(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),E=(0,eM.useDragSelect)({enabled:b,onItemTouched:L,getIndexFromPoint:M}),D=(0,w.useCallback)(e=>{c(e.metadata.id)},[]),R=(0,w.useCallback)((e,t,r)=>{b?x(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r}):(x(n=>{let l=new Set(n);if(t&&null!==m){let t=Math.min(m,e),r=Math.max(m,e);for(let e=t;e<=r;e++)l.add(e)}else r?l.has(e)?l.delete(e):l.add(e):(l.clear(),l.add(e));return l}),f(e))},[m,b]),I=(0,w.useCallback)(e=>{v(!0),x(t=>{let r=new Set(t);return r.add(e),r})},[]),T=(0,w.useCallback)(()=>{x(new Set(C.map((e,t)=>t)))},[C]),A=(0,w.useCallback)(()=>{x(new Set)},[]),B=(0,w.useCallback)(()=>{v(!1)},[]),z=(0,w.useCallback)(()=>{"resize"===s?o("select-chars"):"select-chars"===s&&(o("select-set"),x(new Set))},[s]),O=(0,w.useCallback)(()=>{"select-set"===s&&i?o("select-chars"):"select-chars"===s&&h.size>0&&(N?o("resize"):(n(Array.from(h).sort((e,t)=>e-t).map(e=>C[e])),t()))},[s,i,h,N,C,n,t]),$=(0,w.useCallback)(()=>{let e=Array.from(h).sort((e,t)=>e-t).map(e=>C[e]);N&&(e=e.map(e=>(0,K.resizeCharacter)(e,r.width,r.height,p))),n(e),t()},[h,C,N,r,p,n,t]),P=(0,w.useCallback)(e=>{"Escape"===e.key&&t()},[t]);return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:P,children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-2xl max-h-[80vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,j.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-retro-grid/30",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Import Characters"}),(0,j.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["select-set"===s&&"Select a character set to import from","select-chars"===s&&`Select characters to import (${h.size} selected)`,"resize"===s&&"Configure resize settings"]})]}),(0,j.jsxs)("div",{className:"flex-1 overflow-hidden p-4 flex flex-col min-h-0",children:["select-set"===s&&(0,j.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 gap-4",children:[(0,j.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,j.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"Search...",className:"w-full px-3 py-2 pl-9 bg-retro-dark border border-retro-grid/50 rounded text-sm text-gray-200 placeholder-gray-500 focus:outline-none focus:border-retro-cyan/50",autoFocus:!0}),(0,j.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,j.jsx)("div",{className:"space-y-2 flex-1 overflow-y-auto min-h-0",children:a?(0,j.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):0===S.length?(0,j.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No character sets found"}):S.map(e=>(0,j.jsx)(ew.LibraryCardCompact,{characterSet:e,selected:i===e.metadata.id,onClick:()=>D(e)},e.metadata.id))}),k&&(0,j.jsxs)("div",{className:"flex-shrink-0 text-xs text-gray-500 text-center pt-2 border-t border-retro-grid/30",children:["Source: ",(0,eN.formatSize)(k.config)," (",C.length," chars)",N&&(0,j.jsxs)("span",{className:"text-yellow-500 ml-2",children:["(will be resized to ",(0,eN.formatSize)(r),")"]})]})]}),"select-chars"===s&&k&&(0,j.jsxs)("div",{className:"flex flex-col flex-1 min-h-0 gap-4 relative",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between flex-shrink-0",children:[(0,j.jsx)("div",{className:"text-xs text-gray-500",children:b?"Tap to toggle selection":"Click to select, Shift+click for range, Ctrl+click to toggle"}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsxs)("button",{onClick:()=>v(!b),className:`flex items-center gap-1 px-2 py-1 rounded text-xs transition-colors ${b?"bg-retro-cyan/20 text-retro-cyan":"text-gray-400 hover:text-retro-cyan hover:bg-retro-cyan/10"}`,title:b?"Exit selection mode":"Enter selection mode",children:[b?(0,j.jsx)("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,j.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,j.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,j.jsx)("span",{children:"Select"})]}),!b&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("button",{onClick:T,className:"text-xs text-retro-cyan hover:underline",children:"All"}),(0,j.jsx)("button",{onClick:A,className:"text-xs text-gray-400 hover:underline",children:"Clear"})]})]})]}),(0,j.jsx)("div",{className:`bg-black/30 rounded-lg p-3 flex-1 overflow-y-auto min-h-0 ${b?"pb-16 ring-1 ring-retro-cyan/30":""}`,children:(0,j.jsx)("div",{ref:y,className:"grid gap-1 select-none",style:{gridTemplateColumns:`repeat(auto-fill, minmax(${Math.max(3*k.config.width,24)+8}px, 1fr))`},onTouchStartCapture:E.onTouchStart,onTouchMoveCapture:E.onTouchMove,onTouchEndCapture:E.onTouchEnd,onMouseDownCapture:E.onMouseDown,onMouseMoveCapture:E.onMouseMove,onMouseUpCapture:E.onMouseUp,onClickCapture:E.onClickCapture,children:C.map((e,t)=>(0,j.jsx)(eE,{character:e,index:t,isSelected:h.has(t),isSelectionMode:b,onClick:R,onLongPress:I},t))})}),(0,j.jsx)(W,{isVisible:b,selectionCount:h.size,totalItems:C.length,onSelectAll:T,onClearSelection:A,onExitMode:B})]}),"resize"===s&&k&&(0,j.jsxs)("div",{className:"space-y-6",children:[(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("p",{className:"text-sm text-gray-300 mb-2",children:"Source dimensions differ from target"}),(0,j.jsxs)("p",{className:"text-xs text-gray-500",children:[(0,eN.formatSize)(k.config)," → ",(0,eN.formatSize)(r)]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2 text-center",children:"Anchor Position"}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mb-3 text-center",children:"Select where to anchor content when resizing"}),(0,j.jsx)("div",{className:"grid grid-cols-3 gap-1 w-32 mx-auto",children:eL.map(e=>{let t=p===e;return(0,j.jsx)("button",{type:"button",onClick:()=>g(e),className:`
                          w-10 h-10 rounded border-2 transition-all
                          flex items-center justify-center
                          ${t?"border-retro-cyan bg-retro-cyan/20":"border-retro-grid/50 bg-retro-dark hover:border-retro-grid"}
                        `,title:{tl:"Top Left",tc:"Top Center",tr:"Top Right",ml:"Middle Left",mc:"Middle Center",mr:"Middle Right",bl:"Bottom Left",bc:"Bottom Center",br:"Bottom Right"}[e],children:(0,j.jsx)("div",{className:`
                            w-3 h-3 rounded-sm transition-colors
                            ${t?"bg-retro-cyan":"bg-gray-600"}
                          `})},e)})})]}),(0,j.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:[h.size," character",1!==h.size?"s":""," will be imported and resized"]})]})]}),(0,j.jsxs)("div",{className:"flex-shrink-0 p-4 border-t border-retro-grid/30 flex justify-between",children:["select-set"===s?(0,j.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}):(0,j.jsx)("button",{onClick:z,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Back"}),"resize"===s?(0,j.jsxs)("button",{onClick:$,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors",children:["Import (",h.size,")"]}):(0,j.jsx)("button",{onClick:O,disabled:"select-set"===s&&!i||"select-chars"===s&&0===h.size,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"select-chars"!==s||N?"Next":`Import (${h.size})`})]})]})]}):null}function eR({isOpen:e,onClose:t,characters:r,currentIndex:n,onCopy:l}){let[a,s]=(0,w.useState)(null);(0,w.useEffect)(()=>{e||s(null)},[e]);let o=(0,w.useCallback)(e=>{s(e)},[]),i=(0,w.useCallback)(()=>{null!==a&&(l(a),t())},[a,l,t]),c=(0,w.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&null!==a&&i()},[t,a,i]);return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:c,children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-lg max-h-[70vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,j.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-retro-grid/30",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Copy Character"}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Select a character to copy. It will replace the currently selected character(s)."})]}),(0,j.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[(0,j.jsx)("div",{className:"bg-black/30 rounded-lg p-3",children:(0,j.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(auto-fill, minmax(40px, 1fr))"},children:r.map((e,t)=>{let r=a===t,l=t===n;return(0,j.jsxs)("button",{onClick:()=>o(t),disabled:l,className:`
                      p-1.5 rounded border-2 transition-all relative
                      ${r?"border-retro-cyan bg-retro-cyan/20":l?"border-retro-pink/30 bg-retro-pink/10 opacity-50 cursor-not-allowed":"border-transparent hover:border-retro-grid/50"}
                    `,title:l?"Current selection":`Character ${t}`,children:[(0,j.jsx)(T.CharacterDisplay,{character:e,mode:"small",smallScale:3}),l&&(0,j.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,j.jsx)("span",{className:"text-[8px] text-retro-pink bg-retro-dark/80 px-1 rounded",children:"current"})})]},t)})})}),null!==a&&(0,j.jsxs)("div",{className:"text-xs text-gray-500 text-center mt-3",children:["Character ",a," selected"]})]}),(0,j.jsxs)("div",{className:"flex-shrink-0 p-4 border-t border-retro-grid/30 flex justify-between",children:[(0,j.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:i,disabled:null===a,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Copy"})]})]})]}):null}var eI=e.i(74080);let eT="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function eA(e){let t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function eB(e){return"nodeType"in e}function ez(e){var t,r;return e?eA(e)?e:eB(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function eW(e){let{Document:t}=ez(e);return e instanceof t}function eO(e){return!eA(e)&&e instanceof ez(e).HTMLElement}function e$(e){return e instanceof ez(e).SVGElement}function eP(e){return e?eA(e)?e.document:eB(e)?eW(e)?e:eO(e)||e$(e)?e.ownerDocument:document:document:document}let eF=eT?w.useLayoutEffect:w.useEffect;function eH(e){let t=(0,w.useRef)(e);return eF(()=>{t.current=e}),(0,w.useCallback)(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return null==t.current?void 0:t.current(...r)},[])}function eU(e,t){void 0===t&&(t=[e]);let r=(0,w.useRef)(e);return eF(()=>{r.current!==e&&(r.current=e)},t),r}function eV(e,t){let r=(0,w.useRef)();return(0,w.useMemo)(()=>{let t=e(r.current);return r.current=t,t},[...t])}function eK(e){let t=eH(e),r=(0,w.useRef)(null),n=(0,w.useCallback)(e=>{e!==r.current&&(null==t||t(e,r.current)),r.current=e},[]);return[r,n]}function eX(e){let t=(0,w.useRef)();return(0,w.useEffect)(()=>{t.current=e},[e]),t.current}let eY={};function eG(e,t){return(0,w.useMemo)(()=>{if(t)return t;let r=null==eY[e]?0:eY[e]+1;return eY[e]=r,e+"-"+r},[e,t])}function eJ(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),l=1;l<r;l++)n[l-1]=arguments[l];return n.reduce((t,r)=>{for(let[n,l]of Object.entries(r)){let r=t[n];null!=r&&(t[n]=r+e*l)}return t},{...t})}}let eq=eJ(1),eZ=eJ(-1);function e_(e){if(!e)return!1;let{KeyboardEvent:t}=ez(e.target);return t&&e instanceof t}function eQ(e){if(function(e){if(!e)return!1;let{TouchEvent:t}=ez(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return"clientX"in e&&"clientY"in e?{x:e.clientX,y:e.clientY}:null}let e0=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[e0.Translate.toString(e),e0.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),e1="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]",e2={display:"none"};function e4(e){let{id:t,value:r}=e;return w.default.createElement("div",{id:t,style:e2},r)}function e5(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;return w.default.createElement("div",{id:t,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":n,"aria-atomic":!0},r)}let e3=(0,w.createContext)(null),e6={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},e8={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function e7(e){var t;let r,{announcements:n=e8,container:l,hiddenTextDescribedById:a,screenReaderInstructions:s=e6}=e,{announce:o,announcement:i}=function(){let[e,t]=(0,w.useState)("");return{announce:(0,w.useCallback)(e=>{null!=e&&t(e)},[]),announcement:e}}(),c=eG("DndLiveRegion"),[d,u]=(0,w.useState)(!1);if((0,w.useEffect)(()=>{u(!0)},[]),t=(0,w.useMemo)(()=>({onDragStart(e){let{active:t}=e;o(n.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;n.onDragMove&&o(n.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;o(n.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;o(n.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;o(n.onDragCancel({active:t,over:r}))}}),[o,n]),r=(0,w.useContext)(e3),(0,w.useEffect)(()=>{if(!r)throw Error("useDndMonitor must be used within a children of <DndContext>");return r(t)},[t,r]),!d)return null;let h=w.default.createElement(w.default.Fragment,null,w.default.createElement(e4,{id:a,value:s.draggable}),w.default.createElement(e5,{id:c,announcement:i}));return l?(0,eI.createPortal)(h,l):h}function e9(){}function te(e,t){return(0,w.useMemo)(()=>({sensor:e,options:null!=t?t:{}}),[e,t])}(r=u||(u={})).DragStart="dragStart",r.DragMove="dragMove",r.DragEnd="dragEnd",r.DragCancel="dragCancel",r.DragOver="dragOver",r.RegisterDroppable="registerDroppable",r.SetDroppableDisabled="setDroppableDisabled",r.UnregisterDroppable="unregisterDroppable";let tt=Object.freeze({x:0,y:0});function tr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function tn(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function tl(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function ta(e){let{left:t,top:r,height:n,width:l}=e;return[{x:t,y:r},{x:t+l,y:r},{x:t,y:r+n},{x:t+l,y:r+n}]}function ts(e,t){if(!e||0===e.length)return null;let[r]=e;return t?r[t]:r}function to(e,t,r){return void 0===t&&(t=e.left),void 0===r&&(r=e.top),{x:t+.5*e.width,y:r+.5*e.height}}let ti=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,l=to(t,t.left,t.top),a=[];for(let e of n){let{id:t}=e,n=r.get(t);if(n){let r=tr(to(n),l);a.push({id:t,data:{droppableContainer:e,value:r}})}}return a.sort(tn)},tc=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,l=[];for(let e of n){let{id:n}=e,a=r.get(n);if(a){let r=function(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),l=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height);if(n<l&&r<a){let s=t.width*t.height,o=e.width*e.height,i=(l-n)*(a-r);return Number((i/(s+o-i)).toFixed(4))}return 0}(a,t);r>0&&l.push({id:n,data:{droppableContainer:e,value:r}})}}return l.sort(tl)};function td(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:tt}let tu=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((e,t)=>({...e,top:e.top+ +t.y,bottom:e.bottom+ +t.y,left:e.left+ +t.x,right:e.right+ +t.x}),{...e})};function th(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}let tx={ignoreTransform:!1};function tm(e,t){void 0===t&&(t=tx);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:t,transformOrigin:n}=ez(e).getComputedStyle(e);t&&(r=function(e,t,r){let n=th(t);if(!n)return e;let{scaleX:l,scaleY:a,x:s,y:o}=n,i=e.left-s-(1-l)*parseFloat(r),c=e.top-o-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=l?e.width/l:e.width,u=a?e.height/a:e.height;return{width:d,height:u,top:c,right:i+d,bottom:c+u,left:i}}(r,t,n))}let{top:n,left:l,width:a,height:s,bottom:o,right:i}=r;return{top:n,left:l,width:a,height:s,bottom:o,right:i}}function tf(e){return tm(e,{ignoreTransform:!0})}function tp(e,t){let r=[];return e?function n(l){var a,s;let o;if(null!=t&&r.length>=t||!l)return r;if(eW(l)&&null!=l.scrollingElement&&!r.includes(l.scrollingElement))return r.push(l.scrollingElement),r;if(!eO(l)||e$(l)||r.includes(l))return r;let i=ez(e).getComputedStyle(l);return(l!==e&&(void 0===(a=i)&&(a=ez(l).getComputedStyle(l)),o=/(auto|scroll|overlay)/,["overflow","overflowX","overflowY"].some(e=>{let t=a[e];return"string"==typeof t&&o.test(t)}))&&r.push(l),void 0===(s=i)&&(s=ez(l).getComputedStyle(l)),"fixed"===s.position)?r:n(l.parentNode)}(e):r}function tg(e){let[t]=tp(e,1);return null!=t?t:null}function tb(e){return eT&&e?eA(e)?e:eB(e)?eW(e)||e===eP(e).scrollingElement?window:eO(e)?e:null:null:null}function tv(e){return eA(e)?e.scrollX:e.scrollLeft}function ty(e){return eA(e)?e.scrollY:e.scrollTop}function tj(e){return{x:tv(e),y:ty(e)}}function tw(e){return!!eT&&!!e&&e===document.scrollingElement}function tk(e){let t={x:0,y:0},r=tw(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},l=e.scrollTop<=t.y,a=e.scrollLeft<=t.x;return{isTop:l,isLeft:a,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}(n=h||(h={}))[n.Forward=1]="Forward",n[n.Backward=-1]="Backward";let tC={x:.2,y:.2};function tN(e){return e.reduce((e,t)=>eq(e,tj(t)),tt)}function tS(e,t){if(void 0===t&&(t=tm),!e)return;let{top:r,left:n,bottom:l,right:a}=t(e);tg(e)&&(l<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}let tM=[["x",["left","right"],function(e){return e.reduce((e,t)=>e+tv(t),0)}],["y",["top","bottom"],function(e){return e.reduce((e,t)=>e+ty(t),0)}]];class tL{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=tp(t),n=tN(r);for(const[t,l,a]of(this.rect={...e},this.width=e.width,this.height=e.height,tM))for(const e of l)Object.defineProperty(this,e,{get:()=>{let l=a(r),s=n[t]-l;return this.rect[e]+s},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class tE{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)})},this.target=e}add(e,t,r){var n;null==(n=this.target)||n.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function tD(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t&&n>t.y}function tR(e){e.preventDefault()}function tI(e){e.stopPropagation()}(l=x||(x={})).Click="click",l.DragStart="dragstart",l.Keydown="keydown",l.ContextMenu="contextmenu",l.Resize="resize",l.SelectionChange="selectionchange",l.VisibilityChange="visibilitychange",(a=m||(m={})).Space="Space",a.Down="ArrowDown",a.Right="ArrowRight",a.Left="ArrowLeft",a.Up="ArrowUp",a.Esc="Escape",a.Enter="Enter",a.Tab="Tab";let tT={start:[m.Space,m.Enter],cancel:[m.Esc],end:[m.Space,m.Enter,m.Tab]},tA=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case m.Right:return{...r,x:r.x+25};case m.Left:return{...r,x:r.x-25};case m.Down:return{...r,y:r.y+25};case m.Up:return{...r,y:r.y-25}}};class tB{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new tE(eP(t)),this.windowListeners=new tE(ez(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(x.Resize,this.handleCancel),this.windowListeners.add(x.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(x.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&tS(r),t(tt)}handleKeyDown(e){if(e_(e)){let{active:t,context:r,options:n}=this.props,{keyboardCodes:l=tT,coordinateGetter:a=tA,scrollBehavior:s="smooth"}=n,{code:o}=e;if(l.end.includes(o))return void this.handleEnd(e);if(l.cancel.includes(o))return void this.handleCancel(e);let{collisionRect:i}=r.current,c=i?{x:i.left,y:i.top}:tt;this.referenceCoordinates||(this.referenceCoordinates=c);let d=a(e,{active:t,context:r.current,currentCoordinates:c});if(d){let t=eZ(d,c),n={x:0,y:0},{scrollableAncestors:l}=r.current;for(let r of l){let l=e.code,{isTop:a,isRight:o,isLeft:i,isBottom:c,maxScroll:u,minScroll:h}=tk(r),x=function(e){if(e===document.scrollingElement){let{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}let{top:t,left:r,right:n,bottom:l}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:l,width:e.clientWidth,height:e.clientHeight}}(r),f={x:Math.min(l===m.Right?x.right-x.width/2:x.right,Math.max(l===m.Right?x.left:x.left+x.width/2,d.x)),y:Math.min(l===m.Down?x.bottom-x.height/2:x.bottom,Math.max(l===m.Down?x.top:x.top+x.height/2,d.y))},p=l===m.Right&&!o||l===m.Left&&!i,g=l===m.Down&&!c||l===m.Up&&!a;if(p&&f.x!==d.x){let e=r.scrollLeft+t.x,a=l===m.Right&&e<=u.x||l===m.Left&&e>=h.x;if(a&&!t.y)return void r.scrollTo({left:e,behavior:s});a?n.x=r.scrollLeft-e:n.x=l===m.Right?r.scrollLeft-u.x:r.scrollLeft-h.x,n.x&&r.scrollBy({left:-n.x,behavior:s});break}if(g&&f.y!==d.y){let e=r.scrollTop+t.y,a=l===m.Down&&e<=u.y||l===m.Up&&e>=h.y;if(a&&!t.x)return void r.scrollTo({top:e,behavior:s});a?n.y=r.scrollTop-e:n.y=l===m.Down?r.scrollTop-u.y:r.scrollTop-h.y,n.y&&r.scrollBy({top:-n.y,behavior:s});break}}this.handleMove(e,eq(eZ(d,this.referenceCoordinates),n))}}}handleMove(e,t){let{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){let{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){let{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function tz(e){return!!(e&&"distance"in e)}function tW(e){return!!(e&&"delay"in e)}tB.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=tT,onActivation:l}=t,{active:a}=r,{code:s}=e.nativeEvent;if(n.start.includes(s)){let t=a.activatorNode.current;return(!t||e.target===t)&&(e.preventDefault(),null==l||l({event:e.nativeEvent}),!0)}return!1}}];class tO{constructor(e,t,r){var n;void 0===r&&(r=function(e){let{EventTarget:t}=ez(e);return e instanceof t?e:eP(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:l}=e,{target:a}=l;this.props=e,this.events=t,this.document=eP(a),this.documentListeners=new tE(this.document),this.listeners=new tE(r),this.windowListeners=new tE(ez(a)),this.initialCoordinates=null!=(n=eQ(l))?n:tt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(x.Resize,this.handleCancel),this.windowListeners.add(x.DragStart,tR),this.windowListeners.add(x.VisibilityChange,this.handleCancel),this.windowListeners.add(x.ContextMenu,tR),this.documentListeners.add(x.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(tW(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(tz(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){let{active:r,onPending:n}=this.props;n(r,e,this.initialCoordinates,t)}handleStart(){let{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(x.Click,tI,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(x.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;let{activated:r,initialCoordinates:n,props:l}=this,{onMove:a,options:{activationConstraint:s}}=l;if(!n)return;let o=null!=(t=eQ(e))?t:tt,i=eZ(n,o);if(!r&&s){if(tz(s)){if(null!=s.tolerance&&tD(i,s.tolerance))return this.handleCancel();if(tD(i,s.distance))return this.handleStart()}return tW(s)&&tD(i,s.tolerance)?this.handleCancel():void this.handlePending(s,i)}e.cancelable&&e.preventDefault(),a(o)}handleEnd(){let{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){let{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===m.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}let t$={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class tP extends tO{constructor(e){const{event:t}=e;super(e,t$,eP(t.target))}}tP.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!!r.isPrimary&&0===r.button&&(null==n||n({event:r}),!0)}}];(s=f||(f={}))[s.RightClick=2]="RightClick";(o=p||(p={}))[o.Pointer=0]="Pointer",o[o.DraggableRect=1]="DraggableRect",(i=g||(g={}))[i.TreeOrder=0]="TreeOrder",i[i.ReversedTreeOrder=1]="ReversedTreeOrder";let tF={x:{[h.Backward]:!1,[h.Forward]:!1},y:{[h.Backward]:!1,[h.Forward]:!1}};(c=b||(b={}))[c.Always=0]="Always",c[c.BeforeDragging=1]="BeforeDragging",c[c.WhileDragging=2]="WhileDragging",(v||(v={})).Optimized="optimized";let tH=new Map;function tU(e,t){return eV(r=>e?r||("function"==typeof t?t(e):e):null,[t,e])}function tV(e){let{callback:t,disabled:r}=e,n=eH(t),l=(0,w.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.ResizeObserver)return;let{ResizeObserver:e}=window;return new e(n)},[r]);return(0,w.useEffect)(()=>()=>null==l?void 0:l.disconnect(),[l]),l}function tK(e){return new tL(tm(e),e)}function tX(e,t,r){void 0===t&&(t=tK);let[n,l]=(0,w.useState)(null);function a(){l(n=>{if(!e)return null;if(!1===e.isConnected){var l;return null!=(l=null!=n?n:r)?l:null}let a=t(e);return JSON.stringify(n)===JSON.stringify(a)?n:a})}let s=function(e){let{callback:t,disabled:r}=e,n=eH(t),l=(0,w.useMemo)(()=>{if(r||"undefined"==typeof window||void 0===window.MutationObserver)return;let{MutationObserver:e}=window;return new e(n)},[n,r]);return(0,w.useEffect)(()=>()=>null==l?void 0:l.disconnect(),[l]),l}({callback(t){if(e)for(let r of t){let{type:t,target:n}=r;if("childList"===t&&n instanceof HTMLElement&&n.contains(e)){a();break}}}}),o=tV({callback:a});return eF(()=>{a(),e?(null==o||o.observe(e),null==s||s.observe(document.body,{childList:!0,subtree:!0})):(null==o||o.disconnect(),null==s||s.disconnect())},[e]),n}let tY=[];function tG(e,t){void 0===t&&(t=[]);let r=(0,w.useRef)(null);return(0,w.useEffect)(()=>{r.current=null},t),(0,w.useEffect)(()=>{let t=e!==tt;t&&!r.current&&(r.current=e),!t&&r.current&&(r.current=null)},[e]),r.current?eZ(e,r.current):tt}function tJ(e){return(0,w.useMemo)(()=>{let t,r;return e?(t=e.innerWidth,{top:0,left:0,right:t,bottom:r=e.innerHeight,width:t,height:r}):null},[e])}let tq=[];function tZ(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return eO(t)?t:e}let t_=[{sensor:tP,options:{}},{sensor:tB,options:{}}],tQ={current:{}},t0={draggable:{measure:tf},droppable:{measure:tf,strategy:b.WhileDragging,frequency:v.Optimized},dragOverlay:{measure:tm}};class t1 extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}let t2={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new t1,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:e9},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:t0,measureDroppableContainers:e9,windowRect:null,measuringScheduled:!1},t4={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:e9,draggableNodes:new Map,over:null,measureDroppableContainers:e9},t5=(0,w.createContext)(t4),t3=(0,w.createContext)(t2);function t6(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new t1}}}function t8(e,t){switch(t.type){case u.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case u.DragMove:if(null==e.draggable.active)return e;return{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case u.DragEnd:case u.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case u.RegisterDroppable:{let{element:r}=t,{id:n}=r,l=new t1(e.droppable.containers);return l.set(n,r),{...e,droppable:{...e.droppable,containers:l}}}case u.SetDroppableDisabled:{let{id:r,key:n,disabled:l}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;let s=new t1(e.droppable.containers);return s.set(r,{...a,disabled:l}),{...e,droppable:{...e.droppable,containers:s}}}case u.UnregisterDroppable:{let{id:r,key:n}=t,l=e.droppable.containers.get(r);if(!l||n!==l.key)return e;let a=new t1(e.droppable.containers);return a.delete(r),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function t7(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:l}=(0,w.useContext)(t5),a=eX(n),s=eX(null==r?void 0:r.id);return(0,w.useEffect)(()=>{if(!t&&!n&&a&&null!=s){if(!e_(a)||document.activeElement===a.target)return;let e=l.get(s);if(!e)return;let{activatorNode:t,node:r}=e;(t.current||r.current)&&requestAnimationFrame(()=>{for(let e of[t.current,r.current]){if(!e)continue;let t=e.matches(e1)?e:e.querySelector(e1);if(t){t.focus();break}}})}},[n,t,l,s,a]),null}function t9(e,t){let{transform:r,...n}=t;return null!=e&&e.length?e.reduce((e,t)=>t({transform:e,...n}),r):r}let re=(0,w.createContext)({...tt,scaleX:1,scaleY:1});(d=y||(y={}))[d.Uninitialized=0]="Uninitialized",d[d.Initializing=1]="Initializing",d[d.Initialized=2]="Initialized";let rt=(0,w.memo)(function(e){var t,r,n,l,a,s,o,i;let c,d,x,m,f,v,j,k,{id:C,accessibility:N,autoScroll:S=!0,children:M,sensors:L=t_,collisionDetection:E=tc,measuring:D,modifiers:R,...I}=e,[T,A]=(0,w.useReducer)(t8,void 0,t6),[B,z]=function(){let[e]=(0,w.useState)(()=>new Set),t=(0,w.useCallback)(t=>(e.add(t),()=>e.delete(t)),[e]);return[(0,w.useCallback)(t=>{let{type:r,event:n}=t;e.forEach(e=>{var t;return null==(t=e[r])?void 0:t.call(e,n)})},[e]),t]}(),[W,O]=(0,w.useState)(y.Uninitialized),$=W===y.Initialized,{draggable:{active:P,nodes:F,translate:H},droppable:{containers:U}}=T,V=null!=P?F.get(P):null,K=(0,w.useRef)({initial:null,translated:null}),X=(0,w.useMemo)(()=>{var e;return null!=P?{id:P,data:null!=(e=null==V?void 0:V.data)?e:tQ,rect:K}:null},[P,V]),Y=(0,w.useRef)(null),[G,J]=(0,w.useState)(null),[q,Z]=(0,w.useState)(null),_=eU(I,Object.values(I)),Q=eG("DndDescribedBy",C),ee=(0,w.useMemo)(()=>U.getEnabled(),[U]),et=(0,w.useMemo)(()=>({draggable:{...t0.draggable,...null==D?void 0:D.draggable},droppable:{...t0.droppable,...null==D?void 0:D.droppable},dragOverlay:{...t0.dragOverlay,...null==D?void 0:D.dragOverlay}}),[null==D?void 0:D.draggable,null==D?void 0:D.droppable,null==D?void 0:D.dragOverlay]),{droppableRects:er,measureDroppableContainers:en,measuringScheduled:el}=function(e,t){let{dragging:r,dependencies:n,config:l}=t,[a,s]=(0,w.useState)(null),{frequency:o,measure:i,strategy:c}=l,d=(0,w.useRef)(e),u=function(){switch(c){case b.Always:return!1;case b.BeforeDragging:return r;default:return!r}}(),h=eU(u),x=(0,w.useCallback)(function(e){void 0===e&&(e=[]),h.current||s(t=>null===t?e:t.concat(e.filter(e=>!t.includes(e))))},[h]),m=(0,w.useRef)(null),f=eV(t=>{if(u&&!r)return tH;if(!t||t===tH||d.current!==e||null!=a){let t=new Map;for(let r of e){if(!r)continue;if(a&&a.length>0&&!a.includes(r.id)&&r.rect.current){t.set(r.id,r.rect.current);continue}let e=r.node.current,n=e?new tL(i(e),e):null;r.rect.current=n,n&&t.set(r.id,n)}return t}return t},[e,a,r,u,i]);return(0,w.useEffect)(()=>{d.current=e},[e]),(0,w.useEffect)(()=>{u||x()},[r,u]),(0,w.useEffect)(()=>{a&&a.length>0&&s(null)},[JSON.stringify(a)]),(0,w.useEffect)(()=>{u||"number"!=typeof o||null!==m.current||(m.current=setTimeout(()=>{x(),m.current=null},o))},[o,u,x,...n]),{droppableRects:f,measureDroppableContainers:x,measuringScheduled:null!=a}}(ee,{dragging:$,dependencies:[H.x,H.y],config:et.droppable}),ea=eV(e=>{var t;return null==P?null:null!=(t=null!=f?f:e)?t:null},[f=(m=null!=P?F.get(P):void 0)?m.node.current:null,P]),es=(0,w.useMemo)(()=>q?eQ(q):null,[q]),eo=(c=(null==G?void 0:G.autoScrollEnabled)===!1,d="object"==typeof S?!1===S.enabled:!1===S,x=$&&!c&&!d,"object"==typeof S?{...S,enabled:x}:{enabled:x}),ei=tU(ea,et.draggable.measure);!function(e){let{activeNode:t,measure:r,initialRect:n,config:l=!0}=e,a=(0,w.useRef)(!1),{x:s,y:o}="boolean"==typeof l?{x:l,y:l}:l;eF(()=>{if(!s&&!o||!t){a.current=!1;return}if(a.current||!n)return;let e=null==t?void 0:t.node.current;if(!e||!1===e.isConnected)return;let l=td(r(e),n);if(s||(l.x=0),o||(l.y=0),a.current=!0,Math.abs(l.x)>0||Math.abs(l.y)>0){let t=tg(e);t&&t.scrollBy({top:l.y,left:l.x})}},[t,s,o,n,r])}({activeNode:null!=P?F.get(P):null,config:eo.layoutShiftCompensation,initialRect:ei,measure:et.draggable.measure});let ec=tX(ea,et.draggable.measure,ei),ed=tX(ea?ea.parentElement:null),eu=(0,w.useRef)({activatorEvent:null,active:null,activeNode:ea,collisionRect:null,collisions:null,droppableRects:er,draggableNodes:F,draggingNode:null,draggingNodeRect:null,droppableContainers:U,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),eh=U.getNodeFor(null==(t=eu.current.over)?void 0:t.id),ex=function(e){let{measure:t}=e,[r,n]=(0,w.useState)(null),l=tV({callback:(0,w.useCallback)(e=>{for(let{target:r}of e)if(eO(r)){n(e=>{let n=t(r);return e?{...e,width:n.width,height:n.height}:n});break}},[t])}),[a,s]=eK((0,w.useCallback)(e=>{let r=tZ(e);null==l||l.disconnect(),r&&(null==l||l.observe(r)),n(r?t(r):null)},[t,l]));return(0,w.useMemo)(()=>({nodeRef:a,rect:r,setRef:s}),[r,a,s])}({measure:et.dragOverlay.measure}),em=null!=(r=ex.nodeRef.current)?r:ea,ef=$?null!=(n=ex.rect)?n:ec:null,ep=!!(ex.nodeRef.current&&ex.rect),eg=(v=tU(a=ep?null:ec),td(a,v)),eb=tJ(em?ez(em):null),ev=(s=$?null!=eh?eh:ea:null,j=(0,w.useRef)(s),k=eV(e=>s?e&&e!==tY&&s&&j.current&&s.parentNode===j.current.parentNode?e:tp(s):tY,[s]),(0,w.useEffect)(()=>{j.current=s},[s]),k),ey=function(e,t){void 0===t&&(t=tm);let[r]=e,n=tJ(r?ez(r):null),[l,a]=(0,w.useState)(tq);function s(){a(()=>e.length?e.map(e=>tw(e)?n:new tL(t(e),e)):tq)}let o=tV({callback:s});return eF(()=>{null==o||o.disconnect(),s(),e.forEach(e=>null==o?void 0:o.observe(e))},[e]),l}(ev),ej=t9(R,{transform:{x:H.x-eg.x,y:H.y-eg.y,scaleX:1,scaleY:1},activatorEvent:q,active:X,activeNodeRect:ec,containerNodeRect:ed,draggingNodeRect:ef,over:eu.current.over,overlayNodeRect:ex.rect,scrollableAncestors:ev,scrollableAncestorRects:ey,windowRect:eb}),ew=es?eq(es,H):null,ek=function(e){let[t,r]=(0,w.useState)(null),n=(0,w.useRef)(e),l=(0,w.useCallback)(e=>{let t=tb(e.target);t&&r(e=>e?(e.set(t,tj(t)),new Map(e)):null)},[]);return(0,w.useEffect)(()=>{let t=n.current;if(e!==t){a(t);let s=e.map(e=>{let t=tb(e);return t?(t.addEventListener("scroll",l,{passive:!0}),[t,tj(t)]):null}).filter(e=>null!=e);r(s.length?new Map(s):null),n.current=e}return()=>{a(e),a(t)};function a(e){e.forEach(e=>{let t=tb(e);null==t||t.removeEventListener("scroll",l)})}},[l,e]),(0,w.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((e,t)=>eq(e,t),tt):tN(e):tt,[e,t])}(ev),eC=tG(ek),eN=tG(ek,[ec]),eS=eq(ej,eC),eM=ef?tu(ef,ej):null,eL=X&&eM?E({active:X,collisionRect:eM,droppableRects:er,droppableContainers:ee,pointerCoordinates:ew}):null,eE=ts(eL,"id"),[eD,eR]=(0,w.useState)(null),eA=(o=ep?ej:eq(ej,eN),i=null!=(l=null==eD?void 0:eD.rect)?l:null,{...o,scaleX:i&&ec?i.width/ec.width:1,scaleY:i&&ec?i.height/ec.height:1}),eB=(0,w.useRef)(null),eW=(0,w.useCallback)((e,t)=>{let{sensor:r,options:n}=t;if(null==Y.current)return;let l=F.get(Y.current);if(!l)return;let a=e.nativeEvent,s=new r({active:Y.current,activeNode:l,event:a,options:n,context:eu,onAbort(e){if(!F.get(e))return;let{onDragAbort:t}=_.current,r={id:e};null==t||t(r),B({type:"onDragAbort",event:r})},onPending(e,t,r,n){if(!F.get(e))return;let{onDragPending:l}=_.current,a={id:e,constraint:t,initialCoordinates:r,offset:n};null==l||l(a),B({type:"onDragPending",event:a})},onStart(e){let t=Y.current;if(null==t)return;let r=F.get(t);if(!r)return;let{onDragStart:n}=_.current,l={activatorEvent:a,active:{id:t,data:r.data,rect:K}};(0,eI.unstable_batchedUpdates)(()=>{null==n||n(l),O(y.Initializing),A({type:u.DragStart,initialCoordinates:e,active:t}),B({type:"onDragStart",event:l}),J(eB.current),Z(a)})},onMove(e){A({type:u.DragMove,coordinates:e})},onEnd:o(u.DragEnd),onCancel:o(u.DragCancel)});function o(e){return async function(){let{active:t,collisions:r,over:n,scrollAdjustedTranslate:l}=eu.current,s=null;if(t&&l){let{cancelDrop:o}=_.current;s={activatorEvent:a,active:t,collisions:r,delta:l,over:n},e===u.DragEnd&&"function"==typeof o&&await Promise.resolve(o(s))&&(e=u.DragCancel)}Y.current=null,(0,eI.unstable_batchedUpdates)(()=>{A({type:e}),O(y.Uninitialized),eR(null),J(null),Z(null),eB.current=null;let t=e===u.DragEnd?"onDragEnd":"onDragCancel";if(s){let e=_.current[t];null==e||e(s),B({type:t,event:s})}})}}eB.current=s},[F]),e$=(0,w.useCallback)((e,t)=>(r,n)=>{let l=r.nativeEvent,a=F.get(n);null!==Y.current||!a||l.dndKit||l.defaultPrevented||!0===e(r,t.options,{active:a})&&(l.dndKit={capturedBy:t.sensor},Y.current=n,eW(r,t))},[F,eW]),eP=(0,w.useMemo)(()=>L.reduce((e,t)=>{let{sensor:r}=t;return[...e,...r.activators.map(e=>({eventName:e.eventName,handler:e$(e.handler,t)}))]},[]),[L,e$]);(0,w.useEffect)(()=>{if(!eT)return;let e=L.map(e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()});return()=>{for(let t of e)null==t||t()}},L.map(e=>{let{sensor:t}=e;return t})),eF(()=>{ec&&W===y.Initializing&&O(y.Initialized)},[ec,W]),(0,w.useEffect)(()=>{let{onDragMove:e}=_.current,{active:t,activatorEvent:r,collisions:n,over:l}=eu.current;if(!t||!r)return;let a={active:t,activatorEvent:r,collisions:n,delta:{x:eS.x,y:eS.y},over:l};(0,eI.unstable_batchedUpdates)(()=>{null==e||e(a),B({type:"onDragMove",event:a})})},[eS.x,eS.y]),(0,w.useEffect)(()=>{let{active:e,activatorEvent:t,collisions:r,droppableContainers:n,scrollAdjustedTranslate:l}=eu.current;if(!e||null==Y.current||!t||!l)return;let{onDragOver:a}=_.current,s=n.get(eE),o=s&&s.rect.current?{id:s.id,rect:s.rect.current,data:s.data,disabled:s.disabled}:null,i={active:e,activatorEvent:t,collisions:r,delta:{x:l.x,y:l.y},over:o};(0,eI.unstable_batchedUpdates)(()=>{eR(o),null==a||a(i),B({type:"onDragOver",event:i})})},[eE]),eF(()=>{eu.current={activatorEvent:q,active:X,activeNode:ea,collisionRect:eM,collisions:eL,droppableRects:er,draggableNodes:F,draggingNode:em,draggingNodeRect:ef,droppableContainers:U,over:eD,scrollableAncestors:ev,scrollAdjustedTranslate:eS},K.current={initial:ef,translated:eM}},[X,ea,eL,eM,F,em,ef,er,U,eD,ev,eS]),function(e){let t,{acceleration:r,activator:n=p.Pointer,canScroll:l,draggingRect:a,enabled:s,interval:o=5,order:i=g.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:x,threshold:m}=e,f=function(e){let{delta:t,disabled:r}=e,n=eX(t);return eV(e=>{if(r||!n||!e)return tF;let l={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[h.Backward]:e.x[h.Backward]||-1===l.x,[h.Forward]:e.x[h.Forward]||1===l.x},y:{[h.Backward]:e.y[h.Backward]||-1===l.y,[h.Forward]:e.y[h.Forward]||1===l.y}}},[r,t,n])}({delta:x,disabled:!s}),[b,v]=(t=(0,w.useRef)(null),[(0,w.useCallback)((e,r)=>{t.current=setInterval(e,r)},[]),(0,w.useCallback)(()=>{null!==t.current&&(clearInterval(t.current),t.current=null)},[])]),y=(0,w.useRef)({x:0,y:0}),j=(0,w.useRef)({x:0,y:0}),k=(0,w.useMemo)(()=>{switch(n){case p.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case p.DraggableRect:return a}},[n,a,c]),C=(0,w.useRef)(null),N=(0,w.useCallback)(()=>{let e=C.current;if(!e)return;let t=y.current.x*j.current.x,r=y.current.y*j.current.y;e.scrollBy(t,r)},[]),S=(0,w.useMemo)(()=>i===g.TreeOrder?[...d].reverse():d,[i,d]);(0,w.useEffect)(()=>{if(!s||!d.length||!k)return void v();for(let e of S){if((null==l?void 0:l(e))===!1)continue;let t=u[d.indexOf(e)];if(!t)continue;let{direction:n,speed:a}=function(e,t,r,n,l){let{top:a,left:s,right:o,bottom:i}=r;void 0===n&&(n=10),void 0===l&&(l=tC);let{isTop:c,isBottom:d,isLeft:u,isRight:x}=tk(e),m={x:0,y:0},f={x:0,y:0},p={height:t.height*l.y,width:t.width*l.x};return!c&&a<=t.top+p.height?(m.y=h.Backward,f.y=n*Math.abs((t.top+p.height-a)/p.height)):!d&&i>=t.bottom-p.height&&(m.y=h.Forward,f.y=n*Math.abs((t.bottom-p.height-i)/p.height)),!x&&o>=t.right-p.width?(m.x=h.Forward,f.x=n*Math.abs((t.right-p.width-o)/p.width)):!u&&s<=t.left+p.width&&(m.x=h.Backward,f.x=n*Math.abs((t.left+p.width-s)/p.width)),{direction:m,speed:f}}(e,t,k,r,m);for(let e of["x","y"])f[e][n[e]]||(a[e]=0,n[e]=0);if(a.x>0||a.y>0){v(),C.current=e,b(N,o),y.current=a,j.current=n;return}}y.current={x:0,y:0},j.current={x:0,y:0},v()},[r,N,l,v,s,o,JSON.stringify(k),JSON.stringify(f),b,d,S,u,JSON.stringify(m)])}({...eo,delta:H,draggingRect:eM,pointerCoordinates:ew,scrollableAncestors:ev,scrollableAncestorRects:ey});let eH=(0,w.useMemo)(()=>({active:X,activeNode:ea,activeNodeRect:ec,activatorEvent:q,collisions:eL,containerNodeRect:ed,dragOverlay:ex,draggableNodes:F,droppableContainers:U,droppableRects:er,over:eD,measureDroppableContainers:en,scrollableAncestors:ev,scrollableAncestorRects:ey,measuringConfiguration:et,measuringScheduled:el,windowRect:eb}),[X,ea,ec,q,eL,ed,ex,F,U,er,eD,en,ev,ey,et,el,eb]),eY=(0,w.useMemo)(()=>({activatorEvent:q,activators:eP,active:X,activeNodeRect:ec,ariaDescribedById:{draggable:Q},dispatch:A,draggableNodes:F,over:eD,measureDroppableContainers:en}),[q,eP,X,ec,A,Q,F,eD,en]);return w.default.createElement(e3.Provider,{value:z},w.default.createElement(t5.Provider,{value:eY},w.default.createElement(t3.Provider,{value:eH},w.default.createElement(re.Provider,{value:eA},M)),w.default.createElement(t7,{disabled:(null==N?void 0:N.restoreFocus)===!1})),w.default.createElement(e7,{...N,hiddenTextDescribedById:Q}))}),rr=(0,w.createContext)(null),rn="button";function rl(){return(0,w.useContext)(t3)}let ra={timeout:25};function rs(e){let{animation:t,children:r}=e,[n,l]=(0,w.useState)(null),[a,s]=(0,w.useState)(null),o=eX(r);return r||n||!o||l(o),eF(()=>{if(!a)return;let e=null==n?void 0:n.key,r=null==n?void 0:n.props.id;null==e||null==r?l(null):Promise.resolve(t(r,a)).then(()=>{l(null)})},[t,n,a]),w.default.createElement(w.default.Fragment,null,r,n?(0,w.cloneElement)(n,{ref:s}):null)}let ro={x:0,y:0,scaleX:1,scaleY:1};function ri(e){let{children:t}=e;return w.default.createElement(t5.Provider,{value:t4},w.default.createElement(re.Provider,{value:ro},t))}let rc={position:"fixed",touchAction:"none"},rd=e=>e_(e)?"transform 250ms ease":void 0,ru=(0,w.forwardRef)((e,t)=>{let{as:r,activatorEvent:n,adjustScale:l,children:a,className:s,rect:o,style:i,transform:c,transition:d=rd}=e;if(!o)return null;let u=l?c:{...c,scaleX:1,scaleY:1},h={...rc,width:o.width,height:o.height,top:o.top,left:o.left,transform:e0.Transform.toString(u),transformOrigin:l&&n?function(e,t){let r=eQ(e);if(!r)return"0 0";let n={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return n.x+"% "+n.y+"%"}(n,o):void 0,transition:"function"==typeof d?d(n):d,...i};return w.default.createElement(r,{className:s,style:h,ref:t},a)}),rh={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:e0.Transform.toString(t)},{transform:e0.Transform.toString(r)}]},sideEffects:(t={styles:{active:{opacity:"0"}}},e=>{let{active:r,dragOverlay:n}=e,l={},{styles:a,className:s}=t;if(null!=a&&a.active)for(let[e,t]of Object.entries(a.active))void 0!==t&&(l[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,t));if(null!=a&&a.dragOverlay)for(let[e,t]of Object.entries(a.dragOverlay))void 0!==t&&n.node.style.setProperty(e,t);return null!=s&&s.active&&r.node.classList.add(s.active),null!=s&&s.dragOverlay&&n.node.classList.add(s.dragOverlay),function(){for(let[e,t]of Object.entries(l))r.node.style.setProperty(e,t);null!=s&&s.active&&r.node.classList.remove(s.active)}})},rx=0,rm=w.default.memo(e=>{var t;let{adjustScale:r=!1,children:n,dropAnimation:l,style:a,transition:s,modifiers:o,wrapperElement:i="div",className:c,zIndex:d=999}=e,{activatorEvent:u,active:h,activeNodeRect:x,containerNodeRect:m,draggableNodes:f,droppableContainers:p,dragOverlay:g,over:b,measuringConfiguration:v,scrollableAncestors:y,scrollableAncestorRects:j,windowRect:k}=rl(),C=(0,w.useContext)(re),N=(t=null==h?void 0:h.id,(0,w.useMemo)(()=>{if(null!=t)return++rx},[t])),S=t9(o,{activatorEvent:u,active:h,activeNodeRect:x,containerNodeRect:m,draggingNodeRect:g.rect,over:b,overlayNodeRect:g.rect,scrollableAncestors:y,scrollableAncestorRects:j,transform:C,windowRect:k}),M=tU(x),L=function(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:l}=e;return eH((e,a)=>{if(null===t)return;let s=r.get(e);if(!s)return;let o=s.node.current;if(!o)return;let i=tZ(a);if(!i)return;let{transform:c}=ez(a).getComputedStyle(a),d=th(c);if(!d)return;let u="function"==typeof t?t:function(e){let{duration:t,easing:r,sideEffects:n,keyframes:l}={...rh,...e};return e=>{let{active:a,dragOverlay:s,transform:o,...i}=e;if(!t)return;let c={x:s.rect.left-a.rect.left,y:s.rect.top-a.rect.top},d={scaleX:1!==o.scaleX?a.rect.width*o.scaleX/s.rect.width:1,scaleY:1!==o.scaleY?a.rect.height*o.scaleY/s.rect.height:1},u={x:o.x-c.x,y:o.y-c.y,...d},h=l({...i,active:a,dragOverlay:s,transform:{initial:o,final:u}}),[x]=h,m=h[h.length-1];if(JSON.stringify(x)===JSON.stringify(m))return;let f=null==n?void 0:n({active:a,dragOverlay:s,...i}),p=s.node.animate(h,{duration:t,easing:r,fill:"forwards"});return new Promise(e=>{p.onfinish=()=>{null==f||f(),e()}})}}(t);return tS(o,l.draggable.measure),u({active:{id:e,data:s.data,node:o,rect:l.draggable.measure(o)},draggableNodes:r,dragOverlay:{node:a,rect:l.dragOverlay.measure(i)},droppableContainers:n,measuringConfiguration:l,transform:d})})}({config:l,draggableNodes:f,droppableContainers:p,measuringConfiguration:v}),E=M?g.setRef:void 0;return w.default.createElement(ri,null,w.default.createElement(rs,{animation:L},h&&N?w.default.createElement(ru,{key:N,id:h.id,ref:E,as:i,activatorEvent:u,adjustScale:r,className:c,transition:s,rect:M,style:{zIndex:d,...a},transform:S},n):null))});function rf(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function rp(e){return null!==e&&e>=0}let rg=e=>{let{rects:t,activeIndex:r,overIndex:n,index:l}=e,a=rf(t,n,r),s=t[l],o=a[l];return o&&s?{x:o.left-s.left,y:o.top-s.top,scaleX:o.width/s.width,scaleY:o.height/s.height}:null},rb="Sortable",rv=w.default.createContext({activeIndex:-1,containerId:rb,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:rg,disabled:{draggable:!1,droppable:!1}});function ry(e){let{children:t,id:r,items:n,strategy:l=rg,disabled:a=!1}=e,{active:s,dragOverlay:o,droppableRects:i,over:c,measureDroppableContainers:d}=rl(),u=eG(rb,r),h=null!==o.rect,x=(0,w.useMemo)(()=>n.map(e=>"object"==typeof e&&"id"in e?e.id:e),[n]),m=null!=s,f=s?x.indexOf(s.id):-1,p=c?x.indexOf(c.id):-1,g=(0,w.useRef)(x),b=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(x,g.current),v=-1!==p&&-1===f||b,y="boolean"==typeof a?{draggable:a,droppable:a}:a;eF(()=>{b&&m&&d(x)},[b,x,m,d]),(0,w.useEffect)(()=>{g.current=x},[x]);let j=(0,w.useMemo)(()=>({activeIndex:f,containerId:u,disabled:y,disableTransforms:v,items:x,overIndex:p,useDragOverlay:h,sortedRects:x.reduce((e,t,r)=>{let n=i.get(t);return n&&(e[r]=n),e},Array(x.length)),strategy:l}),[f,u,y.draggable,y.droppable,v,x,p,i,h,l]);return w.default.createElement(rv.Provider,{value:j},t)}let rj=e=>{let{id:t,items:r,activeIndex:n,overIndex:l}=e;return rf(r,n,l).indexOf(t)},rw=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:l,items:a,newIndex:s,previousItems:o,previousContainerId:i,transition:c}=e;return!!c&&!!n&&(o===a||l!==s)&&(!!r||s!==l&&t===i)},rk={duration:200,easing:"ease"},rC="transform",rN=e0.Transition.toString({property:rC,duration:0,easing:"linear"}),rS={roleDescription:"sortable"};function rM(e){if(!e)return!1;let t=e.data.current;return!!t&&"sortable"in t&&"object"==typeof t.sortable&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable}let rL=[m.Down,m.Right,m.Up,m.Left],rE=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:l,droppableContainers:a,over:s,scrollableAncestors:o}}=t;if(rL.includes(e.code)){if(e.preventDefault(),!r||!n)return;let t=[];a.getEnabled().forEach(r=>{if(!r||null!=r&&r.disabled)return;let a=l.get(r.id);if(a)switch(e.code){case m.Down:n.top<a.top&&t.push(r);break;case m.Up:n.top>a.top&&t.push(r);break;case m.Left:n.left>a.left&&t.push(r);break;case m.Right:n.left<a.left&&t.push(r)}});let d=(e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,l=ta(t),a=[];for(let e of n){let{id:t}=e,n=r.get(t);if(n){let r=ta(n),s=Number((l.reduce((e,t,n)=>e+tr(r[n],t),0)/4).toFixed(4));a.push({id:t,data:{droppableContainer:e,value:s}})}}return a.sort(tn)})({active:r,collisionRect:n,droppableRects:l,droppableContainers:t,pointerCoordinates:null}),u=ts(d,"id");if(u===(null==s?void 0:s.id)&&d.length>1&&(u=d[1].id),null!=u){let e=a.get(r.id),t=a.get(u),s=t?l.get(t.id):null,d=null==t?void 0:t.node.current;if(d&&s&&e&&t){var i,c;let r=tp(d).some((e,t)=>o[t]!==e),l=rD(e,t),a=(i=e,c=t,!!rM(i)&&!!rM(c)&&!!rD(i,c)&&i.data.current.sortable.index<c.data.current.sortable.index),u=r||!l?{x:0,y:0}:{x:a?n.width-s.width:0,y:a?n.height-s.height:0},h={x:s.left,y:s.top};return u.x&&u.y?h:eZ(h,u)}}}};function rD(e,t){return!!rM(e)&&!!rM(t)&&e.data.current.sortable.containerId===t.data.current.sortable.containerId}function rR({id:e,character:t,index:r}){let{attributes:n,listeners:l,setNodeRef:a,transform:s,transition:o,isDragging:i}=function(e){var t,r,n,l;let{animateLayoutChanges:a=rw,attributes:s,disabled:o,data:i,getNewIndex:c=rj,id:d,strategy:h,resizeObserverConfig:x,transition:m=rk}=e,{items:f,containerId:p,activeIndex:g,disabled:b,disableTransforms:v,sortedRects:y,overIndex:j,useDragOverlay:k,strategy:C}=(0,w.useContext)(rv),N=(t=o,r=b,"boolean"==typeof t?{draggable:t,droppable:!1}:{draggable:null!=(n=null==t?void 0:t.draggable)?n:r.draggable,droppable:null!=(l=null==t?void 0:t.droppable)?l:r.droppable}),S=f.indexOf(d),M=(0,w.useMemo)(()=>({sortable:{containerId:p,index:S,items:f},...i}),[p,i,S,f]),L=(0,w.useMemo)(()=>f.slice(f.indexOf(d)),[f,d]),{rect:E,node:D,isOver:R,setNodeRef:I}=function(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:l}=e,a=eG("Droppable"),{active:s,dispatch:o,over:i,measureDroppableContainers:c}=(0,w.useContext)(t5),d=(0,w.useRef)({disabled:r}),h=(0,w.useRef)(!1),x=(0,w.useRef)(null),m=(0,w.useRef)(null),{disabled:f,updateMeasurementsFor:p,timeout:g}={...ra,...l},b=eU(null!=p?p:n),v=tV({callback:(0,w.useCallback)(()=>{if(!h.current){h.current=!0;return}null!=m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(b.current)?b.current:[b.current]),m.current=null},g)},[g]),disabled:f||!s}),[y,j]=eK((0,w.useCallback)((e,t)=>{v&&(t&&(v.unobserve(t),h.current=!1),e&&v.observe(e))},[v])),k=eU(t);return(0,w.useEffect)(()=>{v&&y.current&&(v.disconnect(),h.current=!1,v.observe(y.current))},[y,v]),(0,w.useEffect)(()=>(o({type:u.RegisterDroppable,element:{id:n,key:a,disabled:r,node:y,rect:x,data:k}}),()=>o({type:u.UnregisterDroppable,key:a,id:n})),[n]),(0,w.useEffect)(()=>{r!==d.current.disabled&&(o({type:u.SetDroppableDisabled,id:n,key:a,disabled:r}),d.current.disabled=r)},[n,a,r,o]),{active:s,rect:x,isOver:(null==i?void 0:i.id)===n,node:y,over:i,setNodeRef:j}}({id:d,data:M,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:L,...x}}),{active:T,activatorEvent:A,activeNodeRect:B,attributes:z,setNodeRef:W,listeners:O,isDragging:$,over:P,setActivatorNodeRef:F,transform:H}=function(e){let{id:t,data:r,disabled:n=!1,attributes:l}=e,a=eG("Draggable"),{activators:s,activatorEvent:o,active:i,activeNodeRect:c,ariaDescribedById:d,draggableNodes:u,over:h}=(0,w.useContext)(t5),{role:x=rn,roleDescription:m="draggable",tabIndex:f=0}=null!=l?l:{},p=(null==i?void 0:i.id)===t,g=(0,w.useContext)(p?re:rr),[b,v]=eK(),[y,j]=eK(),k=(0,w.useMemo)(()=>s.reduce((e,r)=>{let{eventName:n,handler:l}=r;return e[n]=e=>{l(e,t)},e},{}),[s,t]),C=eU(r);return eF(()=>(u.set(t,{id:t,key:a,node:b,activatorNode:y,data:C}),()=>{let e=u.get(t);e&&e.key===a&&u.delete(t)}),[u,t]),{active:i,activatorEvent:o,activeNodeRect:c,attributes:(0,w.useMemo)(()=>({role:x,tabIndex:f,"aria-disabled":n,"aria-pressed":!!p&&x===rn||void 0,"aria-roledescription":m,"aria-describedby":d.draggable}),[n,x,f,p,m,d.draggable]),isDragging:p,listeners:n?void 0:k,node:b,over:h,setNodeRef:v,setActivatorNodeRef:j,transform:g}}({id:d,data:M,attributes:{...rS,...s},disabled:N.draggable}),U=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,w.useMemo)(()=>e=>{t.forEach(t=>t(e))},t)}(I,W),V=!!T,K=V&&!v&&rp(g)&&rp(j),X=!k&&$,Y=X&&K?H:null,G=K?null!=Y?Y:(null!=h?h:C)({rects:y,activeNodeRect:B,activeIndex:g,overIndex:j,index:S}):null,J=rp(g)&&rp(j)?c({id:d,items:f,activeIndex:g,overIndex:j}):S,q=null==T?void 0:T.id,Z=(0,w.useRef)({activeId:q,items:f,newIndex:J,containerId:p}),_=f!==Z.current.items,Q=a({active:T,containerId:p,isDragging:$,isSorting:V,id:d,index:S,items:f,newIndex:Z.current.newIndex,previousItems:Z.current.items,previousContainerId:Z.current.containerId,transition:m,wasDragging:null!=Z.current.activeId}),ee=function(e){let{disabled:t,index:r,node:n,rect:l}=e,[a,s]=(0,w.useState)(null),o=(0,w.useRef)(r);return eF(()=>{if(!t&&r!==o.current&&n.current){let e=l.current;if(e){let t=tm(n.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&s(r)}}r!==o.current&&(o.current=r)},[t,r,n,l]),(0,w.useEffect)(()=>{a&&s(null)},[a]),a}({disabled:!Q,index:S,node:D,rect:E});return(0,w.useEffect)(()=>{V&&Z.current.newIndex!==J&&(Z.current.newIndex=J),p!==Z.current.containerId&&(Z.current.containerId=p),f!==Z.current.items&&(Z.current.items=f)},[V,J,p,f]),(0,w.useEffect)(()=>{if(q===Z.current.activeId)return;if(null!=q&&null==Z.current.activeId){Z.current.activeId=q;return}let e=setTimeout(()=>{Z.current.activeId=q},50);return()=>clearTimeout(e)},[q]),{active:T,activeIndex:g,attributes:z,data:M,rect:E,index:S,newIndex:J,items:f,isOver:R,isSorting:V,isDragging:$,listeners:O,node:D,overIndex:j,over:P,setNodeRef:U,setActivatorNodeRef:F,setDroppableNodeRef:I,setDraggableNodeRef:W,transform:null!=ee?ee:G,transition:ee||_&&Z.current.newIndex===S?rN:(!X||e_(A))&&m&&(V||Q)?e0.Transition.toString({...m,property:rC}):void 0}}({id:e}),c={transform:e0.Transform.toString(s),transition:o};return(0,j.jsxs)("div",{ref:a,style:c,...n,...l,className:`
        p-1.5 rounded border-2 transition-all cursor-grab active:cursor-grabbing
        ${i?"border-retro-cyan bg-retro-cyan/20 opacity-50":"border-retro-grid/30 hover:border-retro-grid/50"}
      `,title:`Character ${r}`,children:[(0,j.jsx)(T.CharacterDisplay,{character:t,mode:"small",smallScale:3}),(0,j.jsx)("div",{className:"text-[8px] text-gray-500 text-center mt-0.5",children:r})]})}function rI({character:e}){return(0,j.jsx)("div",{className:"p-1.5 rounded border-2 border-retro-cyan bg-retro-navy shadow-lg",children:(0,j.jsx)(T.CharacterDisplay,{character:e,mode:"small",smallScale:3})})}function rT({isOpen:e,onClose:t,characters:r,onReorder:n}){let[l,a]=(0,w.useState)([]),[s,o]=(0,w.useState)(null);(0,w.useEffect)(()=>{e&&a([...r])},[e,r]);let i=(0,w.useMemo)(()=>l.map((e,t)=>`char-${t}`),[l]),c=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,w.useMemo)(()=>[...t].filter(e=>null!=e),[...t])}(te(tP,{activationConstraint:{distance:8}}),te(tB,{coordinateGetter:rE})),d=(0,w.useMemo)(()=>s&&l[parseInt(s.replace("char-",""),10)]||null,[s,l]),u=(0,w.useCallback)(e=>{o(e.active.id)},[]),h=(0,w.useCallback)(e=>{let{active:t,over:r}=e;if(o(null),r&&t.id!==r.id){let e=parseInt(t.id.replace("char-",""),10),n=parseInt(r.id.replace("char-",""),10);a(t=>rf(t,e,n))}},[]),x=(0,w.useCallback)(()=>{n(l),t()},[l,n,t]),m=(0,w.useCallback)(e=>{"Escape"===e.key&&t()},[t]),f=(0,w.useMemo)(()=>l.length!==r.length||l.some((e,t)=>e!==r[t]),[l,r]);return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:m,children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-3xl max-h-[80vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,j.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-retro-grid/30",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Reorder Characters"}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Drag and drop characters to reorder them"})]}),(0,j.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,j.jsxs)(rt,{sensors:c,collisionDetection:ti,onDragStart:u,onDragEnd:h,children:[(0,j.jsx)(ry,{items:i,strategy:rg,children:(0,j.jsx)("div",{className:"grid gap-2 bg-black/30 rounded-lg p-3",style:{gridTemplateColumns:"repeat(auto-fill, minmax(50px, 1fr))"},children:l.map((e,t)=>(0,j.jsx)(rR,{id:i[t],character:e,index:t},i[t]))})}),(0,j.jsx)(rm,{children:d&&(0,j.jsx)(rI,{character:d})})]})}),(0,j.jsxs)("div",{className:"flex-shrink-0 p-4 border-t border-retro-grid/30 flex justify-between",children:[(0,j.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:x,disabled:!f,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply"})]})]})]}):null}let rA=[{label:"0.25x",value:.25},{label:"0.5x",value:.5},{label:"0.75x",value:.75},{label:"1.5x",value:1.5},{label:"2x",value:2},{label:"3x",value:3},{label:"4x",value:4}],rB=[{id:"nearest",label:"Nearest Neighbor",description:"Fast, sharp edges"},{id:"threshold",label:"Threshold-based",description:"Smoother, considers pixel coverage"}];function rz({isOpen:e,onClose:t,onScale:r,characters:n,selectedIndices:l,config:a,foregroundColor:s="#ffffff",backgroundColor:o="#000000"}){let[i,c]=(0,w.useState)(2),[d,u]=(0,w.useState)("mc"),[h,x]=(0,w.useState)("nearest"),m=(0,w.useMemo)(()=>Array.from(l).slice(0,16).map(e=>n[e]).filter(e=>void 0!==e),[n,l]),f=(0,w.useMemo)(()=>m.map(e=>(0,K.scaleCharacter)(e,i,d,h)),[m,i,d,h]),p=Math.max(0,l.size-16),g=(0,w.useCallback)(()=>{r(i,d,h),t()},[i,d,h,r,t]),b=(0,w.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&g()},[t,g]);if(!e)return null;let v=Math.min(4,m.length);return(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:b,children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Scale Characters"}),(0,j.jsx)("div",{className:"mb-6",children:(0,j.jsxs)("div",{className:"flex gap-4",children:[(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"Before"}),(0,j.jsx)("div",{className:"bg-retro-dark rounded border border-retro-grid/30 p-2 min-h-[80px] flex items-center justify-center",children:(0,j.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${v}, ${2*a.width}px)`},children:m.map((e,t)=>(0,j.jsx)(T.CharacterDisplay,{character:e,mode:"small",smallScale:2,foregroundColor:s,backgroundColor:o,interactive:!1},t))})}),p>0&&(0,j.jsxs)("p",{className:"text-[10px] text-gray-500 mt-1 text-center",children:["+",p," more"]})]}),(0,j.jsxs)("div",{className:"flex-1",children:[(0,j.jsx)("label",{className:"block text-xs text-gray-500 mb-2",children:"After"}),(0,j.jsx)("div",{className:"bg-retro-dark rounded border border-retro-grid/30 p-2 min-h-[80px] flex items-center justify-center",children:(0,j.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${v}, ${2*a.width}px)`},children:f.map((e,t)=>(0,j.jsx)(T.CharacterDisplay,{character:e,mode:"small",smallScale:2,foregroundColor:s,backgroundColor:o,interactive:!1},t))})}),p>0&&(0,j.jsxs)("p",{className:"text-[10px] text-gray-500 mt-1 text-center",children:["+",p," more"]})]})]})}),(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Scale Factor"}),(0,j.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[rA.map(e=>(0,j.jsx)("button",{type:"button",onClick:()=>c(e.value),className:`
                  px-3 py-1.5 text-sm rounded border transition-all
                  ${i===e.value?"border-retro-pink bg-retro-pink/20 text-retro-pink":"border-retro-grid/50 bg-retro-dark text-gray-400 hover:border-retro-grid hover:text-white"}
                `,children:e.label},e.value)),(0,j.jsxs)("div",{className:"flex items-center gap-1.5 ml-2",children:[(0,j.jsx)("span",{className:"text-xs text-gray-500",children:"or"}),(0,j.jsx)("input",{type:"number",min:.1,max:10,step:.1,value:i,onChange:e=>{let t=parseFloat(e.target.value);!isNaN(t)&&t>0&&t<=10&&c(Math.round(100*t)/100)},className:"w-20 px-2 py-1.5 text-sm bg-retro-dark border border-retro-grid/50 rounded text-white text-center focus:outline-none focus:border-retro-pink"}),(0,j.jsx)("span",{className:"text-xs text-gray-500",children:"x"})]})]})]}),(0,j.jsx)("div",{className:"mb-4",children:(0,j.jsx)(ey,{value:d,onChange:u,description:"Select where to anchor content when scaling"})}),(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Algorithm"}),(0,j.jsx)("div",{className:"flex gap-2",children:rB.map(e=>(0,j.jsxs)("button",{type:"button",onClick:()=>x(e.id),className:`
                  flex-1 px-3 py-2 text-sm rounded border transition-all text-left
                  ${h===e.id?"border-retro-cyan bg-retro-cyan/20 text-retro-cyan":"border-retro-grid/50 bg-retro-dark text-gray-400 hover:border-retro-grid hover:text-white"}
                `,children:[(0,j.jsx)("div",{className:"font-medium",children:e.label}),(0,j.jsx)("div",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]},e.id))})]}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mb-4 text-center h-4",children:i>1?"Content will be enlarged and clipped to fit":i<1?"Content will be reduced":"No scaling applied"}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:g,disabled:1===i||i<=0||i>10,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Apply"})]})]})]})}function rW({isOpen:e,onClose:t,totalCharacters:r,currentIndex:n,onGoTo:l}){let[a,s]=(0,w.useState)(""),[o,i]=(0,w.useState)(null);(0,w.useEffect)(()=>{e&&(s(""),i(null))},[e]),(0,w.useEffect)(()=>{i(function(e){let t=e.trim().toLowerCase();if(!t)return null;if(t.startsWith("0x")){let e=parseInt(t.slice(2),16);return isNaN(e)?null:e}if(t.startsWith("$")){let e=parseInt(t.slice(1),16);return isNaN(e)?null:e}if(t.endsWith("h")){let e=parseInt(t.slice(0,-1),16);return isNaN(e)?null:e}let r=parseInt(t,10);return isNaN(r)?null:r}(a))},[a]);let c=null!==o&&o>=0&&o<r,d=(0,w.useCallback)(()=>{c&&null!==o&&(l(o),t())},[c,o,l,t]),u=(0,w.useCallback)(e=>{"Escape"===e.key?t():"Enter"===e.key&&d()},[t,d]);if(!e)return null;let h=null!==o&&H(o),x=null!==o?F(o):null;return(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:u,children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-xs bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Go to Character"}),(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"Character Index"}),(0,j.jsx)("input",{type:"text",value:a,onChange:e=>s(e.target.value),placeholder:"e.g. 65, 0x41, $41",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white focus:outline-none focus:border-retro-cyan font-mono",autoFocus:!0}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter decimal (65) or hex (0x41, $41)"})]}),(0,j.jsxs)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30 min-h-[60px]",children:[null===o&&a&&(0,j.jsx)("p",{className:"text-xs text-red-400",children:"Invalid number format"}),null!==o&&!c&&(0,j.jsxs)("p",{className:"text-xs text-red-400",children:["Index out of range (0-",r-1,")"]}),c&&null!==o&&(0,j.jsxs)("div",{className:"space-y-1",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-xs text-gray-400",children:"Decimal:"}),(0,j.jsx)("span",{className:"text-sm text-retro-cyan font-mono",children:o})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-xs text-gray-400",children:"Hex:"}),(0,j.jsxs)("span",{className:"text-sm text-retro-cyan font-mono",children:["0x",o.toString(16).toUpperCase().padStart(2,"0")]})]}),h&&(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-xs text-gray-400",children:"ASCII:"}),(0,j.jsxs)("span",{className:"text-sm text-retro-pink font-mono",children:["'",String.fromCharCode(o),"'"]})]}),x&&(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-xs text-gray-400",children:"Control:"}),(0,j.jsxs)("span",{className:"text-sm text-retro-pink",children:[x.abbr," (",x.name,")"]})]})]}),!a&&(0,j.jsxs)("p",{className:"text-xs text-gray-500",children:["Current: ",n," (0x",n.toString(16).toUpperCase().padStart(2,"0"),")"]})]}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:d,disabled:!c,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Go"})]})]})]})}function rO({character:e,index:t,isSelected:r,onClick:n,foregroundColor:l,backgroundColor:a}){let s=e.pixels.length,o=e.pixels[0]?.length||0,i=H(t),c=F(t),d=(0,w.useMemo)(()=>{let e=[`#${t}`,`0x${t.toString(16).toUpperCase().padStart(2,"0")}`];return i?e.push(`'${String.fromCharCode(t)}'`):c&&e.push(`${c.abbr} (${c.name})`),e.join(" | ")},[t,i,c]);return(0,j.jsxs)("button",{onClick:n,className:`
        relative p-0.5 rounded transition-all
        hover:bg-retro-cyan/20 hover:ring-1 hover:ring-retro-cyan/50
        ${r?"bg-retro-cyan/30 ring-2 ring-retro-cyan":""}
      `,title:d,children:[(0,j.jsx)("div",{className:"grid",style:{gridTemplateColumns:`repeat(${o}, 2px)`,gridTemplateRows:`repeat(${s}, 2px)`,width:2*o,height:2*s},children:e.pixels.flat().map((e,t)=>(0,j.jsx)("div",{style:{backgroundColor:e?l:a,width:2,height:2}},t))}),(0,j.jsx)("span",{className:"absolute inset-0 flex items-center justify-center text-[6px] font-mono text-white opacity-0 hover:opacity-100 bg-black/60 rounded",children:t.toString(16).toUpperCase().padStart(2,"0")})]})}function r$({isOpen:e,onClose:t,characters:r,selectedIndex:n,onSelect:l,foregroundColor:a="#ffffff",backgroundColor:s="#000000"}){let o=(0,w.useCallback)(e=>{"Escape"===e.key&&t()},[t]),i=(0,w.useCallback)(e=>{l(e),t()},[l,t]),c=Math.ceil(r.length/16);return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onKeyDown:o,children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-2xl max-h-[90vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Character Map"}),(0,j.jsxs)("p",{className:"text-xs text-gray-400",children:[r.length," characters • Click to select • Hover for details"]})]}),(0,j.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsxs)("div",{className:"flex p-4 pb-0 gap-1",children:[(0,j.jsx)("div",{className:"w-8"})," ",(0,j.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:16}).map((e,t)=>(0,j.jsx)("div",{className:"w-[18px] text-center text-[8px] font-mono text-gray-500",children:t.toString(16).toUpperCase()},t))})]}),(0,j.jsx)("div",{className:"flex-1 overflow-auto p-4 pt-2",children:(0,j.jsx)("div",{className:"flex flex-col gap-0.5",children:Array.from({length:c}).map((e,t)=>{let l=16*t;return(0,j.jsxs)("div",{className:"flex gap-1",children:[(0,j.jsx)("div",{className:"w-8 flex items-center justify-end pr-1 text-[9px] font-mono text-gray-500",children:(16*t).toString(16).toUpperCase().padStart(2,"0")}),(0,j.jsx)("div",{className:"flex gap-0.5",children:Array.from({length:16}).map((e,t)=>{let o=l+t;return o>=r.length?(0,j.jsx)("div",{className:"w-[18px] h-[18px] bg-retro-dark/30 rounded"},t):(0,j.jsx)(rO,{character:r[o],index:o,isSelected:o===n,onClick:()=>i(o),foregroundColor:a,backgroundColor:s},t)})})]},t)})})}),(0,j.jsxs)("div",{className:"p-3 border-t border-retro-grid/30 flex items-center justify-between text-xs text-gray-400",children:[(0,j.jsxs)("div",{className:"flex items-center gap-4",children:[(0,j.jsxs)("span",{className:"flex items-center gap-1",children:[(0,j.jsx)("span",{className:"w-3 h-3 rounded bg-retro-cyan/30 ring-1 ring-retro-cyan"}),(0,j.jsx)("span",{children:"Selected"})]}),(0,j.jsxs)("span",{children:["Current: #",n," (0x",n.toString(16).toUpperCase().padStart(2,"0"),")",H(n)&&(0,j.jsxs)("span",{className:"ml-1 text-retro-pink",children:["'",String.fromCharCode(n),"'"]})]})]}),(0,j.jsx)("span",{className:"font-mono",children:"Press M to toggle"})]})]})]}):null}let rP=[{label:"Quick Fox",text:"The quick brown fox jumps over the lazy dog."},{label:"Hello World",text:"HELLO WORLD!\nHello World!\nhello world!"},{label:"Numbers",text:"0123456789\nABCDEF abcdef"},{label:"Symbols",text:"!@#$%^&*()_+-=[]{}\\|;':\",./<>?"},{label:"ASCII Art",text:"+------------------+\n|  RETRO COMPUTER  |\n+------------------+"}],rF=[{value:1,label:"1x"},{value:2,label:"2x"},{value:3,label:"3x"},{value:4,label:"4x"}];function rH({character:e,scale:t,foregroundColor:r,backgroundColor:n}){let l=(0,w.useRef)(null);return((0,w.useEffect)(()=>{let a=l.current;if(!a||!e)return;let s=a.getContext("2d");if(!s)return;let o=e.pixels[0]?.length||8,i=e.pixels.length;a.width=o*t,a.height=i*t,s.fillStyle=n,s.fillRect(0,0,a.width,a.height),s.fillStyle=r;for(let r=0;r<i;r++)for(let n=0;n<o;n++)e.pixels[r]?.[n]&&s.fillRect(n*t,r*t,t,t)},[e,t,r,n]),e)?(0,j.jsx)("canvas",{ref:l,className:"block"}):(0,j.jsx)("div",{style:{width:8*t,height:8*t,backgroundColor:n}})}function rU({isOpen:e,onClose:t,characters:r,config:n,colors:l}){let[a,s]=(0,w.useState)(rP[0].text),[o,i]=(0,w.useState)(2),[c,d]=(0,w.useState)(l),u=(0,w.useRef)(null);(0,w.useEffect)(()=>{d(l)},[l]),(0,w.useEffect)(()=>{e&&u.current&&u.current.focus()},[e]),(0,w.useEffect)(()=>{if(!e)return;let r=e=>{"Escape"===e.key&&(e.preventDefault(),t())};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e,t]);let h=(0,w.useMemo)(()=>a.split("\n").map(e=>{let t=[];for(let n of e){let e=n.charCodeAt(0);e>=0&&e<r.length?t.push(r[e]):t.push(r[32]||r[0]||null)}return t}),[a,r]);return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Text Preview"}),(0,j.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,j.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Enter text to preview"}),(0,j.jsx)("textarea",{ref:u,value:a,onChange:e=>s(e.target.value),rows:6,className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white font-mono placeholder-gray-500 focus:outline-none focus:border-retro-cyan resize-none",placeholder:"Type your text here..."})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Sample texts"}),(0,j.jsx)("div",{className:"flex flex-wrap gap-2",children:rP.map(e=>(0,j.jsx)("button",{onClick:()=>s(e.text),className:"px-2 py-1 text-xs bg-retro-dark border border-retro-grid/30 rounded text-gray-400 hover:text-retro-cyan hover:border-retro-cyan/50 transition-colors",children:e.label},e.label))})]}),(0,j.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Scale"}),(0,j.jsx)("div",{className:"flex gap-1",children:rF.map(e=>(0,j.jsx)("button",{onClick:()=>i(e.value),className:`px-3 py-1 text-xs rounded transition-colors ${o===e.value?"bg-retro-cyan/20 border border-retro-cyan text-retro-cyan":"bg-retro-dark border border-retro-grid/30 text-gray-400 hover:text-white"}`,children:e.label},e.value))})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Character Set"}),(0,j.jsxs)("div",{className:"text-xs text-gray-500",children:[n.width,"x",n.height," pixels, ",r.length," chars"]})]})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"Preview"}),(0,j.jsx)("div",{className:"p-4 rounded border border-retro-grid/30 overflow-auto max-h-[400px]",style:{backgroundColor:c.background},children:0===h.length||1===h.length&&0===h[0].length?(0,j.jsx)("div",{className:"text-xs text-gray-500 italic",children:"Type something to see the preview..."}):(0,j.jsx)("div",{className:"space-y-0",children:h.map((e,t)=>(0,j.jsx)("div",{className:"flex flex-wrap",style:{minHeight:n.height*o},children:0===e.length?(0,j.jsx)("div",{style:{height:n.height*o,width:n.width*o}}):e.map((e,t)=>(0,j.jsx)(rH,{character:e,scale:o,foregroundColor:c.foreground,backgroundColor:c.background},t))},t))})}),(0,j.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[a.length," characters, ",h.length," lines"]})]})]})}),(0,j.jsxs)("div",{className:"flex items-center justify-between gap-3 p-4 border-t border-retro-grid/30",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-sm text-gray-400",children:"Colors:"}),(0,j.jsx)($.ColorPresetSelector,{colors:c,onColorsChange:d,dropUp:!0})]}),(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("button",{onClick:()=>s(""),className:"px-4 py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Clear"}),(0,j.jsx)("button",{onClick:t,className:"px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors",children:"Close"})]})]})]})]}):null}var rV=e.i(59544);function rK({isOpen:e,onClose:t,snapshots:r,loading:n,error:l,isAtCapacity:a,maxSnapshots:s,currentCharacters:o,currentConfig:i,foregroundColor:c,backgroundColor:d,onSave:u,onRestore:h,onDelete:x,onRename:m,onRestoreApply:f}){let[p,g]=(0,w.useState)(""),[b,v]=(0,w.useState)(!1),[y,k]=(0,w.useState)(null),[C,N]=(0,w.useState)(null),[S,M]=(0,w.useState)(null),[L,E]=(0,w.useState)(""),[D,R]=(0,w.useState)(null);(0,w.useEffect)(()=>{if(e){let e=new Date().toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});g(`Snapshot - ${e}`),k(null),N(null),M(null),R(null)}},[e]);let I=(0,w.useCallback)(async()=>{if(!p.trim())return;v(!0);let e=await u(p.trim());if(v(!1),e){let e=new Date().toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});g(`Snapshot - ${e}`)}},[p,u]),T=(0,w.useCallback)(async e=>{if(y===e){k(null),N(null);return}k(e);let t=await h(e);t&&N(t)},[y,h]),A=(0,w.useCallback)(()=>{if(C&&y){let e=r.find(e=>e.id===y);f(C,e?.name),t()}},[C,y,r,f,t]),z=(0,w.useCallback)(async e=>{await x(e),y===e&&(k(null),N(null)),R(null)},[x,y]),W=(0,w.useCallback)(e=>{M(e.id),E(e.name)},[]),O=(0,w.useCallback)(async()=>{S&&L.trim()&&await m(S,L.trim()),M(null),E("")},[S,L,m]);return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-4xl max-h-[90vh] bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl flex flex-col overflow-hidden",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Snapshots"}),(0,j.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Save and restore character set states (",r.length,"/",s,")"]})]}),(0,j.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col md:flex-row",children:[(0,j.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 border-r border-retro-grid/30",children:[(0,j.jsxs)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30",children:[(0,j.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Create New Snapshot"}),(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),placeholder:"Snapshot name",className:"flex-1 px-2 py-1.5 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",onKeyDown:e=>{"Enter"===e.key&&p.trim()&&!a&&I()}}),(0,j.jsx)(rV.Button,{onClick:I,disabled:!p.trim()||b||a||!!l,variant:"cyan",size:"sm",children:b?"Saving...":"Save"})]}),a&&(0,j.jsx)("p",{className:"text-xs text-orange-400 mt-1",children:"Maximum snapshots reached. Delete one to save a new one."})]}),l?(0,j.jsxs)("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded text-center",children:[(0,j.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,j.jsx)("p",{className:"text-sm text-red-400 mb-1",children:"Failed to load snapshots"}),(0,j.jsx)("p",{className:"text-xs text-gray-500",children:l})]}):n?(0,j.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,j.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"})}):0===r.length?(0,j.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,j.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),(0,j.jsx)("p",{className:"text-sm",children:"No snapshots yet"}),(0,j.jsx)("p",{className:"text-xs mt-1",children:"Create one to save your progress"})]}):(0,j.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,j.jsx)("div",{className:`p-3 rounded border transition-colors cursor-pointer ${y===e.id?"bg-retro-cyan/10 border-retro-cyan":"bg-retro-dark/30 border-retro-grid/30 hover:border-retro-grid/50"}`,onClick:()=>T(e.id),children:(0,j.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[S===e.id?(0,j.jsx)("input",{type:"text",value:L,onChange:e=>E(e.target.value),className:"w-full px-2 py-1 bg-retro-dark border border-retro-cyan rounded text-sm text-white focus:outline-none",autoFocus:!0,onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"===e.key?O():"Escape"===e.key&&M(null)},onBlur:O}):(0,j.jsx)("h3",{className:"text-sm text-white font-medium truncate",children:e.name}),(0,j.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,j.jsx)("span",{className:"text-xs text-gray-500",children:(0,eN.formatTimestamp)(e.createdAt)}),(0,j.jsx)("span",{className:"text-xs text-gray-600",children:"|"}),(0,j.jsxs)("span",{className:"text-xs text-gray-500",children:[e.characterCount," chars"]}),(0,j.jsx)("span",{className:"text-xs text-gray-600",children:"|"}),(0,j.jsxs)("span",{className:"text-xs text-gray-500",children:[e.config.width,"x",e.config.height]})]})]}),(0,j.jsxs)("div",{className:"flex items-center gap-1",children:[(0,j.jsx)("button",{onClick:t=>{t.stopPropagation(),W(e)},className:"p-1 text-gray-500 hover:text-white transition-colors",title:"Rename",children:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),D===e.id?(0,j.jsxs)("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),children:[(0,j.jsx)("button",{onClick:()=>z(e.id),className:"px-2 py-0.5 text-xs bg-red-500/20 border border-red-500 rounded text-red-400 hover:bg-red-500/30",children:"Delete"}),(0,j.jsx)("button",{onClick:()=>R(null),className:"px-2 py-0.5 text-xs border border-retro-grid/50 rounded text-gray-400 hover:text-white",children:"Cancel"})]}):(0,j.jsx)("button",{onClick:t=>{t.stopPropagation(),R(e.id)},className:"p-1 text-gray-500 hover:text-red-400 transition-colors",title:"Delete",children:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},e.id))})]}),(0,j.jsxs)("div",{className:"w-full md:w-72 p-4 bg-retro-dark/30 flex flex-col",children:[(0,j.jsx)("h3",{className:"text-sm font-medium text-gray-400 mb-3",children:"Preview"}),y&&C?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"flex-1 overflow-auto bg-retro-dark rounded border border-retro-grid/30 p-2 mb-3",children:[(0,j.jsx)(B.CharacterPreviewGrid,{characters:C.slice(0,64),config:i,foregroundColor:c,backgroundColor:d,smallScale:2,maxCharacters:64}),C.length>64&&(0,j.jsxs)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:["+",C.length-64," more characters"]})]}),(0,j.jsx)("div",{className:"flex gap-2",children:(0,j.jsx)(rV.Button,{onClick:A,variant:"cyan",size:"sm",className:"flex-1",children:"Restore This Snapshot"})}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"This will replace your current work"})]}):(0,j.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsxs)("svg",{className:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),(0,j.jsx)("p",{className:"text-sm",children:"Select a snapshot to preview"})]})})]})]}),(0,j.jsx)("div",{className:"p-4 border-t border-retro-grid/30 bg-retro-dark/30",children:(0,j.jsxs)("div",{className:"flex items-center gap-4",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h4",{className:"text-xs text-gray-400 mb-1",children:"Current State"}),(0,j.jsx)(B.CharacterPreviewGrid,{characters:o.slice(0,16),config:i,foregroundColor:c,backgroundColor:d,smallScale:2,maxCharacters:16})]}),(0,j.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,j.jsxs)("p",{children:[o.length," characters"]}),(0,j.jsxs)("p",{children:[i.width,"x",i.height," px"]})]})]})})]})]}):null}var rX=e.i(33491);function rY({isOpen:e,onClose:t,name:r,description:n,characters:l,config:a}){let[s,o]=(0,w.useState)(null),[i,c]=(0,w.useState)(!1),[d,u]=(0,w.useState)(null),h=(0,rX.canShare)(l.length,a.width,a.height);(0,w.useEffect)(()=>{if(!e||!h.canShare)return void o(null);try{let e=(0,rX.encodeCharacterSet)(r,n,l,a),t=(0,rX.createShareUrl)(e);o(t),u(null)}catch(e){u(e instanceof Error?e.message:"Failed to generate share URL"),o(null)}},[e,r,n,l,a,h.canShare]);let x=(0,w.useCallback)(async()=>{if(s)try{await navigator.clipboard.writeText(s),c(!0),setTimeout(()=>c(!1),2e3)}catch{let e=document.createElement("textarea");e.value=s,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),c(!0),setTimeout(()=>c(!1),2e3)}},[s]);if(!e)return null;let m=s?(0,rX.getUrlLengthStatus)(s):"error";return(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),(0,j.jsxs)("div",{className:"relative w-full max-w-lg bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl overflow-hidden",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Share Character Set"}),(0,j.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Share via URL - no account needed"})]}),(0,j.jsx)("button",{onClick:t,className:"p-1 text-gray-400 hover:text-white transition-colors",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsxs)("div",{className:"p-4",children:[(0,j.jsx)("div",{className:"mb-4 p-3 bg-retro-dark/50 rounded border border-retro-grid/30",children:(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"w-10 h-10 rounded bg-retro-cyan/10 flex items-center justify-center",children:(0,j.jsx)("svg",{className:"w-5 h-5 text-retro-cyan",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsx)("h3",{className:"text-sm text-white font-medium truncate",children:r}),(0,j.jsxs)("p",{className:"text-xs text-gray-500",children:[l.length," characters | ",a.width,"x",a.height," px"]})]})]})}),!h.canShare&&(0,j.jsx)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded",children:(0,j.jsxs)("div",{className:"flex items-start gap-2",children:[(0,j.jsx)("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-sm text-red-400",children:h.message}),(0,j.jsx)("p",{className:"text-xs text-red-400/70 mt-1",children:"Try exporting to a file instead, or reduce the number of characters."})]})]})}),h.canShare&&"warning"===m&&(0,j.jsx)("div",{className:"mb-4 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded",children:(0,j.jsxs)("div",{className:"flex items-start gap-2",children:[(0,j.jsx)("svg",{className:"w-5 h-5 text-yellow-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("p",{className:"text-sm text-yellow-400",children:"Long URL Warning"}),(0,j.jsx)("p",{className:"text-xs text-yellow-400/70 mt-1",children:"This URL may not work on all platforms (email, social media). Consider exporting to a file for reliability."})]})]})}),d&&(0,j.jsx)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded",children:(0,j.jsx)("p",{className:"text-sm text-red-400",children:d})}),s&&(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"Share URL"}),(0,j.jsxs)("div",{className:"flex gap-2",children:[(0,j.jsxs)("div",{className:"flex-1 relative",children:[(0,j.jsx)("input",{type:"text",value:s,readOnly:!0,className:"w-full h-full px-3 py-2 pr-20 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white font-mono truncate focus:outline-none focus:border-retro-cyan",onClick:e=>e.target.select()}),(0,j.jsx)("div",{className:"absolute top-0 bottom-0 right-0 w-20 pointer-events-none bg-gradient-to-r from-transparent via-retro-dark/80 to-retro-dark"}),(0,j.jsxs)("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:[s.length," chars"]})]}),(0,j.jsx)(rV.Button,{onClick:x,variant:"cyan",size:"sm",className:"whitespace-nowrap",children:i?"Copied!":"Copy"})]})]}),(0,j.jsxs)("div",{className:"mt-4 p-3 bg-retro-dark/30 rounded border border-retro-grid/20",children:[(0,j.jsx)("h4",{className:"text-xs font-medium text-gray-400 mb-2",children:"How sharing works"}),(0,j.jsxs)("ul",{className:"text-xs text-gray-500 space-y-1",children:[(0,j.jsxs)("li",{className:"flex items-start gap-2",children:[(0,j.jsx)("span",{className:"text-retro-cyan",children:"1."}),"Your character set is encoded into the URL"]}),(0,j.jsxs)("li",{className:"flex items-start gap-2",children:[(0,j.jsx)("span",{className:"text-retro-cyan",children:"2."}),"Anyone with the link can view and import it"]}),(0,j.jsxs)("li",{className:"flex items-start gap-2",children:[(0,j.jsx)("span",{className:"text-retro-cyan",children:"3."}),"No data is stored on any server"]})]})]})]}),(0,j.jsx)("div",{className:"flex justify-end gap-2 p-4 border-t border-retro-grid/30 bg-retro-dark/30",children:(0,j.jsx)(rV.Button,{onClick:t,variant:"ghost",size:"sm",children:"Close"})})]})]})}function rG({isOpen:e,onClose:t,onSelectSet:r,excludeId:n}){let{characterSets:l,loading:a}=(0,ek.useCharacterLibrary)(),[s,o]=(0,w.useState)("");(0,w.useEffect)(()=>{e||o("")},[e]);let i=(0,w.useMemo)(()=>l.filter(e=>{if(n&&e.metadata.id===n)return!1;if(s){let t=s.toLowerCase();return e.metadata.name.toLowerCase().includes(t)||e.metadata.description?.toLowerCase().includes(t)||e.metadata.manufacturer?.toLowerCase().includes(t)||e.metadata.system?.toLowerCase().includes(t)}return!0}),[l,n,s]),c=(0,w.useCallback)(e=>{try{let n=(0,eC.deserializeCharacterSet)(e);r(n),t()}catch(e){console.error("Failed to deserialize character set:",e)}},[r,t]),d=(0,w.useCallback)(()=>{o(""),t()},[t]);return e?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:d}),(0,j.jsxs)("div",{className:"relative w-full max-w-2xl max-h-[80vh] bg-retro-dark border border-retro-grid/50 rounded-xl shadow-2xl flex flex-col",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-retro-grid/30",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white",children:"Select Overlay Character Set"}),(0,j.jsx)("p",{className:"text-xs text-gray-400 mt-0.5",children:"Choose a character set to overlay for tracing"})]}),(0,j.jsx)("button",{onClick:d,className:"p-1 text-gray-400 hover:text-white transition-colors","aria-label":"Close",children:(0,j.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsx)("div",{className:"p-4 border-b border-retro-grid/30",children:(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),placeholder:"Search character sets...",className:"w-full px-3 py-2 pl-10 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",autoFocus:!0}),(0,j.jsx)("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),(0,j.jsx)("div",{className:"flex-1 overflow-auto p-4",children:a?(0,j.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,j.jsx)("div",{className:"w-6 h-6 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"})}):0===i.length?(0,j.jsx)("div",{className:"text-center py-8 text-gray-500",children:s?"No character sets match your search":"No character sets available"}):(0,j.jsx)("div",{className:"grid gap-2",children:i.map(e=>(0,j.jsx)(rJ,{characterSet:e,onSelect:()=>c(e)},e.metadata.id))})})]})]}):null}function rJ({characterSet:e,onSelect:t}){let r=e.metadata,n=e.config,l=Math.ceil(n.width/8)*n.height,a=e.binaryData?Math.ceil(3*e.binaryData.length/4):0,s=l>0?Math.floor(a/l):0;return(0,j.jsxs)("button",{onClick:t,className:"w-full flex items-center gap-3 p-3 rounded-lg border border-retro-grid/30 hover:border-retro-amber/50 hover:bg-retro-amber/5 text-left transition-colors",children:[(0,j.jsx)("div",{className:"w-12 h-12 bg-black/50 rounded flex-shrink-0 flex items-center justify-center",children:(0,j.jsxs)("span",{className:"text-xs text-gray-400 font-mono",children:[n.width,"x",n.height]})}),(0,j.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)("span",{className:"text-sm text-white truncate",children:r.name}),r.isBuiltIn&&(0,j.jsx)("span",{className:"px-1.5 py-0.5 text-[10px] bg-retro-purple/30 text-retro-pink rounded",children:"Built-in"})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2 mt-0.5 text-xs text-gray-500",children:[(0,j.jsxs)("span",{children:[s," chars"]}),r.manufacturer&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{children:"·"}),(0,j.jsx)("span",{className:"truncate",children:r.manufacturer})]}),r.system&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{children:"·"}),(0,j.jsx)("span",{className:"truncate",children:r.system})]}),r.chip&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("span",{children:"·"}),(0,j.jsx)("span",{className:"truncate",children:r.chip})]})]})]}),(0,j.jsx)("svg",{className:"w-5 h-5 text-retro-amber/50 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}let rq={danger:"bg-red-500/20 border-red-500 text-red-400 hover:bg-red-500/30",warning:"bg-orange-500/20 border-orange-500 text-orange-400 hover:bg-orange-500/30",info:"bg-retro-cyan/20 border-retro-cyan text-retro-cyan hover:bg-retro-cyan/30"};function rZ({isOpen:e,title:t,message:r,details:n,confirmLabel:l="Confirm",cancelLabel:a="Cancel",variant:s="info",onConfirm:o,onCancel:i}){let c=(0,w.useRef)(null);return((0,w.useEffect)(()=>{e&&c.current&&c.current.focus()},[e]),(0,w.useEffect)(()=>{if(!e)return;let t=e=>{"Escape"===e.key&&i()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[e,i]),e)?(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:i}),(0,j.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",role:"alertdialog","aria-modal":"true","aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-message",children:[(0,j.jsx)("h2",{id:"confirm-dialog-title",className:"text-lg font-medium text-white mb-2",children:t}),(0,j.jsx)("p",{id:"confirm-dialog-message",className:"text-sm text-gray-400 mb-4",children:r}),n&&(0,j.jsx)("div",{className:"text-xs text-gray-500 mb-6",children:n}),(0,j.jsxs)("div",{className:`flex gap-3 ${!n?"mt-2":""}`,children:[(0,j.jsx)("button",{onClick:i,className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:a}),(0,j.jsx)("button",{ref:c,onClick:o,className:`flex-1 px-4 py-2 text-sm border rounded transition-colors ${rq[s]}`,children:l})]})]})]}):null}var r_=e.i(54750),rQ=e.i(69771),r0=e.i(83621),r1=e.i(45048),r2=e.i(44254);function r4(){let e=(0,k.useRouter)(),t=(0,k.useSearchParams)().get("id"),{getById:r,save:n,deleteSet:l,loading:a}=(0,ek.useCharacterLibrary)(),s=(0,r2.useToast)(),[o,i]=(0,w.useState)(!0),[c,d]=(0,w.useState)(null),[u,h]=(0,w.useState)(!1),[x,m]=(0,w.useState)(null),f=(0,r0.useCharacterEditor)(x),[p,g]=(0,w.useState)((0,r1.getActiveColors)()),[b,v]=(0,w.useState)(20),[y,N]=(0,w.useState)(null),[S,M]=(0,w.useState)(!1),[L,E]=(0,w.useState)(!1),[D,B]=(0,w.useState)(!1),[z,W]=(0,w.useState)(!1),[$,P]=(0,w.useState)(!1),[F,H]=(0,w.useState)(!1),[K,X]=(0,w.useState)(""),[Y,G]=(0,w.useState)(!1),[J,q]=(0,w.useState)(!1),[Z,_]=(0,w.useState)(!1),[Q,ee]=(0,w.useState)(!1),[et,er]=(0,w.useState)(!1),[en,el]=(0,w.useState)(!1),[ea,es]=(0,w.useState)(!1),[eo,ei]=(0,w.useState)(!1),[ec,ed]=(0,w.useState)(!1),[eu,eb]=(0,w.useState)(!1),[ev,ey]=(0,w.useState)(!1),[ew,eN]=(0,w.useState)(null),[eS,eM]=(0,w.useState)(!1),[eL,eE]=(0,w.useState)("pixel"),[eI,eT]=(0,w.useState)(!1),{contextMenu:eA,showContextMenu:eB,hideContextMenu:ez}=function(){let[e,t]=(0,w.useState)(null);return{contextMenu:e,showContextMenu:(0,w.useCallback)((e,r,n)=>{t({x:e,y:r,index:n})},[]),hideContextMenu:(0,w.useCallback)(()=>{t(null)},[])}}(),eW=(0,r_.useAutoSave)({characterSetId:t,characters:f.characters,config:f.config,selectedIndex:f.selectedIndex,isDirty:f.isDirty,enabled:!!x}),eO=(0,rQ.useSnapshots)({characterSetId:t,enabled:!!x}),e$=(0,w.useCallback)(async e=>{let t=await eO.saveNewSnapshot(e,f.characters,f.config);return t&&s.success("Snapshot saved"),t},[eO,f.characters,f.config,s]),eP=(0,w.useCallback)((e,t)=>{x&&(f.reset({...x,characters:e}),s.info(t?`Restored: ${t}`:"Snapshot restored"))},[x,f,s]);(0,w.useEffect)(()=>{!async function(){if(!a){if(!t){d("No character set ID provided"),i(!1);return}try{let e=await r(t);e?(m(e),f.reset(e)):d("Character set not found")}catch(e){d(e instanceof Error?e.message:"Failed to load character set")}finally{i(!1)}}}()},[t,a]);let eF=(0,w.useCallback)(async()=>{if(x)try{h(!0);let e={metadata:{...x.metadata,updatedAt:Date.now()},config:f.config,characters:f.characters};await n(e),f.markSaved(),m(e),eW.clearAutoSave(),s.success("Saved successfully")}catch(e){console.error("Failed to save:",e),s.error("Failed to save changes")}finally{h(!1)}},[x,f,n,eW,s]),eH=(0,w.useCallback)(()=>{f.isDirty?eT(!0):e.push("/tools/character-rom-editor")},[f.isDirty,e]),eU=(0,w.useCallback)(()=>{eW.clearAutoSave(),eT(!1),e.push("/tools/character-rom-editor")},[eW,e]),eV=(0,w.useCallback)(()=>{t&&e.push(`/tools/character-rom-editor/export?id=${t}`)},[t,e]),eK=(0,w.useCallback)(()=>{P(!0)},[]),eX=(0,w.useCallback)(()=>{x&&(f.reset(x),s.info("Changes discarded")),P(!1)},[x,f,s]),eY=(0,w.useCallback)((e,t,r)=>{f.resizeCharacters(e,t,r)},[f]),eG=(0,w.useCallback)(()=>{let e=eW.recover();if(e&&x)try{let t=(0,eC.base64ToBinary)(e.binaryData),r=(0,eC.parseCharacterRom)(t,e.config);f.reset({...x,characters:r,config:e.config}),f.setSelectedIndex(e.selectedIndex)}catch(e){console.error("Failed to recover:",e),eW.discard()}},[eW,x,f]),eJ=(0,w.useCallback)(async()=>{if(x&&K.trim())try{G(!0);let t={metadata:{...x.metadata,id:crypto.randomUUID(),name:K.trim(),createdAt:Date.now(),updatedAt:Date.now(),isBuiltIn:!1},config:f.config,characters:f.characters};await n(t),eW.clearAutoSave(),s.success(`Saved as "${K.trim()}"`),e.push(`/tools/character-rom-editor/edit?id=${t.metadata.id}`)}catch(e){console.error("Failed to save as:",e),s.error("Failed to save copy")}finally{G(!1),H(!1),X("")}},[x,K,f,n,eW,e,s]),eq=(0,w.useCallback)(async()=>{if(t)try{W(!0),await l(t),s.success("Character set deleted"),e.push("/tools/character-rom-editor")}catch(e){console.error("Failed to delete:",e),s.error("Failed to delete character set")}finally{W(!1),B(!1)}},[t,l,e,s]),eZ=(0,w.useCallback)(async e=>{if(x)try{let t={...x,metadata:{...x.metadata,...e,updatedAt:Date.now()}};await n(t),m(t),s.success("Info updated")}catch(e){console.error("Failed to update metadata:",e),s.error("Failed to update info")}},[x,n,s]),e_=(0,w.useCallback)(()=>{X(x?.metadata.name?`${x.metadata.name} (copy)`:""),H(!0)},[x?.metadata.name]),eQ=f.characters.length,e0=(0,w.useCallback)(()=>{f.selectedIndex>0&&f.setSelectedIndex(f.selectedIndex-1)},[f]),e1=(0,w.useCallback)(()=>{f.selectedIndex<eQ-1&&f.setSelectedIndex(f.selectedIndex+1)},[f,eQ]),e2=(0,w.useCallback)(()=>{let e=Math.max(0,f.selectedIndex-16);f.setSelectedIndex(e)},[f]),e4=(0,w.useCallback)(()=>{let e=Math.min(eQ-1,f.selectedIndex+16);f.setSelectedIndex(e)},[f,eQ]),e5=(0,w.useCallback)(()=>{f.setSelectedIndex(0)},[f]),e3=(0,w.useCallback)(()=>{f.setSelectedIndex(eQ-1)},[f,eQ]),e6=(0,w.useMemo)(()=>(0,ef.createEditorShortcuts)({undo:f.undo,redo:f.redo,save:eF,rotateLeft:()=>f.rotateSelected("left"),rotateRight:()=>f.rotateSelected("right"),shiftUp:()=>f.shiftSelected("up"),shiftDown:()=>f.shiftSelected("down"),shiftLeft:()=>f.shiftSelected("left"),shiftRight:()=>f.shiftSelected("right"),invert:f.invertSelected,flipHorizontal:f.flipSelectedHorizontal,flipVertical:f.flipSelectedVertical,selectAll:f.selectAll,deleteSelected:f.deleteSelected,addCharacter:f.addCharacter,showHelp:()=>M(!0),navigatePrev:e0,navigateNext:e1,navigatePageUp:e2,navigatePageDown:e4,navigateFirst:e5,navigateLast:e3,goToCharacter:()=>es(!0),showAsciiMap:()=>ei(!0),showTextPreview:()=>ed(!0),showSnapshots:()=>eb(!0),exportSet:eV,importSet:()=>_(!0),shareSet:()=>ey(!0),saveAs:e_,editMetadata:()=>E(!0),resetChanges:eK,reorderCharacters:()=>er(!0)}),[f,eF,eV,eK,e_,e0,e1,e2,e4,e5,e3]);(0,ef.useKeyboardShortcuts)(e6,{enabled:!S});let e8=(0,w.useMemo)(()=>{if(!eA)return[];let e=eA.index,t=f.batchSelection.size>0,r=t?f.batchSelection.size+1:1;return[{label:"Edit",onClick:()=>f.setSelectedIndex(e)},{label:"Copy From...",shortcut:"C",onClick:()=>ee(!0)},{label:"",onClick:()=>{},divider:!0},{label:"Invert",shortcut:"I",onClick:f.invertSelected},{label:"Clear",onClick:f.clearSelected},{label:"Fill",onClick:f.fillSelected},{label:"",onClick:()=>{},divider:!0},{label:`Delete${t?` (${r})`:""}`,shortcut:"Del",onClick:()=>{f.deleteSelected(),s.success(t?`${r} characters deleted`:"Character deleted")},danger:!0}]},[eA,f,s]),e7=[{id:"add-char",label:"Add Char",tooltip:"Add a new character to the set",shortcut:"Ctrl+N",icon:(0,j.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 17l3.5-10h3L17 17M8.5 13h7"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 4v4m-2-2h4"})]}),onClick:f.addCharacter,priority:2},{id:"save",label:u?"Saving...":"Save Set",tooltip:"Save character set to browser storage",shortcut:"Ctrl+S",icon:(0,j.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10l4 4v12a2 2 0 01-2 2H7a2 2 0 01-2-2V5z"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 3v5h8V3"}),(0,j.jsx)("rect",{x:"14",y:"3",width:"2",height:"5",rx:"0.5",fill:"currentColor",stroke:"none"}),(0,j.jsx)("rect",{x:"8",y:"12",width:"8",height:"6",rx:"1",strokeWidth:2})]}),onClick:eF,disabled:u||!f.isDirty,active:f.isDirty,priority:3},{id:"save-as",label:"Save Set As",tooltip:"Save as a new character set with a different name",shortcut:"Ctrl+Alt+S",icon:(0,j.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10l4 4v12a2 2 0 01-2 2H7a2 2 0 01-2-2V5z"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 3v5h6V3"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M18 8v4m-2-2h4"}),(0,j.jsx)("rect",{x:"8",y:"12",width:"8",height:"6",rx:"1",strokeWidth:2})]}),onClick:e_,priority:1},{id:"delete",label:"Delete Set",tooltip:"Delete this character set from browser storage",icon:(0,j.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 3h4"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 6v14a2 2 0 002 2h8a2 2 0 002-2V6"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 10v8M14 10v8"})]}),onClick:()=>B(!0),disabled:x?.metadata.isBuiltIn,priority:1},{type:"separator",id:"sep-1"},{id:"undo",label:"Undo",tooltip:"Undo last change",shortcut:"Ctrl+Z",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),onClick:f.undo,disabled:!f.canUndo,priority:3},{id:"redo",label:"Redo",tooltip:"Redo last undone change",shortcut:"Ctrl+Y",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})}),onClick:f.redo,disabled:!f.canRedo,priority:3},{id:"reset",label:"Reset Set",tooltip:"Discard all unsaved changes",shortcut:"Ctrl+Shift+R",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),onClick:eK,disabled:!f.isDirty,priority:2},{type:"separator",id:"sep-2"},{id:"edit-metadata",label:"Edit Info",tooltip:"Edit character set name and description",shortcut:"F2",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),onClick:()=>E(!0),priority:3},{id:"resize",label:"Resize Set",tooltip:"Change character dimensions (width × height)",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),onClick:()=>q(!0),priority:0},{id:"import",label:"Import Chars",tooltip:"Import characters from ROM file or image",shortcut:"Ctrl+I",icon:(0,j.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 20l2.5-7h3L16 20M9.25 16h5.5"}),(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v8m0 0l-3-3m3 3l3-3"})]}),onClick:()=>_(!0),priority:1},{id:"reorder",label:"Reorder",tooltip:"Drag and drop to reorder characters",shortcut:"O",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),onClick:()=>er(!0),priority:0},{type:"separator",id:"sep-3"},{id:"export",label:"Export Set",tooltip:"Export character set as ROM binary file",shortcut:"E",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5v14a2 2 0 002 2h10a2 2 0 002-2V5M12 21V9m0 0l4 4m-4-4l-4 4"})}),onClick:eV,priority:1},{id:"share",label:"Share",tooltip:"Generate a shareable link to this character set",shortcut:"Ctrl+Shift+E",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),onClick:()=>ey(!0),priority:0},{type:"separator",id:"sep-4"},{id:"snapshots",label:`Snapshots (${eO.snapshots.length})`,tooltip:"Save and restore named versions of your work",shortcut:"Ctrl+Shift+S",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),onClick:()=>eb(!0),priority:1},{type:"separator",id:"sep-5"},{id:"overlay",label:"Overlay",tooltip:"Overlay another character set for tracing",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),onClick:()=>{ew?eN(null):eM(!0)},active:!!ew,activeVariant:"amber",priority:0},{id:"goto",label:"Go to",tooltip:"Jump to a specific character by index",shortcut:"G",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),onClick:()=>es(!0),priority:0},{id:"ascii-map",label:"ASCII Map",tooltip:"View all characters in a grid with ASCII codes",shortcut:"M",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),onClick:()=>ei(!0),priority:0},{id:"text-preview",label:"Preview",tooltip:"Preview text rendered with this character set",shortcut:"T",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})}),onClick:()=>ed(!0),priority:0},{type:"separator",id:"sep-6"},{id:"help",label:"Help",tooltip:"View all keyboard shortcuts and help",shortcut:"?",icon:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),onClick:()=>M(!0),priority:3}];if(o)return(0,j.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-retro-dark",children:(0,j.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,j.jsx)("div",{className:"w-12 h-12 border-2 border-retro-cyan border-t-transparent rounded-full animate-spin"}),(0,j.jsx)("span",{className:"text-sm text-gray-400",children:"Loading character set..."})]})});if(c)return(0,j.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-retro-dark",children:(0,j.jsxs)("div",{className:"flex flex-col items-center gap-4 text-center",children:[(0,j.jsx)("svg",{className:"w-16 h-16 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,j.jsx)("h2",{className:"text-lg font-medium text-red-400",children:c}),(0,j.jsx)(C.default,{href:"/tools/character-rom-editor",className:"text-sm text-retro-cyan hover:text-retro-pink transition-colors",children:"Back to Library"})]})});let e9=f.characters[f.selectedIndex]||null,te=f.batchSelection.size>0;return(0,j.jsxs)(R,{title:x?.metadata.name||"Character Editor",toolbar:e7,children:[(0,j.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,j.jsx)(U,{characterSetName:x?.metadata.name||"Untitled",isDirty:f.isDirty,characterIndex:f.selectedIndex,totalCharacters:f.characters.length,batchMode:te,zoom:b,onZoomChange:v,colors:p,onColorsChange:g,onBack:eH,className:"flex-shrink-0"}),ew&&(0,j.jsxs)("div",{className:"flex items-center gap-2 px-4 py-1.5 bg-retro-navy/60 border-b border-retro-grid/30 text-xs flex-shrink-0",children:[(0,j.jsx)("span",{className:"text-gray-400",children:"Overlay:"}),(0,j.jsx)("span",{className:"text-retro-amber truncate max-w-[150px]",children:ew.metadata.name}),(0,j.jsx)("span",{className:"text-gray-500",children:"|"}),(0,j.jsx)("button",{onClick:()=>eE("pixel"),className:`px-2 py-0.5 rounded transition-colors ${"pixel"===eL?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:text-white"}`,children:"1:1 Pixels"}),(0,j.jsx)("button",{onClick:()=>eE("stretch"),className:`px-2 py-0.5 rounded transition-colors ${"stretch"===eL?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:text-white"}`,children:"Stretch"}),(0,j.jsx)("button",{onClick:()=>eE("side-by-side"),className:`px-2 py-0.5 rounded transition-colors ${"side-by-side"===eL?"bg-retro-amber/20 text-retro-amber":"text-gray-400 hover:text-white"}`,children:"Side by Side"}),(0,j.jsx)("div",{className:"flex-1"}),(0,j.jsx)("button",{onClick:()=>eN(null),className:"text-gray-400 hover:text-red-400 transition-colors",title:"Remove overlay",children:(0,j.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,j.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,j.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,j.jsx)(I,{leftSidebar:(0,j.jsx)(O,{characters:f.characters,config:f.config,selectedIndex:f.selectedIndex,batchSelection:f.batchSelection,onSelect:f.toggleBatchSelection,onAddCharacter:f.addCharacter,onDeleteSelected:f.deleteSelected,onSelectAll:f.selectAll,onSelectNone:()=>f.toggleBatchSelection(f.selectedIndex,!1),onContextMenu:eB,foregroundColor:p.foreground,backgroundColor:p.background}),leftSidebarWidth:"240px",rightSidebar:(0,j.jsx)(eh,{character:e9,characterWidth:f.config.width,characterHeight:f.config.height,onShift:f.shiftSelected,onRotate:f.rotateSelected,onFlipHorizontal:f.flipSelectedHorizontal,onFlipVertical:f.flipSelectedVertical,onInvert:f.invertSelected,onClear:f.clearSelected,onFill:f.fillSelected,onCenter:f.centerSelected,onScale:()=>el(!0),onDelete:f.deleteSelected,onCopy:()=>ee(!0),disabled:!e9,className:"h-full"}),rightSidebarWidth:"120px",rightSidebarCollapsible:!1,children:(0,j.jsxs)("div",{className:`h-full ${"side-by-side"===eL&&ew?"flex items-center justify-center gap-8":""}`,children:[(0,j.jsx)(A,{character:e9,config:f.config,onPixelToggle:f.toggleSelectedPixel,onPixelSet:f.setSelectedPixel,onDragStart:f.startBatch,onDragEnd:()=>f.endBatch("Paint pixels"),getPixelState:f.getSelectedPixelState,batchMode:te,foregroundColor:p.foreground,backgroundColor:p.background,gridColor:p.gridColor,zoom:b,minZoom:8,maxZoom:100,onZoomChange:v,onPixelHover:(e,t)=>N({x:t,y:e}),onPixelLeave:()=>N(null),overlayCharacter:ew?.characters[f.selectedIndex]||null,overlayConfig:ew?.config,overlayMode:eL}),"side-by-side"===eL&&ew&&(0,j.jsxs)("div",{className:"flex flex-col items-center",children:[(0,j.jsxs)("div",{className:"text-xs text-gray-400 mb-2",children:[ew.metadata.name," #",f.selectedIndex]}),(0,j.jsx)("div",{className:"border border-retro-amber/30 rounded p-1 bg-black/30",children:(0,j.jsx)(T.CharacterDisplay,{character:ew.characters[f.selectedIndex]||{pixels:Array(ew.config.height).fill(null).map(()=>Array(ew.config.width).fill(!1))},mode:"large",scale:b,foregroundColor:p.foreground,backgroundColor:p.background,gridColor:p.gridColor,gridThickness:1,interactive:!1})}),!ew.characters[f.selectedIndex]&&(0,j.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"No character at this index"})]})]})})}),(0,j.jsx)(ex,{history:f.history,currentIndex:f.historyIndex,onJump:f.jumpToHistory,canRedo:f.canRedo,totalEntries:f.totalHistoryEntries}),(0,j.jsx)(V,{hoverCoords:y})]}),(0,j.jsx)(rZ,{isOpen:eW.hasRecoveryData,title:"Recover Unsaved Changes?",message:"We found unsaved changes from a previous session. Would you like to recover them?",details:eW.recoveryData&&(0,j.jsxs)(j.Fragment,{children:["Last saved: ",new Date(eW.recoveryData.timestamp).toLocaleString()]}),confirmLabel:"Recover",cancelLabel:"Discard",variant:"info",onConfirm:eG,onCancel:eW.discard}),(0,j.jsx)(ep,{isOpen:S,onClose:()=>M(!1),shortcuts:e6}),x&&(0,j.jsx)(eg.MetadataEditModal,{isOpen:L,onClose:()=>E(!1),metadata:x.metadata,onSave:eZ}),(0,j.jsx)(ej,{isOpen:J,onClose:()=>q(!1),currentWidth:f.config.width,currentHeight:f.config.height,onResize:eY}),(0,j.jsx)(eD,{isOpen:Z,onClose:()=>_(!1),currentConfig:f.config,onImport:e=>{f.addCharacters(e)}}),(0,j.jsx)(eR,{isOpen:Q,onClose:()=>ee(!1),characters:f.characters,currentIndex:f.selectedIndex,onCopy:e=>{[f.selectedIndex,...Array.from(f.batchSelection)].forEach(t=>{f.copyCharacter(e,t)})}}),(0,j.jsx)(rT,{isOpen:et,onClose:()=>er(!1),characters:f.characters,onReorder:e=>{f.setCharacters(e)}}),(0,j.jsx)(rz,{isOpen:en,onClose:()=>el(!1),onScale:(e,t,r)=>{f.scaleSelected(e,t,r),el(!1)},characters:f.characters,selectedIndices:f.selectedIndices,config:f.config,foregroundColor:p.foreground,backgroundColor:p.background}),(0,j.jsx)(rW,{isOpen:ea,onClose:()=>es(!1),totalCharacters:eQ,currentIndex:f.selectedIndex,onGoTo:e=>f.setSelectedIndex(e)}),(0,j.jsx)(r$,{isOpen:eo,onClose:()=>ei(!1),characters:f.characters,selectedIndex:f.selectedIndex,onSelect:e=>f.setSelectedIndex(e),foregroundColor:p.foreground,backgroundColor:p.background}),(0,j.jsx)(rU,{isOpen:ec,onClose:()=>ed(!1),characters:f.characters,config:f.config,colors:p}),(0,j.jsx)(rK,{isOpen:eu,onClose:()=>eb(!1),snapshots:eO.snapshots,loading:eO.loading,error:eO.error,isAtCapacity:eO.isAtCapacity,maxSnapshots:eO.maxSnapshots,currentCharacters:f.characters,currentConfig:f.config,foregroundColor:p.foreground,backgroundColor:p.background,onSave:e$,onRestore:eO.restore,onDelete:eO.remove,onRename:eO.rename,onRestoreApply:eP}),x&&(0,j.jsx)(rY,{isOpen:ev,onClose:()=>ey(!1),name:x.metadata.name,description:x.metadata.description,characters:f.characters,config:f.config}),(0,j.jsx)(rG,{isOpen:eS,onClose:()=>eM(!1),excludeId:t||void 0,onSelectSet:eN}),eA&&(0,j.jsx)(em,{x:eA.x,y:eA.y,items:e8,onClose:ez}),F&&(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>H(!1)}),(0,j.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white mb-4",children:"Save As"}),(0,j.jsxs)("div",{className:"mb-4",children:[(0,j.jsx)("label",{className:"block text-sm text-gray-300 mb-1",children:"New name"}),(0,j.jsx)("input",{type:"text",value:K,onChange:e=>X(e.target.value),placeholder:"Character set name",className:"w-full px-3 py-2 bg-retro-dark border border-retro-grid/50 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-retro-cyan",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&K.trim()?eJ():"Escape"===e.key&&H(!1)}})]}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:()=>H(!1),className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:eJ,disabled:!K.trim()||Y,className:"flex-1 px-4 py-2 text-sm bg-retro-cyan/20 border border-retro-cyan rounded text-retro-cyan hover:bg-retro-cyan/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:Y?"Saving...":"Save"})]})]})]}),D&&(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>B(!1)}),(0,j.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white mb-2",children:"Delete Character Set?"}),(0,j.jsxs)("p",{className:"text-sm text-gray-400 mb-4",children:['Are you sure you want to delete "',x?.metadata.name,'"? This action cannot be undone.']}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:()=>B(!1),className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:eq,disabled:z,className:"flex-1 px-4 py-2 text-sm bg-red-500/20 border border-red-500 rounded text-red-400 hover:bg-red-500/30 transition-colors disabled:opacity-50",children:z?"Deleting...":"Delete"})]})]})]}),$&&(0,j.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,j.jsx)("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>P(!1)}),(0,j.jsxs)("div",{className:"relative w-full max-w-md bg-retro-navy border border-retro-grid/50 rounded-lg shadow-xl p-6",children:[(0,j.jsx)("h2",{className:"text-lg font-medium text-white mb-2",children:"Reset to Last Saved?"}),(0,j.jsxs)("p",{className:"text-sm text-gray-400 mb-4",children:['This will discard all unsaved changes and restore "',x?.metadata.name,'" to its last saved state. This action cannot be undone.']}),(0,j.jsxs)("div",{className:"flex gap-3",children:[(0,j.jsx)("button",{onClick:()=>P(!1),className:"flex-1 px-4 py-2 text-sm border border-retro-grid/50 rounded text-gray-400 hover:border-retro-grid hover:text-white transition-colors",children:"Cancel"}),(0,j.jsx)("button",{onClick:eX,className:"flex-1 px-4 py-2 text-sm bg-orange-500/20 border border-orange-500 rounded text-orange-400 hover:bg-orange-500/30 transition-colors",children:"Reset"})]})]})]}),(0,j.jsx)(rZ,{isOpen:eI,title:"Unsaved Changes",message:"You have unsaved changes. Are you sure you want to leave? Your changes will be lost.",confirmLabel:"Leave",cancelLabel:"Stay",variant:"warning",onConfirm:eU,onCancel:()=>eT(!1)})]})}e.s(["EditView",()=>r4],53454)}]);